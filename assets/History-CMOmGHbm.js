import{c as Pe,j as e,d as xe,v as ze,S as me,D as We,w as Q,x as B,y as Y,b as ge,z as he,g as Ue,E as Ge,F as Oe,f as Ye}from"./index-Cs9c4FFy.js";import{r as x}from"./vendor-react-wGySg1uH.js";import{C as K}from"./Card-DjxVovBb.js";import{C as He,U as Be,M as de,a as qe}from"./MealDetailModal-CQOv7Zvr.js";import{X as pe}from"./x-B7DFZvYm.js";import{C as H}from"./calendar-Dr8sklDz.js";import{A as Je,R as ue}from"./users-CwA1y5wA.js";import{T as be,C as Ve}from"./trending-up-DMWpirKr.js";import{S as Ke}from"./scale-DtPdjzgq.js";import{C as ye}from"./chevron-left-CnFS3Ey0.js";import{T as Xe}from"./target-BLJLFmpk.js";import{T as $,G as Qe}from"./index-cQ6qJtkF.js";import{C as X}from"./chevron-right-CCkh4mUe.js";import{L as Ze}from"./loader-2-BDWAW8ws.js";import"./vendor-charts-Bdt_fL2G.js";import"./vendor-supabase-DfwcnzK-.js";import"./camera-CByKHVqQ.js";import"./trash-2-CnwVye9B.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=Pe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),tt=({summary:a,onClose:l})=>{const d=new Date(a.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl border border-white/50 animate-in slide-in-from-bottom duration-300",children:[e.jsxs("div",{className:"relative bg-royal-50 p-8 pb-10",children:[e.jsx("div",{className:"absolute top-6 right-6",children:e.jsx("button",{onClick:l,className:"p-2 bg-white text-gray-900 rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:e.jsx(pe,{size:20})})}),e.jsxs("div",{className:"flex items-center gap-2 text-royal-600 mb-3",children:[e.jsx(H,{size:20}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Daily Report"})]}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 leading-tight",children:d})]}),e.jsxs("div",{className:"p-8 -mt-6 bg-white rounded-t-[32px] relative shadow-[-10px_-10px_30px_rgba(0,0,0,0.02)]",children:[e.jsxs("div",{className:"bg-white rounded-[32px] p-6 border border-gray-100 shadow-[0_10px_30px_-10px_rgba(0,0,0,0.05)] mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 block",children:"Total Consumed"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-5xl font-extrabold text-gray-900 tracking-tighter",children:a.totalCalories}),e.jsx("span",{className:"text-gray-400 font-bold text-lg",children:"kcal"})]})]}),e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-royal-50 flex items-center justify-center text-royal-600",children:e.jsx(Je,{size:28})})]}),e.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(He,{size:16})," Macro Breakdown"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-emerald-50 hover:border-emerald-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-emerald-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalProtein,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Protein"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-blue-50 hover:border-blue-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-blue-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalCarbs,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Carbs"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-orange-50 hover:border-orange-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-orange-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalFat,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Fat"})]})]})})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 flex justify-between items-center text-xs font-bold text-gray-400 uppercase tracking-wider",children:[e.jsxs("span",{children:[a.entries.length," meals tracked"]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-royal-600",children:[e.jsx(be,{size:14}),"See History Tab"]})]})]})]})})},at=({onClose:a,onConfirm:l})=>{const[d,u]=x.useState(0),[m,g]=x.useState(""),[r,c]=x.useState(!1),[o,f]=x.useState(!0),[E,A]=x.useState(!1),[T,M]=x.useState(null);x.useEffect(()=>{(async()=>{const F=await xe();F&&(M(F),u(F.weight),g(F.weight.toString())),f(!1)})()},[]);const I=async()=>{const k=parseFloat(m)||d;if(r&&T&&k!==d){A(!0);try{await ze({...T,weight:k}),u(k)}catch(F){console.error("Failed to save weight:",F)}A(!1)}l(k)};return o?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-8 w-[90%] max-w-sm shadow-2xl",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-royal-200 dark:border-royal-800 border-t-royal-600 rounded-full animate-spin"})})})}):e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-end sm:items-center justify-center animate-in fade-in duration-300",onClick:a,children:e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-t-[28px] sm:rounded-[28px] p-6 w-full sm:w-[90%] sm:max-w-sm shadow-2xl animate-in slide-in-from-bottom duration-500",onClick:k=>k.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-royal-100 dark:bg-royal-900/30 flex items-center justify-center",children:e.jsx(Ke,{size:20,className:"text-royal-600 dark:text-royal-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-black text-gray-900 dark:text-gray-50",children:"Weight Check"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-medium",children:"Before viewing your report"})]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-xl bg-gray-100 dark:bg-white/5 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:e.jsx(pe,{size:16,className:"text-gray-400"})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-5 mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4 text-center",children:"Is your current weight still accurate?"}),r?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:m,onChange:k=>g(k.target.value),className:"w-28 text-center text-3xl font-black text-gray-900 dark:text-gray-50 bg-white dark:bg-[#0F111A] border-2 border-royal-200 dark:border-royal-800 rounded-xl py-2 focus:outline-none focus:border-royal-500",step:"0.1",min:"20",max:"300",autoFocus:!0}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm font-bold text-gray-400",children:"kg"})]}),e.jsx("button",{onClick:()=>{c(!1),g(d.toString())},className:"text-xs text-gray-400 font-medium hover:text-gray-600",children:"Cancel"})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-black text-gray-900 dark:text-gray-50 mb-1",children:[d,e.jsx("span",{className:"text-lg font-bold text-gray-400 ml-1",children:"kg"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"text-xs text-royal-600 dark:text-royal-400 font-bold flex items-center gap-1 mx-auto hover:underline",children:[e.jsx(ue,{size:12}),"Update weight"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 py-3.5 rounded-xl bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 font-bold text-sm hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:I,disabled:E,className:"flex-1 py-3.5 rounded-xl bg-royal-600 text-white font-bold text-sm hover:bg-royal-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:E?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{size:16}),"Confirm"]})})]})]})})},rt=({report:a,reportType:l,onClose:d,onRegenerate:u,isRegenerating:m=!1})=>{const g=()=>{const c=new Date(a.periodStart),o=new Date(a.periodEnd);if(l==="daily")return c.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});if(l==="weekly"){const f=c.toLocaleDateString("en-US",{month:"short",day:"numeric"}),E=o.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${f} - ${E}`}return c.toLocaleDateString("en-US",{month:"long",year:"numeric"})},r=()=>{switch(l){case"daily":return"Daily Review";case"weekly":return"Weekly Summary";case"monthly":return"Monthly Report"}};return e.jsx("div",{className:"fixed inset-0 bg-[#F8F9FE] dark:bg-[#0F111A] z-[100] animate-in slide-in-from-right duration-300 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen pb-20",children:[e.jsx("div",{className:"sticky top-0 bg-[#F8F9FE]/80 dark:bg-[#0F111A]/80 backdrop-blur-xl z-10 px-6 pt-10 pb-4 border-b border-gray-100 dark:border-white/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:d,className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 hover:text-royal-600 transition-colors",children:[e.jsx(ye,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back"})]}),e.jsxs("button",{onClick:u,disabled:m,className:"flex items-center gap-2 text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl hover:bg-royal-100 dark:hover:bg-royal-900/30 transition-colors disabled:opacity-50",children:[e.jsx(ue,{size:12,className:m?"animate-spin":""}),m?"Generating...":"Regenerate"]})]})}),e.jsxs("div",{className:"px-6 pt-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(me,{size:20,className:"text-royal-600 dark:text-royal-400"}),e.jsx("span",{className:"text-[10px] font-bold text-royal-600 dark:text-royal-400 uppercase tracking-widest",children:"Coach Tips"})]}),e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight mb-1",children:r()}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500",children:[e.jsx(H,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:g()})]})]}),e.jsx("div",{className:"bg-gradient-to-br from-royal-500 to-royal-700 rounded-[24px] p-6 mb-6 shadow-lg shadow-royal-200/30 dark:shadow-royal-900/40",children:e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0",children:e.jsx(be,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white/80 mb-1",children:"Summary"}),e.jsx("p",{className:"text-white text-sm leading-relaxed",children:a.summary})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Period Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-orange-100 dark:bg-orange-500/10 flex items-center justify-center",children:e.jsx(Be,{size:12,className:"text-orange-600 dark:text-orange-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Calories"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.avgCalories,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"kcal"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-emerald-100 dark:bg-emerald-500/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-black text-emerald-600 dark:text-emerald-400",children:"P"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Protein"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.avgProtein,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"g"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-purple-100 dark:bg-purple-500/10 flex items-center justify-center",children:e.jsx(We,{size:12,className:"text-purple-600 dark:text-purple-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Workouts"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.workoutsCompleted,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"done"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-blue-100 dark:bg-blue-500/10 flex items-center justify-center",children:e.jsx(Xe,{size:12,className:"text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Rate"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.calorieGoalHitRate,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"%"})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Improvement Tips"}),e.jsx("div",{className:"space-y-3",children:a.tips.map((c,o)=>e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5 flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-50 dark:bg-white/5 flex items-center justify-center flex-shrink-0 text-xl",children:c.emoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 mb-0.5",children:c.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed",children:c.description})]})]},o))})]}),a.weightAtReport&&e.jsxs("div",{className:"text-center text-xs text-gray-400 dark:text-gray-500",children:["Weight at report: ",e.jsxs("span",{className:"font-bold",children:[a.weightAtReport," kg"]})]})]})]})})},st=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",ot=()=>new Qe({apiKey:st()}),fe="snapcal_coach_reports_v1",lt=`You are **Cal Coach**, providing personalized health and fitness reviews.

**Your Role:**
Generate concise, motivating, and actionable reports based on the user's tracking data.

**Report Guidelines:**
1. **Summary**: 2-3 sentences highlighting key achievements and areas for improvement
2. **Tips**: Exactly 3 specific, actionable tips 
3. **Tone**: Encouraging but honest. Celebrate wins, gently address gaps

**Tip Format:**
Each tip should have:
- emoji: A relevant emoji (ðŸ¥—, ðŸ’ª, ðŸŽ¯, âš¡, ðŸ’§, ðŸ”¥, etc.)
- title: Short action phrase (3-5 words)
- description: One sentence explaining the tip

**Never:**
- Be negative or discouraging
- Give generic advice that doesn't relate to the user's data
- Use medical disclaimers or suggest consulting doctors
- Repeat the same tip twice`,nt=async(a,l)=>{if(!Q){const g=localStorage.getItem("snapcal_workouts");return g?JSON.parse(g).filter(c=>c.date>=a&&c.date<=l):[]}const d=await B();if(!d)return[];const{data:u,error:m}=await Y.from("workout_plans").select("*").eq("user_id",d.id).gte("date",a).lte("date",l);return m?(console.error("Failed to fetch workout plans:",m),[]):u.map(g=>({id:g.id,date:g.date,title:g.title,exercises:g.exercises||[]}))},it=async(a,l,d)=>{const[u,m,g,r]=await Promise.all([xe(),ge(),he(),nt(l,d)]),c=g.filter(b=>b.date>=l&&b.date<=d),o=c.length,f=c.reduce((b,w)=>b+(w.totalCalories>0?1:0),0),E=o>0?Math.round(c.reduce((b,w)=>b+w.totalCalories,0)/o):0,A=o>0?Math.round(c.reduce((b,w)=>b+w.totalProtein,0)/o):0,T=o>0?Math.round(c.reduce((b,w)=>b+w.totalCarbs,0)/o):0,M=o>0?Math.round(c.reduce((b,w)=>b+w.totalFat,0)/o):0,I=c.filter(b=>Math.abs(b.totalCalories-m)<=m*.1).length,k=o>0?Math.round(I/o*100):0,F=r.filter(b=>b.exercises.some(w=>w.completed)).length,P={avgCalories:E,avgProtein:A,avgCarbs:T,avgFat:M,totalMeals:f,workoutsCompleted:F,daysTracked:o,calorieGoalHitRate:k},q=c.map(b=>({date:b.date,calories:b.totalCalories,protein:b.totalProtein,carbs:b.totalCarbs,fat:b.totalFat,meals:b.totalCalories>0?1:0}));return{profile:u,dailyGoal:m,periodStart:l,periodEnd:d,reportType:a,metrics:P,dailyBreakdown:q,workoutsCompleted:F}},dt=a=>{const{profile:l,dailyGoal:d,periodStart:u,periodEnd:m,reportType:g,metrics:r,dailyBreakdown:c}=a;let o=`**${g.charAt(0).toUpperCase()+g.slice(1)} Health Review**
`;return o+=`Period: ${u} to ${m}

`,l&&(o+=`**User Profile:**
`,l.name&&(o+=`- Name: ${l.name}
`),l.weight&&(o+=`- Weight: ${l.weight} kg
`),l.height&&(o+=`- Height: ${l.height} cm
`),l.goal&&(o+=`- Goal: ${{cut:"Lose weight",bulk:"Build muscle",maintain:"Maintain weight"}[l.goal]}
`),o+=`- Daily Calorie Goal: ${d} kcal

`),o+=`**Period Statistics:**
`,o+=`- Days tracked: ${r.daysTracked}
`,o+=`- Average daily calories: ${r.avgCalories} kcal (Goal: ${d})
`,o+=`- Average protein: ${r.avgProtein}g
`,o+=`- Average carbs: ${r.avgCarbs}g
`,o+=`- Average fat: ${r.avgFat}g
`,o+=`- Calorie goal hit rate: ${r.calorieGoalHitRate}%
`,o+=`- Workouts completed: ${r.workoutsCompleted}

`,c.length>0&&c.length<=7&&(o+=`**Daily Breakdown:**
`,c.forEach(f=>{o+=`- ${f.date}: ${f.calories} kcal, P: ${f.protein}g, C: ${f.carbs}g, F: ${f.fat}g
`})),o+=`
---

Provide a summary and 3 actionable tips based on this data.`,o},ct=async a=>{const l=ot(),d=dt(a),u=await l.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:d}]}],config:{systemInstruction:lt,responseMimeType:"application/json",responseSchema:{type:$.OBJECT,properties:{summary:{type:$.STRING},tips:{type:$.ARRAY,items:{type:$.OBJECT,properties:{emoji:{type:$.STRING},title:{type:$.STRING},description:{type:$.STRING}},required:["emoji","title","description"]}}},required:["summary","tips"]}}});return JSON.parse(u.text||'{"summary": "", "tips": []}')},we=()=>{try{const a=localStorage.getItem(fe);return a?JSON.parse(a):[]}catch{return[]}},xt=a=>{localStorage.setItem(fe,JSON.stringify(a))},mt=async(a,l,d)=>{if(!Q)return we().find(c=>c.reportType===a&&c.periodStart===l&&c.periodEnd===d)||null;const u=await B();if(!u)return null;const{data:m,error:g}=await Y.from("coach_reports").select("*").eq("user_id",u.id).eq("report_type",a).eq("period_start",l).eq("period_end",d).single();return g||!m?null:{id:m.id,userId:m.user_id,reportType:m.report_type,periodStart:m.period_start,periodEnd:m.period_end,summary:m.summary,tips:m.tips,metrics:m.metrics,weightAtReport:m.weight_at_report,createdAt:m.created_at}},gt=async a=>{if(!Q){const m=we().filter(g=>!(g.reportType===a.reportType&&g.periodStart===a.periodStart&&g.periodEnd===a.periodEnd));m.push(a),xt(m);return}const l=await B();if(!l)throw new Error("User not authenticated");await Y.from("coach_reports").delete().eq("user_id",l.id).eq("report_type",a.reportType).eq("period_start",a.periodStart).eq("period_end",a.periodEnd);const{error:d}=await Y.from("coach_reports").insert({id:a.id,user_id:l.id,report_type:a.reportType,period_start:a.periodStart,period_end:a.periodEnd,summary:a.summary,tips:a.tips,metrics:a.metrics,weight_at_report:a.weightAtReport});if(d)throw console.error("Failed to save report:",d),new Error("Failed to save report")},ht=async(a,l,d,u)=>{var o;const m=await B();if(!m)throw new Error("User not authenticated");const g=await it(a,l,d),r=await ct(g),c={id:`${a}_${l}_${Date.now()}`,userId:m.id,reportType:a,periodStart:l,periodEnd:d,summary:r.summary,tips:r.tips.slice(0,3),metrics:g.metrics,weightAtReport:u||((o=g.profile)==null?void 0:o.weight),createdAt:new Date().toISOString()};return await gt(c),c},ce=async(a,l,d,u=!1,m)=>{if(!u){const g=await mt(a,l,d);if(g)return g}return ht(a,l,d,m)},pt=(a,l)=>{if(a==="daily")return{start:l,end:l};if(a==="weekly"){const c=new Date(l),o=new Date(c);o.setDate(c.getDate()+6);const f=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`;return{start:l,end:f}}const[d,u]=l.split("-").map(Number),m=new Date(d,u,0),g=`${d}-${String(u).padStart(2,"0")}-01`,r=`${d}-${String(u).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")}`;return{start:g,end:r}},Tt=()=>{const[a,l]=x.useState([]),[d,u]=x.useState(2e3),[m,g]=x.useState(!0),[r,c]=x.useState("day"),[o,f]=x.useState(null),[E,A]=x.useState(null),[T,M]=x.useState(!1),[I,k]=x.useState(null),[F,P]=x.useState(!1),[q,b]=x.useState(!1),[w,J]=x.useState(null),[je,Z]=x.useState(!1),[ke,ee]=x.useState(!1),[N,Ne]=x.useState(Ue()),[S,ve]=x.useState(new Date().toISOString().substring(0,7)),[v,Se]=x.useState(()=>{const t=new Date,s=t.getDay(),n=s===0?-6:1-s,i=new Date(t);i.setDate(t.getDate()+n);const h=i.getFullYear(),p=String(i.getMonth()+1).padStart(2,"0"),y=String(i.getDate()).padStart(2,"0");return`${h}-${p}-${y}`}),[Ce,te]=x.useState(!1),[De,Fe]=x.useState({}),[R,U]=x.useState({}),[Ee,ae]=x.useState({}),[G,z]=x.useState({}),V=x.useRef(null);document.documentElement.classList.contains("dark");const re=x.useCallback(()=>{if(V.current){const t=V.current;t.scrollLeft=t.scrollWidth}},[]);x.useEffect(()=>{const t=setTimeout(re,100);return()=>clearTimeout(t)},[r,re]);const O=async()=>{g(!0);try{const[t,s]=await Promise.all([he(),ge()]);l(t),u(s),W(N)}catch(t){console.error("Failed to load history data",t)}finally{g(!1)}},W=x.useCallback(async t=>{if(!R[t]){ae(s=>({...s,[t]:!0}));try{const s=await Ge(t);U(n=>({...n,[t]:s}))}catch(s){console.error(`Failed to load entries for ${t}`,s)}finally{ae(s=>({...s,[t]:!1}))}}},[R]),Re=x.useCallback(async t=>{if(G[t]===void 0){z(s=>({...s,[t]:null}));try{const s=await Oe(t);z(n=>({...n,[t]:s}))}catch(s){console.error(`Failed to load image for entry ${t}`,s)}}},[G]);x.useEffect(()=>{O();const t=()=>{U({}),z({}),O()};return window.addEventListener("food-entry-updated",t),()=>window.removeEventListener("food-entry-updated",t)},[]),x.useEffect(()=>{N&&(r==="day"||r==="week")&&W(N)},[N,W,r]);const se=async t=>{await Ye(t),U({}),z({}),await O()},oe=t=>{f(null),k(t),M(!0)},Me=async t=>{P(!1),Z(!0);try{const s=r==="day"?"daily":r==="week"?"weekly":"monthly",n=r==="day"?N:r==="week"?v:S,{start:i,end:h}=pt(s,n),p=await ce(s,i,h,!1,t);J(p),b(!0)}catch(s){console.error("Failed to generate report:",s),alert("Failed to generate AI report. Please try again.")}finally{Z(!1)}},$e=async()=>{if(w){ee(!0);try{const t=await ce(w.reportType,w.periodStart,w.periodEnd,!0);J(t)}catch(t){console.error("Failed to regenerate report:",t),alert("Failed to regenerate report. Please try again.")}finally{ee(!1)}}},le=t=>(G[t.id]===void 0&&Re(t.id),{...t,imageUrl:G[t.id]||void 0}),Ae=x.useMemo(()=>{if(r==="day"){const t=[],s=new Date,n=new Date(s.getFullYear(),s.getMonth(),1);for(let i=new Date(n);i<=s;i.setDate(i.getDate()+1)){const h=i.getFullYear(),p=String(i.getMonth()+1).padStart(2,"0"),y=String(i.getDate()).padStart(2,"0"),j=`${h}-${p}-${y}`;t.push({id:j,name:i.toLocaleDateString("en-US",{weekday:"short"}),label:i.getDate().toString(),date:j})}return t}else if(r==="week"){const t=[],s=new Date,n=s.getDay(),i=n===0?-6:1-n,h=new Date(s);h.setDate(s.getDate()+i);for(let p=0;p<8;p++){const y=new Date(h);y.setDate(h.getDate()-p*7);const j=new Date(y);j.setDate(y.getDate()+6);const C=y.toLocaleDateString("en-US",{month:"short",day:"numeric"}),D=j.toLocaleDateString("en-US",{day:"numeric"}),L=y.getFullYear(),Le=String(y.getMonth()+1).padStart(2,"0"),Ie=String(y.getDate()).padStart(2,"0"),ie=`${L}-${Le}-${Ie}`;t.push({id:ie,name:"Week",label:`${C} - ${D}`,date:ie})}return t.reverse()}else{const t=new Set;return a.forEach(n=>{const i=n.date.substring(0,7);t.add(i)}),Array.from(t).sort().map(n=>{const[i,h]=n.split("-"),p=new Date(parseInt(i),parseInt(h)-1,1);return{id:n,name:p.toLocaleDateString("en-US",{year:"2-digit"}),label:p.toLocaleDateString("en-US",{month:"short"}),date:n}})}},[r,a]),_=x.useMemo(()=>{if(r==="day")return a.find(t=>t.date===N)||{date:N,totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};if(r==="week"){if(!v)return{date:"",totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};const t=new Date(v),s=new Date(t);s.setDate(t.getDate()+6);const n=v,i=s.getFullYear(),h=String(s.getMonth()+1).padStart(2,"0"),p=String(s.getDate()).padStart(2,"0"),y=`${i}-${h}-${p}`,C=a.filter(D=>D.date>=n&&D.date<=y).reduce((D,L)=>({totalCalories:D.totalCalories+L.totalCalories,totalProtein:D.totalProtein+L.totalProtein,totalCarbs:D.totalCarbs+L.totalCarbs,totalFat:D.totalFat+L.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:v,...C}}else{const s=a.filter(n=>n.date.startsWith(S)).reduce((n,i)=>({totalCalories:n.totalCalories+i.totalCalories,totalProtein:n.totalProtein+i.totalProtein,totalCarbs:n.totalCarbs+i.totalCarbs,totalFat:n.totalFat+i.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:S,...s}}},[a,N,S,v,r]),Te=x.useMemo(()=>{if(r==="day")return[];const t=n=>{if(r==="month")return n.startsWith(S);if(r==="week"&&v)try{const[i,h,p]=v.split("-").map(Number),y=new Date(i,h-1,p),j=new Date(y);j.setDate(y.getDate()+6);const C=new Date(n);return C>=y&&C<=j}catch{return!1}return!1};return Object.entries(R).filter(([n])=>t(n)).flatMap(([n,i])=>i).sort((n,i)=>i.timestamp.localeCompare(n.timestamp))},[R,S,v,r]),ne=x.useMemo(()=>{if(r==="day")return{};const t=n=>{if(r==="month")return n.startsWith(S);if(r==="week"&&v)try{const[i,h,p]=v.split("-").map(Number),y=new Date(i,h-1,p),j=new Date(y);j.setDate(y.getDate()+6);const C=new Date(n);return C>=y&&C<=j}catch{return!1}return!1},s={};return Object.entries(R).filter(([n])=>t(n)).forEach(([n,i])=>{i.length>0&&(s[n]=i.sort((h,p)=>p.timestamp.localeCompare(h.timestamp)))}),s},[R,S,v,r]),_e=t=>{Fe(s=>({...s,[t]:!s[t]}))};return x.useEffect(()=>{r==="month"&&a.filter(s=>s.date.startsWith(S)).map(s=>s.date).forEach(s=>W(s))},[r,S,a,W]),Ce?e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in slide-in-from-right duration-500 bg-[#F8F9FE] dark:bg-[#0F111A]",children:[e.jsxs("div",{className:"px-6 pt-10 pb-32 overflow-y-auto no-scrollbar",children:[e.jsxs("button",{onClick:()=>te(!1),className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 mb-6 hover:text-royal-600 transition-colors",children:[e.jsx(ye,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back to Report"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"History Log"}),e.jsx("div",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl border border-royal-100 dark:border-royal-800/50",children:r==="week"?new Date(N).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):new Date(S+"-01").toLocaleDateString(void 0,{month:"long",year:"numeric"})})]}),e.jsx("div",{className:"space-y-4",children:r==="day"?Ee[N]?e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(t=>e.jsx("div",{className:"h-20 bg-white dark:bg-[#1A1C26] rounded-[24px] animate-pulse border border-gray-100 dark:border-white/5"},t))}):(R[N]||[]).length>0?(R[N]||[]).map(t=>{const s=le(t);return e.jsxs("div",{onClick:()=>f(s),className:"bg-white dark:bg-[#1A1C26] p-4 flex justify-between items-center rounded-[24px] shadow-sm border border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer active:scale-[0.98]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold",children:t.food_item}),e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:t.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:t.calories}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},t.id)}):e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[e.jsx(H,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:"No meals logged for this day."})]}):Object.keys(ne).length>0?Object.entries(ne).sort(([t],[s])=>s.localeCompare(t)).map(([t,s])=>{const n=De[t],i=s.reduce((h,p)=>h+p.calories,0);return e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] border border-gray-100 dark:border-white/5 overflow-hidden",children:[e.jsxs("button",{onClick:()=>_e(t),className:"w-full p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`transition-transform duration-200 ${n?"rotate-90":""}`,children:e.jsx(X,{size:16,className:"text-gray-400"})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:new Date(t).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),e.jsxs("span",{className:"text-[9px] font-medium text-gray-400",children:[s.length," meal",s.length!==1?"s":""]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:i}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]}),n&&e.jsx("div",{className:"border-t border-gray-100 dark:border-white/5",children:s.map(h=>{const p=le(h);return e.jsxs("div",{onClick:()=>f(p),className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer border-b border-gray-50 dark:border-white/5 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:p.imageUrl?e.jsx("img",{src:p.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold leading-tight",children:h.food_item}),e.jsx("span",{className:"text-[9px] text-gray-400 dark:text-gray-500",children:h.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:h.calories}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},h.id)})})]},t)}):e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[e.jsx(H,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),e.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:["No data for this ",r==="month"?"month":"week","."]})]})})]}),o&&e.jsx(de,{entry:o,onClose:()=>f(null),onDelete:se,onEdit:oe})]}):e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-y-auto no-scrollbar relative bg-[#F8F9FE] dark:bg-[#0F111A]",children:[e.jsxs("div",{className:"px-6 pt-10 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"Report"}),e.jsxs("div",{className:"flex p-1 bg-white dark:bg-[#1A1C26] rounded-xl border border-gray-100 dark:border-white/5 shadow-sm",children:[e.jsx("button",{onClick:()=>c("day"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="day"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Daily"}),e.jsx("button",{onClick:()=>c("week"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="week"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Weekly"}),e.jsx("button",{onClick:()=>c("month"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="month"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Monthly"})]})]}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{ref:V,className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1 snap-x",style:{WebkitOverflowScrolling:"touch"},children:Ae.map(t=>{const s=r==="day"?t.id===N:r==="week"?t.id===v:t.id===S,n=a.some(i=>{if(r==="day")return i.date===t.id;if(r==="week"){const[h,p,y]=t.id.split("-").map(Number),j=new Date(h,p-1,y),C=new Date(j);C.setDate(j.getDate()+6);const D=new Date(i.date);return D>=j&&D<=C}return i.date.startsWith(t.id)});return e.jsxs("button",{onClick:()=>{r==="day"?Ne(t.id):r==="week"?Se(t.id):ve(t.id)},className:`flex-shrink-0 flex flex-col items-center justify-center ${r==="week"?"w-24":"w-12"} py-3 rounded-2xl transition-all duration-300 snap-center ${s?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 transform scale-110":"bg-white dark:bg-[#1A1C26] text-gray-400 dark:text-gray-500 border border-gray-100 dark:border-white/5"}`,children:[e.jsx("span",{className:`text-[9px] font-bold uppercase mb-1 ${s?"text-white/70":"text-gray-400"}`,children:t.name}),e.jsx("span",{className:"text-sm font-extrabold",children:t.label}),n&&!s&&e.jsx("div",{className:"w-1 h-1 rounded-full bg-royal-400 mt-1"})]},t.id)})}),e.jsx("div",{className:"absolute top-0 left-0 bottom-2 w-8 bg-gradient-to-r from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 right-0 bottom-2 w-8 bg-gradient-to-l from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-6 shadow-sm border border-gray-100 dark:border-white/5 flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-1",children:r==="day"?"Daily Total":r==="week"?"Weekly Total":"Monthly Total"}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("span",{className:"text-5xl font-black text-gray-900 dark:text-gray-50 tracking-tighter",children:Math.round(_.totalCalories)}),e.jsx("span",{className:"text-[10px] font-black text-royal-600 dark:text-royal-400 uppercase tracking-widest mt-0.5",children:"KCAL"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2.5 w-full",children:[e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-emerald-50/30 dark:bg-emerald-500/5 rounded-2xl border border-emerald-100/50 dark:border-emerald-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-emerald-600/60 dark:text-emerald-400/60 uppercase mb-0.5",children:"Protein"}),e.jsxs("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:[Math.round(_.totalProtein),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-amber-50/30 dark:bg-amber-500/5 rounded-2xl border border-amber-100/50 dark:border-amber-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-amber-600/60 dark:text-amber-400/60 uppercase mb-0.5",children:"Carbs"}),e.jsxs("span",{className:"text-sm font-black text-amber-600 dark:text-amber-400",children:[Math.round(_.totalCarbs),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-rose-50/30 dark:bg-rose-500/5 rounded-2xl border border-rose-100/50 dark:border-rose-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-rose-600/60 dark:text-rose-400/60 uppercase mb-0.5",children:"Fat"}),e.jsxs("span",{className:"text-sm font-black text-rose-600 dark:text-rose-400",children:[Math.round(_.totalFat),"g"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs(K,{onClick:()=>P(!0),className:"p-5 flex flex-col justify-between h-36 bg-gradient-to-br from-royal-500 to-royal-700 text-white border-none shadow-royal-200/50 cursor-pointer active:scale-[0.98] transition-transform",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(me,{size:12,className:"text-white/70"}),e.jsx("p",{className:"text-[10px] font-bold text-white/70 uppercase",children:r==="day"?"Coach Tips":"Report"})]}),e.jsx("h3",{className:"text-lg font-black leading-tight",children:r==="day"?"Daily Review":r==="week"?"Weekly Summary":e.jsxs(e.Fragment,{children:["Your Health",e.jsx("br",{}),"Summary"]})})]}),e.jsx("div",{className:"mt-2 py-2 bg-white/20 rounded-xl text-[10px] font-bold backdrop-blur-sm flex items-center justify-center gap-2",children:je?e.jsx(Ze,{size:12,className:"animate-spin"}):e.jsxs(e.Fragment,{children:["VIEW INSIGHTS",e.jsx(X,{size:12})]})})]}),e.jsxs("div",{className:"grid grid-rows-2 gap-4 h-36",children:[e.jsxs(K,{onClick:()=>te(!0),className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5 active:scale-95 transition-transform cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"History Log"}),e.jsx(X,{size:10,className:"text-gray-300"})]}),e.jsxs("p",{className:"text-xs font-black text-gray-900 dark:text-gray-50",children:[r==="day"?(R[N]||[]).length:Te.length," Meals"]})]}),e.jsxs(K,{className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Status"}),e.jsx(et,{size:10,className:"text-gray-300"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1 bg-gray-100 dark:bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-royal-500 rounded-full",style:{width:`${Math.min(_.totalCalories/(r==="day"?d:r==="week"?d*7:d*30)*100,100)}%`}})}),e.jsxs("span",{className:"text-[10px] font-black text-gray-900 dark:text-gray-50",children:[Math.round(_.totalCalories/(r==="day"?d:r==="week"?d*7:d*30)*100),"%"]})]})]})]})]}),e.jsx("div",{className:"h-24"})]}),o&&e.jsx(de,{entry:o,onClose:()=>f(null),onDelete:se,onEdit:oe}),E&&e.jsx(tt,{summary:E,onClose:()=>A(null)}),T&&e.jsx(qe,{editEntry:I,onClose:()=>{M(!1),k(null)},onSuccess:()=>{M(!1),k(null),U({}),z({}),O()},onOpenSharedMeal:()=>{M(!1)}}),F&&e.jsx(at,{onClose:()=>P(!1),onConfirm:Me}),q&&w&&e.jsx(rt,{report:w,reportType:w.reportType,onClose:()=>{b(!1),J(null)},onRegenerate:$e,isRegenerating:ke})]})};export{Tt as History};
