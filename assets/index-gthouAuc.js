var Zy=Object.defineProperty;var ev=(t,e,n)=>e in t?Zy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ba=(t,e,n)=>ev(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function tv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Wp={exports:{}},ua={},Jp={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Io=Symbol.for("react.element"),nv=Symbol.for("react.portal"),rv=Symbol.for("react.fragment"),sv=Symbol.for("react.strict_mode"),ov=Symbol.for("react.profiler"),iv=Symbol.for("react.provider"),av=Symbol.for("react.context"),lv=Symbol.for("react.forward_ref"),cv=Symbol.for("react.suspense"),uv=Symbol.for("react.memo"),dv=Symbol.for("react.lazy"),bd=Symbol.iterator;function fv(t){return t===null||typeof t!="object"?null:(t=bd&&t[bd]||t["@@iterator"],typeof t=="function"?t:null)}var Kp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yp=Object.assign,Qp={};function _s(t,e,n){this.props=t,this.context=e,this.refs=Qp,this.updater=n||Kp}_s.prototype.isReactComponent={};_s.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_s.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Xp(){}Xp.prototype=_s.prototype;function eu(t,e,n){this.props=t,this.context=e,this.refs=Qp,this.updater=n||Kp}var tu=eu.prototype=new Xp;tu.constructor=eu;Yp(tu,_s.prototype);tu.isPureReactComponent=!0;var Sd=Array.isArray,Zp=Object.prototype.hasOwnProperty,nu={current:null},em={key:!0,ref:!0,__self:!0,__source:!0};function tm(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)Zp.call(e,r)&&!em.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Io,type:t,key:o,ref:i,props:s,_owner:nu.current}}function hv(t,e){return{$$typeof:Io,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ru(t){return typeof t=="object"&&t!==null&&t.$$typeof===Io}function pv(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var kd=/\/+/g;function Va(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pv(""+t.key):e.toString(36)}function ci(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Io:case nv:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+Va(i,0):r,Sd(s)?(n="",t!=null&&(n=t.replace(kd,"$&/")+"/"),ci(s,e,n,"",function(d){return d})):s!=null&&(ru(s)&&(s=hv(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(kd,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",Sd(t))for(var a=0;a<t.length;a++){o=t[a];var c=r+Va(o,a);i+=ci(o,e,n,c,s)}else if(c=fv(t),typeof c=="function")for(t=c.call(t),a=0;!(o=t.next()).done;)o=o.value,c=r+Va(o,a++),i+=ci(o,e,n,c,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Uo(t,e,n){if(t==null)return t;var r=[],s=0;return ci(t,r,"","",function(o){return e.call(n,o,s++)}),r}function mv(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dt={current:null},ui={transition:null},gv={ReactCurrentDispatcher:dt,ReactCurrentBatchConfig:ui,ReactCurrentOwner:nu};function nm(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:Uo,forEach:function(t,e,n){Uo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Uo(t,function(){e++}),e},toArray:function(t){return Uo(t,function(e){return e})||[]},only:function(t){if(!ru(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};de.Component=_s;de.Fragment=rv;de.Profiler=ov;de.PureComponent=eu;de.StrictMode=sv;de.Suspense=cv;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gv;de.act=nm;de.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Yp({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=nu.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Zp.call(e,c)&&!em.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Io,type:t.type,key:s,ref:o,props:r,_owner:i}};de.createContext=function(t){return t={$$typeof:av,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:iv,_context:t},t.Consumer=t};de.createElement=tm;de.createFactory=function(t){var e=tm.bind(null,t);return e.type=t,e};de.createRef=function(){return{current:null}};de.forwardRef=function(t){return{$$typeof:lv,render:t}};de.isValidElement=ru;de.lazy=function(t){return{$$typeof:dv,_payload:{_status:-1,_result:t},_init:mv}};de.memo=function(t,e){return{$$typeof:uv,type:t,compare:e===void 0?null:e}};de.startTransition=function(t){var e=ui.transition;ui.transition={};try{t()}finally{ui.transition=e}};de.unstable_act=nm;de.useCallback=function(t,e){return dt.current.useCallback(t,e)};de.useContext=function(t){return dt.current.useContext(t)};de.useDebugValue=function(){};de.useDeferredValue=function(t){return dt.current.useDeferredValue(t)};de.useEffect=function(t,e){return dt.current.useEffect(t,e)};de.useId=function(){return dt.current.useId()};de.useImperativeHandle=function(t,e,n){return dt.current.useImperativeHandle(t,e,n)};de.useInsertionEffect=function(t,e){return dt.current.useInsertionEffect(t,e)};de.useLayoutEffect=function(t,e){return dt.current.useLayoutEffect(t,e)};de.useMemo=function(t,e){return dt.current.useMemo(t,e)};de.useReducer=function(t,e,n){return dt.current.useReducer(t,e,n)};de.useRef=function(t){return dt.current.useRef(t)};de.useState=function(t){return dt.current.useState(t)};de.useSyncExternalStore=function(t,e,n){return dt.current.useSyncExternalStore(t,e,n)};de.useTransition=function(){return dt.current.useTransition()};de.version="18.3.1";Jp.exports=de;var k=Jp.exports;const yv=tv(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vv=k,xv=Symbol.for("react.element"),wv=Symbol.for("react.fragment"),_v=Object.prototype.hasOwnProperty,bv=vv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sv={key:!0,ref:!0,__self:!0,__source:!0};function rm(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)_v.call(e,r)&&!Sv.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:xv,type:t,key:o,ref:i,props:s,_owner:bv.current}}ua.Fragment=wv;ua.jsx=rm;ua.jsxs=rm;Wp.exports=ua;var l=Wp.exports,Il={},sm={exports:{}},It={},om={exports:{}},im={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(M,F){var j=M.length;M.push(F);e:for(;0<j;){var J=j-1>>>1,U=M[J];if(0<s(U,F))M[J]=F,M[j]=U,j=J;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var F=M[0],j=M.pop();if(j!==F){M[0]=j;e:for(var J=0,U=M.length,Z=U>>>1;J<Z;){var te=2*(J+1)-1,ce=M[te],D=te+1,ie=M[D];if(0>s(ce,j))D<U&&0>s(ie,ce)?(M[J]=ie,M[D]=j,J=D):(M[J]=ce,M[te]=j,J=te);else if(D<U&&0>s(ie,j))M[J]=ie,M[D]=j,J=D;else break e}}return F}function s(M,F){var j=M.sortIndex-F.sortIndex;return j!==0?j:M.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var c=[],d=[],h=1,p=null,m=3,g=!1,y=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=M)r(d),F.sortIndex=F.expirationTime,e(c,F);else break;F=n(d)}}function S(M){if(_=!1,v(M),!y)if(n(c)!==null)y=!0,B(T);else{var F=n(d);F!==null&&X(S,F.startTime-M)}}function T(M,F){y=!1,_&&(_=!1,x(P),P=-1),g=!0;var j=m;try{for(v(F),p=n(c);p!==null&&(!(p.expirationTime>F)||M&&!V());){var J=p.callback;if(typeof J=="function"){p.callback=null,m=p.priorityLevel;var U=J(p.expirationTime<=F);F=t.unstable_now(),typeof U=="function"?p.callback=U:p===n(c)&&r(c),v(F)}else r(c);p=n(c)}if(p!==null)var Z=!0;else{var te=n(d);te!==null&&X(S,te.startTime-F),Z=!1}return Z}finally{p=null,m=j,g=!1}}var E=!1,C=null,P=-1,R=5,I=-1;function V(){return!(t.unstable_now()-I<R)}function Y(){if(C!==null){var M=t.unstable_now();I=M;var F=!0;try{F=C(!0,M)}finally{F?Q():(E=!1,C=null)}}else E=!1}var Q;if(typeof w=="function")Q=function(){w(Y)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,q=N.port2;N.port1.onmessage=Y,Q=function(){q.postMessage(null)}}else Q=function(){b(Y,0)};function B(M){C=M,E||(E=!0,Q())}function X(M,F){P=b(function(){M(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(M){M.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,B(T))},t.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<M?Math.floor(1e3/M):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(M){switch(m){case 1:case 2:case 3:var F=3;break;default:F=m}var j=m;m=F;try{return M()}finally{m=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(M,F){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var j=m;m=M;try{return F()}finally{m=j}},t.unstable_scheduleCallback=function(M,F,j){var J=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?J+j:J):j=J,M){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=j+U,M={id:h++,callback:F,priorityLevel:M,startTime:j,expirationTime:U,sortIndex:-1},j>J?(M.sortIndex=j,e(d,M),n(c)===null&&M===n(d)&&(_?(x(P),P=-1):_=!0,X(S,j-J))):(M.sortIndex=U,e(c,M),y||g||(y=!0,B(T))),M},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(M){var F=m;return function(){var j=m;m=F;try{return M.apply(this,arguments)}finally{m=j}}}})(im);om.exports=im;var kv=om.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ev=k,Nt=kv;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var am=new Set,to={};function br(t,e){us(t,e),us(t+"Capture",e)}function us(t,e){for(to[t]=e,t=0;t<e.length;t++)am.add(e[t])}var yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Al=Object.prototype.hasOwnProperty,Cv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ed={},Cd={};function Tv(t){return Al.call(Cd,t)?!0:Al.call(Ed,t)?!1:Cv.test(t)?Cd[t]=!0:(Ed[t]=!0,!1)}function Nv(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Iv(t,e,n,r){if(e===null||typeof e>"u"||Nv(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ft(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ze[t]=new ft(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ze[e]=new ft(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ze[t]=new ft(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ze[t]=new ft(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ze[t]=new ft(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ze[t]=new ft(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ze[t]=new ft(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ze[t]=new ft(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ze[t]=new ft(t,5,!1,t.toLowerCase(),null,!1,!1)});var su=/[\-:]([a-z])/g;function ou(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(su,ou);Ze[e]=new ft(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(su,ou);Ze[e]=new ft(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(su,ou);Ze[e]=new ft(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ze[t]=new ft(t,1,!1,t.toLowerCase(),null,!1,!1)});Ze.xlinkHref=new ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ze[t]=new ft(t,1,!1,t.toLowerCase(),null,!0,!0)});function iu(t,e,n,r){var s=Ze.hasOwnProperty(e)?Ze[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Iv(e,n,s,r)&&(n=null),r||s===null?Tv(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var bn=Ev.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jo=Symbol.for("react.element"),Or=Symbol.for("react.portal"),$r=Symbol.for("react.fragment"),au=Symbol.for("react.strict_mode"),Rl=Symbol.for("react.profiler"),lm=Symbol.for("react.provider"),cm=Symbol.for("react.context"),lu=Symbol.for("react.forward_ref"),Pl=Symbol.for("react.suspense"),Ml=Symbol.for("react.suspense_list"),cu=Symbol.for("react.memo"),Nn=Symbol.for("react.lazy"),um=Symbol.for("react.offscreen"),Td=Symbol.iterator;function Ns(t){return t===null||typeof t!="object"?null:(t=Td&&t[Td]||t["@@iterator"],typeof t=="function"?t:null)}var Ie=Object.assign,qa;function Fs(t){if(qa===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qa=e&&e[1]||""}return`
`+qa+t}var Ha=!1;function Wa(t,e){if(!t||Ha)return"";Ha=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var c=`
`+s[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=a);break}}}finally{Ha=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fs(t):""}function Av(t){switch(t.tag){case 5:return Fs(t.type);case 16:return Fs("Lazy");case 13:return Fs("Suspense");case 19:return Fs("SuspenseList");case 0:case 2:case 15:return t=Wa(t.type,!1),t;case 11:return t=Wa(t.type.render,!1),t;case 1:return t=Wa(t.type,!0),t;default:return""}}function Dl(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $r:return"Fragment";case Or:return"Portal";case Rl:return"Profiler";case au:return"StrictMode";case Pl:return"Suspense";case Ml:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case cm:return(t.displayName||"Context")+".Consumer";case lm:return(t._context.displayName||"Context")+".Provider";case lu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cu:return e=t.displayName||null,e!==null?e:Dl(t.type)||"Memo";case Nn:e=t._payload,t=t._init;try{return Dl(t(e))}catch{}}return null}function Rv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dl(e);case 8:return e===au?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dm(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Pv(t){var e=dm(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fo(t){t._valueTracker||(t._valueTracker=Pv(t))}function fm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dm(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ei(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ll(t,e){var n=e.checked;return Ie({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Nd(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Vn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hm(t,e){e=e.checked,e!=null&&iu(t,"checked",e,!1)}function Ul(t,e){hm(t,e);var n=Vn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?jl(t,e.type,n):e.hasOwnProperty("defaultValue")&&jl(t,e.type,Vn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Id(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function jl(t,e,n){(e!=="number"||Ei(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Os=Array.isArray;function es(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Vn(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Fl(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Ie({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ad(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(Os(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Vn(n)}}function pm(t,e){var n=Vn(e.value),r=Vn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Rd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ol(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Oo,gm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Oo=Oo||document.createElement("div"),Oo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Oo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function no(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mv=["Webkit","ms","Moz","O"];Object.keys(Vs).forEach(function(t){Mv.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vs[e]=Vs[t]})});function ym(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Vs.hasOwnProperty(t)&&Vs[t]?(""+e).trim():e+"px"}function vm(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ym(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Dv=Ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $l(t,e){if(e){if(Dv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Gl(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zl=null;function uu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bl=null,ts=null,ns=null;function Pd(t){if(t=Po(t)){if(typeof Bl!="function")throw Error(L(280));var e=t.stateNode;e&&(e=ma(e),Bl(t.stateNode,t.type,e))}}function xm(t){ts?ns?ns.push(t):ns=[t]:ts=t}function wm(){if(ts){var t=ts,e=ns;if(ns=ts=null,Pd(t),e)for(t=0;t<e.length;t++)Pd(e[t])}}function _m(t,e){return t(e)}function bm(){}var Ja=!1;function Sm(t,e,n){if(Ja)return t(e,n);Ja=!0;try{return _m(t,e,n)}finally{Ja=!1,(ts!==null||ns!==null)&&(bm(),wm())}}function ro(t,e){var n=t.stateNode;if(n===null)return null;var r=ma(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var Vl=!1;if(yn)try{var Is={};Object.defineProperty(Is,"passive",{get:function(){Vl=!0}}),window.addEventListener("test",Is,Is),window.removeEventListener("test",Is,Is)}catch{Vl=!1}function Lv(t,e,n,r,s,o,i,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var qs=!1,Ci=null,Ti=!1,ql=null,Uv={onError:function(t){qs=!0,Ci=t}};function jv(t,e,n,r,s,o,i,a,c){qs=!1,Ci=null,Lv.apply(Uv,arguments)}function Fv(t,e,n,r,s,o,i,a,c){if(jv.apply(this,arguments),qs){if(qs){var d=Ci;qs=!1,Ci=null}else throw Error(L(198));Ti||(Ti=!0,ql=d)}}function Sr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function km(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Md(t){if(Sr(t)!==t)throw Error(L(188))}function Ov(t){var e=t.alternate;if(!e){if(e=Sr(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return Md(s),t;if(o===r)return Md(s),e;o=o.sibling}throw Error(L(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function Em(t){return t=Ov(t),t!==null?Cm(t):null}function Cm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Cm(t);if(e!==null)return e;t=t.sibling}return null}var Tm=Nt.unstable_scheduleCallback,Dd=Nt.unstable_cancelCallback,$v=Nt.unstable_shouldYield,Gv=Nt.unstable_requestPaint,De=Nt.unstable_now,zv=Nt.unstable_getCurrentPriorityLevel,du=Nt.unstable_ImmediatePriority,Nm=Nt.unstable_UserBlockingPriority,Ni=Nt.unstable_NormalPriority,Bv=Nt.unstable_LowPriority,Im=Nt.unstable_IdlePriority,da=null,on=null;function Vv(t){if(on&&typeof on.onCommitFiberRoot=="function")try{on.onCommitFiberRoot(da,t,void 0,(t.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:Wv,qv=Math.log,Hv=Math.LN2;function Wv(t){return t>>>=0,t===0?32:31-(qv(t)/Hv|0)|0}var $o=64,Go=4194304;function $s(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ii(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=$s(a):(o&=i,o!==0&&(r=$s(o)))}else i=n&~s,i!==0?r=$s(i):o!==0&&(r=$s(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yt(e),s=1<<n,r|=t[n],e&=~s;return r}function Jv(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kv(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-Yt(o),a=1<<i,c=s[i];c===-1?(!(a&n)||a&r)&&(s[i]=Jv(a,e)):c<=e&&(t.expiredLanes|=a),o&=~a}}function Hl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Am(){var t=$o;return $o<<=1,!($o&4194240)&&($o=64),t}function Ka(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ao(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yt(e),t[e]=n}function Yv(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Yt(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function fu(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yt(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var xe=0;function Rm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Pm,hu,Mm,Dm,Lm,Wl=!1,zo=[],Un=null,jn=null,Fn=null,so=new Map,oo=new Map,Rn=[],Qv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ld(t,e){switch(t){case"focusin":case"focusout":Un=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":so.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":oo.delete(e.pointerId)}}function As(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=Po(e),e!==null&&hu(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Xv(t,e,n,r,s){switch(e){case"focusin":return Un=As(Un,t,e,n,r,s),!0;case"dragenter":return jn=As(jn,t,e,n,r,s),!0;case"mouseover":return Fn=As(Fn,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return so.set(o,As(so.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,oo.set(o,As(oo.get(o)||null,t,e,n,r,s)),!0}return!1}function Um(t){var e=lr(t.target);if(e!==null){var n=Sr(e);if(n!==null){if(e=n.tag,e===13){if(e=km(n),e!==null){t.blockedOn=e,Lm(t.priority,function(){Mm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function di(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Jl(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);zl=r,n.target.dispatchEvent(r),zl=null}else return e=Po(n),e!==null&&hu(e),t.blockedOn=n,!1;e.shift()}return!0}function Ud(t,e,n){di(t)&&n.delete(e)}function Zv(){Wl=!1,Un!==null&&di(Un)&&(Un=null),jn!==null&&di(jn)&&(jn=null),Fn!==null&&di(Fn)&&(Fn=null),so.forEach(Ud),oo.forEach(Ud)}function Rs(t,e){t.blockedOn===e&&(t.blockedOn=null,Wl||(Wl=!0,Nt.unstable_scheduleCallback(Nt.unstable_NormalPriority,Zv)))}function io(t){function e(s){return Rs(s,t)}if(0<zo.length){Rs(zo[0],t);for(var n=1;n<zo.length;n++){var r=zo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Un!==null&&Rs(Un,t),jn!==null&&Rs(jn,t),Fn!==null&&Rs(Fn,t),so.forEach(e),oo.forEach(e),n=0;n<Rn.length;n++)r=Rn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Rn.length&&(n=Rn[0],n.blockedOn===null);)Um(n),n.blockedOn===null&&Rn.shift()}var rs=bn.ReactCurrentBatchConfig,Ai=!0;function ex(t,e,n,r){var s=xe,o=rs.transition;rs.transition=null;try{xe=1,pu(t,e,n,r)}finally{xe=s,rs.transition=o}}function tx(t,e,n,r){var s=xe,o=rs.transition;rs.transition=null;try{xe=4,pu(t,e,n,r)}finally{xe=s,rs.transition=o}}function pu(t,e,n,r){if(Ai){var s=Jl(t,e,n,r);if(s===null)ol(t,e,r,Ri,n),Ld(t,r);else if(Xv(s,t,e,n,r))r.stopPropagation();else if(Ld(t,r),e&4&&-1<Qv.indexOf(t)){for(;s!==null;){var o=Po(s);if(o!==null&&Pm(o),o=Jl(t,e,n,r),o===null&&ol(t,e,r,Ri,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else ol(t,e,r,null,n)}}var Ri=null;function Jl(t,e,n,r){if(Ri=null,t=uu(r),t=lr(t),t!==null)if(e=Sr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=km(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ri=t,null}function jm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zv()){case du:return 1;case Nm:return 4;case Ni:case Bv:return 16;case Im:return 536870912;default:return 16}default:return 16}}var Dn=null,mu=null,fi=null;function Fm(){if(fi)return fi;var t,e=mu,n=e.length,r,s="value"in Dn?Dn.value:Dn.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return fi=s.slice(t,1<r?1-r:void 0)}function hi(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Bo(){return!0}function jd(){return!1}function At(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Bo:jd,this.isPropagationStopped=jd,this}return Ie(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Bo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Bo)},persist:function(){},isPersistent:Bo}),e}var bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gu=At(bs),Ro=Ie({},bs,{view:0,detail:0}),nx=At(Ro),Ya,Qa,Ps,fa=Ie({},Ro,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ps&&(Ps&&t.type==="mousemove"?(Ya=t.screenX-Ps.screenX,Qa=t.screenY-Ps.screenY):Qa=Ya=0,Ps=t),Ya)},movementY:function(t){return"movementY"in t?t.movementY:Qa}}),Fd=At(fa),rx=Ie({},fa,{dataTransfer:0}),sx=At(rx),ox=Ie({},Ro,{relatedTarget:0}),Xa=At(ox),ix=Ie({},bs,{animationName:0,elapsedTime:0,pseudoElement:0}),ax=At(ix),lx=Ie({},bs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),cx=At(lx),ux=Ie({},bs,{data:0}),Od=At(ux),dx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function px(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=hx[t])?!!e[t]:!1}function yu(){return px}var mx=Ie({},Ro,{key:function(t){if(t.key){var e=dx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yu,charCode:function(t){return t.type==="keypress"?hi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gx=At(mx),yx=Ie({},fa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$d=At(yx),vx=Ie({},Ro,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yu}),xx=At(vx),wx=Ie({},bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),_x=At(wx),bx=Ie({},fa,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Sx=At(bx),kx=[9,13,27,32],vu=yn&&"CompositionEvent"in window,Hs=null;yn&&"documentMode"in document&&(Hs=document.documentMode);var Ex=yn&&"TextEvent"in window&&!Hs,Om=yn&&(!vu||Hs&&8<Hs&&11>=Hs),Gd=" ",zd=!1;function $m(t,e){switch(t){case"keyup":return kx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Gr=!1;function Cx(t,e){switch(t){case"compositionend":return Gm(e);case"keypress":return e.which!==32?null:(zd=!0,Gd);case"textInput":return t=e.data,t===Gd&&zd?null:t;default:return null}}function Tx(t,e){if(Gr)return t==="compositionend"||!vu&&$m(t,e)?(t=Fm(),fi=mu=Dn=null,Gr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Om&&e.locale!=="ko"?null:e.data;default:return null}}var Nx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Nx[t.type]:e==="textarea"}function zm(t,e,n,r){xm(r),e=Pi(e,"onChange"),0<e.length&&(n=new gu("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ws=null,ao=null;function Ix(t){Zm(t,0)}function ha(t){var e=Vr(t);if(fm(e))return t}function Ax(t,e){if(t==="change")return e}var Bm=!1;if(yn){var Za;if(yn){var el="oninput"in document;if(!el){var Vd=document.createElement("div");Vd.setAttribute("oninput","return;"),el=typeof Vd.oninput=="function"}Za=el}else Za=!1;Bm=Za&&(!document.documentMode||9<document.documentMode)}function qd(){Ws&&(Ws.detachEvent("onpropertychange",Vm),ao=Ws=null)}function Vm(t){if(t.propertyName==="value"&&ha(ao)){var e=[];zm(e,ao,t,uu(t)),Sm(Ix,e)}}function Rx(t,e,n){t==="focusin"?(qd(),Ws=e,ao=n,Ws.attachEvent("onpropertychange",Vm)):t==="focusout"&&qd()}function Px(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ha(ao)}function Mx(t,e){if(t==="click")return ha(e)}function Dx(t,e){if(t==="input"||t==="change")return ha(e)}function Lx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var en=typeof Object.is=="function"?Object.is:Lx;function lo(t,e){if(en(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Al.call(e,s)||!en(t[s],e[s]))return!1}return!0}function Hd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Wd(t,e){var n=Hd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hd(n)}}function qm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?qm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Hm(){for(var t=window,e=Ei();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ei(t.document)}return e}function xu(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ux(t){var e=Hm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&qm(n.ownerDocument.documentElement,n)){if(r!==null&&xu(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=Wd(n,o);var i=Wd(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var jx=yn&&"documentMode"in document&&11>=document.documentMode,zr=null,Kl=null,Js=null,Yl=!1;function Jd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Yl||zr==null||zr!==Ei(r)||(r=zr,"selectionStart"in r&&xu(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Js&&lo(Js,r)||(Js=r,r=Pi(Kl,"onSelect"),0<r.length&&(e=new gu("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zr)))}function Vo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Br={animationend:Vo("Animation","AnimationEnd"),animationiteration:Vo("Animation","AnimationIteration"),animationstart:Vo("Animation","AnimationStart"),transitionend:Vo("Transition","TransitionEnd")},tl={},Wm={};yn&&(Wm=document.createElement("div").style,"AnimationEvent"in window||(delete Br.animationend.animation,delete Br.animationiteration.animation,delete Br.animationstart.animation),"TransitionEvent"in window||delete Br.transitionend.transition);function pa(t){if(tl[t])return tl[t];if(!Br[t])return t;var e=Br[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Wm)return tl[t]=e[n];return t}var Jm=pa("animationend"),Km=pa("animationiteration"),Ym=pa("animationstart"),Qm=pa("transitionend"),Xm=new Map,Kd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wn(t,e){Xm.set(t,e),br(e,[t])}for(var nl=0;nl<Kd.length;nl++){var rl=Kd[nl],Fx=rl.toLowerCase(),Ox=rl[0].toUpperCase()+rl.slice(1);Wn(Fx,"on"+Ox)}Wn(Jm,"onAnimationEnd");Wn(Km,"onAnimationIteration");Wn(Ym,"onAnimationStart");Wn("dblclick","onDoubleClick");Wn("focusin","onFocus");Wn("focusout","onBlur");Wn(Qm,"onTransitionEnd");us("onMouseEnter",["mouseout","mouseover"]);us("onMouseLeave",["mouseout","mouseover"]);us("onPointerEnter",["pointerout","pointerover"]);us("onPointerLeave",["pointerout","pointerover"]);br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));br("onBeforeInput",["compositionend","keypress","textInput","paste"]);br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$x=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gs));function Yd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Fv(r,e,void 0,t),t.currentTarget=null}function Zm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==o&&s.isPropagationStopped())break e;Yd(s,a,d),o=c}else for(i=0;i<r.length;i++){if(a=r[i],c=a.instance,d=a.currentTarget,a=a.listener,c!==o&&s.isPropagationStopped())break e;Yd(s,a,d),o=c}}}if(Ti)throw t=ql,Ti=!1,ql=null,t}function Se(t,e){var n=e[tc];n===void 0&&(n=e[tc]=new Set);var r=t+"__bubble";n.has(r)||(eg(e,t,2,!1),n.add(r))}function sl(t,e,n){var r=0;e&&(r|=4),eg(n,t,r,e)}var qo="_reactListening"+Math.random().toString(36).slice(2);function co(t){if(!t[qo]){t[qo]=!0,am.forEach(function(n){n!=="selectionchange"&&($x.has(n)||sl(n,!1,t),sl(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[qo]||(e[qo]=!0,sl("selectionchange",!1,e))}}function eg(t,e,n,r){switch(jm(e)){case 1:var s=ex;break;case 4:s=tx;break;default:s=pu}n=s.bind(null,e,n,t),s=void 0,!Vl||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function ol(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;a!==null;){if(i=lr(a),i===null)return;if(c=i.tag,c===5||c===6){r=o=i;continue e}a=a.parentNode}}r=r.return}Sm(function(){var d=o,h=uu(n),p=[];e:{var m=Xm.get(t);if(m!==void 0){var g=gu,y=t;switch(t){case"keypress":if(hi(n)===0)break e;case"keydown":case"keyup":g=gx;break;case"focusin":y="focus",g=Xa;break;case"focusout":y="blur",g=Xa;break;case"beforeblur":case"afterblur":g=Xa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Fd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=sx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=xx;break;case Jm:case Km:case Ym:g=ax;break;case Qm:g=_x;break;case"scroll":g=nx;break;case"wheel":g=Sx;break;case"copy":case"cut":case"paste":g=cx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=$d}var _=(e&4)!==0,b=!_&&t==="scroll",x=_?m!==null?m+"Capture":null:m;_=[];for(var w=d,v;w!==null;){v=w;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,x!==null&&(S=ro(w,x),S!=null&&_.push(uo(w,S,v)))),b)break;w=w.return}0<_.length&&(m=new g(m,y,null,n,h),p.push({event:m,listeners:_}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==zl&&(y=n.relatedTarget||n.fromElement)&&(lr(y)||y[vn]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(y=n.relatedTarget||n.toElement,g=d,y=y?lr(y):null,y!==null&&(b=Sr(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(g=null,y=d),g!==y)){if(_=Fd,S="onMouseLeave",x="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(_=$d,S="onPointerLeave",x="onPointerEnter",w="pointer"),b=g==null?m:Vr(g),v=y==null?m:Vr(y),m=new _(S,w+"leave",g,n,h),m.target=b,m.relatedTarget=v,S=null,lr(h)===d&&(_=new _(x,w+"enter",y,n,h),_.target=v,_.relatedTarget=b,S=_),b=S,g&&y)t:{for(_=g,x=y,w=0,v=_;v;v=Tr(v))w++;for(v=0,S=x;S;S=Tr(S))v++;for(;0<w-v;)_=Tr(_),w--;for(;0<v-w;)x=Tr(x),v--;for(;w--;){if(_===x||x!==null&&_===x.alternate)break t;_=Tr(_),x=Tr(x)}_=null}else _=null;g!==null&&Qd(p,m,g,_,!1),y!==null&&b!==null&&Qd(p,b,y,_,!0)}}e:{if(m=d?Vr(d):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var T=Ax;else if(Bd(m))if(Bm)T=Dx;else{T=Px;var E=Rx}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(T=Mx);if(T&&(T=T(t,d))){zm(p,T,n,h);break e}E&&E(t,m,d),t==="focusout"&&(E=m._wrapperState)&&E.controlled&&m.type==="number"&&jl(m,"number",m.value)}switch(E=d?Vr(d):window,t){case"focusin":(Bd(E)||E.contentEditable==="true")&&(zr=E,Kl=d,Js=null);break;case"focusout":Js=Kl=zr=null;break;case"mousedown":Yl=!0;break;case"contextmenu":case"mouseup":case"dragend":Yl=!1,Jd(p,n,h);break;case"selectionchange":if(jx)break;case"keydown":case"keyup":Jd(p,n,h)}var C;if(vu)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Gr?$m(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(Om&&n.locale!=="ko"&&(Gr||P!=="onCompositionStart"?P==="onCompositionEnd"&&Gr&&(C=Fm()):(Dn=h,mu="value"in Dn?Dn.value:Dn.textContent,Gr=!0)),E=Pi(d,P),0<E.length&&(P=new Od(P,t,null,n,h),p.push({event:P,listeners:E}),C?P.data=C:(C=Gm(n),C!==null&&(P.data=C)))),(C=Ex?Cx(t,n):Tx(t,n))&&(d=Pi(d,"onBeforeInput"),0<d.length&&(h=new Od("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=C))}Zm(p,e)})}function uo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Pi(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=ro(t,n),o!=null&&r.unshift(uo(t,o,s)),o=ro(t,e),o!=null&&r.push(uo(t,o,s))),t=t.return}return r}function Tr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Qd(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=ro(n,o),c!=null&&i.unshift(uo(n,c,a))):s||(c=ro(n,o),c!=null&&i.push(uo(n,c,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var Gx=/\r\n?/g,zx=/\u0000|\uFFFD/g;function Xd(t){return(typeof t=="string"?t:""+t).replace(Gx,`
`).replace(zx,"")}function Ho(t,e,n){if(e=Xd(e),Xd(t)!==e&&n)throw Error(L(425))}function Mi(){}var Ql=null,Xl=null;function Zl(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ec=typeof setTimeout=="function"?setTimeout:void 0,Bx=typeof clearTimeout=="function"?clearTimeout:void 0,Zd=typeof Promise=="function"?Promise:void 0,Vx=typeof queueMicrotask=="function"?queueMicrotask:typeof Zd<"u"?function(t){return Zd.resolve(null).then(t).catch(qx)}:ec;function qx(t){setTimeout(function(){throw t})}function il(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),io(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);io(e)}function On(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ef(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ss=Math.random().toString(36).slice(2),sn="__reactFiber$"+Ss,fo="__reactProps$"+Ss,vn="__reactContainer$"+Ss,tc="__reactEvents$"+Ss,Hx="__reactListeners$"+Ss,Wx="__reactHandles$"+Ss;function lr(t){var e=t[sn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[vn]||n[sn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ef(t);t!==null;){if(n=t[sn])return n;t=ef(t)}return e}t=n,n=t.parentNode}return null}function Po(t){return t=t[sn]||t[vn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function ma(t){return t[fo]||null}var nc=[],qr=-1;function Jn(t){return{current:t}}function ke(t){0>qr||(t.current=nc[qr],nc[qr]=null,qr--)}function _e(t,e){qr++,nc[qr]=t.current,t.current=e}var qn={},ot=Jn(qn),yt=Jn(!1),gr=qn;function ds(t,e){var n=t.type.contextTypes;if(!n)return qn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function vt(t){return t=t.childContextTypes,t!=null}function Di(){ke(yt),ke(ot)}function tf(t,e,n){if(ot.current!==qn)throw Error(L(168));_e(ot,e),_e(yt,n)}function tg(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(L(108,Rv(t)||"Unknown",s));return Ie({},n,r)}function Li(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qn,gr=ot.current,_e(ot,t),_e(yt,yt.current),!0}function nf(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=tg(t,e,gr),r.__reactInternalMemoizedMergedChildContext=t,ke(yt),ke(ot),_e(ot,t)):ke(yt),_e(yt,n)}var hn=null,ga=!1,al=!1;function ng(t){hn===null?hn=[t]:hn.push(t)}function Jx(t){ga=!0,ng(t)}function Kn(){if(!al&&hn!==null){al=!0;var t=0,e=xe;try{var n=hn;for(xe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}hn=null,ga=!1}catch(s){throw hn!==null&&(hn=hn.slice(t+1)),Tm(du,Kn),s}finally{xe=e,al=!1}}return null}var Hr=[],Wr=0,Ui=null,ji=0,Pt=[],Mt=0,yr=null,pn=1,mn="";function tr(t,e){Hr[Wr++]=ji,Hr[Wr++]=Ui,Ui=t,ji=e}function rg(t,e,n){Pt[Mt++]=pn,Pt[Mt++]=mn,Pt[Mt++]=yr,yr=t;var r=pn;t=mn;var s=32-Yt(r)-1;r&=~(1<<s),n+=1;var o=32-Yt(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,pn=1<<32-Yt(e)+s|n<<s|r,mn=o+t}else pn=1<<o|n<<s|r,mn=t}function wu(t){t.return!==null&&(tr(t,1),rg(t,1,0))}function _u(t){for(;t===Ui;)Ui=Hr[--Wr],Hr[Wr]=null,ji=Hr[--Wr],Hr[Wr]=null;for(;t===yr;)yr=Pt[--Mt],Pt[Mt]=null,mn=Pt[--Mt],Pt[Mt]=null,pn=Pt[--Mt],Pt[Mt]=null}var Ct=null,Et=null,Ee=!1,Kt=null;function sg(t,e){var n=Lt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function rf(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ct=t,Et=On(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ct=t,Et=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=yr!==null?{id:pn,overflow:mn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Lt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ct=t,Et=null,!0):!1;default:return!1}}function rc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function sc(t){if(Ee){var e=Et;if(e){var n=e;if(!rf(t,e)){if(rc(t))throw Error(L(418));e=On(n.nextSibling);var r=Ct;e&&rf(t,e)?sg(r,n):(t.flags=t.flags&-4097|2,Ee=!1,Ct=t)}}else{if(rc(t))throw Error(L(418));t.flags=t.flags&-4097|2,Ee=!1,Ct=t}}}function sf(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ct=t}function Wo(t){if(t!==Ct)return!1;if(!Ee)return sf(t),Ee=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Zl(t.type,t.memoizedProps)),e&&(e=Et)){if(rc(t))throw og(),Error(L(418));for(;e;)sg(t,e),e=On(e.nextSibling)}if(sf(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Et=On(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Et=null}}else Et=Ct?On(t.stateNode.nextSibling):null;return!0}function og(){for(var t=Et;t;)t=On(t.nextSibling)}function fs(){Et=Ct=null,Ee=!1}function bu(t){Kt===null?Kt=[t]:Kt.push(t)}var Kx=bn.ReactCurrentBatchConfig;function Ms(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function Jo(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function of(t){var e=t._init;return e(t._payload)}function ig(t){function e(x,w){if(t){var v=x.deletions;v===null?(x.deletions=[w],x.flags|=16):v.push(w)}}function n(x,w){if(!t)return null;for(;w!==null;)e(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function s(x,w){return x=Bn(x,w),x.index=0,x.sibling=null,x}function o(x,w,v){return x.index=v,t?(v=x.alternate,v!==null?(v=v.index,v<w?(x.flags|=2,w):v):(x.flags|=2,w)):(x.flags|=1048576,w)}function i(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,w,v,S){return w===null||w.tag!==6?(w=pl(v,x.mode,S),w.return=x,w):(w=s(w,v),w.return=x,w)}function c(x,w,v,S){var T=v.type;return T===$r?h(x,w,v.props.children,S,v.key):w!==null&&(w.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Nn&&of(T)===w.type)?(S=s(w,v.props),S.ref=Ms(x,w,v),S.return=x,S):(S=wi(v.type,v.key,v.props,null,x.mode,S),S.ref=Ms(x,w,v),S.return=x,S)}function d(x,w,v,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=ml(v,x.mode,S),w.return=x,w):(w=s(w,v.children||[]),w.return=x,w)}function h(x,w,v,S,T){return w===null||w.tag!==7?(w=hr(v,x.mode,S,T),w.return=x,w):(w=s(w,v),w.return=x,w)}function p(x,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=pl(""+w,x.mode,v),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case jo:return v=wi(w.type,w.key,w.props,null,x.mode,v),v.ref=Ms(x,null,w),v.return=x,v;case Or:return w=ml(w,x.mode,v),w.return=x,w;case Nn:var S=w._init;return p(x,S(w._payload),v)}if(Os(w)||Ns(w))return w=hr(w,x.mode,v,null),w.return=x,w;Jo(x,w)}return null}function m(x,w,v,S){var T=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return T!==null?null:a(x,w,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case jo:return v.key===T?c(x,w,v,S):null;case Or:return v.key===T?d(x,w,v,S):null;case Nn:return T=v._init,m(x,w,T(v._payload),S)}if(Os(v)||Ns(v))return T!==null?null:h(x,w,v,S,null);Jo(x,v)}return null}function g(x,w,v,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(v)||null,a(w,x,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case jo:return x=x.get(S.key===null?v:S.key)||null,c(w,x,S,T);case Or:return x=x.get(S.key===null?v:S.key)||null,d(w,x,S,T);case Nn:var E=S._init;return g(x,w,v,E(S._payload),T)}if(Os(S)||Ns(S))return x=x.get(v)||null,h(w,x,S,T,null);Jo(w,S)}return null}function y(x,w,v,S){for(var T=null,E=null,C=w,P=w=0,R=null;C!==null&&P<v.length;P++){C.index>P?(R=C,C=null):R=C.sibling;var I=m(x,C,v[P],S);if(I===null){C===null&&(C=R);break}t&&C&&I.alternate===null&&e(x,C),w=o(I,w,P),E===null?T=I:E.sibling=I,E=I,C=R}if(P===v.length)return n(x,C),Ee&&tr(x,P),T;if(C===null){for(;P<v.length;P++)C=p(x,v[P],S),C!==null&&(w=o(C,w,P),E===null?T=C:E.sibling=C,E=C);return Ee&&tr(x,P),T}for(C=r(x,C);P<v.length;P++)R=g(C,x,P,v[P],S),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?P:R.key),w=o(R,w,P),E===null?T=R:E.sibling=R,E=R);return t&&C.forEach(function(V){return e(x,V)}),Ee&&tr(x,P),T}function _(x,w,v,S){var T=Ns(v);if(typeof T!="function")throw Error(L(150));if(v=T.call(v),v==null)throw Error(L(151));for(var E=T=null,C=w,P=w=0,R=null,I=v.next();C!==null&&!I.done;P++,I=v.next()){C.index>P?(R=C,C=null):R=C.sibling;var V=m(x,C,I.value,S);if(V===null){C===null&&(C=R);break}t&&C&&V.alternate===null&&e(x,C),w=o(V,w,P),E===null?T=V:E.sibling=V,E=V,C=R}if(I.done)return n(x,C),Ee&&tr(x,P),T;if(C===null){for(;!I.done;P++,I=v.next())I=p(x,I.value,S),I!==null&&(w=o(I,w,P),E===null?T=I:E.sibling=I,E=I);return Ee&&tr(x,P),T}for(C=r(x,C);!I.done;P++,I=v.next())I=g(C,x,P,I.value,S),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?P:I.key),w=o(I,w,P),E===null?T=I:E.sibling=I,E=I);return t&&C.forEach(function(Y){return e(x,Y)}),Ee&&tr(x,P),T}function b(x,w,v,S){if(typeof v=="object"&&v!==null&&v.type===$r&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case jo:e:{for(var T=v.key,E=w;E!==null;){if(E.key===T){if(T=v.type,T===$r){if(E.tag===7){n(x,E.sibling),w=s(E,v.props.children),w.return=x,x=w;break e}}else if(E.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Nn&&of(T)===E.type){n(x,E.sibling),w=s(E,v.props),w.ref=Ms(x,E,v),w.return=x,x=w;break e}n(x,E);break}else e(x,E);E=E.sibling}v.type===$r?(w=hr(v.props.children,x.mode,S,v.key),w.return=x,x=w):(S=wi(v.type,v.key,v.props,null,x.mode,S),S.ref=Ms(x,w,v),S.return=x,x=S)}return i(x);case Or:e:{for(E=v.key;w!==null;){if(w.key===E)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){n(x,w.sibling),w=s(w,v.children||[]),w.return=x,x=w;break e}else{n(x,w);break}else e(x,w);w=w.sibling}w=ml(v,x.mode,S),w.return=x,x=w}return i(x);case Nn:return E=v._init,b(x,w,E(v._payload),S)}if(Os(v))return y(x,w,v,S);if(Ns(v))return _(x,w,v,S);Jo(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(n(x,w.sibling),w=s(w,v),w.return=x,x=w):(n(x,w),w=pl(v,x.mode,S),w.return=x,x=w),i(x)):n(x,w)}return b}var hs=ig(!0),ag=ig(!1),Fi=Jn(null),Oi=null,Jr=null,Su=null;function ku(){Su=Jr=Oi=null}function Eu(t){var e=Fi.current;ke(Fi),t._currentValue=e}function oc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ss(t,e){Oi=t,Su=Jr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gt=!0),t.firstContext=null)}function Ft(t){var e=t._currentValue;if(Su!==t)if(t={context:t,memoizedValue:e,next:null},Jr===null){if(Oi===null)throw Error(L(308));Jr=t,Oi.dependencies={lanes:0,firstContext:t}}else Jr=Jr.next=t;return e}var cr=null;function Cu(t){cr===null?cr=[t]:cr.push(t)}function lg(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Cu(e)):(n.next=s.next,s.next=n),e.interleaved=n,xn(t,r)}function xn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var In=!1;function Tu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cg(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $n(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,pe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,xn(t,n)}return s=r.interleaved,s===null?(e.next=e,Cu(r)):(e.next=s.next,s.next=e),r.interleaved=e,xn(t,n)}function pi(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fu(t,n)}}function af(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function $i(t,e,n,r){var s=t.updateQueue;In=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==i&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(o!==null){var p=s.baseState;i=0,h=d=c=null,a=o;do{var m=a.lane,g=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=t,_=a;switch(m=e,g=n,_.tag){case 1:if(y=_.payload,typeof y=="function"){p=y.call(g,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,m=typeof y=="function"?y.call(g,p,m):y,m==null)break e;p=Ie({},p,m);break e;case 2:In=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else g={eventTime:g,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=g,c=p):h=h.next=g,i|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);xr|=i,t.lanes=i,t.memoizedState=p}}function lf(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(L(191,s));s.call(r)}}}var Mo={},an=Jn(Mo),ho=Jn(Mo),po=Jn(Mo);function ur(t){if(t===Mo)throw Error(L(174));return t}function Nu(t,e){switch(_e(po,e),_e(ho,t),_e(an,Mo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ol(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ol(e,t)}ke(an),_e(an,e)}function ps(){ke(an),ke(ho),ke(po)}function ug(t){ur(po.current);var e=ur(an.current),n=Ol(e,t.type);e!==n&&(_e(ho,t),_e(an,n))}function Iu(t){ho.current===t&&(ke(an),ke(ho))}var Te=Jn(0);function Gi(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ll=[];function Au(){for(var t=0;t<ll.length;t++)ll[t]._workInProgressVersionPrimary=null;ll.length=0}var mi=bn.ReactCurrentDispatcher,cl=bn.ReactCurrentBatchConfig,vr=0,Ne=null,$e=null,Be=null,zi=!1,Ks=!1,mo=0,Yx=0;function et(){throw Error(L(321))}function Ru(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!en(t[n],e[n]))return!1;return!0}function Pu(t,e,n,r,s,o){if(vr=o,Ne=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mi.current=t===null||t.memoizedState===null?ew:tw,t=n(r,s),Ks){o=0;do{if(Ks=!1,mo=0,25<=o)throw Error(L(301));o+=1,Be=$e=null,e.updateQueue=null,mi.current=nw,t=n(r,s)}while(Ks)}if(mi.current=Bi,e=$e!==null&&$e.next!==null,vr=0,Be=$e=Ne=null,zi=!1,e)throw Error(L(300));return t}function Mu(){var t=mo!==0;return mo=0,t}function rn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?Ne.memoizedState=Be=t:Be=Be.next=t,Be}function Ot(){if($e===null){var t=Ne.alternate;t=t!==null?t.memoizedState:null}else t=$e.next;var e=Be===null?Ne.memoizedState:Be.next;if(e!==null)Be=e,$e=t;else{if(t===null)throw Error(L(310));$e=t,t={memoizedState:$e.memoizedState,baseState:$e.baseState,baseQueue:$e.baseQueue,queue:$e.queue,next:null},Be===null?Ne.memoizedState=Be=t:Be=Be.next=t}return Be}function go(t,e){return typeof e=="function"?e(t):e}function ul(t){var e=Ot(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=$e,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,c=null,d=o;do{var h=d.lane;if((vr&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=p,i=r):c=c.next=p,Ne.lanes|=h,xr|=h}d=d.next}while(d!==null&&d!==o);c===null?i=r:c.next=a,en(r,e.memoizedState)||(gt=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,Ne.lanes|=o,xr|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function dl(t){var e=Ot(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);en(o,e.memoizedState)||(gt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function dg(){}function fg(t,e){var n=Ne,r=Ot(),s=e(),o=!en(r.memoizedState,s);if(o&&(r.memoizedState=s,gt=!0),r=r.queue,Du(mg.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Be!==null&&Be.memoizedState.tag&1){if(n.flags|=2048,yo(9,pg.bind(null,n,r,s,e),void 0,null),Ve===null)throw Error(L(349));vr&30||hg(n,e,s)}return s}function hg(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pg(t,e,n,r){e.value=n,e.getSnapshot=r,gg(e)&&yg(t)}function mg(t,e,n){return n(function(){gg(e)&&yg(t)})}function gg(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!en(t,n)}catch{return!0}}function yg(t){var e=xn(t,1);e!==null&&Qt(e,t,1,-1)}function cf(t){var e=rn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:t},e.queue=t,t=t.dispatch=Zx.bind(null,Ne,t),[e.memoizedState,t]}function yo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function vg(){return Ot().memoizedState}function gi(t,e,n,r){var s=rn();Ne.flags|=t,s.memoizedState=yo(1|e,n,void 0,r===void 0?null:r)}function ya(t,e,n,r){var s=Ot();r=r===void 0?null:r;var o=void 0;if($e!==null){var i=$e.memoizedState;if(o=i.destroy,r!==null&&Ru(r,i.deps)){s.memoizedState=yo(e,n,o,r);return}}Ne.flags|=t,s.memoizedState=yo(1|e,n,o,r)}function uf(t,e){return gi(8390656,8,t,e)}function Du(t,e){return ya(2048,8,t,e)}function xg(t,e){return ya(4,2,t,e)}function wg(t,e){return ya(4,4,t,e)}function _g(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function bg(t,e,n){return n=n!=null?n.concat([t]):null,ya(4,4,_g.bind(null,e,t),n)}function Lu(){}function Sg(t,e){var n=Ot();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ru(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kg(t,e){var n=Ot();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ru(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Eg(t,e,n){return vr&21?(en(n,e)||(n=Am(),Ne.lanes|=n,xr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gt=!0),t.memoizedState=n)}function Qx(t,e){var n=xe;xe=n!==0&&4>n?n:4,t(!0);var r=cl.transition;cl.transition={};try{t(!1),e()}finally{xe=n,cl.transition=r}}function Cg(){return Ot().memoizedState}function Xx(t,e,n){var r=zn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Tg(t))Ng(e,n);else if(n=lg(t,e,n,r),n!==null){var s=lt();Qt(n,t,r,s),Ig(n,e,r)}}function Zx(t,e,n){var r=zn(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Tg(t))Ng(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,en(a,i)){var c=e.interleaved;c===null?(s.next=s,Cu(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=lg(t,e,s,r),n!==null&&(s=lt(),Qt(n,t,r,s),Ig(n,e,r))}}function Tg(t){var e=t.alternate;return t===Ne||e!==null&&e===Ne}function Ng(t,e){Ks=zi=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ig(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,fu(t,n)}}var Bi={readContext:Ft,useCallback:et,useContext:et,useEffect:et,useImperativeHandle:et,useInsertionEffect:et,useLayoutEffect:et,useMemo:et,useReducer:et,useRef:et,useState:et,useDebugValue:et,useDeferredValue:et,useTransition:et,useMutableSource:et,useSyncExternalStore:et,useId:et,unstable_isNewReconciler:!1},ew={readContext:Ft,useCallback:function(t,e){return rn().memoizedState=[t,e===void 0?null:e],t},useContext:Ft,useEffect:uf,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,gi(4194308,4,_g.bind(null,e,t),n)},useLayoutEffect:function(t,e){return gi(4194308,4,t,e)},useInsertionEffect:function(t,e){return gi(4,2,t,e)},useMemo:function(t,e){var n=rn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=rn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Xx.bind(null,Ne,t),[r.memoizedState,t]},useRef:function(t){var e=rn();return t={current:t},e.memoizedState=t},useState:cf,useDebugValue:Lu,useDeferredValue:function(t){return rn().memoizedState=t},useTransition:function(){var t=cf(!1),e=t[0];return t=Qx.bind(null,t[1]),rn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ne,s=rn();if(Ee){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),Ve===null)throw Error(L(349));vr&30||hg(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,uf(mg.bind(null,r,o,t),[t]),r.flags|=2048,yo(9,pg.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=rn(),e=Ve.identifierPrefix;if(Ee){var n=mn,r=pn;n=(r&~(1<<32-Yt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=mo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Yx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tw={readContext:Ft,useCallback:Sg,useContext:Ft,useEffect:Du,useImperativeHandle:bg,useInsertionEffect:xg,useLayoutEffect:wg,useMemo:kg,useReducer:ul,useRef:vg,useState:function(){return ul(go)},useDebugValue:Lu,useDeferredValue:function(t){var e=Ot();return Eg(e,$e.memoizedState,t)},useTransition:function(){var t=ul(go)[0],e=Ot().memoizedState;return[t,e]},useMutableSource:dg,useSyncExternalStore:fg,useId:Cg,unstable_isNewReconciler:!1},nw={readContext:Ft,useCallback:Sg,useContext:Ft,useEffect:Du,useImperativeHandle:bg,useInsertionEffect:xg,useLayoutEffect:wg,useMemo:kg,useReducer:dl,useRef:vg,useState:function(){return dl(go)},useDebugValue:Lu,useDeferredValue:function(t){var e=Ot();return $e===null?e.memoizedState=t:Eg(e,$e.memoizedState,t)},useTransition:function(){var t=dl(go)[0],e=Ot().memoizedState;return[t,e]},useMutableSource:dg,useSyncExternalStore:fg,useId:Cg,unstable_isNewReconciler:!1};function qt(t,e){if(t&&t.defaultProps){e=Ie({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ic(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ie({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var va={isMounted:function(t){return(t=t._reactInternals)?Sr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=lt(),s=zn(t),o=gn(r,s);o.payload=e,n!=null&&(o.callback=n),e=$n(t,o,s),e!==null&&(Qt(e,t,s,r),pi(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=lt(),s=zn(t),o=gn(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=$n(t,o,s),e!==null&&(Qt(e,t,s,r),pi(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=lt(),r=zn(t),s=gn(n,r);s.tag=2,e!=null&&(s.callback=e),e=$n(t,s,r),e!==null&&(Qt(e,t,r,n),pi(e,t,r))}};function df(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!lo(n,r)||!lo(s,o):!0}function Ag(t,e,n){var r=!1,s=qn,o=e.contextType;return typeof o=="object"&&o!==null?o=Ft(o):(s=vt(e)?gr:ot.current,r=e.contextTypes,o=(r=r!=null)?ds(t,s):qn),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=va,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function ff(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&va.enqueueReplaceState(e,e.state,null)}function ac(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Tu(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Ft(o):(o=vt(e)?gr:ot.current,s.context=ds(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(ic(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&va.enqueueReplaceState(s,s.state,null),$i(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ms(t,e){try{var n="",r=e;do n+=Av(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function fl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function lc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var rw=typeof WeakMap=="function"?WeakMap:Map;function Rg(t,e,n){n=gn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){qi||(qi=!0,vc=r),lc(t,e)},n}function Pg(t,e,n){n=gn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){lc(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){lc(t,e),typeof r!="function"&&(Gn===null?Gn=new Set([this]):Gn.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function hf(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new rw;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=yw.bind(null,t,e,n),e.then(t,t))}function pf(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function mf(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=gn(-1,1),e.tag=2,$n(n,e,1))),n.lanes|=1),t)}var sw=bn.ReactCurrentOwner,gt=!1;function at(t,e,n,r){e.child=t===null?ag(e,null,n,r):hs(e,t.child,n,r)}function gf(t,e,n,r,s){n=n.render;var o=e.ref;return ss(e,s),r=Pu(t,e,n,r,o,s),n=Mu(),t!==null&&!gt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,wn(t,e,s)):(Ee&&n&&wu(e),e.flags|=1,at(t,e,r,s),e.child)}function yf(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!Bu(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Mg(t,e,o,r,s)):(t=wi(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:lo,n(i,r)&&t.ref===e.ref)return wn(t,e,s)}return e.flags|=1,t=Bn(o,r),t.ref=e.ref,t.return=e,e.child=t}function Mg(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(lo(o,r)&&t.ref===e.ref)if(gt=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(gt=!0);else return e.lanes=t.lanes,wn(t,e,s)}return cc(t,e,n,r,s)}function Dg(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Yr,bt),bt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_e(Yr,bt),bt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,_e(Yr,bt),bt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,_e(Yr,bt),bt|=r;return at(t,e,s,n),e.child}function Lg(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function cc(t,e,n,r,s){var o=vt(n)?gr:ot.current;return o=ds(e,o),ss(e,s),n=Pu(t,e,n,r,o,s),r=Mu(),t!==null&&!gt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,wn(t,e,s)):(Ee&&r&&wu(e),e.flags|=1,at(t,e,n,s),e.child)}function vf(t,e,n,r,s){if(vt(n)){var o=!0;Li(e)}else o=!1;if(ss(e,s),e.stateNode===null)yi(t,e),Ag(e,n,r),ac(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var c=i.context,d=n.contextType;typeof d=="object"&&d!==null?d=Ft(d):(d=vt(n)?gr:ot.current,d=ds(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||c!==d)&&ff(e,i,r,d),In=!1;var m=e.memoizedState;i.state=m,$i(e,r,i,s),c=e.memoizedState,a!==r||m!==c||yt.current||In?(typeof h=="function"&&(ic(e,n,h,r),c=e.memoizedState),(a=In||df(e,n,a,r,m,c,d))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),i.props=r,i.state=c,i.context=d,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,cg(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:qt(e.type,a),i.props=d,p=e.pendingProps,m=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=Ft(c):(c=vt(n)?gr:ot.current,c=ds(e,c));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==p||m!==c)&&ff(e,i,r,c),In=!1,m=e.memoizedState,i.state=m,$i(e,r,i,s);var y=e.memoizedState;a!==p||m!==y||yt.current||In?(typeof g=="function"&&(ic(e,n,g,r),y=e.memoizedState),(d=In||df(e,n,d,r,m,y,c)||!1)?(h||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,y,c)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),i.props=r,i.state=y,i.context=c,r=d):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return uc(t,e,n,r,o,s)}function uc(t,e,n,r,s,o){Lg(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&nf(e,n,!1),wn(t,e,o);r=e.stateNode,sw.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=hs(e,t.child,null,o),e.child=hs(e,null,a,o)):at(t,e,a,o),e.memoizedState=r.state,s&&nf(e,n,!0),e.child}function Ug(t){var e=t.stateNode;e.pendingContext?tf(t,e.pendingContext,e.pendingContext!==e.context):e.context&&tf(t,e.context,!1),Nu(t,e.containerInfo)}function xf(t,e,n,r,s){return fs(),bu(s),e.flags|=256,at(t,e,n,r),e.child}var dc={dehydrated:null,treeContext:null,retryLane:0};function fc(t){return{baseLanes:t,cachePool:null,transitions:null}}function jg(t,e,n){var r=e.pendingProps,s=Te.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),_e(Te,s&1),t===null)return sc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=_a(i,r,0,null),t=hr(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=fc(n),e.memoizedState=dc,t):Uu(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return ow(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Bn(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Bn(a,o):(o=hr(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?fc(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=dc,r}return o=t.child,t=o.sibling,r=Bn(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Uu(t,e){return e=_a({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ko(t,e,n,r){return r!==null&&bu(r),hs(e,t.child,null,n),t=Uu(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ow(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=fl(Error(L(422))),Ko(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=_a({mode:"visible",children:r.children},s,0,null),o=hr(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&hs(e,t.child,null,i),e.child.memoizedState=fc(i),e.memoizedState=dc,o);if(!(e.mode&1))return Ko(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(L(419)),r=fl(o,r,void 0),Ko(t,e,i,r)}if(a=(i&t.childLanes)!==0,gt||a){if(r=Ve,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,xn(t,s),Qt(r,t,s,-1))}return zu(),r=fl(Error(L(421))),Ko(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=vw.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Et=On(s.nextSibling),Ct=e,Ee=!0,Kt=null,t!==null&&(Pt[Mt++]=pn,Pt[Mt++]=mn,Pt[Mt++]=yr,pn=t.id,mn=t.overflow,yr=e),e=Uu(e,r.children),e.flags|=4096,e)}function wf(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),oc(t.return,e,n)}function hl(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function Fg(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(at(t,e,r.children,n),r=Te.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wf(t,n,e);else if(t.tag===19)wf(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(_e(Te,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Gi(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hl(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Gi(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hl(e,!0,n,null,o);break;case"together":hl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yi(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function wn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=Bn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Bn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function iw(t,e,n){switch(e.tag){case 3:Ug(e),fs();break;case 5:ug(e);break;case 1:vt(e.type)&&Li(e);break;case 4:Nu(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;_e(Fi,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(_e(Te,Te.current&1),e.flags|=128,null):n&e.child.childLanes?jg(t,e,n):(_e(Te,Te.current&1),t=wn(t,e,n),t!==null?t.sibling:null);_e(Te,Te.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Fg(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),_e(Te,Te.current),r)break;return null;case 22:case 23:return e.lanes=0,Dg(t,e,n)}return wn(t,e,n)}var Og,hc,$g,Gg;Og=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};hc=function(){};$g=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ur(an.current);var o=null;switch(n){case"input":s=Ll(t,s),r=Ll(t,r),o=[];break;case"select":s=Ie({},s,{value:void 0}),r=Ie({},r,{value:void 0}),o=[];break;case"textarea":s=Fl(t,s),r=Fl(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Mi)}$l(n,r);var i;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(to.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(i in a)!a.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&a[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(to.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Se("scroll",t),o||a===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};Gg=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ds(t,e){if(!Ee)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function tt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function aw(t,e,n){var r=e.pendingProps;switch(_u(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tt(e),null;case 1:return vt(e.type)&&Di(),tt(e),null;case 3:return r=e.stateNode,ps(),ke(yt),ke(ot),Au(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Kt!==null&&(_c(Kt),Kt=null))),hc(t,e),tt(e),null;case 5:Iu(e);var s=ur(po.current);if(n=e.type,t!==null&&e.stateNode!=null)$g(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return tt(e),null}if(t=ur(an.current),Wo(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[sn]=e,r[fo]=o,t=(e.mode&1)!==0,n){case"dialog":Se("cancel",r),Se("close",r);break;case"iframe":case"object":case"embed":Se("load",r);break;case"video":case"audio":for(s=0;s<Gs.length;s++)Se(Gs[s],r);break;case"source":Se("error",r);break;case"img":case"image":case"link":Se("error",r),Se("load",r);break;case"details":Se("toggle",r);break;case"input":Nd(r,o),Se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Se("invalid",r);break;case"textarea":Ad(r,o),Se("invalid",r)}$l(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Ho(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Ho(r.textContent,a,t),s=["children",""+a]):to.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Se("scroll",r)}switch(n){case"input":Fo(r),Id(r,o,!0);break;case"textarea":Fo(r),Rd(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Mi)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[sn]=e,t[fo]=r,Og(t,e,!1,!1),e.stateNode=t;e:{switch(i=Gl(n,r),n){case"dialog":Se("cancel",t),Se("close",t),s=r;break;case"iframe":case"object":case"embed":Se("load",t),s=r;break;case"video":case"audio":for(s=0;s<Gs.length;s++)Se(Gs[s],t);s=r;break;case"source":Se("error",t),s=r;break;case"img":case"image":case"link":Se("error",t),Se("load",t),s=r;break;case"details":Se("toggle",t),s=r;break;case"input":Nd(t,r),s=Ll(t,r),Se("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ie({},r,{value:void 0}),Se("invalid",t);break;case"textarea":Ad(t,r),s=Fl(t,r),Se("invalid",t);break;default:s=r}$l(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?vm(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&gm(t,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&no(t,c):typeof c=="number"&&no(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(to.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Se("scroll",t):c!=null&&iu(t,o,c,i))}switch(n){case"input":Fo(t),Id(t,r,!1);break;case"textarea":Fo(t),Rd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Vn(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?es(t,!!r.multiple,o,!1):r.defaultValue!=null&&es(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Mi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tt(e),null;case 6:if(t&&e.stateNode!=null)Gg(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=ur(po.current),ur(an.current),Wo(e)){if(r=e.stateNode,n=e.memoizedProps,r[sn]=e,(o=r.nodeValue!==n)&&(t=Ct,t!==null))switch(t.tag){case 3:Ho(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ho(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[sn]=e,e.stateNode=r}return tt(e),null;case 13:if(ke(Te),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ee&&Et!==null&&e.mode&1&&!(e.flags&128))og(),fs(),e.flags|=98560,o=!1;else if(o=Wo(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(L(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(L(317));o[sn]=e}else fs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tt(e),o=!1}else Kt!==null&&(_c(Kt),Kt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Te.current&1?Ge===0&&(Ge=3):zu())),e.updateQueue!==null&&(e.flags|=4),tt(e),null);case 4:return ps(),hc(t,e),t===null&&co(e.stateNode.containerInfo),tt(e),null;case 10:return Eu(e.type._context),tt(e),null;case 17:return vt(e.type)&&Di(),tt(e),null;case 19:if(ke(Te),o=e.memoizedState,o===null)return tt(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Ds(o,!1);else{if(Ge!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Gi(t),i!==null){for(e.flags|=128,Ds(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return _e(Te,Te.current&1|2),e.child}t=t.sibling}o.tail!==null&&De()>gs&&(e.flags|=128,r=!0,Ds(o,!1),e.lanes=4194304)}else{if(!r)if(t=Gi(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ds(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Ee)return tt(e),null}else 2*De()-o.renderingStartTime>gs&&n!==1073741824&&(e.flags|=128,r=!0,Ds(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=De(),e.sibling=null,n=Te.current,_e(Te,r?n&1|2:n&1),e):(tt(e),null);case 22:case 23:return Gu(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bt&1073741824&&(tt(e),e.subtreeFlags&6&&(e.flags|=8192)):tt(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function lw(t,e){switch(_u(e),e.tag){case 1:return vt(e.type)&&Di(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ps(),ke(yt),ke(ot),Au(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Iu(e),null;case 13:if(ke(Te),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));fs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ke(Te),null;case 4:return ps(),null;case 10:return Eu(e.type._context),null;case 22:case 23:return Gu(),null;case 24:return null;default:return null}}var Yo=!1,nt=!1,cw=typeof WeakSet=="function"?WeakSet:Set,H=null;function Kr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pe(t,e,r)}else n.current=null}function pc(t,e,n){try{n()}catch(r){Pe(t,e,r)}}var _f=!1;function uw(t,e){if(Ql=Ai,t=Hm(),xu(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,c=-1,d=0,h=0,p=t,m=null;t:for(;;){for(var g;p!==n||s!==0&&p.nodeType!==3||(a=i+s),p!==o||r!==0&&p.nodeType!==3||(c=i+r),p.nodeType===3&&(i+=p.nodeValue.length),(g=p.firstChild)!==null;)m=p,p=g;for(;;){if(p===t)break t;if(m===n&&++d===s&&(a=i),m===o&&++h===r&&(c=i),(g=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=g}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xl={focusedElem:t,selectionRange:n},Ai=!1,H=e;H!==null;)if(e=H,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,H=t;else for(;H!==null;){e=H;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,b=y.memoizedState,x=e.stateNode,w=x.getSnapshotBeforeUpdate(e.elementType===e.type?_:qt(e.type,_),b);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(S){Pe(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}return y=_f,_f=!1,y}function Ys(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&pc(e,n,o)}s=s.next}while(s!==r)}}function xa(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function mc(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function zg(t){var e=t.alternate;e!==null&&(t.alternate=null,zg(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[sn],delete e[fo],delete e[tc],delete e[Hx],delete e[Wx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Bg(t){return t.tag===5||t.tag===3||t.tag===4}function bf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Bg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function gc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Mi));else if(r!==4&&(t=t.child,t!==null))for(gc(t,e,n),t=t.sibling;t!==null;)gc(t,e,n),t=t.sibling}function yc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(yc(t,e,n),t=t.sibling;t!==null;)yc(t,e,n),t=t.sibling}var Qe=null,Wt=!1;function Tn(t,e,n){for(n=n.child;n!==null;)Vg(t,e,n),n=n.sibling}function Vg(t,e,n){if(on&&typeof on.onCommitFiberUnmount=="function")try{on.onCommitFiberUnmount(da,n)}catch{}switch(n.tag){case 5:nt||Kr(n,e);case 6:var r=Qe,s=Wt;Qe=null,Tn(t,e,n),Qe=r,Wt=s,Qe!==null&&(Wt?(t=Qe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Qe.removeChild(n.stateNode));break;case 18:Qe!==null&&(Wt?(t=Qe,n=n.stateNode,t.nodeType===8?il(t.parentNode,n):t.nodeType===1&&il(t,n),io(t)):il(Qe,n.stateNode));break;case 4:r=Qe,s=Wt,Qe=n.stateNode.containerInfo,Wt=!0,Tn(t,e,n),Qe=r,Wt=s;break;case 0:case 11:case 14:case 15:if(!nt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&pc(n,e,i),s=s.next}while(s!==r)}Tn(t,e,n);break;case 1:if(!nt&&(Kr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Pe(n,e,a)}Tn(t,e,n);break;case 21:Tn(t,e,n);break;case 22:n.mode&1?(nt=(r=nt)||n.memoizedState!==null,Tn(t,e,n),nt=r):Tn(t,e,n);break;default:Tn(t,e,n)}}function Sf(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new cw),e.forEach(function(r){var s=xw.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Bt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Qe=a.stateNode,Wt=!1;break e;case 3:Qe=a.stateNode.containerInfo,Wt=!0;break e;case 4:Qe=a.stateNode.containerInfo,Wt=!0;break e}a=a.return}if(Qe===null)throw Error(L(160));Vg(o,i,s),Qe=null,Wt=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Pe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)qg(e,t),e=e.sibling}function qg(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Bt(e,t),nn(t),r&4){try{Ys(3,t,t.return),xa(3,t)}catch(_){Pe(t,t.return,_)}try{Ys(5,t,t.return)}catch(_){Pe(t,t.return,_)}}break;case 1:Bt(e,t),nn(t),r&512&&n!==null&&Kr(n,n.return);break;case 5:if(Bt(e,t),nn(t),r&512&&n!==null&&Kr(n,n.return),t.flags&32){var s=t.stateNode;try{no(s,"")}catch(_){Pe(t,t.return,_)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&hm(s,o),Gl(a,i);var d=Gl(a,o);for(i=0;i<c.length;i+=2){var h=c[i],p=c[i+1];h==="style"?vm(s,p):h==="dangerouslySetInnerHTML"?gm(s,p):h==="children"?no(s,p):iu(s,h,p,d)}switch(a){case"input":Ul(s,o);break;case"textarea":pm(s,o);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?es(s,!!o.multiple,g,!1):m!==!!o.multiple&&(o.defaultValue!=null?es(s,!!o.multiple,o.defaultValue,!0):es(s,!!o.multiple,o.multiple?[]:"",!1))}s[fo]=o}catch(_){Pe(t,t.return,_)}}break;case 6:if(Bt(e,t),nn(t),r&4){if(t.stateNode===null)throw Error(L(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(_){Pe(t,t.return,_)}}break;case 3:if(Bt(e,t),nn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{io(e.containerInfo)}catch(_){Pe(t,t.return,_)}break;case 4:Bt(e,t),nn(t);break;case 13:Bt(e,t),nn(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Ou=De())),r&4&&Sf(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(nt=(d=nt)||h,Bt(e,t),nt=d):Bt(e,t),nn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(H=t,h=t.child;h!==null;){for(p=H=h;H!==null;){switch(m=H,g=m.child,m.tag){case 0:case 11:case 14:case 15:Ys(4,m,m.return);break;case 1:Kr(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(_){Pe(r,n,_)}}break;case 5:Kr(m,m.return);break;case 22:if(m.memoizedState!==null){Ef(p);continue}}g!==null?(g.return=m,H=g):Ef(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=p.stateNode,c=p.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=ym("display",i))}catch(_){Pe(t,t.return,_)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(_){Pe(t,t.return,_)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Bt(e,t),nn(t),r&4&&Sf(t);break;case 21:break;default:Bt(e,t),nn(t)}}function nn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Bg(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(no(s,""),r.flags&=-33);var o=bf(t);yc(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=bf(t);gc(t,a,i);break;default:throw Error(L(161))}}catch(c){Pe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function dw(t,e,n){H=t,Hg(t)}function Hg(t,e,n){for(var r=(t.mode&1)!==0;H!==null;){var s=H,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Yo;if(!i){var a=s.alternate,c=a!==null&&a.memoizedState!==null||nt;a=Yo;var d=nt;if(Yo=i,(nt=c)&&!d)for(H=s;H!==null;)i=H,c=i.child,i.tag===22&&i.memoizedState!==null?Cf(s):c!==null?(c.return=i,H=c):Cf(s);for(;o!==null;)H=o,Hg(o),o=o.sibling;H=s,Yo=a,nt=d}kf(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,H=o):kf(t)}}function kf(t){for(;H!==null;){var e=H;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nt||xa(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:qt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&lf(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}lf(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&io(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}nt||e.flags&512&&mc(e)}catch(m){Pe(e,e.return,m)}}if(e===t){H=null;break}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}}function Ef(t){for(;H!==null;){var e=H;if(e===t){H=null;break}var n=e.sibling;if(n!==null){n.return=e.return,H=n;break}H=e.return}}function Cf(t){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{xa(4,e)}catch(c){Pe(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Pe(e,s,c)}}var o=e.return;try{mc(e)}catch(c){Pe(e,o,c)}break;case 5:var i=e.return;try{mc(e)}catch(c){Pe(e,i,c)}}}catch(c){Pe(e,e.return,c)}if(e===t){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var fw=Math.ceil,Vi=bn.ReactCurrentDispatcher,ju=bn.ReactCurrentOwner,Ut=bn.ReactCurrentBatchConfig,pe=0,Ve=null,Fe=null,Xe=0,bt=0,Yr=Jn(0),Ge=0,vo=null,xr=0,wa=0,Fu=0,Qs=null,mt=null,Ou=0,gs=1/0,dn=null,qi=!1,vc=null,Gn=null,Qo=!1,Ln=null,Hi=0,Xs=0,xc=null,vi=-1,xi=0;function lt(){return pe&6?De():vi!==-1?vi:vi=De()}function zn(t){return t.mode&1?pe&2&&Xe!==0?Xe&-Xe:Kx.transition!==null?(xi===0&&(xi=Am()),xi):(t=xe,t!==0||(t=window.event,t=t===void 0?16:jm(t.type)),t):1}function Qt(t,e,n,r){if(50<Xs)throw Xs=0,xc=null,Error(L(185));Ao(t,n,r),(!(pe&2)||t!==Ve)&&(t===Ve&&(!(pe&2)&&(wa|=n),Ge===4&&Pn(t,Xe)),xt(t,r),n===1&&pe===0&&!(e.mode&1)&&(gs=De()+500,ga&&Kn()))}function xt(t,e){var n=t.callbackNode;Kv(t,e);var r=Ii(t,t===Ve?Xe:0);if(r===0)n!==null&&Dd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Dd(n),e===1)t.tag===0?Jx(Tf.bind(null,t)):ng(Tf.bind(null,t)),Vx(function(){!(pe&6)&&Kn()}),n=null;else{switch(Rm(r)){case 1:n=du;break;case 4:n=Nm;break;case 16:n=Ni;break;case 536870912:n=Im;break;default:n=Ni}n=e0(n,Wg.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Wg(t,e){if(vi=-1,xi=0,pe&6)throw Error(L(327));var n=t.callbackNode;if(os()&&t.callbackNode!==n)return null;var r=Ii(t,t===Ve?Xe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Wi(t,r);else{e=r;var s=pe;pe|=2;var o=Kg();(Ve!==t||Xe!==e)&&(dn=null,gs=De()+500,fr(t,e));do try{mw();break}catch(a){Jg(t,a)}while(!0);ku(),Vi.current=o,pe=s,Fe!==null?e=0:(Ve=null,Xe=0,e=Ge)}if(e!==0){if(e===2&&(s=Hl(t),s!==0&&(r=s,e=wc(t,s))),e===1)throw n=vo,fr(t,0),Pn(t,r),xt(t,De()),n;if(e===6)Pn(t,r);else{if(s=t.current.alternate,!(r&30)&&!hw(s)&&(e=Wi(t,r),e===2&&(o=Hl(t),o!==0&&(r=o,e=wc(t,o))),e===1))throw n=vo,fr(t,0),Pn(t,r),xt(t,De()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:nr(t,mt,dn);break;case 3:if(Pn(t,r),(r&130023424)===r&&(e=Ou+500-De(),10<e)){if(Ii(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){lt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ec(nr.bind(null,t,mt,dn),e);break}nr(t,mt,dn);break;case 4:if(Pn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-Yt(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=De()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*fw(r/1960))-r,10<r){t.timeoutHandle=ec(nr.bind(null,t,mt,dn),r);break}nr(t,mt,dn);break;case 5:nr(t,mt,dn);break;default:throw Error(L(329))}}}return xt(t,De()),t.callbackNode===n?Wg.bind(null,t):null}function wc(t,e){var n=Qs;return t.current.memoizedState.isDehydrated&&(fr(t,e).flags|=256),t=Wi(t,e),t!==2&&(e=mt,mt=n,e!==null&&_c(e)),t}function _c(t){mt===null?mt=t:mt.push.apply(mt,t)}function hw(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!en(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pn(t,e){for(e&=~Fu,e&=~wa,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yt(e),r=1<<n;t[n]=-1,e&=~r}}function Tf(t){if(pe&6)throw Error(L(327));os();var e=Ii(t,0);if(!(e&1))return xt(t,De()),null;var n=Wi(t,e);if(t.tag!==0&&n===2){var r=Hl(t);r!==0&&(e=r,n=wc(t,r))}if(n===1)throw n=vo,fr(t,0),Pn(t,e),xt(t,De()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nr(t,mt,dn),xt(t,De()),null}function $u(t,e){var n=pe;pe|=1;try{return t(e)}finally{pe=n,pe===0&&(gs=De()+500,ga&&Kn())}}function wr(t){Ln!==null&&Ln.tag===0&&!(pe&6)&&os();var e=pe;pe|=1;var n=Ut.transition,r=xe;try{if(Ut.transition=null,xe=1,t)return t()}finally{xe=r,Ut.transition=n,pe=e,!(pe&6)&&Kn()}}function Gu(){bt=Yr.current,ke(Yr)}function fr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Bx(n)),Fe!==null)for(n=Fe.return;n!==null;){var r=n;switch(_u(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Di();break;case 3:ps(),ke(yt),ke(ot),Au();break;case 5:Iu(r);break;case 4:ps();break;case 13:ke(Te);break;case 19:ke(Te);break;case 10:Eu(r.type._context);break;case 22:case 23:Gu()}n=n.return}if(Ve=t,Fe=t=Bn(t.current,null),Xe=bt=e,Ge=0,vo=null,Fu=wa=xr=0,mt=Qs=null,cr!==null){for(e=0;e<cr.length;e++)if(n=cr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}cr=null}return t}function Jg(t,e){do{var n=Fe;try{if(ku(),mi.current=Bi,zi){for(var r=Ne.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}zi=!1}if(vr=0,Be=$e=Ne=null,Ks=!1,mo=0,ju.current=null,n===null||n.return===null){Ge=1,vo=e,Fe=null;break}e:{var o=t,i=n.return,a=n,c=e;if(e=Xe,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=pf(i);if(g!==null){g.flags&=-257,mf(g,i,a,o,e),g.mode&1&&hf(o,d,e),e=g,c=d;var y=e.updateQueue;if(y===null){var _=new Set;_.add(c),e.updateQueue=_}else y.add(c);break e}else{if(!(e&1)){hf(o,d,e),zu();break e}c=Error(L(426))}}else if(Ee&&a.mode&1){var b=pf(i);if(b!==null){!(b.flags&65536)&&(b.flags|=256),mf(b,i,a,o,e),bu(ms(c,a));break e}}o=c=ms(c,a),Ge!==4&&(Ge=2),Qs===null?Qs=[o]:Qs.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var x=Rg(o,c,e);af(o,x);break e;case 1:a=c;var w=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Gn===null||!Gn.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var S=Pg(o,a,e);af(o,S);break e}}o=o.return}while(o!==null)}Qg(n)}catch(T){e=T,Fe===n&&n!==null&&(Fe=n=n.return);continue}break}while(!0)}function Kg(){var t=Vi.current;return Vi.current=Bi,t===null?Bi:t}function zu(){(Ge===0||Ge===3||Ge===2)&&(Ge=4),Ve===null||!(xr&268435455)&&!(wa&268435455)||Pn(Ve,Xe)}function Wi(t,e){var n=pe;pe|=2;var r=Kg();(Ve!==t||Xe!==e)&&(dn=null,fr(t,e));do try{pw();break}catch(s){Jg(t,s)}while(!0);if(ku(),pe=n,Vi.current=r,Fe!==null)throw Error(L(261));return Ve=null,Xe=0,Ge}function pw(){for(;Fe!==null;)Yg(Fe)}function mw(){for(;Fe!==null&&!$v();)Yg(Fe)}function Yg(t){var e=Zg(t.alternate,t,bt);t.memoizedProps=t.pendingProps,e===null?Qg(t):Fe=e,ju.current=null}function Qg(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=lw(n,e),n!==null){n.flags&=32767,Fe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ge=6,Fe=null;return}}else if(n=aw(n,e,bt),n!==null){Fe=n;return}if(e=e.sibling,e!==null){Fe=e;return}Fe=e=t}while(e!==null);Ge===0&&(Ge=5)}function nr(t,e,n){var r=xe,s=Ut.transition;try{Ut.transition=null,xe=1,gw(t,e,n,r)}finally{Ut.transition=s,xe=r}return null}function gw(t,e,n,r){do os();while(Ln!==null);if(pe&6)throw Error(L(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Yv(t,o),t===Ve&&(Fe=Ve=null,Xe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Qo||(Qo=!0,e0(Ni,function(){return os(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ut.transition,Ut.transition=null;var i=xe;xe=1;var a=pe;pe|=4,ju.current=null,uw(t,n),qg(n,t),Ux(Xl),Ai=!!Ql,Xl=Ql=null,t.current=n,dw(n),Gv(),pe=a,xe=i,Ut.transition=o}else t.current=n;if(Qo&&(Qo=!1,Ln=t,Hi=s),o=t.pendingLanes,o===0&&(Gn=null),Vv(n.stateNode),xt(t,De()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(qi)throw qi=!1,t=vc,vc=null,t;return Hi&1&&t.tag!==0&&os(),o=t.pendingLanes,o&1?t===xc?Xs++:(Xs=0,xc=t):Xs=0,Kn(),null}function os(){if(Ln!==null){var t=Rm(Hi),e=Ut.transition,n=xe;try{if(Ut.transition=null,xe=16>t?16:t,Ln===null)var r=!1;else{if(t=Ln,Ln=null,Hi=0,pe&6)throw Error(L(331));var s=pe;for(pe|=4,H=t.current;H!==null;){var o=H,i=o.child;if(H.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(H=d;H!==null;){var h=H;switch(h.tag){case 0:case 11:case 15:Ys(8,h,o)}var p=h.child;if(p!==null)p.return=h,H=p;else for(;H!==null;){h=H;var m=h.sibling,g=h.return;if(zg(h),h===d){H=null;break}if(m!==null){m.return=g,H=m;break}H=g}}}var y=o.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var b=_.sibling;_.sibling=null,_=b}while(_!==null)}}H=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,H=i;else e:for(;H!==null;){if(o=H,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ys(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,H=x;break e}H=o.return}}var w=t.current;for(H=w;H!==null;){i=H;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,H=v;else e:for(i=w;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:xa(9,a)}}catch(T){Pe(a,a.return,T)}if(a===i){H=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,H=S;break e}H=a.return}}if(pe=s,Kn(),on&&typeof on.onPostCommitFiberRoot=="function")try{on.onPostCommitFiberRoot(da,t)}catch{}r=!0}return r}finally{xe=n,Ut.transition=e}}return!1}function Nf(t,e,n){e=ms(n,e),e=Rg(t,e,1),t=$n(t,e,1),e=lt(),t!==null&&(Ao(t,1,e),xt(t,e))}function Pe(t,e,n){if(t.tag===3)Nf(t,t,n);else for(;e!==null;){if(e.tag===3){Nf(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Gn===null||!Gn.has(r))){t=ms(n,t),t=Pg(e,t,1),e=$n(e,t,1),t=lt(),e!==null&&(Ao(e,1,t),xt(e,t));break}}e=e.return}}function yw(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=lt(),t.pingedLanes|=t.suspendedLanes&n,Ve===t&&(Xe&n)===n&&(Ge===4||Ge===3&&(Xe&130023424)===Xe&&500>De()-Ou?fr(t,0):Fu|=n),xt(t,e)}function Xg(t,e){e===0&&(t.mode&1?(e=Go,Go<<=1,!(Go&130023424)&&(Go=4194304)):e=1);var n=lt();t=xn(t,e),t!==null&&(Ao(t,e,n),xt(t,n))}function vw(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Xg(t,n)}function xw(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),Xg(t,n)}var Zg;Zg=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yt.current)gt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return gt=!1,iw(t,e,n);gt=!!(t.flags&131072)}else gt=!1,Ee&&e.flags&1048576&&rg(e,ji,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;yi(t,e),t=e.pendingProps;var s=ds(e,ot.current);ss(e,n),s=Pu(null,e,r,t,s,n);var o=Mu();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vt(r)?(o=!0,Li(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Tu(e),s.updater=va,e.stateNode=s,s._reactInternals=e,ac(e,r,t,n),e=uc(null,e,r,!0,o,n)):(e.tag=0,Ee&&o&&wu(e),at(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(yi(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=_w(r),t=qt(r,t),s){case 0:e=cc(null,e,r,t,n);break e;case 1:e=vf(null,e,r,t,n);break e;case 11:e=gf(null,e,r,t,n);break e;case 14:e=yf(null,e,r,qt(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qt(r,s),cc(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qt(r,s),vf(t,e,r,s,n);case 3:e:{if(Ug(e),t===null)throw Error(L(387));r=e.pendingProps,o=e.memoizedState,s=o.element,cg(t,e),$i(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=ms(Error(L(423)),e),e=xf(t,e,r,n,s);break e}else if(r!==s){s=ms(Error(L(424)),e),e=xf(t,e,r,n,s);break e}else for(Et=On(e.stateNode.containerInfo.firstChild),Ct=e,Ee=!0,Kt=null,n=ag(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fs(),r===s){e=wn(t,e,n);break e}at(t,e,r,n)}e=e.child}return e;case 5:return ug(e),t===null&&sc(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,Zl(r,s)?i=null:o!==null&&Zl(r,o)&&(e.flags|=32),Lg(t,e),at(t,e,i,n),e.child;case 6:return t===null&&sc(e),null;case 13:return jg(t,e,n);case 4:return Nu(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hs(e,null,r,n):at(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qt(r,s),gf(t,e,r,s,n);case 7:return at(t,e,e.pendingProps,n),e.child;case 8:return at(t,e,e.pendingProps.children,n),e.child;case 12:return at(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,_e(Fi,r._currentValue),r._currentValue=i,o!==null)if(en(o.value,i)){if(o.children===s.children&&!yt.current){e=wn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=gn(-1,n&-n),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),oc(o.return,n,e),a.lanes|=n;break}c=c.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(L(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),oc(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}at(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,ss(e,n),s=Ft(s),r=r(s),e.flags|=1,at(t,e,r,n),e.child;case 14:return r=e.type,s=qt(r,e.pendingProps),s=qt(r.type,s),yf(t,e,r,s,n);case 15:return Mg(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qt(r,s),yi(t,e),e.tag=1,vt(r)?(t=!0,Li(e)):t=!1,ss(e,n),Ag(e,r,s),ac(e,r,s,n),uc(null,e,r,!0,t,n);case 19:return Fg(t,e,n);case 22:return Dg(t,e,n)}throw Error(L(156,e.tag))};function e0(t,e){return Tm(t,e)}function ww(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lt(t,e,n,r){return new ww(t,e,n,r)}function Bu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _w(t){if(typeof t=="function")return Bu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lu)return 11;if(t===cu)return 14}return 2}function Bn(t,e){var n=t.alternate;return n===null?(n=Lt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function wi(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")Bu(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case $r:return hr(n.children,s,o,e);case au:i=8,s|=8;break;case Rl:return t=Lt(12,n,e,s|2),t.elementType=Rl,t.lanes=o,t;case Pl:return t=Lt(13,n,e,s),t.elementType=Pl,t.lanes=o,t;case Ml:return t=Lt(19,n,e,s),t.elementType=Ml,t.lanes=o,t;case um:return _a(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lm:i=10;break e;case cm:i=9;break e;case lu:i=11;break e;case cu:i=14;break e;case Nn:i=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=Lt(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function hr(t,e,n,r){return t=Lt(7,t,r,e),t.lanes=n,t}function _a(t,e,n,r){return t=Lt(22,t,r,e),t.elementType=um,t.lanes=n,t.stateNode={isHidden:!1},t}function pl(t,e,n){return t=Lt(6,t,null,e),t.lanes=n,t}function ml(t,e,n){return e=Lt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function bw(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ka(0),this.expirationTimes=Ka(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ka(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vu(t,e,n,r,s,o,i,a,c){return t=new bw(t,e,n,a,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Lt(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tu(o),t}function Sw(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Or,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function t0(t){if(!t)return qn;t=t._reactInternals;e:{if(Sr(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(vt(n))return tg(t,n,e)}return e}function n0(t,e,n,r,s,o,i,a,c){return t=Vu(n,r,!0,t,s,o,i,a,c),t.context=t0(null),n=t.current,r=lt(),s=zn(n),o=gn(r,s),o.callback=e??null,$n(n,o,s),t.current.lanes=s,Ao(t,s,r),xt(t,r),t}function ba(t,e,n,r){var s=e.current,o=lt(),i=zn(s);return n=t0(n),e.context===null?e.context=n:e.pendingContext=n,e=gn(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$n(s,e,i),t!==null&&(Qt(t,s,i,o),pi(t,s,i)),i}function Ji(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function If(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function qu(t,e){If(t,e),(t=t.alternate)&&If(t,e)}function kw(){return null}var r0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hu(t){this._internalRoot=t}Sa.prototype.render=Hu.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));ba(t,e,null,null)};Sa.prototype.unmount=Hu.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wr(function(){ba(null,t,null,null)}),e[vn]=null}};function Sa(t){this._internalRoot=t}Sa.prototype.unstable_scheduleHydration=function(t){if(t){var e=Dm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Rn.length&&e!==0&&e<Rn[n].priority;n++);Rn.splice(n,0,t),n===0&&Um(t)}};function Wu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ka(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Af(){}function Ew(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var d=Ji(i);o.call(d)}}var i=n0(e,r,t,0,null,!1,!1,"",Af);return t._reactRootContainer=i,t[vn]=i.current,co(t.nodeType===8?t.parentNode:t),wr(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Ji(c);a.call(d)}}var c=Vu(t,0,!1,null,null,!1,!1,"",Af);return t._reactRootContainer=c,t[vn]=c.current,co(t.nodeType===8?t.parentNode:t),wr(function(){ba(e,c,n,r)}),c}function Ea(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var c=Ji(i);a.call(c)}}ba(e,i,t,s)}else i=Ew(n,e,t,s,r);return Ji(i)}Pm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=$s(e.pendingLanes);n!==0&&(fu(e,n|1),xt(e,De()),!(pe&6)&&(gs=De()+500,Kn()))}break;case 13:wr(function(){var r=xn(t,1);if(r!==null){var s=lt();Qt(r,t,1,s)}}),qu(t,1)}};hu=function(t){if(t.tag===13){var e=xn(t,134217728);if(e!==null){var n=lt();Qt(e,t,134217728,n)}qu(t,134217728)}};Mm=function(t){if(t.tag===13){var e=zn(t),n=xn(t,e);if(n!==null){var r=lt();Qt(n,t,e,r)}qu(t,e)}};Dm=function(){return xe};Lm=function(t,e){var n=xe;try{return xe=t,e()}finally{xe=n}};Bl=function(t,e,n){switch(e){case"input":if(Ul(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ma(r);if(!s)throw Error(L(90));fm(r),Ul(r,s)}}}break;case"textarea":pm(t,n);break;case"select":e=n.value,e!=null&&es(t,!!n.multiple,e,!1)}};_m=$u;bm=wr;var Cw={usingClientEntryPoint:!1,Events:[Po,Vr,ma,xm,wm,$u]},Ls={findFiberByHostInstance:lr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tw={bundleType:Ls.bundleType,version:Ls.version,rendererPackageName:Ls.rendererPackageName,rendererConfig:Ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Em(t),t===null?null:t.stateNode},findFiberByHostInstance:Ls.findFiberByHostInstance||kw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xo.isDisabled&&Xo.supportsFiber)try{da=Xo.inject(Tw),on=Xo}catch{}}It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cw;It.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wu(e))throw Error(L(200));return Sw(t,e,null,n)};It.createRoot=function(t,e){if(!Wu(t))throw Error(L(299));var n=!1,r="",s=r0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Vu(t,1,!1,null,null,n,!1,r,s),t[vn]=e.current,co(t.nodeType===8?t.parentNode:t),new Hu(e)};It.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=Em(e),t=t===null?null:t.stateNode,t};It.flushSync=function(t){return wr(t)};It.hydrate=function(t,e,n){if(!ka(e))throw Error(L(200));return Ea(null,t,e,!0,n)};It.hydrateRoot=function(t,e,n){if(!Wu(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=r0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=n0(e,null,t,1,n??null,s,!1,o,i),t[vn]=e.current,co(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Sa(e)};It.render=function(t,e,n){if(!ka(e))throw Error(L(200));return Ea(null,t,e,!1,n)};It.unmountComponentAtNode=function(t){if(!ka(t))throw Error(L(40));return t._reactRootContainer?(wr(function(){Ea(null,null,t,!1,function(){t._reactRootContainer=null,t[vn]=null})}),!0):!1};It.unstable_batchedUpdates=$u;It.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ka(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return Ea(t,e,n,!1,r)};It.version="18.3.1-next-f1338f8080-20240426";function s0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s0)}catch(t){console.error(t)}}s0(),sm.exports=It;var Nw=sm.exports,Rf=Nw;Il.createRoot=Rf.createRoot,Il.hydrateRoot=Rf.hydrateRoot;var ve=(t=>(t.DASHBOARD="DASHBOARD",t.CAL_COACH="CAL_COACH",t.WORKOUT_PLAN="WORKOUT_PLAN",t.HISTORY="HISTORY",t.PROFILE="PROFILE",t.ONBOARDING="ONBOARDING",t))(ve||{});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Iw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),W=(t,e)=>{const n=k.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:a="",children:c,...d},h)=>k.createElement("svg",{ref:h,...Iw,width:s,height:s,stroke:r,strokeWidth:i?Number(o)*24/Number(s):o,className:["lucide",`lucide-${Aw(t)}`,a].join(" "),...d},[...e.map(([p,m])=>k.createElement(p,m)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=W("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=W("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=W("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=W("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=W("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=W("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=W("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=W("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=W("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=W("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=W("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=W("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=W("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=W("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=W("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=W("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=W("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=W("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=W("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=W("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=W("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=W("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=W("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=W("Footprints",[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=W("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=W("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=W("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=W("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=W("ImageOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=W("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=W("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=W("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=W("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=W("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=W("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=W("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=W("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=W("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=W("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=W("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=W("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=W("PersonStanding",[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["path",{d:"m9 20 3-6 3 6",key:"se2kox"}],["path",{d:"m6 8 6 2 6-2",key:"4o3us4"}],["path",{d:"M12 10v4",key:"1kjpxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=W("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=W("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=W("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=W("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=W("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=W("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=W("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n_=W("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mf=W("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=W("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=W("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=W("Sword",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=W("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=W("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=W("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o_=W("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=W("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=W("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=W("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=W("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=W("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=W("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=W("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=W("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function p0(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=p0(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function or(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=p0(t))&&(r&&(r+=" "),r+=e);return r}const l_=({children:t,currentView:e,onNavigate:n})=>l.jsxs("div",{className:"h-[100dvh] bg-surface dark:bg-surface-dark flex flex-col max-w-md mx-auto relative shadow-2xl shadow-gray-200 dark:shadow-black/50 overflow-hidden border-x border-gray-100/50 dark:border-white/5 transition-colors duration-300",children:[l.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:t}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-white/60 dark:bg-[#0f111a]/60 backdrop-blur-md pointer-events-auto z-40"}),l.jsx("div",{className:"absolute bottom-8 left-6 right-6 z-50",children:l.jsxs("nav",{className:"bg-white/80 dark:bg-[#1a1c26]/80 backdrop-blur-xl rounded-[32px] p-2 shadow-diffused-lg dark:shadow-diffused-dark border border-white dark:border-white/5 flex justify-between items-center",children:[l.jsxs("button",{onClick:()=>n(ve.DASHBOARD),className:or("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ve.DASHBOARD?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[l.jsx($w,{size:22,strokeWidth:e===ve.DASHBOARD?2.5:2}),e===ve.DASHBOARD&&l.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-left-2 duration-300",children:"Today"})]}),l.jsxs("button",{onClick:()=>n(ve.CAL_COACH),className:or("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ve.CAL_COACH?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[l.jsx(wt,{size:22,strokeWidth:e===ve.CAL_COACH?2.5:2}),e===ve.CAL_COACH&&l.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-left-2 duration-300",children:"Coach"})]}),l.jsxs("button",{onClick:()=>n(ve.WORKOUT_PLAN),className:or("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ve.WORKOUT_PLAN?"flex-[2] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[l.jsx(ys,{size:22,strokeWidth:e===ve.WORKOUT_PLAN?2.5:2}),e===ve.WORKOUT_PLAN&&l.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-left-2 duration-300",children:"Workout"})]}),l.jsxs("button",{onClick:()=>n(ve.HISTORY),className:or("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ve.HISTORY?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[l.jsx(Pw,{size:22,strokeWidth:e===ve.HISTORY?2.5:2}),e===ve.HISTORY&&l.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-right-2 duration-300",children:"Report"})]}),l.jsxs("button",{onClick:()=>n(ve.PROFILE),className:or("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ve.PROFILE?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[l.jsx(xs,{size:22,strokeWidth:e===ve.PROFILE?2.5:2}),e===ve.PROFILE&&l.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-right-2 duration-300",children:"Profile"})]})]})})]}),rt=({children:t,className:e,onClick:n})=>l.jsx("div",{onClick:n,className:or("bg-white dark:bg-[#1a1c26] rounded-[32px] p-5 shadow-diffused dark:shadow-diffused-dark border border-white/60 dark:border-white/5",n&&"cursor-pointer active:scale-[0.98] transition-all hover:shadow-diffused-lg dark:hover:shadow-diffused-dark hover:-translate-y-0.5",e),children:t});function Ca(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function c_(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function a(h){try{d(r.next(h))}catch(p){i(p)}}function c(h){try{d(r.throw(h))}catch(p){i(p)}}function d(h){h.done?o(h.value):s(h.value).then(a,c)}d((r=r.apply(t,e||[])).next())})}const u_=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Zu extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class d_ extends Zu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Df extends Zu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Lf extends Zu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var kc;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(kc||(kc={}));class f_{constructor(e,{headers:n={},customFetch:r,region:s=kc.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=u_(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return c_(this,arguments,void 0,function*(n,r={}){var s;let o,i;try{const{headers:a,method:c,body:d,signal:h,timeout:p}=r;let m={},{region:g}=r;g||(g=this.region);const y=new URL(`${this.url}/${n}`);g&&g!=="any"&&(m["x-region"]=g,y.searchParams.set("forceFunctionRegion",g));let _;d&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(m["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(m["Content-Type"]="application/json",_=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?_=JSON.stringify(d):_=d;let b=h;p&&(i=new AbortController,o=setTimeout(()=>i.abort(),p),h?(b=i.signal,h.addEventListener("abort",()=>i.abort())):b=i.signal);const x=yield this.fetch(y.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),a),body:_,signal:b}).catch(T=>{throw new d_(T)}),w=x.headers.get("x-relay-error");if(w&&w==="true")throw new Df(x);if(!x.ok)throw new Lf(x);let v=((s=x.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),S;return v==="application/json"?S=yield x.json():v==="application/octet-stream"||v==="application/pdf"?S=yield x.blob():v==="text/event-stream"?S=x:v==="multipart/form-data"?S=yield x.formData():S=yield x.text(),{data:S,error:null,response:x}}catch(a){return{data:null,error:a,response:a instanceof Lf||a instanceof Df?a.context:void 0}}finally{o&&clearTimeout(o)}})}}var h_=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},p_=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let i=null,a=null,c=null,d=o.status,h=o.statusText;if(o.ok){var p,m;if(n.method!=="HEAD"){var g;const x=await o.text();x===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((g=n.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?a=x:a=JSON.parse(x))}const _=(p=n.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),b=(m=o.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");_&&b&&b.length>1&&(c=parseInt(b[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(i={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,c=null,d=406,h="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var y;const _=await o.text();try{i=JSON.parse(_),Array.isArray(i)&&o.status===404&&(a=[],i=null,d=200,h="OK")}catch{o.status===404&&_===""?(d=204,h="No Content"):i={message:_}}if(i&&n.isMaybeSingle&&(!(i==null||(y=i.details)===null||y===void 0)&&y.includes("0 rows"))&&(i=null,d=200,h="OK"),i&&n.shouldThrowOnError)throw new h_(i)}return{error:i,data:a,count:c,status:d,statusText:h}});return this.shouldThrowOnError||(s=s.catch(o=>{var i;let a="";const c=o==null?void 0:o.cause;if(c){var d,h,p,m;const y=(d=c==null?void 0:c.message)!==null&&d!==void 0?d:"",_=(h=c==null?void 0:c.code)!==null&&h!==void 0?h:"";a=`${(p=o==null?void 0:o.name)!==null&&p!==void 0?p:"FetchError"}: ${o==null?void 0:o.message}`,a+=`

Caused by: ${(m=c==null?void 0:c.name)!==null&&m!==void 0?m:"Error"}: ${y}`,_&&(a+=` (${_})`),c!=null&&c.stack&&(a+=`
${c.stack}`)}else{var g;a=(g=o==null?void 0:o.stack)!==null&&g!==void 0?g:""}return{error:{message:`${(i=o==null?void 0:o.name)!==null&&i!==void 0?i:"FetchError"}: ${o==null?void 0:o.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}},m_=class extends p_{select(t){let e=!1;const n=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",i=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${i?`${i},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var i;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${c}"; options=${a};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Uf=new RegExp("[,()]");var Lr=class extends m_{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Uf.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Uf.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${o}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},g_=class{constructor(t,{headers:e={},schema:n,fetch:r}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:n=!1,count:r}=e??{},s=n?"HEAD":"GET";let o=!1;const i=(t??"*").split("").map(d=>/\s/.test(d)&&!o?"":(d==='"'&&(o=!o),d)).join(""),{url:a,headers:c}=this.cloneRequestState();return a.searchParams.set("select",i),r&&c.append("Prefer",`count=${r}`),new Lr({method:s,url:a,headers:c,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var r;const s="POST",{url:o,headers:i}=this.cloneRequestState();if(e&&i.append("Prefer",`count=${e}`),n||i.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(a.length>0){const c=[...new Set(a)].map(d=>`"${d}"`);o.searchParams.set("columns",c.join(","))}}return new Lr({method:s,url:o,headers:i,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}={}){var o;const i="POST",{url:a,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&a.searchParams.set("on_conflict",e),r&&c.append("Prefer",`count=${r}`),s||c.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(d.length>0){const h=[...new Set(d)].map(p=>`"${p}"`);a.searchParams.set("columns",h.join(","))}}return new Lr({method:i,url:a,headers:c,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:e}={}){var n;const r="PATCH",{url:s,headers:o}=this.cloneRequestState();return e&&o.append("Prefer",`count=${e}`),new Lr({method:r,url:s,headers:o,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE",{url:r,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Lr({method:n,url:r,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},y_=class m0{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new g_(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new m0(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:o}={}){var i;let a;const c=new URL(`${this.url}/rpc/${e}`);let d;const h=g=>g!==null&&typeof g=="object"&&(!Array.isArray(g)||g.some(h)),p=r&&Object.values(n).some(h);p?(a="POST",d=n):r||s?(a=r?"HEAD":"GET",Object.entries(n).filter(([g,y])=>y!==void 0).map(([g,y])=>[g,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([g,y])=>{c.searchParams.append(g,y)})):(a="POST",d=n);const m=new Headers(this.headers);return p?m.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&m.set("Prefer",`count=${o}`),new Lr({method:a,url:c,headers:m,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class v_{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const r=n.versions;if(r&&r.node){const s=r.node,o=parseInt(s.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const x_="2.90.1",w_=`realtime-js/${x_}`,g0="1.0.0",__="2.0.0",jf=g0,Ec=1e4,b_=1e3,S_=100;var An;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(An||(An={}));var Oe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Oe||(Oe={}));var Jt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Jt||(Jt={}));var Cc;(function(t){t.websocket="websocket"})(Cc||(Cc={}));var ir;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ir||(ir={}));class k_{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},i=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(e,n,r){var s,o;const i=e.topic,a=(s=e.ref)!==null&&s!==void 0?s:"",c=(o=e.join_ref)!==null&&o!==void 0?o:"",d=e.payload.event,h=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},p=Object.keys(h).length===0?"":JSON.stringify(h);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const m=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+a.length+i.length+d.length+p.length,g=new ArrayBuffer(this.HEADER_LENGTH+m);let y=new DataView(g),_=0;y.setUint8(_++,this.KINDS.userBroadcastPush),y.setUint8(_++,c.length),y.setUint8(_++,a.length),y.setUint8(_++,i.length),y.setUint8(_++,d.length),y.setUint8(_++,p.length),y.setUint8(_++,n),Array.from(c,x=>y.setUint8(_++,x.charCodeAt(0))),Array.from(a,x=>y.setUint8(_++,x.charCodeAt(0))),Array.from(i,x=>y.setUint8(_++,x.charCodeAt(0))),Array.from(d,x=>y.setUint8(_++,x.charCodeAt(0))),Array.from(p,x=>y.setUint8(_++,x.charCodeAt(0)));var b=new Uint8Array(g.byteLength+r.byteLength);return b.set(new Uint8Array(g),0),b.set(new Uint8Array(r),g.byteLength),b.buffer}decode(e,n){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return n(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,o,i,a,c]=r;return n({join_ref:s,ref:o,topic:i,event:a,payload:c})}return n({})}_binaryDecode(e){const n=new DataView(e),r=n.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,s)}}_decodeUserBroadcast(e,n,r){const s=n.getUint8(1),o=n.getUint8(2),i=n.getUint8(3),a=n.getUint8(4);let c=this.HEADER_LENGTH+4;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+o));c=c+o;const p=r.decode(e.slice(c,c+i));c=c+i;const m=e.slice(c,e.byteLength),g=a===this.JSON_ENCODING?JSON.parse(r.decode(m)):m,y={type:this.BROADCAST_EVENT,event:h,payload:g};return i>0&&(y.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>n.includes(r)))}}class y0{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var we;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(we||(we={}));const Ff=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((o,i)=>(o[i]=E_(i,t,e,s),o),{}):{}},E_=(t,e,n,r)=>{const s=e.find(a=>a.name===t),o=s==null?void 0:s.type,i=n[t];return o&&!r.includes(o)?v0(o,i):Tc(i)},v0=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return I_(e,n)}switch(t){case we.bool:return C_(e);case we.float4:case we.float8:case we.int2:case we.int4:case we.int8:case we.numeric:case we.oid:return T_(e);case we.json:case we.jsonb:return N_(e);case we.timestamp:return A_(e);case we.abstime:case we.date:case we.daterange:case we.int4range:case we.int8range:case we.money:case we.reltime:case we.text:case we.time:case we.timestamptz:case we.timetz:case we.tsrange:case we.tstzrange:return Tc(e);default:return Tc(e)}},Tc=t=>t,C_=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},T_=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},N_=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},I_=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let o;const i=t.slice(1,n);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(a=>v0(e,a))}return t},A_=t=>typeof t=="string"?t.replace(" ","T"):t,x0=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class gl{constructor(e,n,r={},s=Ec){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Of;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Of||(Of={}));class Zs{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zs.syncState(this.state,s,o,i),this.pendingDiffs.forEach(c=>{this.state=Zs.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Zs.syncDiff(this.state,s,o,i),a())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const o=this.cloneDeep(e),i=this.transformState(n),a={},c={};return this.map(o,(d,h)=>{i[d]||(c[d]=h)}),this.map(i,(d,h)=>{const p=o[d];if(p){const m=h.map(b=>b.presence_ref),g=p.map(b=>b.presence_ref),y=h.filter(b=>g.indexOf(b.presence_ref)<0),_=p.filter(b=>m.indexOf(b.presence_ref)<0);y.length>0&&(a[d]=y),_.length>0&&(c[d]=_)}else a[d]=h}),this.syncDiff(o,{joins:a,leaves:c},r,s)}static syncDiff(e,n,r,s){const{joins:o,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(o,(a,c)=>{var d;const h=(d=e[a])!==null&&d!==void 0?d:[];if(e[a]=this.cloneDeep(c),h.length>0){const p=e[a].map(g=>g.presence_ref),m=h.filter(g=>p.indexOf(g.presence_ref)<0);e[a].unshift(...m)}r(a,h,c)}),this.map(i,(a,c)=>{let d=e[a];if(!d)return;const h=c.map(p=>p.presence_ref);d=d.filter(p=>h.indexOf(p.presence_ref)<0),e[a]=d,s(a,d,c),d.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $f;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})($f||($f={}));var eo;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(eo||(eo={}));var fn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(fn||(fn={}));class Qr{constructor(e,n={config:{}},r){var s,o;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Oe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new gl(this,Jt.join,this.params,this.timeout),this.rejoinTimer=new y0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Oe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Oe.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Jt.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new Zs(this),this.broadcastEndpointURL=x0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Oe.closed){const{config:{broadcast:i,presence:a,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[eo.PRESENCE]&&this.bindings[eo.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,p={},m={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(fn.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(fn.CLOSED)),this.updateJoinPayload(Object.assign({config:m},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),g===void 0){e==null||e(fn.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,b=(y=_==null?void 0:_.length)!==null&&y!==void 0?y:0,x=[];for(let w=0;w<b;w++){const v=_[w],{filter:{event:S,schema:T,table:E,filter:C}}=v,P=g&&g[w];if(P&&P.event===S&&Qr.isFilterValueEqual(P.schema,T)&&Qr.isFilterValueEqual(P.table,E)&&Qr.isFilterValueEqual(P.filter,C))x.push(Object.assign(Object.assign({},v),{id:P.id}));else{this.unsubscribe(),this.state=Oe.errored,e==null||e(fn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(fn.SUBSCRIBED);return}}).receive("error",g=>{this.state=Oe.errored,e==null||e(fn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(fn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Oe.joined&&e===eo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,r)}async httpSend(e,n,r={}){var s;if(n==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(a.status===202)return{success:!0};let c=a.statusText;try{const d=await a.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:i}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,a,c;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Oe.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Jt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new gl(this,Jt.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Oe.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,o=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(o),i}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new gl(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>S_){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,o;const i=e.toLocaleLowerCase(),{close:a,error:c,leave:d,join:h}=Jt;if(r&&[a,c,d,h].indexOf(i)>=0&&r!==this._joinRef())return;let m=this._onMessage(i,n,r);if(n&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var y,_,b;return((y=g.filter)===null||y===void 0?void 0:y.event)==="*"||((b=(_=g.filter)===null||_===void 0?void 0:_.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===i}).map(g=>g.callback(m,r)):(o=this.bindings[i])===null||o===void 0||o.filter(g=>{var y,_,b,x,w,v,S,T;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const E=g.id,C=(y=g.filter)===null||y===void 0?void 0:y.event;return E&&((_=n.ids)===null||_===void 0?void 0:_.includes(E))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))&&(!(!((x=g.filter)===null||x===void 0)&&x.table)||g.filter.table===((w=n.data)===null||w===void 0?void 0:w.table))}else{const E=(S=(v=g==null?void 0:g.filter)===null||v===void 0?void 0:v.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return E==="*"||E===((T=n==null?void 0:n.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof m=="object"&&"ids"in m){const y=m.data,{schema:_,table:b,commit_timestamp:x,type:w,errors:v}=y;m=Object.assign(Object.assign({},{schema:_,table:b,commit_timestamp:x,eventType:w,new:{},old:{},errors:v}),this._getPayloadRecords(y))}g.callback(m,r)})}_isClosed(){return this.state===Oe.closed}_isJoined(){return this.state===Oe.joined}_isJoining(){return this.state===Oe.joining}_isLeaving(){return this.state===Oe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),o={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&Qr.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Jt.close,{},e)}_onError(e){this._on(Jt.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Oe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Ff(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Ff(e.columns,e.old_record)),n}}const yl=()=>{},Zo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},R_=[1e3,2e3,5e3,1e4],P_=1e4,M_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class D_{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ec,this.transport=null,this.heartbeatIntervalMs=Zo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=yl,this.ref=0,this.reconnectTimer=null,this.vsn=jf,this.logger=yl,this.conn=null,this.sendBuffer=[],this.serializer=new k_,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...o)=>s(...o):(...o)=>fetch(...o),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Cc.websocket}`,this.httpEndpoint=x0(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=v_.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case An.connecting:return ir.Connecting;case An.open:return ir.Open;case An.closing:return ir.Closing;default:return ir.Closed}}isConnected(){return this.connectionState()===ir.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(o=>o.topic===r);if(s)return s;{const o=new Qr(`realtime:${e}`,n,this);return this.channels.push(o),o}}push(e){const{topic:n,event:r,payload:s,ref:o}=e,i=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${n} ${r} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(b_,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Zo.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",d)}catch(h){this.log("error","error in heartbeat callback",h)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:s,payload:o,ref:i}=n,a=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${r} ${s} ${a}`.trim(),o),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,o,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===An.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===An.open||this.conn.readyState===An.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Jt.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([M_],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,r=!1;if(e)n=e,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const o={access_token:n,version:w_};n&&s.updateJoinPayload(o),s.joinedOnce&&s._isJoined()&&s._push(Jt.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new y0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,o,i,a,c,d,h,p,m,g;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Ec,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Zo.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:yl,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:jf,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e==null?void 0:e.reconnectAfterMs)!==null&&d!==void 0?d:y=>R_[y-1]||P_,this.vsn){case g0:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:(y,_)=>_(JSON.stringify(y)),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:(y,_)=>_(JSON.parse(y));break;case __:this.encode=(m=e==null?void 0:e.encode)!==null&&m!==void 0?m:this.serializer.encode.bind(this.serializer),this.decode=(g=e==null?void 0:e.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var _o=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function L_(t,e,n){const r=new URL(e,t);if(n)for(const[s,o]of Object.entries(n))o!==void 0&&r.searchParams.set(s,o);return r.toString()}async function U_(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function j_(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:s,body:o,headers:i}){const a=L_(t.baseUrl,r,s),c=await U_(t.auth),d=await e(a,{method:n,headers:{...o?{"Content-Type":"application/json"}:{},...c,...i},body:o?JSON.stringify(o):void 0}),h=await d.text(),p=(d.headers.get("content-type")||"").includes("application/json"),m=p&&h?JSON.parse(h):h;if(!d.ok){const g=p?m:void 0,y=g==null?void 0:g.error;throw new _o((y==null?void 0:y.message)??`Request failed with status ${d.status}`,{status:d.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:g})}return{status:d.status,headers:d.headers,data:m}}}}function ei(t){return t.join("")}var F_=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:ei(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ei(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ei(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ei(t.namespace)}`}),!0}catch(e){if(e instanceof _o&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof _o&&n.status===409)return;throw n}}};function Nr(t){return t.join("")}var O_=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Nr(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Nr(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Nr(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Nr(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Nr(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Nr(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof _o&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof _o&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},$_=class{constructor(t){var r;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=j_({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(r=t.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new F_(this.client,e),this.tableOps=new O_(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Ta=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function Ce(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var G_=class extends Ta{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Nc=class extends Ta{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const ed=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),z_=()=>Response,Ic=t=>{if(Array.isArray(t))return t.map(n=>Ic(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[s]=Ic(r)}),e},B_=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},V_=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function bo(t){"@babel/helpers - typeof";return bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bo(t)}function q_(t,e){if(bo(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(bo(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H_(t){var e=q_(t,"string");return bo(e)=="symbol"?e:e+""}function W_(t,e,n){return(e=H_(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Gf(Object(n),!0).forEach(function(r){W_(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gf(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const vl=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},J_=async(t,e,n)=>{t instanceof await z_()&&!(n!=null&&n.noResolveJson)?t.json().then(r=>{const s=t.status||500,o=(r==null?void 0:r.statusCode)||s+"";e(new G_(vl(r),s,o))}).catch(r=>{e(new Nc(vl(r),r))}):e(new Nc(vl(t),t))},K_=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(B_(r)?(s.headers=se({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),se(se({},s),n))};async function Do(t,e,n,r,s,o){return new Promise((i,a)=>{t(n,K_(e,r,s,o)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>J_(c,a,r))})}async function So(t,e,n,r){return Do(t,"GET",e,n,r)}async function Ht(t,e,n,r,s){return Do(t,"POST",e,r,s,n)}async function Ac(t,e,n,r,s){return Do(t,"PUT",e,r,s,n)}async function Y_(t,e,n,r){return Do(t,"HEAD",e,se(se({},n),{},{noResolveJson:!0}),r)}async function td(t,e,n,r,s){return Do(t,"DELETE",e,r,s,n)}var Q_=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Ce(e))return{data:null,error:e};throw e}}};let w0;w0=Symbol.toStringTag;var X_=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[w0]="BlobDownloadBuilder",this.promise=null}asStream(){return new Q_(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Ce(e))return{data:null,error:e};throw e}}};const Z_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},zf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var eb=class{constructor(t,e={},n,r){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=ed(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,r){var s=this;try{let o;const i=se(se({},zf),r);let a=se(se({},s.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",s.encodeMetadata(c)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.has("cacheControl")||o.append("cacheControl",i.cacheControl),c&&!o.has("metadata")&&o.append("metadata",s.encodeMetadata(c))):(o=n,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,c&&(a["x-metadata"]=s.toBase64(s.encodeMetadata(c))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!i.duplex&&(i.duplex="half")),r!=null&&r.headers&&(a=se(se({},a),r.headers));const d=s._removeEmptyFolders(e),h=s._getFinalPath(d),p=await(t=="PUT"?Ac:Ht)(s.fetch,`${s.url}/object/${h}`,o,se({headers:a},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(Ce(o))return{data:null,error:o};throw o}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,r){var s=this;const o=s._removeEmptyFolders(t),i=s._getFinalPath(o),a=new URL(s.url+`/object/upload/sign/${i}`);a.searchParams.set("token",e);try{let c;const d=se({upsert:zf.upsert},r),h=se(se({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType),{data:{path:o,fullPath:(await Ac(s.fetch,a.toString(),c,{headers:h})).Key},error:null}}catch(c){if(s.shouldThrowOnError)throw c;if(Ce(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(t,e){var n=this;try{let r=n._getFinalPath(t);const s=se({},n.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const o=await Ht(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(n.url+o.url),a=i.searchParams.get("token");if(!a)throw new Ta("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:a},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Ce(r))return{data:null,error:r};throw r}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var r=this;try{return{data:await Ht(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ce(s))return{data:null,error:s};throw s}}async copy(t,e,n){var r=this;try{return{data:{path:(await Ht(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers})).Key},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ce(s))return{data:null,error:s};throw s}}async createSignedUrl(t,e,n){var r=this;try{let s=r._getFinalPath(t),o=await Ht(r.fetch,`${r.url}/object/sign/${s}`,se({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:r.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${r.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ce(s))return{data:null,error:s};throw s}}async createSignedUrls(t,e,n){var r=this;try{const s=await Ht(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>se(se({},i),{},{signedUrl:i.signedURL?encodeURI(`${r.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ce(s))return{data:null,error:s};throw s}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),s=r?`?${r}`:"",o=this._getFinalPath(t),i=()=>So(this.fetch,`${this.url}/${n}/${o}${s}`,{headers:this.headers,noResolveJson:!0});return new X_(i,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:Ic(await So(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ce(r))return{data:null,error:r};throw r}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await Y_(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Ce(r)&&r instanceof Nc){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}}getPublicUrl(t,e){const n=this._getFinalPath(t),r=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&r.push(s);const o=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});i!==""&&r.push(i);let a=r.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${a}`)}}}async remove(t){var e=this;try{return{data:await td(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}async list(t,e,n){var r=this;try{const s=se(se(se({},Z_),e),{},{prefix:t||""});return{data:await Ht(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},n),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ce(s))return{data:null,error:s};throw s}}async listV2(t,e){var n=this;try{const r=se({},t);return{data:await Ht(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},e),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Ce(r))return{data:null,error:r};throw r}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const _0="2.90.1",b0={"X-Client-Info":`storage-js/${_0}`};var tb=class{constructor(t,e={},n,r){this.shouldThrowOnError=!1;const s=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=se(se({},b0),e),this.fetch=ed(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await So(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await So(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await Ht(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Ce(r))return{data:null,error:r};throw r}}async updateBucket(t,e){var n=this;try{return{data:await Ac(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Ce(r))return{data:null,error:r};throw r}}async emptyBucket(t){var e=this;try{return{data:await Ht(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await td(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},nb=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=se(se({},b0),e),this.fetch=ed(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Ht(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const r=n.toString(),s=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return{data:await So(e.fetch,s,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await td(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ce(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!V_(t))throw new Ta("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new $_({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(s,o){const i=s[o];return typeof i!="function"?i:async(...a)=>{try{return{data:await i.apply(s,a),error:null}}catch(c){if(r)throw c;return{data:null,error:c}}}}})}};const nd={"X-Client-Info":`storage-js/${_0}`,"Content-Type":"application/json"};var S0=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function St(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var xl=class extends S0{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},rb=class extends S0{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const rd=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),sb=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Bf=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),ob=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const r=t.status||500,s=t;if(typeof s.json=="function")s.json().then(o=>{const i=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||r+"";e(new xl(Bf(o),r,i))}).catch(()=>{const o=r+"";e(new xl(s.statusText||`HTTP ${r} error`,r,o))});else{const o=r+"";e(new xl(s.statusText||`HTTP ${r} error`,r,o))}}else e(new rb(Bf(t),t))},ib=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return r?(sb(r)?(s.headers=se({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,se(se({},s),n)):s};async function ab(t,e,n,r,s,o){return new Promise((i,a)=>{t(n,ib(e,r,s,o)).then(c=>{if(!c.ok)throw c;if(r!=null&&r.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>ob(c,a,r))})}async function kt(t,e,n,r,s){return ab(t,"POST",e,r,s,n)}var lb=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=se(se({},nd),e),this.fetch=rd(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await kt(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await kt(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(St(r))return{data:null,error:r};throw r}}async listIndexes(t){var e=this;try{return{data:await kt(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await kt(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(St(r))return{data:null,error:r};throw r}}},cb=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=se(se({},nd),e),this.fetch=rd(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await kt(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await kt(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await kt(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await kt(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await kt(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}},ub=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=se(se({},nd),e),this.fetch=rd(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await kt(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await kt(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await kt(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await kt(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(St(n))return{data:null,error:n};throw n}}},db=class extends ub{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new fb(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},fb=class extends lb{constructor(t,e,n,r){super(t,e,r),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,se(se({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,se(se({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new hb(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},hb=class extends cb{constructor(t,e,n,r,s){super(t,e,s),this.vectorBucketName=n,this.indexName=r}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,se(se({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,se(se({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,se(se({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,se(se({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,se(se({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},pb=class extends tb{constructor(t,e={},n,r){super(t,e,n,r)}from(t){return new eb(this.url,this.headers,t,this.fetch)}get vectors(){return new db(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new nb(this.url+"/iceberg",this.headers,this.fetch)}};const k0="2.90.1",Ur=30*1e3,Rc=3,wl=Rc*Ur,mb="http://localhost:9999",gb="supabase.auth.token",yb={"X-Client-Info":`gotrue-js/${k0}`},Pc="X-Supabase-Api-Version",E0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,xb=10*60*1e3;class ko extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function K(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class wb extends ko{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function _b(t){return K(t)&&t.name==="AuthApiError"}class ar extends ko{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Sn extends ko{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class _t extends Sn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bb(t){return K(t)&&t.name==="AuthSessionMissingError"}class Ir extends Sn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ti extends Sn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ni extends Sn{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Sb(t){return K(t)&&t.name==="AuthImplicitGrantRedirectError"}class Vf extends Sn{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class kb extends Sn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Mc extends Sn{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function _l(t){return K(t)&&t.name==="AuthRetryableFetchError"}class qf extends Sn{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Dc extends Sn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hf=` 	
\r=`.split(""),Eb=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Hf.length;e+=1)t[Hf[e].charCodeAt(0)]=-2;for(let e=0;e<Xi.length;e+=1)t[Xi[e].charCodeAt(0)]=e;return t})();function Wf(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Xi[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Xi[r]),e.queuedBits-=6}}function C0(t,e,n){const r=Eb[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Jf(t){const e=[],n=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{Nb(i,r,n)};for(let i=0;i<t.length;i+=1)C0(t.charCodeAt(i),s,o);return e.join("")}function Cb(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Tb(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}Cb(r,e)}}function Nb(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function as(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)C0(t.charCodeAt(s),n,r);return new Uint8Array(e)}function Ib(t){const e=[];return Tb(t,n=>e.push(n)),new Uint8Array(e)}function dr(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>Wf(s,n,r)),Wf(null,n,r),e.join("")}function Ab(t){return Math.round(Date.now()/1e3)+t}function Rb(){return Symbol("auth-callback")}const Ye=()=>typeof window<"u"&&typeof document<"u",Zn={tested:!1,writable:!1},T0=()=>{if(!Ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zn.tested)return Zn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Zn.tested=!0,Zn.writable=!0}catch{Zn.tested=!0,Zn.writable=!1}return Zn.writable};function Pb(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const N0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Mb=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",jr=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},er=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Je=async(t,e)=>{await t.removeItem(e)};class Na{constructor(){this.promise=new Na.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Na.promiseConstructor=Promise;function bl(t){const e=t.split(".");if(e.length!==3)throw new Dc("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!vb.test(e[r]))throw new Dc("JWT not in base64url format");return{header:JSON.parse(Jf(e[0])),payload:JSON.parse(Jf(e[1])),signature:as(e[2]),raw:{header:e[0],payload:e[1]}}}async function Db(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Lb(t,e){return new Promise((r,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await t(o);if(!e(o,null,i)){r(i);return}}catch(i){if(!e(o,i)){s(i);return}}})()})}function Ub(t){return("0"+t.toString(16)).substr(-2)}function jb(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let o=0;o<56;o++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Ub).join("")}async function Fb(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function Ob(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Fb(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ar(t,e,n=!1){const r=jb();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await jr(t,`${e}-code-verifier`,s);const o=await Ob(r);return[o,r===o?"plain":"s256"]}const $b=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Gb(t){const e=t.headers.get(Pc);if(!e||!e.match($b))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function zb(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Bb(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Vb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Rr(t){if(!Vb.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Sl(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function qb(t,e){return new Proxy(t,{get:(n,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const o=r.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,r,s)}})}function Kf(t){return JSON.parse(JSON.stringify(t))}const rr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Hb=[502,503,504];async function Yf(t){var e;if(!Mb(t))throw new Mc(rr(t),0);if(Hb.includes(t.status))throw new Mc(rr(t),t.status);let n;try{n=await t.json()}catch(o){throw new ar(rr(o),o)}let r;const s=Gb(t);if(s&&s.getTime()>=E0["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new qf(rr(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new _t}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new qf(rr(n),t.status,n.weak_password.reasons);throw new wb(rr(n),t.status||500,r)}const Wb=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function re(t,e,n,r){var s;const o=Object.assign({},r==null?void 0:r.headers);o[Pc]||(o[Pc]=E0["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const i=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await Jb(t,e,n+a,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function Jb(t,e,n,r,s,o){const i=Wb(e,r,s,o);let a;try{a=await t(n,Object.assign({},i))}catch(c){throw console.error(c),new Mc(rr(c),0)}if(a.ok||await Yf(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(c){await Yf(c)}}function Vt(t){var e;let n=null;Qb(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=Ab(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Qf(t){const e=Vt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Mn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Kb(t){return{data:t,error:null}}function Yb(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o}=t,i=Ca(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o},c=Object.assign({},i);return{data:{properties:a,user:c},error:null}}function Xf(t){return t}function Qb(t){return t.access_token&&t.refresh_token&&t.expires_in}const kl=["global","local","others"];class Xb{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=N0(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=kl[0]){if(kl.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${kl.join(", ")}`);try{return await re(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await re(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Mn})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Ca(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Yb,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(K(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await re(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Mn})}catch(n){if(K(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,o,i,a,c;try{const d={nextPage:null,lastPage:0,total:0},h=await re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:Xf});if(h.error)throw h.error;const p=await h.json(),m=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(y=>{const _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(y.split(";")[1].split("=")[1]);d[`${b}Page`]=_}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(K(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Rr(e);try{return await re(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Mn})}catch(n){if(K(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Rr(e);try{return await re(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Mn})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Rr(e);try{return await re(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Mn})}catch(r){if(K(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Rr(e.userId);try{const{data:n,error:r}=await re(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(K(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Rr(e.userId),Rr(e.id);try{return{data:await re(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,s,o,i,a,c;try{const d={nextPage:null,lastPage:0,total:0},h=await re(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:Xf});if(h.error)throw h.error;const p=await h.json(),m=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(y=>{const _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(y.split(";")[1].split("=")[1]);d[`${b}Page`]=_}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(K(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await re(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(K(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await re(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(K(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await re(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(K(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await re(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await re(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(K(n))return{data:null,error:n};throw n}}}function Zf(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const Pr={debug:!!(globalThis&&T0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class I0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Zb extends I0{}async function eS(t,e,n){Pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Pr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{Pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Pr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Zb(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Pr.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function tS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function A0(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function nS(t){return parseInt(t,16)}function rS(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function sS(t){var e;const{chainId:n,domain:r,expirationTime:s,issuedAt:o=new Date,nonce:i,notBefore:a,requestId:c,resources:d,scheme:h,uri:p,version:m}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(m!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=A0(t.address),y=h?`${h}://${r}`:r,_=t.statement?`${t.statement}
`:"",b=`${y} wants you to sign in with your Ethereum account:
${g}

${_}`;let x=`URI: ${p}
Version: ${m}
Chain ID: ${n}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(s&&(x+=`
Expiration Time: ${s.toISOString()}`),a&&(x+=`
Not Before: ${a.toISOString()}`),c&&(x+=`
Request ID: ${c}`),d){let w=`
Resources:`;for(const v of d){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);w+=`
- ${v}`}x+=w}return`${b}
${x}`}class je extends Error{constructor({message:e,code:n,cause:r,name:s}){var o;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(o=s??(r instanceof Error?r.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=n}}class Zi extends je{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function oS({error:t,options:e}){var n,r,s;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new je({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new je({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=o.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new je({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new je({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new je({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new je({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new je({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new je({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(R0(i)){if(o.rp.id!==i)return new je({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new je({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new je({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function iS({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new je({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new je({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(R0(r)){if(n.rpId!==r)return new je({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new je({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new je({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new je({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class aS{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const lS=new aS;function cS(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,s=Ca(t,["challenge","user","excludeCredentials"]),o=as(e).buffer,i=Object.assign(Object.assign({},n),{id:as(n.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:o,user:i});if(r&&r.length>0){a.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];a.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:as(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return a}function uS(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=Ca(t,["challenge","allowCredentials"]),s=as(e).buffer,o=Object.assign(Object.assign({},r),{challenge:s});if(n&&n.length>0){o.allowCredentials=new Array(n.length);for(let i=0;i<n.length;i++){const a=n[i];o.allowCredentials[i]=Object.assign(Object.assign({},a),{id:as(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return o}function dS(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:dr(new Uint8Array(t.response.attestationObject)),clientDataJSON:dr(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function fS(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:dr(new Uint8Array(s.authenticatorData)),clientDataJSON:dr(new Uint8Array(s.clientDataJSON)),signature:dr(new Uint8Array(s.signature)),userHandle:s.userHandle?dr(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function R0(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function eh(){var t,e;return!!(Ye()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function hS(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Zi("Browser returned unexpected credential type",e)}:{data:null,error:new Zi("Empty credential response",e)}}catch(e){return{data:null,error:oS({error:e,options:t})}}}async function pS(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Zi("Browser returned unexpected credential type",e)}:{data:null,error:new Zi("Empty credential response",e)}}catch(e){return{data:null,error:iS({error:e,options:t})}}}const mS={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},gS={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ea(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),n=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of t)if(s)for(const o in s){const i=s[o];if(i!==void 0)if(Array.isArray(i))r[o]=i;else if(n(i))r[o]=i;else if(e(i)){const a=r[o];e(a)?r[o]=ea(a,i):r[o]=ea(i)}else r[o]=i}return r}function yS(t,e){return ea(mS,t,e||{})}function vS(t,e){return ea(gS,t,e||{})}class xS{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:s},o){try{const{data:i,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!i)return{data:null,error:a};const c=s??lS.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=yS(i.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:h,error:p}=await hS({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const d=vS(i.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:h,error:p}=await pS(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(i){return K(i)?{data:null,error:i}:{data:null,error:new ar("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},o){if(!n)return{data:null,error:new ko("rpId is required for WebAuthn authentication")};try{if(!eh())return{data:null,error:new ar("Browser does not support WebAuthn",null)};const{data:i,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:s},{request:o});if(!i)return{data:null,error:a};const{webauthn:c}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:c.type,rpId:n,rpOrigins:r,credential_response:c.credential_response}})}catch(i){return K(i)?{data:null,error:i}:{data:null,error:new ar("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},o){if(!n)return{data:null,error:new ko("rpId is required for WebAuthn registration")};try{if(!eh())return{data:null,error:new ar("Browser does not support WebAuthn",null)};const{data:i,error:a}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(m=>m.factor_type==="webauthn"&&m.friendly_name===e&&m.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:a};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:s},{create:o});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:n,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return K(i)?{data:null,error:i}:{data:null,error:new ar("Unexpected error in register",i)}}}}tS();const wS={url:mb,storageKey:gb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:yb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function th(t,e,n){return await n()}const Mr={};class Eo{get jwks(){var e,n;return(n=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{cachedAt:e})}constructor(e){var n,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},wS),e);if(this.storageKey=o.storageKey,this.instanceID=(n=Eo.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Eo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&Ye()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Xb({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=N0(o.fetch),this.lock=o.lock||th,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&Ye()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=eS:this.lock=th,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new xS(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:T0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Zf(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Zf(this.memoryStorage)),Ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${k0}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},r="none";if(Ye()&&(n=Pb(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),Ye()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Sb(o)){const c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:i,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return K(n)?this._returnResult({error:n}):this._returnResult({error:new ar("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const o=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Vt}),{data:i,error:a}=o;if(a||!i)return this._returnResult({data:{user:null,session:null},error:a});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(K(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var n,r,s;try{let o;if("email"in e){const{email:h,password:p,options:m}=e;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await Ar(this.storage,this.storageKey)),o=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:h,password:p,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:g,code_challenge_method:y},xform:Vt})}else if("phone"in e){const{phone:h,password:p,options:m}=e;o=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},channel:(s=m==null?void 0:m.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Vt})}else throw new ti("You must provide either an email or phone number and a password");const{data:i,error:a}=o;if(a||!i)return await Je(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(await Je(this.storage,`${this.storageKey}-code-verifier`),K(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:i,options:a}=e;n=await re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Qf})}else if("phone"in e){const{phone:o,password:i,options:a}=e;n=await re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Qf})}else throw new ti("You must provide either an email or phone number and a password");const{data:r,error:s}=n;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const o=new Ir;return this._returnResult({data:{user:null,session:null},error:o})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(K(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,r,s,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,s,o,i,a,c,d,h,p,m;let g,y;if("message"in e)g=e.message,y=e.signature;else{const{chain:_,wallet:b,statement:x,options:w}=e;let v;if(Ye())if(typeof b=="object")v=b;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")v=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=b}const S=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href),T=await v.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=A0(T[0]);let C=(r=w==null?void 0:w.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!C){const R=await v.request({method:"eth_chainId"});C=nS(R)}const P={domain:S.host,address:E,statement:x,uri:S.href,version:"1",chainId:C,nonce:(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=w==null?void 0:w.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=w==null?void 0:w.signInWithEthereum)===null||h===void 0?void 0:h.resources};g=sS(P),y=await v.request({method:"personal_sign",params:[rS(g),E]})}try{const{data:_,error:b}=await re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:y},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Vt});if(b)throw b;if(!_||!_.session||!_.user){const x=new Ir;return this._returnResult({data:{user:null,session:null},error:x})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:b})}catch(_){if(K(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var n,r,s,o,i,a,c,d,h,p,m,g;let y,_;if("message"in e)y=e.message,_=e.signature;else{const{chain:b,wallet:x,statement:w,options:v}=e;let S;if(Ye())if(typeof x=="object")S=x;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))S=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=x}const T=new URL((n=v==null?void 0:v.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in S&&S.signIn){const E=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),w?{statement:w}:null));let C;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")C=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)C=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)y=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),_=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${T.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(s=(r=v==null?void 0:v.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v==null?void 0:v.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((p=(h=v==null?void 0:v.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...v.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const E=await S.signMessage(new TextEncoder().encode(y),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=E}}try{const{data:b,error:x}=await re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:dr(_)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Vt});if(x)throw x;if(!b||!b.session||!b.user){const w=new Ir;return this._returnResult({data:{user:null,session:null},error:w})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:x})}catch(b){if(K(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const n=await er(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new kb;const{data:o,error:i}=await re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Vt});if(await Je(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!o||!o.session||!o.user){const a=new Ir;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(await Je(this.storage,`${this.storageKey}-code-verifier`),K(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:o,nonce:i}=e,a=await re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Vt}),{data:c,error:d}=a;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new Ir;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(n){if(K(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,r,s,o,i;try{if("email"in e){const{email:a,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Ar(this.storage,this.storageKey));const{error:p}=await re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:a,options:c}=e,{data:d,error:h}=await re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h})}throw new ti("You must provide either an email or phone number.")}catch(a){if(await Je(this.storage,`${this.storageKey}-code-verifier`),K(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,r;try{let s,o;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:a}=await re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:Vt});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(K(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var n,r,s,o,i;try{let a=null,c=null;this.flowType==="pkce"&&([a,c]=await Ar(this.storage,this.storageKey));const d=await re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:c}),headers:this.headers,xform:Kb});return!((o=d.data)===null||o===void 0)&&o.url&&Ye()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(a){if(await Je(this.storage,`${this.storageKey}-code-verifier`),K(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new _t;const{error:s}=await re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(K(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:o}=e,{error:i}=await re(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:r,type:s,options:o}=e,{data:i,error:a}=await re(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:a})}throw new ti("You must provide either an email or phone number and a type")}catch(n){if(K(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await er(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<wl:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const i=await er(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=Sl()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=qb(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Mn}):await this._useSession(async n=>{var r,s,o;const{data:i,error:a}=n;if(a)throw a;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _t}:await re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Mn})})}catch(n){if(K(n))return bb(n)&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:o}=r;if(o)throw o;if(!s.session)throw new _t;const i=s.session;let a=null,c=null;this.flowType==="pkce"&&e.email!=null&&([a,c]=await Ar(this.storage,this.storageKey));const{data:d,error:h}=await re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:c}),jwt:i.access_token,xform:Mn});if(h)throw h;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(r){if(await Je(this.storage,`${this.storageKey}-code-verifier`),K(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new _t;const n=Date.now()/1e3;let r=n,s=!0,o=null;const{payload:i}=bl(e.access_token);if(i.exp&&(r=i.exp,s=r<=n),s){const{data:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:c}=await this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(n){if(K(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:i,error:a}=n;if(a)throw a;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new _t;const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(K(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Ye())throw new ni("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ni(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Vf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ni("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Vf("No code detected.");const{data:w,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:a,expires_at:c,token_type:d}=e;if(!o||!a||!i||!d)throw new ni("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(a);let m=h+p;c&&(m=parseInt(c));const g=m-h;g*1e3<=Ur&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${p}s`);const y=m-p;h-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,m,h):h-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,m,h);const{data:_,error:b}=await this._getUser(o);if(b)throw b;const x={provider_token:r,provider_refresh_token:s,access_token:o,expires_in:p,expires_at:m,refresh_token:i,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:e.type},error:null})}catch(r){if(K(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await er(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return this._returnResult({error:o});const i=(r=s.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(_b(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await Je(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=Rb(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:o},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Ar(this.storage,this.storageKey,!0));try{return await re(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(await Je(this.storage,`${this.storageKey}-code-verifier`),K(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:s}=await this._useSession(async o=>{var i,a,c,d,h;const{data:p,error:m}=o;if(m)throw m;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await re(this.fetch,"GET",g,{headers:this.headers,jwt:(h=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return Ye()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(K(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:s,data:{session:o}}=n;if(s)throw s;const{options:i,provider:a,token:c,access_token:d,nonce:h}=e,p=await re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=o==null?void 0:o.access_token)!==null&&r!==void 0?r:void 0,body:{provider:a,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Vt}),{data:m,error:g}=p;return g?this._returnResult({data:{user:null,session:null},error:g}):!m||!m.session||!m.user?this._returnResult({data:{user:null,session:null},error:new Ir}):(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("USER_UPDATED",m.session)),this._returnResult({data:m,error:g}))}catch(s){if(await Je(this.storage,`${this.storageKey}-code-verifier`),K(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)throw i;return await re(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Lb(async s=>(s>0&&await Db(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Vt})),(s,o)=>{const i=200*Math.pow(2,s);return o&&_l(o)&&Date.now()+i-r<Ur})}catch(r){if(this._debug(n,"error",r),K(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Ye()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await er(this.storage,this.storageKey);if(s&&this.userStorage){let i=await er(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await jr(this.userStorage,this.storageKey+"-user",i)),s.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:Sl()}else if(s&&!s.user&&!s.user){const i=await er(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await Je(this.storage,this.storageKey+"-user"),await jr(this.storage,this.storageKey,s)):s.user=Sl()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const o=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<wl;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${wl}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),_l(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:a}=await this._getUser(s.access_token);!a&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new _t;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Na;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new _t;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={data:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(s,"error",o),K(o)){const i={data:null,error:o};return _l(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Je(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await jr(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const o=Kf(s);await jr(this.storage,this.storageKey,o)}else{const s=Kf(n);await jr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Je(this.storage,this.storageKey),await Je(this.storage,this.storageKey+"-code-verifier"),await Je(this.storage,this.storageKey+"-user"),this.userStorage&&await Je(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ye()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ur);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Ur);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Ur}ms, refresh threshold is ${Rc} ticks`),s<=Rc&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof I0)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ye()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,i]=await Ar(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);s.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?this._returnResult({data:null,error:o}):await re(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await re(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return this._returnResult({data:null,error:o});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?dS(e.webauthn.credential_response):fS(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:c}=await re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:c}))})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return this._returnResult({data:null,error:o});const i=await re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(i.error)return i;const{data:a}=i;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:cS(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:uS(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])s.all.push(o),o.status==="verified"&&s[o.factor_type].push(o);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=bl(r.access_token);let i=null;o.aal&&(i=o.aal);let a=i;((n=(e=r.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(a="aal2");const d=o.amr||[];return{data:{currentLevel:i,nextLevel:a,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?await re(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new _t})})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:o}=r;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new _t});const i=await re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return i.data&&i.data.redirect_url&&Ye()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(K(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:o}=r;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new _t});const i=await re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return i.data&&i.data.redirect_url&&Ye()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(K(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;return r?this._returnResult({data:null,error:r}):n?await re(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new _t})})}catch(e){if(K(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?(await re(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new _t})})}catch(n){if(K(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+xb>s)return r;const{data:o,error:i}=await re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,r=o.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:g,error:y}=await this.getSession();if(y||!g.session)return this._returnResult({data:null,error:y});r=g.session.access_token}const{header:s,payload:o,signature:i,raw:{header:a,payload:c}}=bl(r);n!=null&&n.allowExpired||zb(o.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:o,header:s,signature:i},error:null}}const h=Bb(s.alg),p=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,i,Ib(`${a}.${c}`)))throw new Dc("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(r){if(K(r))return this._returnResult({data:null,error:r});throw r}}}Eo.nextInstanceID={};const _S=Eo,bS="2.90.1";let zs="";typeof Deno<"u"?zs="deno":typeof document<"u"?zs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?zs="react-native":zs="node";const SS={"X-Client-Info":`supabase-js-${zs}/${bS}`},kS={headers:SS},ES={schema:"public"},CS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},TS={};function Co(t){"@babel/helpers - typeof";return Co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Co(t)}function NS(t,e){if(Co(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Co(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IS(t){var e=NS(t,"string");return Co(e)=="symbol"?e:e+""}function AS(t,e,n){return(e=IS(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nh(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nh(Object(n),!0).forEach(function(r){AS(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nh(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const RS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),PS=()=>Headers,MS=(t,e,n)=>{const r=RS(n),s=PS();return async(o,i)=>{var a;const c=(a=await e())!==null&&a!==void 0?a:t;let d=new s(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(o,Re(Re({},i),{},{headers:d}))}};function DS(t){return t.endsWith("/")?t:t+"/"}function LS(t,e){var n,r;const{db:s,auth:o,realtime:i,global:a}=t,{db:c,auth:d,realtime:h,global:p}=e,m={db:Re(Re({},c),s),auth:Re(Re({},d),o),realtime:Re(Re({},h),i),storage:{},global:Re(Re(Re({},p),a),{},{headers:Re(Re({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?m.accessToken=t.accessToken:delete m.accessToken,m}function US(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(DS(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var jS=class extends _S{constructor(t){super(t)}},FS=class{constructor(t,e,n){var r,s;this.supabaseUrl=t,this.supabaseKey=e;const o=US(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const i=`sb-${o.hostname.split(".")[0]}-auth-token`,a={db:ES,realtime:TS,auth:Re(Re({},CS),{},{storageKey:i}),global:kS},c=LS(n??{},a);if(this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=c.auth)!==null&&d!==void 0?d:{},this.headers,c.global.fetch)}this.fetch=MS(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Re({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new y_(new URL("rest/v1",o).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new pb(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new f_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:r}=await t.auth.getSession();return(e=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,storageKey:o,flowType:i,lock:a,debug:c,throwOnError:d},h,p){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jS({url:this.authUrl.href,headers:Re(Re({},m),h),storageKey:o,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,flowType:i,lock:a,debug:c,throwOnError:d,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new D_(this.realtimeUrl.href,Re(Re({},t),{},{params:Re(Re({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const OS=(t,e,n)=>new FS(t,e,n);function $S(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const n=e.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}$S()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const sd="https://vsqytdzbxxhketbvcoif.supabase.co",P0=`sb_publishable_m-b7gwiZtZu4k0eaXHPoTg_mM_qFuvG
`;console.log("Supabase URL Detected:","Yes",`(Length: ${sd.length})`);console.log("Supabase Key Detected:","Yes",`(Length: ${P0.length})`);const ws=sd.startsWith("http"),M0="snapcal_mode_preference",Lc=()=>ws?localStorage.getItem(M0)==="local"?"local":"cloud":"local",GS=t=>{localStorage.setItem(M0,t),window.location.reload()},le=ws&&Lc()==="cloud";ws?le||console.log("Supabase configured but user prefers Local Storage."):console.log("Supabase is not configured. Using Mock Auth & Local Storage.");const ue=OS(ws?sd:"https://placeholder.supabase.co",ws?P0:"placeholder"),Ia="snapcal_mock_session",ta="snapcal_auth_change",zS=t=>new Promise(e=>setTimeout(e,t)),D0=async(t,e)=>{var n,r;if(le){const{data:s,error:o}=await ue.auth.signInWithPassword({email:t,password:e});if(o)throw new Error(o.message);return{user:{id:((n=s.user)==null?void 0:n.id)||"",email:(r=s.user)==null?void 0:r.email}}}else{await zS(600);const s={id:btoa(t.toLowerCase()),email:t};return localStorage.setItem(Ia,JSON.stringify(s)),window.dispatchEvent(new Event(ta)),{user:s}}},BS=async(t,e)=>{var n,r;if(le){const{data:s,error:o}=await ue.auth.signUp({email:t,password:e});if(o)throw new Error(o.message);return{user:{id:((n=s.user)==null?void 0:n.id)||"",email:(r=s.user)==null?void 0:r.email}}}else return D0(t,e)},VS=async()=>{if(le){const{error:t}=await ue.auth.signOut();if(t)throw t}else localStorage.removeItem(Ia),window.dispatchEvent(new Event(ta))},he=async()=>{if(le){const{data:t}=await ue.auth.getUser();return t.user?{id:t.user.id,email:t.user.email}:null}else{const t=localStorage.getItem(Ia);return t?JSON.parse(t):null}},qS=t=>{if(le){const{data:e}=ue.auth.onAuthStateChange((n,r)=>{r!=null&&r.user?t({id:r.user.id,email:r.user.email}):t(null)});return()=>e.subscription.unsubscribe()}else{const e=()=>{const n=localStorage.getItem(Ia);t(n?JSON.parse(n):null)};return window.addEventListener(ta,e),window.addEventListener("storage",e),()=>{window.removeEventListener(ta,e),window.removeEventListener("storage",e)}}};class HS{constructor(){Ba(this,"cache",new Map);Ba(this,"defaultTTL",5*60*1e3)}get(e){const n=this.cache.get(e);return n?Date.now()-n.timestamp>n.ttl?(this.cache.delete(e),null):n.data:null}set(e,n,r){this.cache.set(e,{data:n,timestamp:Date.now(),ttl:r||this.defaultTTL})}has(e){return this.get(e)!==null}invalidate(e){this.cache.delete(e)}invalidatePattern(e){const n=[];this.cache.forEach((r,s)=>{e.test(s)&&n.push(s)}),n.forEach(r=>this.cache.delete(r))}clear(){this.cache.clear()}clearDateSensitiveCaches(){console.log(" Clearing date-sensitive caches..."),this.invalidatePattern(/^food:/),console.log(" Date-sensitive caches cleared")}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const ct=new HS,$t={ENTRIES:"food:entries",ENTRIES_LITE:"food:entries:lite",DAILY_SUMMARIES:"food:summaries",DAILY_SUMMARIES_LITE:"food:summaries:lite",DAILY_GOAL:"user:goal",USER_PROFILE:"user:profile",STREAK_DATA:"user:streak",AVATAR_STATE:"user:avatar",WEIGHT_GOAL:"user:weight-goal",entriesForDate:t=>`food:entries:${t}`,entryImage:t=>`food:image:${t}`};async function kr(t,e,n){const r=ct.get(t);if(r!==null)return r;const s=await e();return ct.set(t,s,n),s}const od="snapcal_data_v1",To="snapcal_settings_v1",No="snapcal_profile_v1",id="snapcal_summaries_v1",L0="snapcal_coach_messages_v1",U0="snapcal_workout_plans_v1",WS="id, user_id, timestamp, date, time, food_item, calories, protein, carbs, fat, confidence, image_url, is_manual, ingredients, original_ai_response",j0="id, user_id, timestamp, date, time, food_item, calories, protein, carbs, fat, confidence, is_manual, ingredients",JS="id, date, calories, protein, carbs, fat",Gt=()=>{try{const t=localStorage.getItem(od);return t?JSON.parse(t):[]}catch{return[]}},Aa=t=>{try{localStorage.setItem(od,JSON.stringify(t))}catch(e){throw e.name==="QuotaExceededError"||e.name==="NS_ERROR_DOM_QUOTA_REACHED"||String(e).toLowerCase().includes("quota")?new Error("Browser Storage Full: Your local history (with photos) has reached the browser's 5MB limit. Please delete some old entries in the History tab or connect to Supabase for unlimited cloud storage."):e}},F0=()=>{try{const t=localStorage.getItem(id);return t?JSON.parse(t):[]}catch{return[]}},KS=t=>{try{localStorage.setItem(id,JSON.stringify(t))}catch{throw new Error("Browser Storage Full: Cannot even save simple summaries. Please clear your browser data.")}},Ra=t=>({id:t.id,user_id:t.user_id,timestamp:t.timestamp,date:t.date,time:t.time,food_item:t.food_item,calories:t.calories,protein:t.protein||0,carbs:t.carbs||0,fat:t.fat||0,confidence:t.confidence,imageUrl:t.image_url,isManual:t.is_manual,ingredients:t.ingredients||[],originalAiResponse:t.original_ai_response}),Lo=(t,e)=>{console.error(`Supabase ${e} Error:`,t);const n=(t==null?void 0:t.message)||String(t)||"",r=n.toLowerCase();throw r.includes("quota")||r.includes("limit")||r.includes("tier")?new Error("Cloud Quota Reached: Your Supabase storage limit has been exceeded. Try deleting old entries."):r.includes("relation")||r.includes("column")||r.includes("does not exist")?new Error("Database Setup Required: It looks like the 'food_entries' table is missing in Supabase. Please check the Profile tab for the setup SQL script."):r.includes("policy")||r.includes("permission")||r.includes("row-level security")?new Error("Permission Denied: Supabase RLS policies are blocking this save. Ensure authenticated users have 'INSERT' and 'UPDATE' access."):new Error(`Cloud Save Failed: ${n}`)},O0=async t=>{const e=await he();if(!e)throw new Error("User must be logged in to save.");if(!le){const r=Gt(),s=r.findIndex(i=>i.id===t.id),o={...t,user_id:e.id};s>=0?r[s]=o:r.push(o),Aa(r),ct.invalidatePattern(/^food:/);return}const{error:n}=await ue.from("food_entries").upsert({id:t.id,user_id:e.id,timestamp:t.timestamp,date:t.date,time:t.time,food_item:t.food_item,calories:t.calories,protein:t.protein,carbs:t.carbs,fat:t.fat,confidence:t.confidence,is_manual:t.isManual,image_url:t.imageUrl===void 0?null:t.imageUrl,ingredients:t.ingredients,original_ai_response:t.originalAiResponse});n&&Lo(n,"Save Entry"),ct.invalidatePattern(/^food:/)},ad=async()=>kr($t.ENTRIES,async()=>{const t=await he();if(!t)return[];if(!le)return Gt().filter(r=>r.user_id===t.id).sort((r,s)=>s.timestamp.localeCompare(r.timestamp));const{data:e,error:n}=await ue.from("food_entries").select(WS).eq("user_id",t.id).order("timestamp",{ascending:!1}).limit(200);return n?(console.error("Supabase Fetch Error:",n),n.message.includes("relation")?[]:[]):e?e.map(Ra):[]},3*60*1e3),YS=async()=>kr($t.ENTRIES_LITE,async()=>{const t=await he();if(!t)return[];if(!le)return Gt().filter(r=>r.user_id===t.id).map(r=>({...r,imageUrl:void 0,originalAiResponse:void 0})).sort((r,s)=>s.timestamp.localeCompare(r.timestamp));const{data:e,error:n}=await ue.from("food_entries").select(j0).eq("user_id",t.id).order("timestamp",{ascending:!1}).limit(200);return n?(console.error("Supabase Fetch Lite Error:",n),[]):e?e.map(Ra):[]},3*60*1e3),$0=async()=>kr($t.DAILY_SUMMARIES_LITE,async()=>{const t=await he();if(!t)return[];if(!le){const s=Gt().filter(c=>c.user_id===t.id),o={};s.forEach(c=>{o[c.date]||(o[c.date]=[]),o[c.date].push(c)});const i=F0().filter(c=>c.user_id===t.id),a={};return i.forEach(c=>{a[c.date]={date:c.date,totalCalories:c.total_calories||c.totalCalories,totalProtein:c.total_protein||c.totalProtein||0,totalCarbs:c.total_carbs||c.totalCarbs||0,totalFat:c.total_fat||c.totalFat||0}}),Object.keys(o).forEach(c=>{const d=o[c];a[c]={date:c,totalCalories:d.reduce((h,p)=>h+p.calories,0),totalProtein:d.reduce((h,p)=>h+(p.protein||0),0),totalCarbs:d.reduce((h,p)=>h+(p.carbs||0),0),totalFat:d.reduce((h,p)=>h+(p.fat||0),0)}}),Object.values(a).sort((c,d)=>new Date(d.date).getTime()-new Date(c.date).getTime())}const{data:e,error:n}=await ue.from("food_entries").select("date, calories, protein, carbs, fat").eq("user_id",t.id).order("date",{ascending:!1});if(n)return console.error("Supabase summary fetch error:",n),[];const r={};(e||[]).forEach(s=>{r[s.date]||(r[s.date]={calories:0,protein:0,carbs:0,fat:0}),r[s.date].calories+=s.calories||0,r[s.date].protein+=s.protein||0,r[s.date].carbs+=s.carbs||0,r[s.date].fat+=s.fat||0});try{const{data:s}=await ue.from("daily_summaries").select("date, total_calories, total_protein, total_carbs, total_fat").eq("user_id",t.id);(s||[]).forEach(o=>{r[o.date]||(r[o.date]={calories:o.total_calories,protein:o.total_protein,carbs:o.total_carbs,fat:o.total_fat})})}catch{}return Object.entries(r).map(([s,o])=>({date:s,totalCalories:o.calories,totalProtein:o.protein,totalCarbs:o.carbs,totalFat:o.fat})).sort((s,o)=>new Date(o.date).getTime()-new Date(s.date).getTime())},3*60*1e3),QS=async t=>kr($t.entriesForDate(t),async()=>{const e=await he();if(!e)return[];if(!le)return Gt().filter(s=>s.user_id===e.id&&s.date===t).map(s=>({...s,imageUrl:void 0,originalAiResponse:void 0})).sort((s,o)=>o.timestamp.localeCompare(s.timestamp));const{data:n,error:r}=await ue.from("food_entries").select(j0).eq("user_id",e.id).eq("date",t).order("timestamp",{ascending:!1});return r?(console.error("Supabase date fetch error:",r),[]):n?n.map(Ra):[]},5*60*1e3),XS=async t=>kr($t.entryImage(t),async()=>{const e=await he();if(!e)return null;if(!le){const o=Gt().find(i=>i.id===t&&i.user_id===e.id);return(o==null?void 0:o.imageUrl)||null}const{data:n,error:r}=await ue.from("food_entries").select("image_url").eq("id",t).eq("user_id",e.id).single();return r||!n?null:n.image_url},30*60*1e3),rh=async()=>{const t=await he();if(!t)return;const e=new Date;e.setDate(e.getDate()-30);const n=e.toISOString().split("T")[0];let r=[];if(!le)r=Gt().filter(o=>o.user_id===t.id&&o.date<n);else try{const{data:o}=await ue.from("food_entries").select(JS).eq("user_id",t.id).lt("date",n);o&&(r=o.map(Ra))}catch{return}if(r.length===0)return;const s={};r.forEach(o=>{s[o.date]||(s[o.date]=[]),s[o.date].push(o)});for(const o of Object.keys(s)){const i=s[o],a={id:`${t.id}_${o}`,user_id:t.id,date:o,total_calories:i.reduce((c,d)=>c+d.calories,0),total_protein:i.reduce((c,d)=>c+(d.protein||0),0),total_carbs:i.reduce((c,d)=>c+(d.carbs||0),0),total_fat:i.reduce((c,d)=>c+(d.fat||0),0)};if(le)await ue.from("daily_summaries").upsert(a),await ue.from("food_entries").delete().eq("user_id",t.id).eq("date",o);else{const c=F0(),d=c.findIndex(p=>p.user_id===t.id&&p.date===o);d>=0?c[d]=a:c.push(a),KS(c);const h=Gt().filter(p=>!(p.user_id===t.id&&p.date===o));Aa(h)}}},G0=async t=>{const e=await he();if(!e)throw new Error("Not logged in");if(!le){const r=Gt().filter(s=>!(s.id===t&&s.user_id===e.id));Aa(r),ct.invalidatePattern(/^food:/);return}const{error:n}=await ue.from("food_entries").delete().eq("id",t).eq("user_id",e.id);n&&Lo(n,"Delete Entry"),ct.invalidatePattern(/^food:/)},ZS=async t=>{const e=await he();if(!e)throw new Error("Not logged in");if(!le){const r=Gt(),s=r.findIndex(o=>o.id===t&&o.user_id===e.id);s>=0&&(r[s].imageUrl=void 0,Aa(r)),ct.invalidatePattern(/^food:/);return}const{error:n}=await ue.from("food_entries").update({image_url:null}).eq("id",t).eq("user_id",e.id);n&&Lo(n,"Clear Image"),ct.invalidatePattern(/^food:/)},ks=async()=>kr($t.DAILY_GOAL,async()=>{const t=await he();if(!t)return 2e3;if(!le){const r=localStorage.getItem(To);return(r?JSON.parse(r):{})[t.id]||2e3}const{data:e,error:n}=await ue.from("user_settings").select("daily_goal").eq("user_id",t.id).single();return n||!e?2e3:e.daily_goal},10*60*1e3),Pa=async t=>{const e=await he();if(!e)throw new Error("Not logged in");if(!le){const r=localStorage.getItem(To),s=r?JSON.parse(r):{};s[e.id]=t,localStorage.setItem(To,JSON.stringify(s)),ct.invalidate($t.DAILY_GOAL);return}const{error:n}=await ue.from("user_settings").upsert({user_id:e.id,daily_goal:t},{onConflict:"user_id"});n&&Lo(n,"Save Daily Goal"),ct.invalidate($t.DAILY_GOAL)},Yn=async()=>kr($t.USER_PROFILE,async()=>{const t=await he();if(!t)return null;if(!le){const r=localStorage.getItem(No);return(r?JSON.parse(r):{})[t.id]||null}const{data:e,error:n}=await ue.from("user_profiles").select("name, height, weight, age, gender, activity_level, goal, equipment_access, target_weight").eq("user_id",t.id).single();return n||!e?null:{name:e.name,height:e.height,weight:e.weight,age:e.age,gender:e.gender,activityLevel:e.activity_level,goal:e.goal,equipmentAccess:e.equipment_access,targetWeight:e.target_weight}},10*60*1e3),Ma=async t=>{const e=await he();if(!e)throw new Error("Not logged in");if(!le){const r=localStorage.getItem(No),s=r?JSON.parse(r):{};s[e.id]=t,localStorage.setItem(No,JSON.stringify(s)),ct.invalidate($t.USER_PROFILE);return}const{error:n}=await ue.from("user_profiles").upsert({user_id:e.id,name:t.name,height:t.height,weight:t.weight,age:t.age,gender:t.gender,activity_level:t.activityLevel,goal:t.goal,equipment_access:t.equipmentAccess,target_weight:t.targetWeight},{onConflict:"user_id"});n&&Lo(n,"Save Profile"),ct.invalidate($t.USER_PROFILE)},ek=()=>Gt().length>0,tk=async()=>{if(!le)throw new Error("Must be in Cloud Mode to sync");const t=await he();if(!t)throw new Error("Must be logged in to sync");const e=Gt();if(e.length>0){const s=e.map(i=>({id:i.id,user_id:t.id,timestamp:i.timestamp,date:i.date,time:i.time,food_item:i.food_item,calories:i.calories,protein:i.protein,carbs:i.carbs,fat:i.fat,confidence:i.confidence,is_manual:i.isManual,image_url:i.imageUrl,ingredients:i.ingredients,original_ai_response:i.originalAiResponse})),o=5;for(let i=0;i<s.length;i+=o){const a=s.slice(i,i+o),{error:c}=await ue.from("food_entries").upsert(a);if(c)throw console.error("Chunk upload failed",c),new Error(`Sync failed at item ${i+1}: `+c.message)}}const n=localStorage.getItem(To);if(n){const s=JSON.parse(n),o=Object.keys(s)[0];o&&s[o]&&await Pa(s[o])}const r=localStorage.getItem(No);if(r){const s=JSON.parse(r),o=Object.keys(s)[0];o&&s[o]&&await Ma(s[o])}localStorage.removeItem(od),localStorage.removeItem(id),localStorage.removeItem(To),localStorage.removeItem(No)},nk=async()=>{if(!le)return{ok:!0};if(!await he())return{ok:!0};const{error:e}=await ue.from("food_entries").select("id").limit(1);return e?e.message.includes("relation")||e.code==="42P01"?{ok:!1,missingTables:!0,error:"Tables missing"}:{ok:!1,error:e.message}:{ok:!0}},na="snapcal_onboarding_v1",rk=async t=>{if(!t||!t.id)return!1;const e=localStorage.getItem(na),n=e?JSON.parse(e):{};if(n[t.id]===!0)return!0;if(!le)return!1;try{const{data:r,error:s}=await ue.from("user_settings").select("has_completed_onboarding").eq("user_id",t.id).maybeSingle(),o=(r==null?void 0:r.has_completed_onboarding)||!1;return o&&(n[t.id]=!0,localStorage.setItem(na,JSON.stringify(n))),o}catch{return!1}},z0=async t=>{if(!t||!t.id)return;const e=localStorage.getItem(na),n=e?JSON.parse(e):{};if(n[t.id]=!0,localStorage.setItem(na,JSON.stringify(n)),le)try{const{error:r}=await ue.from("user_settings").upsert({user_id:t.id,has_completed_onboarding:!0},{onConflict:"user_id"});r&&console.error("Cloud mark onboarding error:",r)}catch(r){console.error("Cloud mark onboarding exception:",r)}},sk=async t=>{await z0(t)},ld=()=>{try{const t=localStorage.getItem(L0);return t?JSON.parse(t):[]}catch{return[]}},B0=t=>{try{localStorage.setItem(L0,JSON.stringify(t))}catch(e){console.error("Failed to save chat messages to local storage:",e)}},Dr=async t=>{const e=await he();if(!e){console.warn("User not logged in, cannot save chat message");return}const n=new Date(t.timestamp).toISOString().split("T")[0];if(!le){const r=ld(),s={...t,user_id:e.id,date:n};r.push(s),B0(r);return}try{const{error:r}=await ue.from("coach_messages").insert({id:t.id,user_id:e.id,role:t.role,content:t.content,timestamp:t.timestamp,date:n});r&&console.error("Failed to save chat message to Supabase:",r)}catch(r){console.error("Exception saving chat message:",r)}},V0=async t=>{const e=await he();if(!e)return[];if(!le)return ld().filter(r=>r.user_id===e.id&&r.date===t).sort((r,s)=>r.timestamp-s.timestamp);try{const{data:n,error:r}=await ue.from("coach_messages").select("id, role, content, timestamp").eq("user_id",e.id).eq("date",t).order("timestamp",{ascending:!0});return r?(console.error("Failed to fetch chat messages:",r),[]):n||[]}catch(n){return console.error("Exception fetching chat messages:",n),[]}},ok=async()=>{const t=new Date().toISOString().split("T")[0];return V0(t)},ik=async()=>{const t=await he();if(!t)return;const e=new Date;e.setDate(e.getDate()-30);const n=e.toISOString().split("T")[0];if(!le){const s=ld().filter(o=>o.user_id!==t.id||o.date>=n);B0(s);return}try{const{error:r}=await ue.from("coach_messages").delete().eq("user_id",t.id).lt("date",n);r&&console.error("Failed to cleanup old chat messages:",r)}catch(r){console.error("Exception during chat cleanup:",r)}},Da=()=>{try{const t=localStorage.getItem(U0);return t?JSON.parse(t):[]}catch{return[]}},q0=t=>{try{localStorage.setItem(U0,JSON.stringify(t))}catch(e){console.error("Failed to save workout plans to local storage:",e)}},ra=async(t,e,n,r,s)=>{const o=await he();if(!o)return console.warn("User not logged in, cannot save workout plan"),"";const i=r||`${o.id}_${t}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,a={id:i,user_id:o.id,date:t,title:e,workout_type_id:s,exercises:n},c=Da(),d=c.findIndex(h=>h.id===i);if(d>=0?c[d]=a:c.push(a),q0(c),le)try{const{error:h}=await ue.from("workout_plans").upsert({id:i,user_id:o.id,date:t,title:e,workout_type_id:s,exercises:n});h&&console.warn("Supabase save failed, using localStorage fallback:",h.message)}catch(h){console.warn("Exception saving workout plan to Supabase, using localStorage fallback:",h)}return i},sh=async t=>{const e=await he();if(!e)return[];const n=[];if(Da().filter(o=>o.user_id===e.id&&o.date===t).forEach(o=>{n.push({id:o.id,date:o.date,title:o.title,exercises:o.exercises})}),le)try{const{data:o,error:i}=await ue.from("workout_plans").select("id, date, title, exercises").eq("user_id",e.id).eq("date",t);if(!i&&o){const a=new Set(n.map(c=>c.id));o.forEach(c=>{a.has(c.id)||n.push({id:c.id,date:c.date,title:c.title,exercises:c.exercises})})}}catch(o){console.warn("Exception fetching workout plans from Supabase, using localStorage only:",o)}return n},oh=async(t,e)=>{const n=await he();if(!n)return[];const r=`${t}-${String(e).padStart(2,"0")}-01`,s=`${t}-${String(e).padStart(2,"0")}-31`,i=Da().filter(a=>a.user_id===n.id&&a.date>=r&&a.date<=s).map(a=>a.date);if(le)try{const{data:a,error:c}=await ue.from("workout_plans").select("date").eq("user_id",n.id).gte("date",r).lte("date",s);if(!c&&a){const d=a.map(h=>h.date);return Array.from(new Set([...i,...d]))}}catch(a){console.warn("Exception fetching workout plans from Supabase, using localStorage only:",a)}return i},ak=async(t,e)=>{if(!await he()){console.warn("User not logged in, cannot save multi-day workout plan");return}const r=new Date(t);for(let s=0;s<e.length;s++){const o=e[s];if(o.isRestDay)continue;const i=new Date(r);i.setDate(i.getDate()+s);const a=i.toISOString().split("T")[0];await ra(a,o.title,o.exercises)}},lk=async t=>{const e=await he();if(!e){console.warn("User not logged in, cannot delete workout plan");return}const r=Da().filter(s=>s.id!==t);if(q0(r),le)try{const{error:s}=await ue.from("workout_plans").delete().eq("id",t).eq("user_id",e.id);s&&console.warn("Failed to delete workout plan from Supabase:",s.message)}catch(s){console.warn("Exception deleting workout plan from Supabase:",s)}},ck=()=>{const t=new Date,e=new Date(t);return e.setHours(24,0,0,0),e.getTime()-t.getTime()},uk=t=>{let e;const n=()=>{const r=ck();console.log(` Scheduling midnight refresh in ${Math.round(r/1e3/60)} minutes`),e=setTimeout(()=>{console.log(" Midnight detected! Running callback..."),t(),n()},r)};return n(),()=>{e&&(clearTimeout(e),console.log(" Midnight timer canceled"))}},Qn=()=>{const t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},El="snapcal_last_active_date",dk=()=>{const t=Qn(),e=localStorage.getItem(El);if(!e)return localStorage.setItem(El,t),!1;const n=e!==t;return n&&(console.log(` Day changed detected: ${e}  ${t}`),localStorage.setItem(El,t)),n},Le=({className:t,variant:e="primary",isLoading:n,children:r,...s})=>{const o="inline-flex items-center justify-center px-6 py-4 rounded-[24px] font-semibold transition-all duration-300 active:scale-95 disabled:opacity-50 disabled:pointer-events-none text-sm tracking-wide",i={primary:"bg-royal-600 text-white hover:bg-royal-700 shadow-[0_10px_20px_-10px_rgba(124,58,237,0.5)]",secondary:"bg-royal-50 text-royal-700 hover:bg-royal-100",ghost:"bg-transparent text-gray-500 hover:text-royal-600 hover:bg-royal-50"};return l.jsx("button",{className:or(o,i[e],t),disabled:n||s.disabled,...s,children:n?l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):r})};var fk={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let hk,pk;function mk(){return{geminiUrl:hk,vertexUrl:pk}}function gk(t,e,n,r){var s,o;if(!(t!=null&&t.baseUrl)){const i=mk();return e?(s=i.vertexUrl)!==null&&s!==void 0?s:n:(o=i.geminiUrl)!==null&&o!==void 0?o:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kn{}function $(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const o=e[s];return o!=null?String(o):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function f(t,e,n){for(let o=0;o<e.length-1;o++){const i=e[o];if(i.endsWith("[]")){const a=i.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${i}`);if(Array.isArray(t[a])){const c=t[a];if(Array.isArray(n))for(let d=0;d<c.length;d++){const h=c[d];f(h,e.slice(o+1),n[d])}else for(const d of c)f(d,e.slice(o+1),n)}return}else if(i.endsWith("[0]")){const a=i.slice(0,-3);a in t||(t[a]=[{}]);const c=t[a];f(c[0],e.slice(o+1),n);return}(!t[i]||typeof t[i]!="object")&&(t[i]={}),t=t[i]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function u(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2);if(o in t){const i=t[o];return Array.isArray(i)?i.map(a=>u(a,e.slice(r+1),n)):n}else return n}else t=t[s]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function yk(t,e){for(const[n,r]of Object.entries(e)){const s=n.split("."),o=r.split("."),i=new Set;let a=-1;for(let c=0;c<s.length;c++)if(s[c]==="*"){a=c;break}if(a!==-1&&o.length>a)for(let c=a;c<o.length;c++){const d=o[c];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&i.add(d)}Uc(t,s,o,0,i)}}function Uc(t,e,n,r,s){if(r>=e.length||typeof t!="object"||t===null)return;const o=e[r];if(o.endsWith("[]")){const i=o.slice(0,-2),a=t;if(i in a&&Array.isArray(a[i]))for(const c of a[i])Uc(c,e,n,r+1,s)}else if(o==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const i=t,a=Object.keys(i).filter(d=>!d.startsWith("_")&&!s.has(d)),c={};for(const d of a)c[d]=i[d];for(const[d,h]of Object.entries(c)){const p=[];for(const m of n.slice(r))m==="*"?p.push(d):p.push(m);f(i,p,h)}for(const d of a)delete i[d]}}else{const i=t;o in i&&Uc(i[o],e,n,r+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cd(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vk(t){const e={},n=u(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=u(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function xk(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["response","generateVideoResponse"]);return i!=null&&f(e,["response"],_k(i)),e}function wk(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["response"]);return i!=null&&f(e,["response"],bk(i)),e}function _k(t){const e={},n=u(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Sk(i))),f(e,["generatedVideos"],o)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=u(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function bk(t){const e={},n=u(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>kk(i))),f(e,["generatedVideos"],o)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=u(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function Sk(t){const e={},n=u(t,["video"]);return n!=null&&f(e,["video"],Ak(n)),e}function kk(t){const e={},n=u(t,["_self"]);return n!=null&&f(e,["video"],Rk(n)),e}function Ek(t){const e={},n=u(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function Ck(t){const e={},n=u(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function Tk(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["response"]);return i!=null&&f(e,["response"],Nk(i)),e}function Nk(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["parent"]);r!=null&&f(e,["parent"],r);const s=u(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function H0(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["response"]);return i!=null&&f(e,["response"],Ik(i)),e}function Ik(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["parent"]);r!=null&&f(e,["parent"],r);const s=u(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function Ak(t){const e={},n=u(t,["uri"]);n!=null&&f(e,["uri"],n);const r=u(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],cd(r));const s=u(t,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function Rk(t){const e={},n=u(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=u(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],cd(r));const s=u(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ih;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ih||(ih={}));var ah;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(ah||(ah={}));var lh;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(lh||(lh={}));var oe;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(oe||(oe={}));var ch;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(ch||(ch={}));var uh;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(uh||(uh={}));var dh;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(dh||(dh={}));var fh;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(fh||(fh={}));var hh;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(hh||(hh={}));var ph;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ph||(ph={}));var mh;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(mh||(mh={}));var gh;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(gh||(gh={}));var yh;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(yh||(yh={}));var vh;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(vh||(vh={}));var xh;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(xh||(xh={}));var wh;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(wh||(wh={}));var _h;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(_h||(_h={}));var bh;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(bh||(bh={}));var Sh;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Sh||(Sh={}));var kh;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(kh||(kh={}));var Eh;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Eh||(Eh={}));var sa;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(sa||(sa={}));var Ch;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Ch||(Ch={}));var Th;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Th||(Th={}));var Nh;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Nh||(Nh={}));var jc;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(jc||(jc={}));var Ih;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Ih||(Ih={}));var Ah;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(Ah||(Ah={}));var Rh;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Rh||(Rh={}));var Ph;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Ph||(Ph={}));var Mh;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Mh||(Mh={}));var Dh;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Dh||(Dh={}));var Lh;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Lh||(Lh={}));var Uh;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Uh||(Uh={}));var jh;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(jh||(jh={}));var Fh;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Fh||(Fh={}));var Oh;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Oh||(Oh={}));var $h;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})($h||($h={}));var Gh;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Gh||(Gh={}));var zh;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(zh||(zh={}));var Bh;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Bh||(Bh={}));var Vh;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Vh||(Vh={}));var qh;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(qh||(qh={}));var Hh;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Hh||(Hh={}));var Wh;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(Wh||(Wh={}));var Jh;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Jh||(Jh={}));var Kh;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Kh||(Kh={}));var Yh;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Yh||(Yh={}));var Qh;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Qh||(Qh={}));var Xh;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Xh||(Xh={}));var Zh;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Zh||(Zh={}));var ep;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ep||(ep={}));var tp;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(tp||(tp={}));var np;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(np||(np={}));var Xr;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Xr||(Xr={}));class Fc{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Us{get text(){var e,n,r,s,o,i,a,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const m of(c=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[g,y]of Object.entries(m))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(y!==null||y!==void 0)&&p.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;h=!0,d+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,n,r,s,o,i,a,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(c=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(p))m!=="inlineData"&&(g!==null||g!==void 0)&&h.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,r,s,o,i,a,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,n,r,s,o,i,a,c,d;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,r,s,o,i,a,c,d;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class rp{}class sp{}class Pk{}class Mk{}class Dk{}class Lk{}class op{}class ip{}class ap{}class Uk{}class oa{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new oa;let s;const o=e;return n?s=wk(o):s=xk(o),Object.assign(r,s),r}}class lp{}class cp{}class up{}class dp{}class jk{}class Fk{}class Ok{}class ud{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new ud,o=Tk(e);return Object.assign(r,o),r}}class $k{}class Gk{}class zk{}class fp{}class Bk{get text(){var e,n,r;let s="",o=!1;const i=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(a))c!=="text"&&c!=="thought"&&d!==null&&i.push(c);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;o=!0,s+=a.text}}return i.length>0&&console.warn(`there are non-text parts ${i} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?s:void 0}get data(){var e,n,r;let s="";const o=[];for(const i of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,c]of Object.entries(i))a!=="inlineData"&&c!==null&&o.push(a);i.inlineData&&typeof i.inlineData.data=="string"&&(s+=atob(i.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class Vk{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class dd{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new dd,o=H0(e);return Object.assign(r,o),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function me(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function W0(t,e){const n=me(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function J0(t){return Array.isArray(t)?t.map(e=>ia(e)):[ia(t)]}function ia(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function K0(t){const e=ia(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Y0(t){const e=ia(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function hp(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Q0(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>hp(e)):[hp(t)]}function Oc(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function pp(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function mp(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function st(t){if(t==null)throw new Error("ContentUnion is required");return Oc(t)?t:{role:"user",parts:Q0(t)}}function fd(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=st(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=st(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>st(n)):[st(e)]}function jt(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(pp(t)||mp(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[st(t)]}const e=[],n=[],r=Oc(t[0]);for(const s of t){const o=Oc(s);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(s);else{if(pp(s)||mp(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return r||e.push({role:"user",parts:Q0(n)}),e}function qk(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(oe).includes(n[0].toUpperCase())?n[0].toUpperCase():oe.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(oe).includes(r.toUpperCase())?r.toUpperCase():oe.TYPE_UNSPECIFIED})}}function ls(t){const e={},n=["items"],r=["anyOf"],s=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&qk(t.type,e);for(const[i,a]of Object.entries(t))if(a!=null)if(i=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(oe).includes(a.toUpperCase())?a.toUpperCase():oe.TYPE_UNSPECIFIED}else if(n.includes(i))e[i]=ls(a);else if(r.includes(i)){const c=[];for(const d of a){if(d.type=="null"){e.nullable=!0;continue}c.push(ls(d))}e[i]=c}else if(s.includes(i)){const c={};for(const[d,h]of Object.entries(a))c[d]=ls(h);e[i]=c}else{if(i==="additionalProperties")continue;e[i]=a}return e}function hd(t){return ls(t)}function pd(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function md(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Es(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ls(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ls(e.response));return t}function Cs(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Hk(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function En(t,e){if(typeof e!="string")throw new Error("name must be a string");return Hk(t,e,"cachedContents")}function X0(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Xn(t){return cd(t)}function Wk(t){return t!=null&&typeof t=="object"&&"name"in t}function Jk(t){return t!=null&&typeof t=="object"&&"video"in t}function Kk(t){return t!=null&&typeof t=="object"&&"uri"in t}function Z0(t){var e;let n;if(Wk(t)&&(n=t.name),!(Kk(t)&&(n=t.uri,n===void 0))&&!(Jk(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const s=n.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${n}`);n=s[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function ey(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function ty(t){for(const e of["models","tunedModels","publisherModels"])if(Yk(t,e))return t[e];return[]}function Yk(t,e){return t!==null&&typeof t=="object"&&e in t}function Qk(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function Xk(t,e={}){const n=[],r=new Set;for(const s of t){const o=s.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const i=Qk(s,e);i.functionDeclarations&&n.push(...i.functionDeclarations)}return{functionDeclarations:n}}function ny(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,s=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(s>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Zk(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function ry(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const s=n.inlinedResponses;if(!Array.isArray(s)||s.length===0)return t;let o=!1;for(const i of s){if(typeof i!="object"||i===null)continue;const c=i.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function Ts(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function sy(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eE(t){const e={},n=u(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=u(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>DE(i))),f(e,["inlinedResponses"],o)}const s=u(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["inlinedEmbedContentResponses"],o)}return e}function tE(t){const e={},n=u(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=u(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const s=u(t,["bigqueryDestination","outputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function nE(t){const e={},n=u(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=u(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const s=u(t,["bigqueryUri"]);if(s!=null&&f(e,["bigqueryDestination","outputUri"],s),u(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(u(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Si(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const s=u(t,["metadata","state"]);s!=null&&f(e,["state"],sy(s));const o=u(t,["metadata","createTime"]);o!=null&&f(e,["createTime"],o);const i=u(t,["metadata","endTime"]);i!=null&&f(e,["endTime"],i);const a=u(t,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const c=u(t,["metadata","model"]);c!=null&&f(e,["model"],c);const d=u(t,["metadata","output"]);return d!=null&&f(e,["dest"],eE(ry(d))),e}function $c(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=u(t,["state"]);s!=null&&f(e,["state"],sy(s));const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["createTime"]);i!=null&&f(e,["createTime"],i);const a=u(t,["startTime"]);a!=null&&f(e,["startTime"],a);const c=u(t,["endTime"]);c!=null&&f(e,["endTime"],c);const d=u(t,["updateTime"]);d!=null&&f(e,["updateTime"],d);const h=u(t,["model"]);h!=null&&f(e,["model"],h);const p=u(t,["inputConfig"]);p!=null&&f(e,["src"],rE(p));const m=u(t,["outputConfig"]);m!=null&&f(e,["dest"],tE(ry(m)));const g=u(t,["completionStats"]);return g!=null&&f(e,["completionStats"],g),e}function rE(t){const e={},n=u(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=u(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const s=u(t,["bigquerySource","inputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function sE(t,e){const n={};if(u(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(u(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=u(e,["fileName"]);r!=null&&f(n,["fileName"],r);const s=u(e,["inlinedRequests"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>ME(t,i))),f(n,["requests","requests"],o)}return n}function oE(t){const e={},n=u(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=u(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const s=u(t,["bigqueryUri"]);if(s!=null&&f(e,["bigquerySource","inputUri"],s),u(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(u(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function iE(t){const e={},n=u(t,["data"]);if(n!=null&&f(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function aE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],Ts(t,r)),n}function lE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],Ts(t,r)),n}function cE(t){const e={},n=u(t,["content"]);n!=null&&f(e,["content"],n);const r=u(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],uE(r));const s=u(t,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const o=u(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const i=u(t,["avgLogprobs"]);i!=null&&f(e,["avgLogprobs"],i);const a=u(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const c=u(t,["index"]);c!=null&&f(e,["index"],c);const d=u(t,["logprobsResult"]);d!=null&&f(e,["logprobsResult"],d);const h=u(t,["safetyRatings"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["safetyRatings"],m)}const p=u(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function uE(t){const e={},n=u(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["citations"],r)}return e}function oy(t){const e={},n=u(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>GE(o))),f(e,["parts"],s)}const r=u(t,["role"]);return r!=null&&f(e,["role"],r),e}function dE(t,e){const n={},r=u(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),u(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function fE(t,e){const n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=u(t,["dest"]);return e!==void 0&&s!=null&&f(e,["outputConfig"],nE(Zk(s))),n}function gp(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["src"]);s!=null&&f(n,["batch","inputConfig"],sE(t,ny(t,s)));const o=u(e,["config"]);return o!=null&&dE(o,n),n}function hE(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["model"],me(t,r));const s=u(e,["src"]);s!=null&&f(n,["inputConfig"],oE(ny(t,s)));const o=u(e,["config"]);return o!=null&&fE(o,n),n}function pE(t,e){const n={},r=u(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function mE(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["src"]);s!=null&&f(n,["batch","inputConfig"],bE(t,s));const o=u(e,["config"]);return o!=null&&pE(o,n),n}function gE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],Ts(t,r)),n}function yE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],Ts(t,r)),n}function vE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["name"]);r!=null&&f(e,["name"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);return o!=null&&f(e,["error"],o),e}function xE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["name"]);r!=null&&f(e,["name"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);return o!=null&&f(e,["error"],o),e}function wE(t,e){const n={},r=u(e,["contents"]);if(r!=null){let o=fd(t,r);Array.isArray(o)&&(o=o.map(i=>i)),f(n,["requests[]","request","content"],o)}const s=u(e,["config"]);return s!=null&&(f(n,["_self"],_E(s,n)),yk(n,{"requests[].*":"requests[].request.*"})),n}function _E(t,e){const n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const s=u(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const o=u(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),u(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function bE(t,e){const n={},r=u(e,["fileName"]);r!=null&&f(n,["file_name"],r);const s=u(e,["inlinedRequests"]);return s!=null&&f(n,["requests"],wE(t,s)),n}function SE(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function kE(t){const e={},n=u(t,["id"]);n!=null&&f(e,["id"],n);const r=u(t,["args"]);r!=null&&f(e,["args"],r);const s=u(t,["name"]);if(s!=null&&f(e,["name"],s),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function EE(t){const e={},n=u(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=u(t,["mode"]);if(r!=null&&f(e,["mode"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function CE(t,e,n){const r={},s=u(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],oy(st(s)));const o=u(e,["temperature"]);o!=null&&f(r,["temperature"],o);const i=u(e,["topP"]);i!=null&&f(r,["topP"],i);const a=u(e,["topK"]);a!=null&&f(r,["topK"],a);const c=u(e,["candidateCount"]);c!=null&&f(r,["candidateCount"],c);const d=u(e,["maxOutputTokens"]);d!=null&&f(r,["maxOutputTokens"],d);const h=u(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const p=u(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=u(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=u(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const y=u(e,["frequencyPenalty"]);y!=null&&f(r,["frequencyPenalty"],y);const _=u(e,["seed"]);_!=null&&f(r,["seed"],_);const b=u(e,["responseMimeType"]);b!=null&&f(r,["responseMimeType"],b);const x=u(e,["responseSchema"]);x!=null&&f(r,["responseSchema"],hd(x));const w=u(e,["responseJsonSchema"]);if(w!=null&&f(r,["responseJsonSchema"],w),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=u(e,["safetySettings"]);if(n!==void 0&&v!=null){let Q=v;Array.isArray(Q)&&(Q=Q.map(N=>zE(N))),f(n,["safetySettings"],Q)}const S=u(e,["tools"]);if(n!==void 0&&S!=null){let Q=Cs(S);Array.isArray(Q)&&(Q=Q.map(N=>VE(Es(N)))),f(n,["tools"],Q)}const T=u(e,["toolConfig"]);if(n!==void 0&&T!=null&&f(n,["toolConfig"],BE(T)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const E=u(e,["cachedContent"]);n!==void 0&&E!=null&&f(n,["cachedContent"],En(t,E));const C=u(e,["responseModalities"]);C!=null&&f(r,["responseModalities"],C);const P=u(e,["mediaResolution"]);P!=null&&f(r,["mediaResolution"],P);const R=u(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],pd(R)),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=u(e,["thinkingConfig"]);I!=null&&f(r,["thinkingConfig"],I);const V=u(e,["imageConfig"]);V!=null&&f(r,["imageConfig"],PE(V));const Y=u(e,["enableEnhancedCivicAnswers"]);return Y!=null&&f(r,["enableEnhancedCivicAnswers"],Y),r}function TE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>cE(d))),f(e,["candidates"],c)}const s=u(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const o=u(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const i=u(t,["responseId"]);i!=null&&f(e,["responseId"],i);const a=u(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function NE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],Ts(t,r)),n}function IE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],Ts(t,r)),n}function AE(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function RE(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function PE(t){const e={},n=u(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=u(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),u(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(u(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function ME(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["request","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let a=jt(s);Array.isArray(a)&&(a=a.map(c=>oy(c))),f(n,["request","contents"],a)}const o=u(e,["metadata"]);o!=null&&f(n,["metadata"],o);const i=u(e,["config"]);return i!=null&&f(n,["request","generationConfig"],CE(t,i,u(n,["request"],{}))),n}function DE(t){const e={},n=u(t,["response"]);n!=null&&f(e,["response"],TE(n));const r=u(t,["error"]);return r!=null&&f(e,["error"],r),e}function LE(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=u(t,["pageToken"]);if(e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),u(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function UE(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=u(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=u(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),n}function jE(t){const e={},n=u(t,["config"]);return n!=null&&LE(n,e),e}function FE(t){const e={},n=u(t,["config"]);return n!=null&&UE(n,e),e}function OE(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["operations"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>Si(i))),f(e,["batchJobs"],o)}return e}function $E(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["batchPredictionJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>$c(i))),f(e,["batchJobs"],o)}return e}function GE(t){const e={},n=u(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=u(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=u(t,["fileData"]);o!=null&&f(e,["fileData"],SE(o));const i=u(t,["functionCall"]);i!=null&&f(e,["functionCall"],kE(i));const a=u(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const c=u(t,["inlineData"]);c!=null&&f(e,["inlineData"],iE(c));const d=u(t,["text"]);d!=null&&f(e,["text"],d);const h=u(t,["thought"]);h!=null&&f(e,["thought"],h);const p=u(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=u(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function zE(t){const e={},n=u(t,["category"]);if(n!=null&&f(e,["category"],n),u(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=u(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function BE(t){const e={},n=u(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=u(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],EE(r)),e}function VE(t){const e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=u(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=u(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=u(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=u(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],AE(i));const a=u(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],RE(a));const c=u(t,["googleSearchRetrieval"]);c!=null&&f(e,["googleSearchRetrieval"],c);const d=u(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var _n;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(_n||(_n={}));class Er{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let i={config:{}};!r||Object.keys(r).length===0?i={config:{}}:typeof r=="object"?i=Object.assign({},r):i=r,i.config&&(i.config.pageToken=n.nextPageToken),this.paramsInternal=i,this.pageInternalSize=(o=(s=i.config)===null||s===void 0?void 0:s.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qE extends kn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Er(_n.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=gp(this.apiClient,e),r=n._url,s=$("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,c=a.requests,d=[];for(const h of c){const p=Object.assign({},h);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const g=p.request;g.systemInstruction=m,p.request=g}d.push(p)}return a.requests=d,delete n.config,delete n._url,delete n._query,{path:s,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},s=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${s}`),r.dest===void 0){const o=this.getGcsUri(e),i=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${s}`;else if(i)r.dest=`${i}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=hE(this.apiClient,e);return a=$("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>$c(h))}else{const d=gp(this.apiClient,e);return a=$("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>Si(h))}}async createEmbeddingsInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=mE(this.apiClient,e);return o=$("{model}:asyncBatchEmbedContent",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Si(c))}}async get(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=IE(this.apiClient,e);return a=$("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>$c(h))}else{const d=NE(this.apiClient,e);return a=$("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>Si(h))}}async cancel(e){var n,r,s,o;let i="",a={};if(this.apiClient.isVertexAI()){const c=lE(this.apiClient,e);i=$("batchPredictionJobs/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const c=aE(this.apiClient,e);i=$("batches/{name}:cancel",c._url),a=c._query,delete c._url,delete c._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=FE(e);return a=$("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=$E(h),m=new fp;return Object.assign(m,p),m})}else{const d=jE(e);return a=$("batches",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=OE(h),m=new fp;return Object.assign(m,p),m})}}async delete(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=yE(this.apiClient,e);return a=$("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>xE(h))}else{const d=gE(this.apiClient,e);return a=$("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>vE(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HE(t){const e={},n=u(t,["data"]);if(n!=null&&f(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function yp(t){const e={},n=u(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>m1(o))),f(e,["parts"],s)}const r=u(t,["role"]);return r!=null&&f(e,["role"],r),e}function WE(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=u(t,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const o=u(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const i=u(t,["contents"]);if(e!==void 0&&i!=null){let h=jt(i);Array.isArray(h)&&(h=h.map(p=>yp(p))),f(e,["contents"],h)}const a=u(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],yp(st(a)));const c=u(t,["tools"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(p=>y1(p))),f(e,["tools"],h)}const d=u(t,["toolConfig"]);if(e!==void 0&&d!=null&&f(e,["toolConfig"],g1(d)),u(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function JE(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=u(t,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const o=u(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const i=u(t,["contents"]);if(e!==void 0&&i!=null){let p=jt(i);Array.isArray(p)&&(p=p.map(m=>m)),f(e,["contents"],p)}const a=u(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],st(a));const c=u(t,["tools"]);if(e!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>v1(m))),f(e,["tools"],p)}const d=u(t,["toolConfig"]);e!==void 0&&d!=null&&f(e,["toolConfig"],d);const h=u(t,["kmsKeyName"]);return e!==void 0&&h!=null&&f(e,["encryption_spec","kmsKeyName"],h),n}function KE(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["model"],W0(t,r));const s=u(e,["config"]);return s!=null&&WE(s,n),n}function YE(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["model"],W0(t,r));const s=u(e,["config"]);return s!=null&&JE(s,n),n}function QE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],En(t,r)),n}function XE(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],En(t,r)),n}function ZE(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function e1(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function t1(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function n1(t){const e={},n=u(t,["id"]);n!=null&&f(e,["id"],n);const r=u(t,["args"]);r!=null&&f(e,["args"],r);const s=u(t,["name"]);if(s!=null&&f(e,["name"],s),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function r1(t){const e={},n=u(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=u(t,["mode"]);if(r!=null&&f(e,["mode"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function s1(t){const e={},n=u(t,["description"]);n!=null&&f(e,["description"],n);const r=u(t,["name"]);r!=null&&f(e,["name"],r);const s=u(t,["parameters"]);s!=null&&f(e,["parameters"],s);const o=u(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const i=u(t,["response"]);i!=null&&f(e,["response"],i);const a=u(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function o1(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],En(t,r)),n}function i1(t,e){const n={},r=u(e,["name"]);return r!=null&&f(n,["_url","name"],En(t,r)),n}function a1(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function l1(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function c1(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=u(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function u1(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=u(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function d1(t){const e={},n=u(t,["config"]);return n!=null&&c1(n,e),e}function f1(t){const e={},n=u(t,["config"]);return n!=null&&u1(n,e),e}function h1(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["cachedContents"],o)}return e}function p1(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["cachedContents"],o)}return e}function m1(t){const e={},n=u(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=u(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=u(t,["fileData"]);o!=null&&f(e,["fileData"],t1(o));const i=u(t,["functionCall"]);i!=null&&f(e,["functionCall"],n1(i));const a=u(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const c=u(t,["inlineData"]);c!=null&&f(e,["inlineData"],HE(c));const d=u(t,["text"]);d!=null&&f(e,["text"],d);const h=u(t,["thought"]);h!=null&&f(e,["thought"],h);const p=u(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=u(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function g1(t){const e={},n=u(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=u(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],r1(r)),e}function y1(t){const e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=u(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=u(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=u(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=u(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],a1(i));const a=u(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],l1(a));const c=u(t,["googleSearchRetrieval"]);c!=null&&f(e,["googleSearchRetrieval"],c);const d=u(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function v1(t){const e={},n=u(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=u(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=u(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const o=u(t,["enterpriseWebSearch"]);o!=null&&f(e,["enterpriseWebSearch"],o);const i=u(t,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>s1(m))),f(e,["functionDeclarations"],p)}const a=u(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const c=u(t,["googleSearch"]);c!=null&&f(e,["googleSearch"],c);const d=u(t,["googleSearchRetrieval"]);d!=null&&f(e,["googleSearchRetrieval"],d);const h=u(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function x1(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=u(t,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),n}function w1(t,e){const n={},r=u(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=u(t,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),n}function _1(t,e){const n={},r=u(e,["name"]);r!=null&&f(n,["_url","name"],En(t,r));const s=u(e,["config"]);return s!=null&&x1(s,n),n}function b1(t,e){const n={},r=u(e,["name"]);r!=null&&f(n,["_url","name"],En(t,r));const s=u(e,["config"]);return s!=null&&w1(s,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class S1 extends kn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Er(_n.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=YE(this.apiClient,e);return a=$("cachedContents",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>h)}else{const d=KE(this.apiClient,e);return a=$("cachedContents",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async get(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=i1(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>h)}else{const d=o1(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=XE(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=e1(h),m=new up;return Object.assign(m,p),m})}else{const d=QE(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=ZE(h),m=new up;return Object.assign(m,p),m})}}async update(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=b1(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>h)}else{const d=_1(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async listInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=f1(e);return a=$("cachedContents",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=p1(h),m=new dp;return Object.assign(m,p),m})}else{const d=d1(e);return a=$("cachedContents",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=h1(h),m=new dp;return Object.assign(m,p),m})}}}function aa(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function vp(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ae(t){return this instanceof ae?(this.v=t,this):new ae(t)}function Xt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(g){return function(y){return Promise.resolve(y).then(g,p)}}function a(g,y){r[g]&&(s[g]=function(_){return new Promise(function(b,x){o.push([g,_,b,x])>1||c(g,_)})},y&&(s[g]=y(s[g])))}function c(g,y){try{d(r[g](y))}catch(_){m(o[0][3],_)}}function d(g){g.value instanceof ae?Promise.resolve(g.value.v).then(h,p):m(o[0][2],g)}function h(g){c("next",g)}function p(g){c("throw",g)}function m(g,y){g(y),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Zt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof vp=="function"?vp(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(i){return new Promise(function(a,c){i=t[o](i),s(a,c,i.done,i.value)})}}function s(o,i,a,c){Promise.resolve(c).then(function(d){o({value:d,done:a})},i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function k1(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:iy(n)}function iy(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function E1(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function xp(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const s=[];let o=!0;for(;r<n&&t[r].role==="model";)s.push(t[r]),o&&!iy(t[r])&&(o=!1),r++;o?e.push(...s):e.pop()}return e}class C1{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new T1(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class T1{constructor(e,n,r,s={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),E1(o)}async sendMessage(e){var n;await this.sendPromise;const r=st(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,i,a;const c=await s,d=(i=(o=c.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content,h=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];h!=null&&(m=(a=h.slice(p))!==null&&a!==void 0?a:[]);const g=d?[d]:[];this.recordHistory(r,g,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var n;await this.sendPromise;const r=st(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,r)}getHistory(e=!1){const n=e?xp(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Xt(this,arguments,function*(){var s,o,i,a,c,d;const h=[];try{for(var p=!0,m=Zt(e),g;g=yield ae(m.next()),s=g.done,!s;p=!0){a=g.value,p=!1;const y=a;if(k1(y)){const _=(d=(c=y.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content;_!==void 0&&h.push(_)}yield yield ae(y)}}catch(y){o={error:y}}finally{try{!p&&!s&&(i=m.return)&&(yield ae(i.call(m)))}finally{if(o)throw o.error}}this.recordHistory(n,h)})}recordHistory(e,n,r){let s=[];n.length>0&&n.every(o=>o.role!==void 0)?s=n:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...xp(r)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class La extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,La.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N1(t){const e={},n=u(t,["file"]);return n!=null&&f(e,["file"],n),e}function I1(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function A1(t){const e={},n=u(t,["name"]);return n!=null&&f(e,["_url","file"],Z0(n)),e}function R1(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function P1(t){const e={},n=u(t,["name"]);return n!=null&&f(e,["_url","file"],Z0(n)),e}function M1(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=u(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function D1(t){const e={},n=u(t,["config"]);return n!=null&&M1(n,e),e}function L1(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["files"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class U1 extends kn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Er(_n.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=D1(e);return o=$("files",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),s.then(c=>{const d=L1(c),h=new $k;return Object.assign(h,d),h})}}async createInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=N1(e);return o=$("upload/v1beta/files",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=I1(c),h=new Gk;return Object.assign(h,d),h})}}async get(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=P1(e);return o=$("files/{file}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=A1(e);return o=$("files/{file}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),s.then(c=>{const d=R1(c),h=new zk;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ki(t){const e={},n=u(t,["data"]);if(n!=null&&f(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function j1(t){const e={},n=u(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>Z1(o))),f(e,["parts"],s)}const r=u(t,["role"]);return r!=null&&f(e,["role"],r),e}function F1(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function O1(t){const e={},n=u(t,["id"]);n!=null&&f(e,["id"],n);const r=u(t,["args"]);r!=null&&f(e,["args"],r);const s=u(t,["name"]);if(s!=null&&f(e,["name"],s),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function $1(t){const e={},n=u(t,["description"]);n!=null&&f(e,["description"],n);const r=u(t,["name"]);r!=null&&f(e,["name"],r);const s=u(t,["parameters"]);s!=null&&f(e,["parameters"],s);const o=u(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const i=u(t,["response"]);i!=null&&f(e,["response"],i);const a=u(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function G1(t){const e={},n=u(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=u(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const s=u(t,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const o=u(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const i=u(t,["enableAffectiveDialog"]);i!=null&&f(e,["enableAffectiveDialog"],i);const a=u(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const c=u(t,["logprobs"]);c!=null&&f(e,["logprobs"],c);const d=u(t,["maxOutputTokens"]);d!=null&&f(e,["maxOutputTokens"],d);const h=u(t,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=u(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=u(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const g=u(t,["responseMimeType"]);g!=null&&f(e,["responseMimeType"],g);const y=u(t,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const _=u(t,["responseSchema"]);_!=null&&f(e,["responseSchema"],_);const b=u(t,["routingConfig"]);b!=null&&f(e,["routingConfig"],b);const x=u(t,["seed"]);x!=null&&f(e,["seed"],x);const w=u(t,["speechConfig"]);w!=null&&f(e,["speechConfig"],w);const v=u(t,["stopSequences"]);v!=null&&f(e,["stopSequences"],v);const S=u(t,["temperature"]);S!=null&&f(e,["temperature"],S);const T=u(t,["thinkingConfig"]);T!=null&&f(e,["thinkingConfig"],T);const E=u(t,["topK"]);E!=null&&f(e,["topK"],E);const C=u(t,["topP"]);if(C!=null&&f(e,["topP"],C),u(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function z1(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function B1(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function V1(t,e){const n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const s=u(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const o=u(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const i=u(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=u(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const c=u(t,["maxOutputTokens"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","maxOutputTokens"],c);const d=u(t,["mediaResolution"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","mediaResolution"],d);const h=u(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=u(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],md(p));const m=u(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=u(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=u(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],j1(st(y)));const _=u(t,["tools"]);if(e!==void 0&&_!=null){let E=Cs(_);Array.isArray(E)&&(E=E.map(C=>tC(Es(C)))),f(e,["setup","tools"],E)}const b=u(t,["sessionResumption"]);e!==void 0&&b!=null&&f(e,["setup","sessionResumption"],eC(b));const x=u(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const w=u(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&f(e,["setup","outputAudioTranscription"],w);const v=u(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&f(e,["setup","realtimeInputConfig"],v);const S=u(t,["contextWindowCompression"]);e!==void 0&&S!=null&&f(e,["setup","contextWindowCompression"],S);const T=u(t,["proactivity"]);if(e!==void 0&&T!=null&&f(e,["setup","proactivity"],T),u(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function q1(t,e){const n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],G1(r));const s=u(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const o=u(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const i=u(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=u(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const c=u(t,["maxOutputTokens"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","maxOutputTokens"],c);const d=u(t,["mediaResolution"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","mediaResolution"],d);const h=u(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=u(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],md(p));const m=u(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=u(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=u(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],st(y));const _=u(t,["tools"]);if(e!==void 0&&_!=null){let C=Cs(_);Array.isArray(C)&&(C=C.map(P=>nC(Es(P)))),f(e,["setup","tools"],C)}const b=u(t,["sessionResumption"]);e!==void 0&&b!=null&&f(e,["setup","sessionResumption"],b);const x=u(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const w=u(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&f(e,["setup","outputAudioTranscription"],w);const v=u(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&f(e,["setup","realtimeInputConfig"],v);const S=u(t,["contextWindowCompression"]);e!==void 0&&S!=null&&f(e,["setup","contextWindowCompression"],S);const T=u(t,["proactivity"]);e!==void 0&&T!=null&&f(e,["setup","proactivity"],T);const E=u(t,["explicitVadSignal"]);return e!==void 0&&E!=null&&f(e,["setup","explicitVadSignal"],E),n}function H1(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["setup","model"],me(t,r));const s=u(e,["config"]);return s!=null&&f(n,["config"],V1(s,n)),n}function W1(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["setup","model"],me(t,r));const s=u(e,["config"]);return s!=null&&f(n,["config"],q1(s,n)),n}function J1(t){const e={},n=u(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function K1(t){const e={},n=u(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["weightedPrompts"],r)}return e}function Y1(t){const e={},n=u(t,["media"]);if(n!=null){let d=J0(n);Array.isArray(d)&&(d=d.map(h=>ki(h))),f(e,["mediaChunks"],d)}const r=u(t,["audio"]);r!=null&&f(e,["audio"],ki(Y0(r)));const s=u(t,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const o=u(t,["video"]);o!=null&&f(e,["video"],ki(K0(o)));const i=u(t,["text"]);i!=null&&f(e,["text"],i);const a=u(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const c=u(t,["activityEnd"]);return c!=null&&f(e,["activityEnd"],c),e}function Q1(t){const e={},n=u(t,["media"]);if(n!=null){let d=J0(n);Array.isArray(d)&&(d=d.map(h=>h)),f(e,["mediaChunks"],d)}const r=u(t,["audio"]);r!=null&&f(e,["audio"],Y0(r));const s=u(t,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const o=u(t,["video"]);o!=null&&f(e,["video"],K0(o));const i=u(t,["text"]);i!=null&&f(e,["text"],i);const a=u(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const c=u(t,["activityEnd"]);return c!=null&&f(e,["activityEnd"],c),e}function X1(t){const e={},n=u(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=u(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const s=u(t,["toolCall"]);s!=null&&f(e,["toolCall"],s);const o=u(t,["toolCallCancellation"]);o!=null&&f(e,["toolCallCancellation"],o);const i=u(t,["usageMetadata"]);i!=null&&f(e,["usageMetadata"],rC(i));const a=u(t,["goAway"]);a!=null&&f(e,["goAway"],a);const c=u(t,["sessionResumptionUpdate"]);c!=null&&f(e,["sessionResumptionUpdate"],c);const d=u(t,["voiceActivityDetectionSignal"]);return d!=null&&f(e,["voiceActivityDetectionSignal"],d),e}function Z1(t){const e={},n=u(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=u(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=u(t,["fileData"]);o!=null&&f(e,["fileData"],F1(o));const i=u(t,["functionCall"]);i!=null&&f(e,["functionCall"],O1(i));const a=u(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const c=u(t,["inlineData"]);c!=null&&f(e,["inlineData"],ki(c));const d=u(t,["text"]);d!=null&&f(e,["text"],d);const h=u(t,["thought"]);h!=null&&f(e,["thought"],h);const p=u(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=u(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function eC(t){const e={},n=u(t,["handle"]);if(n!=null&&f(e,["handle"],n),u(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function tC(t){const e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=u(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=u(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=u(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=u(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],z1(i));const a=u(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],B1(a));const c=u(t,["googleSearchRetrieval"]);c!=null&&f(e,["googleSearchRetrieval"],c);const d=u(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function nC(t){const e={},n=u(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=u(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=u(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const o=u(t,["enterpriseWebSearch"]);o!=null&&f(e,["enterpriseWebSearch"],o);const i=u(t,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>$1(m))),f(e,["functionDeclarations"],p)}const a=u(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const c=u(t,["googleSearch"]);c!=null&&f(e,["googleSearch"],c);const d=u(t,["googleSearchRetrieval"]);d!=null&&f(e,["googleSearchRetrieval"],d);const h=u(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function rC(t){const e={},n=u(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=u(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const s=u(t,["candidatesTokenCount"]);s!=null&&f(e,["responseTokenCount"],s);const o=u(t,["toolUsePromptTokenCount"]);o!=null&&f(e,["toolUsePromptTokenCount"],o);const i=u(t,["thoughtsTokenCount"]);i!=null&&f(e,["thoughtsTokenCount"],i);const a=u(t,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const c=u(t,["promptTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["promptTokensDetails"],g)}const d=u(t,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["cacheTokensDetails"],g)}const h=u(t,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["responseTokensDetails"],g)}const p=u(t,["toolUsePromptTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(y=>y)),f(e,["toolUsePromptTokensDetails"],g)}const m=u(t,["trafficType"]);return m!=null&&f(e,["trafficType"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sC(t){const e={},n=u(t,["data"]);if(n!=null&&f(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function oC(t){const e={},n=u(t,["content"]);n!=null&&f(e,["content"],n);const r=u(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],iC(r));const s=u(t,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const o=u(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const i=u(t,["avgLogprobs"]);i!=null&&f(e,["avgLogprobs"],i);const a=u(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const c=u(t,["index"]);c!=null&&f(e,["index"],c);const d=u(t,["logprobsResult"]);d!=null&&f(e,["logprobsResult"],d);const h=u(t,["safetyRatings"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["safetyRatings"],m)}const p=u(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function iC(t){const e={},n=u(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["citations"],r)}return e}function aC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let o=jt(s);Array.isArray(o)&&(o=o.map(i=>i)),f(n,["contents"],o)}return n}function lC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["tokensInfo"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["tokensInfo"],s)}return e}function cC(t){const e={},n=u(t,["values"]);n!=null&&f(e,["values"],n);const r=u(t,["statistics"]);return r!=null&&f(e,["statistics"],uC(r)),e}function uC(t){const e={},n=u(t,["truncated"]);n!=null&&f(e,["truncated"],n);const r=u(t,["token_count"]);return r!=null&&f(e,["tokenCount"],r),e}function Ua(t){const e={},n=u(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>xT(o))),f(e,["parts"],s)}const r=u(t,["role"]);return r!=null&&f(e,["role"],r),e}function dC(t){const e={},n=u(t,["controlType"]);n!=null&&f(e,["controlType"],n);const r=u(t,["enableControlImageComputation"]);return r!=null&&f(e,["computeControl"],r),e}function fC(t){const e={};if(u(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(u(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(u(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function hC(t,e){const n={},r=u(t,["systemInstruction"]);e!==void 0&&r!=null&&f(e,["systemInstruction"],st(r));const s=u(t,["tools"]);if(e!==void 0&&s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>uy(a))),f(e,["tools"],i)}const o=u(t,["generationConfig"]);return e!==void 0&&o!=null&&f(e,["generationConfig"],sT(o)),n}function pC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let i=jt(s);Array.isArray(i)&&(i=i.map(a=>Ua(a))),f(n,["contents"],i)}const o=u(e,["config"]);return o!=null&&fC(o),n}function mC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let i=jt(s);Array.isArray(i)&&(i=i.map(a=>a)),f(n,["contents"],i)}const o=u(e,["config"]);return o!=null&&hC(o,n),n}function gC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["totalTokens"]);r!=null&&f(e,["totalTokens"],r);const s=u(t,["cachedContentTokenCount"]);return s!=null&&f(e,["cachedContentTokenCount"],s),e}function yC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["totalTokens"]);return r!=null&&f(e,["totalTokens"],r),e}function vC(t,e){const n={},r=u(e,["model"]);return r!=null&&f(n,["_url","name"],me(t,r)),n}function xC(t,e){const n={},r=u(e,["model"]);return r!=null&&f(n,["_url","name"],me(t,r)),n}function wC(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function _C(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function bC(t,e){const n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=u(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const o=u(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const i=u(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const a=u(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const c=u(t,["seed"]);e!==void 0&&c!=null&&f(e,["parameters","seed"],c);const d=u(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&f(e,["parameters","safetySetting"],d);const h=u(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=u(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=u(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const g=u(t,["language"]);e!==void 0&&g!=null&&f(e,["parameters","language"],g);const y=u(t,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const _=u(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&f(e,["parameters","outputOptions","compressionQuality"],_);const b=u(t,["addWatermark"]);e!==void 0&&b!=null&&f(e,["parameters","addWatermark"],b);const x=u(t,["labels"]);e!==void 0&&x!=null&&f(e,["labels"],x);const w=u(t,["editMode"]);e!==void 0&&w!=null&&f(e,["parameters","editMode"],w);const v=u(t,["baseSteps"]);return e!==void 0&&v!=null&&f(e,["parameters","editConfig","baseSteps"],v),n}function SC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=u(e,["referenceImages"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(c=>ET(c))),f(n,["instances[0]","referenceImages"],a)}const i=u(e,["config"]);return i!=null&&bC(i,n),n}function kC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>ja(o))),f(e,["generatedImages"],s)}return e}function EC(t,e){const n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const s=u(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const o=u(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),u(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(u(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function CC(t,e){const n={},r=u(t,["taskType"]);e!==void 0&&r!=null&&f(e,["instances[]","task_type"],r);const s=u(t,["title"]);e!==void 0&&s!=null&&f(e,["instances[]","title"],s);const o=u(t,["outputDimensionality"]);e!==void 0&&o!=null&&f(e,["parameters","outputDimensionality"],o);const i=u(t,["mimeType"]);e!==void 0&&i!=null&&f(e,["instances[]","mimeType"],i);const a=u(t,["autoTruncate"]);return e!==void 0&&a!=null&&f(e,["parameters","autoTruncate"],a),n}function TC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let a=fd(t,s);Array.isArray(a)&&(a=a.map(c=>c)),f(n,["requests[]","content"],a)}const o=u(e,["config"]);o!=null&&EC(o,n);const i=u(e,["model"]);return i!==void 0&&f(n,["requests[]","model"],me(t,i)),n}function NC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let i=fd(t,s);Array.isArray(i)&&(i=i.map(a=>a)),f(n,["instances[]","content"],i)}const o=u(e,["config"]);return o!=null&&CC(o,n),n}function IC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["embeddings"],o)}const s=u(t,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function AC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>cC(i))),f(e,["embeddings"],o)}const s=u(t,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function RC(t){const e={},n=u(t,["endpoint"]);n!=null&&f(e,["name"],n);const r=u(t,["deployedModelId"]);return r!=null&&f(e,["deployedModelId"],r),e}function PC(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function MC(t){const e={},n=u(t,["id"]);n!=null&&f(e,["id"],n);const r=u(t,["args"]);r!=null&&f(e,["args"],r);const s=u(t,["name"]);if(s!=null&&f(e,["name"],s),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function DC(t){const e={},n=u(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=u(t,["mode"]);if(r!=null&&f(e,["mode"],r),u(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function LC(t){const e={},n=u(t,["description"]);n!=null&&f(e,["description"],n);const r=u(t,["name"]);r!=null&&f(e,["name"],r);const s=u(t,["parameters"]);s!=null&&f(e,["parameters"],s);const o=u(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const i=u(t,["response"]);i!=null&&f(e,["response"],i);const a=u(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),u(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function UC(t,e,n){const r={},s=u(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],Ua(st(s)));const o=u(e,["temperature"]);o!=null&&f(r,["temperature"],o);const i=u(e,["topP"]);i!=null&&f(r,["topP"],i);const a=u(e,["topK"]);a!=null&&f(r,["topK"],a);const c=u(e,["candidateCount"]);c!=null&&f(r,["candidateCount"],c);const d=u(e,["maxOutputTokens"]);d!=null&&f(r,["maxOutputTokens"],d);const h=u(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const p=u(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=u(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=u(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const y=u(e,["frequencyPenalty"]);y!=null&&f(r,["frequencyPenalty"],y);const _=u(e,["seed"]);_!=null&&f(r,["seed"],_);const b=u(e,["responseMimeType"]);b!=null&&f(r,["responseMimeType"],b);const x=u(e,["responseSchema"]);x!=null&&f(r,["responseSchema"],hd(x));const w=u(e,["responseJsonSchema"]);if(w!=null&&f(r,["responseJsonSchema"],w),u(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(u(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=u(e,["safetySettings"]);if(n!==void 0&&v!=null){let Q=v;Array.isArray(Q)&&(Q=Q.map(N=>CT(N))),f(n,["safetySettings"],Q)}const S=u(e,["tools"]);if(n!==void 0&&S!=null){let Q=Cs(S);Array.isArray(Q)&&(Q=Q.map(N=>MT(Es(N)))),f(n,["tools"],Q)}const T=u(e,["toolConfig"]);if(n!==void 0&&T!=null&&f(n,["toolConfig"],PT(T)),u(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const E=u(e,["cachedContent"]);n!==void 0&&E!=null&&f(n,["cachedContent"],En(t,E));const C=u(e,["responseModalities"]);C!=null&&f(r,["responseModalities"],C);const P=u(e,["mediaResolution"]);P!=null&&f(r,["mediaResolution"],P);const R=u(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],pd(R)),u(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const I=u(e,["thinkingConfig"]);I!=null&&f(r,["thinkingConfig"],I);const V=u(e,["imageConfig"]);V!=null&&f(r,["imageConfig"],cT(V));const Y=u(e,["enableEnhancedCivicAnswers"]);return Y!=null&&f(r,["enableEnhancedCivicAnswers"],Y),r}function jC(t,e,n){const r={},s=u(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],st(s));const o=u(e,["temperature"]);o!=null&&f(r,["temperature"],o);const i=u(e,["topP"]);i!=null&&f(r,["topP"],i);const a=u(e,["topK"]);a!=null&&f(r,["topK"],a);const c=u(e,["candidateCount"]);c!=null&&f(r,["candidateCount"],c);const d=u(e,["maxOutputTokens"]);d!=null&&f(r,["maxOutputTokens"],d);const h=u(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const p=u(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=u(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=u(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const y=u(e,["frequencyPenalty"]);y!=null&&f(r,["frequencyPenalty"],y);const _=u(e,["seed"]);_!=null&&f(r,["seed"],_);const b=u(e,["responseMimeType"]);b!=null&&f(r,["responseMimeType"],b);const x=u(e,["responseSchema"]);x!=null&&f(r,["responseSchema"],hd(x));const w=u(e,["responseJsonSchema"]);w!=null&&f(r,["responseJsonSchema"],w);const v=u(e,["routingConfig"]);v!=null&&f(r,["routingConfig"],v);const S=u(e,["modelSelectionConfig"]);S!=null&&f(r,["modelConfig"],S);const T=u(e,["safetySettings"]);if(n!==void 0&&T!=null){let B=T;Array.isArray(B)&&(B=B.map(X=>X)),f(n,["safetySettings"],B)}const E=u(e,["tools"]);if(n!==void 0&&E!=null){let B=Cs(E);Array.isArray(B)&&(B=B.map(X=>uy(Es(X)))),f(n,["tools"],B)}const C=u(e,["toolConfig"]);n!==void 0&&C!=null&&f(n,["toolConfig"],C);const P=u(e,["labels"]);n!==void 0&&P!=null&&f(n,["labels"],P);const R=u(e,["cachedContent"]);n!==void 0&&R!=null&&f(n,["cachedContent"],En(t,R));const I=u(e,["responseModalities"]);I!=null&&f(r,["responseModalities"],I);const V=u(e,["mediaResolution"]);V!=null&&f(r,["mediaResolution"],V);const Y=u(e,["speechConfig"]);Y!=null&&f(r,["speechConfig"],pd(Y));const Q=u(e,["audioTimestamp"]);Q!=null&&f(r,["audioTimestamp"],Q);const N=u(e,["thinkingConfig"]);N!=null&&f(r,["thinkingConfig"],N);const q=u(e,["imageConfig"]);if(q!=null&&f(r,["imageConfig"],uT(q)),u(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return r}function wp(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let i=jt(s);Array.isArray(i)&&(i=i.map(a=>Ua(a))),f(n,["contents"],i)}const o=u(e,["config"]);return o!=null&&f(n,["generationConfig"],UC(t,o,n)),n}function _p(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["contents"]);if(s!=null){let i=jt(s);Array.isArray(i)&&(i=i.map(a=>a)),f(n,["contents"],i)}const o=u(e,["config"]);return o!=null&&f(n,["generationConfig"],jC(t,o,n)),n}function bp(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>oC(d))),f(e,["candidates"],c)}const s=u(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const o=u(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const i=u(t,["responseId"]);i!=null&&f(e,["responseId"],i);const a=u(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function Sp(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>h)),f(e,["candidates"],d)}const s=u(t,["createTime"]);s!=null&&f(e,["createTime"],s);const o=u(t,["modelVersion"]);o!=null&&f(e,["modelVersion"],o);const i=u(t,["promptFeedback"]);i!=null&&f(e,["promptFeedback"],i);const a=u(t,["responseId"]);a!=null&&f(e,["responseId"],a);const c=u(t,["usageMetadata"]);return c!=null&&f(e,["usageMetadata"],c),e}function FC(t,e){const n={};if(u(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=u(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=u(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const o=u(t,["guidanceScale"]);if(e!==void 0&&o!=null&&f(e,["parameters","guidanceScale"],o),u(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=u(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&f(e,["parameters","safetySetting"],i);const a=u(t,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const c=u(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&f(e,["parameters","includeSafetyAttributes"],c);const d=u(t,["includeRaiReason"]);e!==void 0&&d!=null&&f(e,["parameters","includeRaiReason"],d);const h=u(t,["language"]);e!==void 0&&h!=null&&f(e,["parameters","language"],h);const p=u(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=u(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m),u(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=u(t,["imageSize"]);if(e!==void 0&&g!=null&&f(e,["parameters","sampleImageSize"],g),u(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function OC(t,e){const n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=u(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const o=u(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const i=u(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const a=u(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const c=u(t,["seed"]);e!==void 0&&c!=null&&f(e,["parameters","seed"],c);const d=u(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&f(e,["parameters","safetySetting"],d);const h=u(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=u(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=u(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const g=u(t,["language"]);e!==void 0&&g!=null&&f(e,["parameters","language"],g);const y=u(t,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const _=u(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&f(e,["parameters","outputOptions","compressionQuality"],_);const b=u(t,["addWatermark"]);e!==void 0&&b!=null&&f(e,["parameters","addWatermark"],b);const x=u(t,["labels"]);e!==void 0&&x!=null&&f(e,["labels"],x);const w=u(t,["imageSize"]);e!==void 0&&w!=null&&f(e,["parameters","sampleImageSize"],w);const v=u(t,["enhancePrompt"]);return e!==void 0&&v!=null&&f(e,["parameters","enhancePrompt"],v),n}function $C(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=u(e,["config"]);return o!=null&&FC(o,n),n}function GC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=u(e,["config"]);return o!=null&&OC(o,n),n}function zC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>eT(i))),f(e,["generatedImages"],o)}const s=u(t,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],ly(s)),e}function BC(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>ja(i))),f(e,["generatedImages"],o)}const s=u(t,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],cy(s)),e}function VC(t,e){const n={},r=u(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r),u(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(u(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=u(t,["durationSeconds"]);if(e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s),u(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=u(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const i=u(t,["resolution"]);e!==void 0&&i!=null&&f(e,["parameters","resolution"],i);const a=u(t,["personGeneration"]);if(e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a),u(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=u(t,["negativePrompt"]);e!==void 0&&c!=null&&f(e,["parameters","negativePrompt"],c);const d=u(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&f(e,["parameters","enhancePrompt"],d),u(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const h=u(t,["lastFrame"]);e!==void 0&&h!=null&&f(e,["instances[0]","lastFrame"],Fa(h));const p=u(t,["referenceImages"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>HT(g))),f(e,["instances[0]","referenceImages"],m)}if(u(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(u(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function qC(t,e){const n={},r=u(t,["numberOfVideos"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=u(t,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const o=u(t,["fps"]);e!==void 0&&o!=null&&f(e,["parameters","fps"],o);const i=u(t,["durationSeconds"]);e!==void 0&&i!=null&&f(e,["parameters","durationSeconds"],i);const a=u(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const c=u(t,["aspectRatio"]);e!==void 0&&c!=null&&f(e,["parameters","aspectRatio"],c);const d=u(t,["resolution"]);e!==void 0&&d!=null&&f(e,["parameters","resolution"],d);const h=u(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=u(t,["pubsubTopic"]);e!==void 0&&p!=null&&f(e,["parameters","pubsubTopic"],p);const m=u(t,["negativePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","negativePrompt"],m);const g=u(t,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const y=u(t,["generateAudio"]);e!==void 0&&y!=null&&f(e,["parameters","generateAudio"],y);const _=u(t,["lastFrame"]);e!==void 0&&_!=null&&f(e,["instances[0]","lastFrame"],tn(_));const b=u(t,["referenceImages"]);if(e!==void 0&&b!=null){let v=b;Array.isArray(v)&&(v=v.map(S=>WT(S))),f(e,["instances[0]","referenceImages"],v)}const x=u(t,["mask"]);e!==void 0&&x!=null&&f(e,["instances[0]","mask"],qT(x));const w=u(t,["compressionQuality"]);return e!==void 0&&w!=null&&f(e,["parameters","compressionQuality"],w),n}function HC(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["response","generateVideoResponse"]);return i!=null&&f(e,["response"],YC(i)),e}function WC(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["response"]);return i!=null&&f(e,["response"],QC(i)),e}function JC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=u(e,["image"]);o!=null&&f(n,["instances[0]","image"],Fa(o));const i=u(e,["video"]);i!=null&&f(n,["instances[0]","video"],dy(i));const a=u(e,["source"]);a!=null&&XC(a,n);const c=u(e,["config"]);return c!=null&&VC(c,n),n}function KC(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=u(e,["image"]);o!=null&&f(n,["instances[0]","image"],tn(o));const i=u(e,["video"]);i!=null&&f(n,["instances[0]","video"],fy(i));const a=u(e,["source"]);a!=null&&ZC(a,n);const c=u(e,["config"]);return c!=null&&qC(c,n),n}function YC(t){const e={},n=u(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>nT(i))),f(e,["generatedVideos"],o)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=u(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function QC(t){const e={},n=u(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>rT(i))),f(e,["generatedVideos"],o)}const r=u(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=u(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function XC(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=u(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Fa(s));const o=u(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],dy(o)),n}function ZC(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=u(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],tn(s));const o=u(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],fy(o)),n}function eT(t){const e={},n=u(t,["_self"]);n!=null&&f(e,["image"],dT(n));const r=u(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const s=u(t,["_self"]);return s!=null&&f(e,["safetyAttributes"],ly(s)),e}function ja(t){const e={},n=u(t,["_self"]);n!=null&&f(e,["image"],ay(n));const r=u(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const s=u(t,["_self"]);s!=null&&f(e,["safetyAttributes"],cy(s));const o=u(t,["prompt"]);return o!=null&&f(e,["enhancedPrompt"],o),e}function tT(t){const e={},n=u(t,["_self"]);n!=null&&f(e,["mask"],ay(n));const r=u(t,["labels"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["labels"],s)}return e}function nT(t){const e={},n=u(t,["video"]);return n!=null&&f(e,["video"],BT(n)),e}function rT(t){const e={},n=u(t,["_self"]);return n!=null&&f(e,["video"],VT(n)),e}function sT(t){const e={},n=u(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=u(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const s=u(t,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const o=u(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const i=u(t,["enableAffectiveDialog"]);i!=null&&f(e,["enableAffectiveDialog"],i);const a=u(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const c=u(t,["logprobs"]);c!=null&&f(e,["logprobs"],c);const d=u(t,["maxOutputTokens"]);d!=null&&f(e,["maxOutputTokens"],d);const h=u(t,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=u(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=u(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const g=u(t,["responseMimeType"]);g!=null&&f(e,["responseMimeType"],g);const y=u(t,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const _=u(t,["responseSchema"]);_!=null&&f(e,["responseSchema"],_);const b=u(t,["routingConfig"]);b!=null&&f(e,["routingConfig"],b);const x=u(t,["seed"]);x!=null&&f(e,["seed"],x);const w=u(t,["speechConfig"]);w!=null&&f(e,["speechConfig"],w);const v=u(t,["stopSequences"]);v!=null&&f(e,["stopSequences"],v);const S=u(t,["temperature"]);S!=null&&f(e,["temperature"],S);const T=u(t,["thinkingConfig"]);T!=null&&f(e,["thinkingConfig"],T);const E=u(t,["topK"]);E!=null&&f(e,["topK"],E);const C=u(t,["topP"]);if(C!=null&&f(e,["topP"],C),u(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function oT(t,e){const n={},r=u(e,["model"]);return r!=null&&f(n,["_url","name"],me(t,r)),n}function iT(t,e){const n={},r=u(e,["model"]);return r!=null&&f(n,["_url","name"],me(t,r)),n}function aT(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function lT(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function cT(t){const e={},n=u(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=u(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),u(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(u(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(u(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function uT(t){const e={},n=u(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=u(t,["imageSize"]);r!=null&&f(e,["imageSize"],r);const s=u(t,["personGeneration"]);s!=null&&f(e,["personGeneration"],s);const o=u(t,["outputMimeType"]);o!=null&&f(e,["imageOutputOptions","mimeType"],o);const i=u(t,["outputCompressionQuality"]);return i!=null&&f(e,["imageOutputOptions","compressionQuality"],i),e}function dT(t){const e={},n=u(t,["bytesBase64Encoded"]);n!=null&&f(e,["imageBytes"],Xn(n));const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function ay(t){const e={},n=u(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=u(t,["bytesBase64Encoded"]);r!=null&&f(e,["imageBytes"],Xn(r));const s=u(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function Fa(t){const e={};if(u(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=u(t,["imageBytes"]);n!=null&&f(e,["bytesBase64Encoded"],Xn(n));const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function tn(t){const e={},n=u(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=u(t,["imageBytes"]);r!=null&&f(e,["bytesBase64Encoded"],Xn(r));const s=u(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function fT(t,e,n){const r={},s=u(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const o=u(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const i=u(e,["filter"]);n!==void 0&&i!=null&&f(n,["_query","filter"],i);const a=u(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],ey(t,a)),r}function hT(t,e,n){const r={},s=u(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const o=u(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const i=u(e,["filter"]);n!==void 0&&i!=null&&f(n,["_query","filter"],i);const a=u(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],ey(t,a)),r}function pT(t,e){const n={},r=u(e,["config"]);return r!=null&&fT(t,r,n),n}function mT(t,e){const n={},r=u(e,["config"]);return r!=null&&hT(t,r,n),n}function gT(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["_self"]);if(s!=null){let o=ty(s);Array.isArray(o)&&(o=o.map(i=>Gc(i))),f(e,["models"],o)}return e}function yT(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["_self"]);if(s!=null){let o=ty(s);Array.isArray(o)&&(o=o.map(i=>zc(i))),f(e,["models"],o)}return e}function vT(t){const e={},n=u(t,["maskMode"]);n!=null&&f(e,["maskMode"],n);const r=u(t,["segmentationClasses"]);r!=null&&f(e,["maskClasses"],r);const s=u(t,["maskDilation"]);return s!=null&&f(e,["dilation"],s),e}function Gc(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=u(t,["description"]);s!=null&&f(e,["description"],s);const o=u(t,["version"]);o!=null&&f(e,["version"],o);const i=u(t,["_self"]);i!=null&&f(e,["tunedModelInfo"],DT(i));const a=u(t,["inputTokenLimit"]);a!=null&&f(e,["inputTokenLimit"],a);const c=u(t,["outputTokenLimit"]);c!=null&&f(e,["outputTokenLimit"],c);const d=u(t,["supportedGenerationMethods"]);d!=null&&f(e,["supportedActions"],d);const h=u(t,["temperature"]);h!=null&&f(e,["temperature"],h);const p=u(t,["maxTemperature"]);p!=null&&f(e,["maxTemperature"],p);const m=u(t,["topP"]);m!=null&&f(e,["topP"],m);const g=u(t,["topK"]);g!=null&&f(e,["topK"],g);const y=u(t,["thinking"]);return y!=null&&f(e,["thinking"],y),e}function zc(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=u(t,["description"]);s!=null&&f(e,["description"],s);const o=u(t,["versionId"]);o!=null&&f(e,["version"],o);const i=u(t,["deployedModels"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>RC(m))),f(e,["endpoints"],p)}const a=u(t,["labels"]);a!=null&&f(e,["labels"],a);const c=u(t,["_self"]);c!=null&&f(e,["tunedModelInfo"],LT(c));const d=u(t,["defaultCheckpointId"]);d!=null&&f(e,["defaultCheckpointId"],d);const h=u(t,["checkpoints"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["checkpoints"],p)}return e}function xT(t){const e={},n=u(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=u(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=u(t,["fileData"]);o!=null&&f(e,["fileData"],PC(o));const i=u(t,["functionCall"]);i!=null&&f(e,["functionCall"],MC(i));const a=u(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const c=u(t,["inlineData"]);c!=null&&f(e,["inlineData"],sC(c));const d=u(t,["text"]);d!=null&&f(e,["text"],d);const h=u(t,["thought"]);h!=null&&f(e,["thought"],h);const p=u(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=u(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function wT(t){const e={},n=u(t,["productImage"]);return n!=null&&f(e,["image"],tn(n)),e}function _T(t,e){const n={},r=u(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=u(t,["baseSteps"]);e!==void 0&&s!=null&&f(e,["parameters","baseSteps"],s);const o=u(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const i=u(t,["seed"]);e!==void 0&&i!=null&&f(e,["parameters","seed"],i);const a=u(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const c=u(t,["personGeneration"]);e!==void 0&&c!=null&&f(e,["parameters","personGeneration"],c);const d=u(t,["addWatermark"]);e!==void 0&&d!=null&&f(e,["parameters","addWatermark"],d);const h=u(t,["outputMimeType"]);e!==void 0&&h!=null&&f(e,["parameters","outputOptions","mimeType"],h);const p=u(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","compressionQuality"],p);const m=u(t,["enhancePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m);const g=u(t,["labels"]);return e!==void 0&&g!=null&&f(e,["labels"],g),n}function bT(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["source"]);s!=null&&kT(s,n);const o=u(e,["config"]);return o!=null&&_T(o,n),n}function ST(t){const e={},n=u(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>ja(s))),f(e,["generatedImages"],r)}return e}function kT(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=u(t,["personImage"]);e!==void 0&&s!=null&&f(e,["instances[0]","personImage","image"],tn(s));const o=u(t,["productImages"]);if(e!==void 0&&o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>wT(a))),f(e,["instances[0]","productImages"],i)}return n}function ET(t){const e={},n=u(t,["referenceImage"]);n!=null&&f(e,["referenceImage"],tn(n));const r=u(t,["referenceId"]);r!=null&&f(e,["referenceId"],r);const s=u(t,["referenceType"]);s!=null&&f(e,["referenceType"],s);const o=u(t,["maskImageConfig"]);o!=null&&f(e,["maskImageConfig"],vT(o));const i=u(t,["controlImageConfig"]);i!=null&&f(e,["controlImageConfig"],dC(i));const a=u(t,["styleImageConfig"]);a!=null&&f(e,["styleImageConfig"],a);const c=u(t,["subjectImageConfig"]);return c!=null&&f(e,["subjectImageConfig"],c),e}function ly(t){const e={},n=u(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=u(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const s=u(t,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function cy(t){const e={},n=u(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=u(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const s=u(t,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function CT(t){const e={},n=u(t,["category"]);if(n!=null&&f(e,["category"],n),u(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=u(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function TT(t){const e={},n=u(t,["image"]);return n!=null&&f(e,["image"],tn(n)),e}function NT(t,e){const n={},r=u(t,["mode"]);e!==void 0&&r!=null&&f(e,["parameters","mode"],r);const s=u(t,["maxPredictions"]);e!==void 0&&s!=null&&f(e,["parameters","maxPredictions"],s);const o=u(t,["confidenceThreshold"]);e!==void 0&&o!=null&&f(e,["parameters","confidenceThreshold"],o);const i=u(t,["maskDilation"]);e!==void 0&&i!=null&&f(e,["parameters","maskDilation"],i);const a=u(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&f(e,["parameters","binaryColorThreshold"],a);const c=u(t,["labels"]);return e!==void 0&&c!=null&&f(e,["labels"],c),n}function IT(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["source"]);s!=null&&RT(s,n);const o=u(e,["config"]);return o!=null&&NT(o,n),n}function AT(t){const e={},n=u(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>tT(s))),f(e,["generatedMasks"],r)}return e}function RT(t,e){const n={},r=u(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=u(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],tn(s));const o=u(t,["scribbleImage"]);return e!==void 0&&o!=null&&f(e,["instances[0]","scribble"],TT(o)),n}function PT(t){const e={},n=u(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=u(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],DC(r)),e}function MT(t){const e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=u(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=u(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=u(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=u(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],aT(i));const a=u(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],lT(a));const c=u(t,["googleSearchRetrieval"]);c!=null&&f(e,["googleSearchRetrieval"],c);const d=u(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function uy(t){const e={},n=u(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=u(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),u(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=u(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const o=u(t,["enterpriseWebSearch"]);o!=null&&f(e,["enterpriseWebSearch"],o);const i=u(t,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>LC(m))),f(e,["functionDeclarations"],p)}const a=u(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const c=u(t,["googleSearch"]);c!=null&&f(e,["googleSearch"],c);const d=u(t,["googleSearchRetrieval"]);d!=null&&f(e,["googleSearchRetrieval"],d);const h=u(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function DT(t){const e={},n=u(t,["baseModel"]);n!=null&&f(e,["baseModel"],n);const r=u(t,["createTime"]);r!=null&&f(e,["createTime"],r);const s=u(t,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function LT(t){const e={},n=u(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(e,["baseModel"],n);const r=u(t,["createTime"]);r!=null&&f(e,["createTime"],r);const s=u(t,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function UT(t,e){const n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=u(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const o=u(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function jT(t,e){const n={},r=u(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=u(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const o=u(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function FT(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","name"],me(t,r));const s=u(e,["config"]);return s!=null&&UT(s,n),n}function OT(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["config"]);return s!=null&&jT(s,n),n}function $T(t,e){const n={},r=u(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=u(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const o=u(t,["personGeneration"]);e!==void 0&&o!=null&&f(e,["parameters","personGeneration"],o);const i=u(t,["includeRaiReason"]);e!==void 0&&i!=null&&f(e,["parameters","includeRaiReason"],i);const a=u(t,["outputMimeType"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","mimeType"],a);const c=u(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&f(e,["parameters","outputOptions","compressionQuality"],c);const d=u(t,["enhanceInputImage"]);e!==void 0&&d!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],d);const h=u(t,["imagePreservationFactor"]);e!==void 0&&h!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const p=u(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=u(t,["numberOfImages"]);e!==void 0&&m!=null&&f(e,["parameters","sampleCount"],m);const g=u(t,["mode"]);return e!==void 0&&g!=null&&f(e,["parameters","mode"],g),n}function GT(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["_url","model"],me(t,r));const s=u(e,["image"]);s!=null&&f(n,["instances[0]","image"],tn(s));const o=u(e,["upscaleFactor"]);o!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],o);const i=u(e,["config"]);return i!=null&&$T(i,n),n}function zT(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>ja(o))),f(e,["generatedImages"],s)}return e}function BT(t){const e={},n=u(t,["uri"]);n!=null&&f(e,["uri"],n);const r=u(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],Xn(r));const s=u(t,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function VT(t){const e={},n=u(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=u(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],Xn(r));const s=u(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function qT(t){const e={},n=u(t,["image"]);n!=null&&f(e,["_self"],tn(n));const r=u(t,["maskMode"]);return r!=null&&f(e,["maskMode"],r),e}function HT(t){const e={},n=u(t,["image"]);n!=null&&f(e,["image"],Fa(n));const r=u(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function WT(t){const e={},n=u(t,["image"]);n!=null&&f(e,["image"],tn(n));const r=u(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function dy(t){const e={},n=u(t,["uri"]);n!=null&&f(e,["uri"],n);const r=u(t,["videoBytes"]);r!=null&&f(e,["encodedVideo"],Xn(r));const s=u(t,["mimeType"]);return s!=null&&f(e,["encoding"],s),e}function fy(t){const e={},n=u(t,["uri"]);n!=null&&f(e,["gcsUri"],n);const r=u(t,["videoBytes"]);r!=null&&f(e,["bytesBase64Encoded"],Xn(r));const s=u(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JT(t,e){const n={},r=u(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["displayName"],r),n}function KT(t){const e={},n=u(t,["config"]);return n!=null&&JT(n,e),e}function YT(t,e){const n={},r=u(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function QT(t){const e={},n=u(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=u(t,["config"]);return r!=null&&YT(r,e),e}function XT(t){const e={},n=u(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function ZT(t,e){const n={},r=u(t,["customMetadata"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["customMetadata"],o)}const s=u(t,["chunkingConfig"]);return e!==void 0&&s!=null&&f(e,["chunkingConfig"],s),n}function eN(t){const e={},n=u(t,["name"]);n!=null&&f(e,["name"],n);const r=u(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=u(t,["done"]);s!=null&&f(e,["done"],s);const o=u(t,["error"]);o!=null&&f(e,["error"],o);const i=u(t,["response"]);return i!=null&&f(e,["response"],nN(i)),e}function tN(t){const e={},n=u(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=u(t,["fileName"]);r!=null&&f(e,["fileName"],r);const s=u(t,["config"]);return s!=null&&ZT(s,e),e}function nN(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["parent"]);r!=null&&f(e,["parent"],r);const s=u(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function rN(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=u(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function sN(t){const e={},n=u(t,["config"]);return n!=null&&rN(n,e),e}function oN(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["fileSearchStores"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["fileSearchStores"],o)}return e}function hy(t,e){const n={},r=u(t,["mimeType"]);e!==void 0&&r!=null&&f(e,["mimeType"],r);const s=u(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=u(t,["customMetadata"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(c=>c)),f(e,["customMetadata"],a)}const i=u(t,["chunkingConfig"]);return e!==void 0&&i!=null&&f(e,["chunkingConfig"],i),n}function iN(t){const e={},n=u(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=u(t,["config"]);return r!=null&&hy(r,e),e}function aN(t){const e={},n=u(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lN="Content-Type",cN="X-Server-Timeout",uN="User-Agent",Bc="x-goog-api-client",dN="1.35.0",fN=`google-genai-sdk/${dN}`,hN="v1beta1",pN="v1beta";class mN{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:hN,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:pN,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[i,a]of Object.entries(e.queryParams))s.searchParams.append(i,String(a));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(n))typeof o=="object"?r[s]=Object.assign(Object.assign({},r[s]),o):o!==void 0&&(r[s]=o);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,s){if(n&&n.timeout||s){const o=new AbortController,i=o.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>o.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=i}return n&&n.extraBody!==null&&gN(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await kp(s),new Fc(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await kp(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Xt(this,arguments,function*(){var r;const s=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),o=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let i="";const a="data:",c=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:d,value:h}=yield ae(s.read());if(d){if(i.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=o.decode(h,{stream:!0});try{const y=JSON.parse(p);if("error"in y){const _=JSON.parse(JSON.stringify(y.error)),b=_.status,x=_.code,w=`got status: ${b}. ${JSON.stringify(y)}`;if(x>=400&&x<600)throw new La({message:w,status:x})}}catch(y){if(y.name==="ApiError")throw y}i+=p;let m=-1,g=0;for(;;){m=-1,g=0;for(const b of c){const x=i.indexOf(b);x!==-1&&(m===-1||x<m)&&(m=x,g=b.length)}if(m===-1)break;const y=i.substring(0,m);i=i.substring(m+g);const _=y.trim();if(_.startsWith(a)){const b=_.substring(a.length).trim();try{const x=new Response(b,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ae(new Fc(x))}catch(x){throw new Error(`exception parsing stream chunk ${b}. ${x}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=fN+" "+this.clientOptions.userAgentExtra;return e[uN]=n,e[Bc]=n,e[lN]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))r.append(s,o);e.timeout&&e.timeout>0&&r.append(cN,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,i=await o.stat(e);s.sizeBytes=String(i.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:i.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=a;const c={file:s},d=this.getFileName(e),h=$("upload/v1beta/files",c._url),p=await this.fetchUploadUrl(h,s.sizeBytes,s.mimeType,d,c,n==null?void 0:n.httpOptions);return o.upload(e,p,this)}async uploadFileToFileSearchStore(e,n,r){var s;const o=this.clientOptions.uploader,i=await o.stat(n),a=String(i.size),c=(s=r==null?void 0:r.mimeType)!==null&&s!==void 0?s:i.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(n),p={};r!=null&&hy(r,p);const m=await this.fetchUploadUrl(d,a,c,h,p,r==null?void 0:r.httpOptions);return o.uploadToFileSearchStore(n,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,s,o,i){var a;let c={};i?c=i:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},s?{"X-Goog-Upload-File-Name":s}:{})};const d=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:c});if(!d||!(d!=null&&d.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(a=d==null?void 0:d.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function kp(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const s=JSON.stringify(r);throw n>=400&&n<600?new La({message:s,status:n}):new Error(s)}}function gN(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,i){const a=Object.assign({},o);for(const c in i)if(Object.prototype.hasOwnProperty.call(i,c)){const d=i[c],h=a[c];d&&typeof d=="object"&&!Array.isArray(d)&&h&&typeof h=="object"&&!Array.isArray(h)?a[c]=r(h,d):(h&&d&&typeof h!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof h}, New type: ${typeof d}. Overwriting.`),a[c]=d)}return a}const s=r(n,e);t.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yN="mcp_used/unknown";let vN=!1;function py(t){for(const e of t)if(xN(e)||typeof e=="object"&&"inputSchema"in e)return!0;return vN}function my(t){var e;const n=(e=t[Bc])!==null&&e!==void 0?e:"";t[Bc]=(n+` ${yN}`).trimStart()}function xN(t){return t!==null&&typeof t=="object"&&t instanceof gd}function wN(t){return Xt(this,arguments,function*(n,r=100){let s,o=0;for(;o<r;){const i=yield ae(n.listTools({cursor:s}));for(const a of i.tools)yield yield ae(a),o++;if(!i.nextCursor)break;s=i.nextCursor}})}class gd{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new gd(e,n)}async initialize(){var e,n,r,s;if(this.mcpTools.length>0)return;const o={},i=[];for(const h of this.mcpClients)try{for(var a=!0,c=(n=void 0,Zt(wN(h))),d;d=await c.next(),e=d.done,!e;a=!0){s=d.value,a=!1;const p=s;i.push(p);const m=p.name;if(o[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);o[m]=h}}catch(p){n={error:p}}finally{try{!a&&!e&&(r=c.return)&&await r.call(c)}finally{if(n)throw n.error}}this.mcpTools=i,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),Xk(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const i=await s.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:i.isError?{error:i}:i}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function _N(t,e,n){const r=new Vk;let s;n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),Object.assign(r,s),e(r)}class bN{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),i=EN(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${a}`;let d=()=>{};const h=new Promise(v=>{d=v}),p=e.callbacks,m=function(){d({})},g=this.apiClient,y={onopen:m,onmessage:v=>{_N(g,p.onmessage,v)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(v){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(v){}},_=this.webSocketFactory.create(c,kN(i),y);_.connect(),await h;const w={setup:{model:me(this.apiClient,e.model)}};return _.send(JSON.stringify(w)),new SN(_,this.apiClient)}}class SN{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=K1(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=J1(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Xr.PLAY)}pause(){this.sendPlaybackControl(Xr.PAUSE)}stop(){this.sendPlaybackControl(Xr.STOP)}resetContext(){this.sendPlaybackControl(Xr.RESET_CONTEXT)}close(){this.conn.close()}}function kN(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function EN(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CN="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function TN(t,e,n){const r=new Bk;let s;n.data instanceof Blob?s=await n.data.text():n.data instanceof ArrayBuffer?s=new TextDecoder().decode(n.data):s=n.data;const o=JSON.parse(s);if(t.isVertexAI()){const i=X1(o);Object.assign(r,i)}else Object.assign(r,o);e(r)}class NN{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new bN(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,s,o,i,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&py(e.config.tools)&&my(p);const m=PN(p);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,h);else{const R=this.apiClient.getApiKey();let I="BidiGenerateContent",V="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),I="BidiGenerateContentConstrained",V="access_token"),h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${I}?${V}=${R}`}let g=()=>{};const y=new Promise(R=>{g=R}),_=e.callbacks,b=function(){var R;(R=_==null?void 0:_.onopen)===null||R===void 0||R.call(_),g({})},x=this.apiClient,w={onopen:b,onmessage:R=>{TN(x,_.onmessage,R)},onerror:(n=_==null?void 0:_.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=_==null?void 0:_.onclose)!==null&&r!==void 0?r:function(R){}},v=this.webSocketFactory.create(h,RN(m),w);v.connect(),await y;let S=me(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&S.startsWith("publishers/")){const R=this.apiClient.getProject(),I=this.apiClient.getLocation();S=`projects/${R}/locations/${I}/`+S}let T={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[sa.AUDIO]}:e.config.responseModalities=[sa.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const E=(a=(i=e.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[],C=[];for(const R of E)if(this.isCallableTool(R)){const I=R;C.push(await I.tool())}else C.push(R);C.length>0&&(e.config.tools=C);const P={model:S,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?T=W1(this.apiClient,P):T=H1(this.apiClient,P),delete T.config,v.send(JSON.stringify(T)),new AN(v,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const IN={turnComplete:!0};class AN{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=jt(n.turns),e.isVertexAI()||(r=r.map(s=>Ua(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(CN)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},IN),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Q1(e)}:n={realtimeInput:Y1(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function RN(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function PN(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ep=10;function Cp(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const i of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(cs(i)){s=!0;break}if(!s)return!0;const o=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function cs(t){return"callTool"in t&&typeof t.callTool=="function"}function MN(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(s=>cs(s)))!==null&&r!==void 0?r:!1}function Tp(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,s)=>{if(cs(r))return;const o=r;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(s)}),n}function Np(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DN extends kn{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,s,o,i,a;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!MN(n)||Cp(n.config))return await this.generateContentInternal(c);const d=Tp(n);if(d.length>0){const _=d.map(b=>`tools[${b}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${_}.`)}let h,p;const m=jt(c.contents),g=(o=(s=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:Ep;let y=0;for(;y<g&&(h=await this.generateContentInternal(c),!(!h.functionCalls||h.functionCalls.length===0));){const _=h.candidates[0].content,b=[];for(const x of(a=(i=n.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[])if(cs(x)){const v=await x.callTool(h.functionCalls);b.push(...v)}y++,p={role:"user",parts:b},c.contents=jt(c.contents),c.contents.push(_),c.contents.push(p),Np(c.config)&&(m.push(_),m.push(p))}return Np(c.config)&&(h.automaticFunctionCallingHistory=m),h},this.generateContentStream=async n=>{var r,s,o,i,a;if(this.maybeMoveToResponseJsonSchem(n),Cp(n.config)){const p=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(p)}const c=Tp(n);if(c.length>0){const p=c.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(o=(s=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,h=(a=(i=n==null?void 0:n.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(d&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let o;const i=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?o=c==null?void 0:c.safetyAttributes:i.push(c);let a;return o?a={generatedImages:i,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:i,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const i={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!i.config.queryBase){if(!((r=i.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");i.config.filter="labels.tune-type:*"}return new Er(_n.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(i),i)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)},this.generateVideos=async n=>{var r,s,o,i,a,c;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((s=n.video)===null||s===void 0)&&s.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((i=(o=n.source)===null||o===void 0?void 0:o.video)===null||i===void 0)&&i.uri&&(!((c=(a=n.source)===null||a===void 0?void 0:a.video)===null||c===void 0)&&c.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,s;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const i=await Promise.all(o.map(async c=>cs(c)?await c.tool():c)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};if(a.config.tools=i,e.config&&e.config.tools&&py(e.config.tools)){const c=(s=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&s!==void 0?s:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),my(d),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return a}async initAfcToolsMap(e){var n,r,s;const o=new Map;for(const i of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(cs(i)){const a=i,c=await a.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(o.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);o.set(d.name,a)}}return o}async processAfcStream(e){var n,r,s;const o=(s=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:Ep;let i=!1,a=0;const c=await this.initAfcToolsMap(e);return function(d,h,p){return Xt(this,arguments,function*(){for(var m,g,y,_,b,x;a<o;){i&&(a++,i=!1);const T=yield ae(d.processParamsMaybeAddMcpUsage(p)),E=yield ae(d.generateContentStreamInternal(T)),C=[],P=[];try{for(var w=!0,v=(g=void 0,Zt(E)),S;S=yield ae(v.next()),m=S.done,!m;w=!0){_=S.value,w=!1;const R=_;if(yield yield ae(R),R.candidates&&(!((b=R.candidates[0])===null||b===void 0)&&b.content)){P.push(R.candidates[0].content);for(const I of(x=R.candidates[0].content.parts)!==null&&x!==void 0?x:[])if(a<o&&I.functionCall){if(!I.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(I.functionCall.name)){const V=yield ae(h.get(I.functionCall.name).callTool([I.functionCall]));C.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${I.functionCall.name}`)}}}}catch(R){g={error:R}}finally{try{!w&&!m&&(y=v.return)&&(yield ae(y.call(v)))}finally{if(g)throw g.error}}if(C.length>0){i=!0;const R=new Us;R.candidates=[{content:{role:"user",parts:C}}],yield yield ae(R);const I=[];I.push(...P),I.push({role:"user",parts:C});const V=jt(p.contents).concat(I);p.contents=V}else break}})}(this,c,e)}async generateContentInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=_p(this.apiClient,e);return a=$("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=Sp(h),m=new Us;return Object.assign(m,p),m})}else{const d=wp(this.apiClient,e);return a=$("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=bp(h),m=new Us;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=_p(this.apiClient,e);return a=$("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),i.then(function(p){return Xt(this,arguments,function*(){var m,g,y,_;try{for(var b=!0,x=Zt(p),w;w=yield ae(x.next()),m=w.done,!m;b=!0){_=w.value,b=!1;const v=_,S=Sp(yield ae(v.json()));S.sdkHttpResponse={headers:v.headers};const T=new Us;Object.assign(T,S),yield yield ae(T)}}catch(v){g={error:v}}finally{try{!b&&!m&&(y=x.return)&&(yield ae(y.call(x)))}finally{if(g)throw g.error}}})})}else{const d=wp(this.apiClient,e);return a=$("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.requestStream({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),i.then(function(p){return Xt(this,arguments,function*(){var m,g,y,_;try{for(var b=!0,x=Zt(p),w;w=yield ae(x.next()),m=w.done,!m;b=!0){_=w.value,b=!1;const v=_,S=bp(yield ae(v.json()));S.sdkHttpResponse={headers:v.headers};const T=new Us;Object.assign(T,S),yield yield ae(T)}}catch(v){g={error:v}}finally{try{!b&&!m&&(y=x.return)&&(yield ae(y.call(x)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=NC(this.apiClient,e);return a=$("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=AC(h),m=new rp;return Object.assign(m,p),m})}else{const d=TC(this.apiClient,e);return a=$("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=IC(h),m=new rp;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=GC(this.apiClient,e);return a=$("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=BC(h),m=new sp;return Object.assign(m,p),m})}else{const d=$C(this.apiClient,e);return a=$("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=zC(h),m=new sp;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=SC(this.apiClient,e);return o=$("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),s.then(c=>{const d=kC(c),h=new Pk;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=GT(this.apiClient,e);return o=$("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),s.then(c=>{const d=zT(c),h=new Mk;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=bT(this.apiClient,e);return o=$("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=ST(c),h=new Dk;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=IT(this.apiClient,e);return o=$("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=AT(c),h=new Lk;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=iT(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>zc(h))}else{const d=oT(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>Gc(h))}}async listInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=mT(this.apiClient,e);return a=$("{models_url}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=yT(h),m=new op;return Object.assign(m,p),m})}else{const d=pT(this.apiClient,e);return a=$("{models_url}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=gT(h),m=new op;return Object.assign(m,p),m})}}async update(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=OT(this.apiClient,e);return a=$("{model}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>zc(h))}else{const d=FT(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>Gc(h))}}async delete(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=xC(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=_C(h),m=new ip;return Object.assign(m,p),m})}else{const d=vC(this.apiClient,e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=wC(h),m=new ip;return Object.assign(m,p),m})}}async countTokens(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=mC(this.apiClient,e);return a=$("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=yC(h),m=new ap;return Object.assign(m,p),m})}else{const d=pC(this.apiClient,e);return a=$("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=gC(h),m=new ap;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=aC(this.apiClient,e);return o=$("{model}:computeTokens",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),s.then(c=>{const d=lC(c),h=new Uk;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=KC(this.apiClient,e);return a=$("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>{const p=WC(h),m=new oa;return Object.assign(m,p),m})}else{const d=JC(this.apiClient,e);return a=$("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const p=HC(h),m=new oa;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LN extends kn{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=Ck(e);return a=$("{operationName}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i}else{const d=Ek(e);return a=$("{operationName}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i}}async fetchPredictVideosOperationInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=vk(e);return o=$("{resourceName}:fetchPredictOperation",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UN(t){const e={},n=u(t,["data"]);if(n!=null&&f(e,["data"],n),u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function jN(t){const e={},n=u(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>HN(o))),f(e,["parts"],s)}const r=u(t,["role"]);return r!=null&&f(e,["role"],r),e}function FN(t,e,n){const r={},s=u(e,["expireTime"]);n!==void 0&&s!=null&&f(n,["expireTime"],s);const o=u(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&f(n,["newSessionExpireTime"],o);const i=u(e,["uses"]);n!==void 0&&i!=null&&f(n,["uses"],i);const a=u(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],qN(t,a));const c=u(e,["lockAdditionalFields"]);return n!==void 0&&c!=null&&f(n,["fieldMask"],c),r}function ON(t,e){const n={},r=u(e,["config"]);return r!=null&&f(n,["config"],FN(t,r,n)),n}function $N(t){const e={};if(u(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=u(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=u(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function GN(t){const e={},n=u(t,["id"]);n!=null&&f(e,["id"],n);const r=u(t,["args"]);r!=null&&f(e,["args"],r);const s=u(t,["name"]);if(s!=null&&f(e,["name"],s),u(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(u(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function zN(t){const e={};if(u(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=u(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function BN(t){const e={};if(u(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(u(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=u(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function VN(t,e){const n={},r=u(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const s=u(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const o=u(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const i=u(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=u(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const c=u(t,["maxOutputTokens"]);e!==void 0&&c!=null&&f(e,["setup","generationConfig","maxOutputTokens"],c);const d=u(t,["mediaResolution"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","mediaResolution"],d);const h=u(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=u(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],md(p));const m=u(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=u(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const y=u(t,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],jN(st(y)));const _=u(t,["tools"]);if(e!==void 0&&_!=null){let E=Cs(_);Array.isArray(E)&&(E=E.map(C=>JN(Es(C)))),f(e,["setup","tools"],E)}const b=u(t,["sessionResumption"]);e!==void 0&&b!=null&&f(e,["setup","sessionResumption"],WN(b));const x=u(t,["inputAudioTranscription"]);e!==void 0&&x!=null&&f(e,["setup","inputAudioTranscription"],x);const w=u(t,["outputAudioTranscription"]);e!==void 0&&w!=null&&f(e,["setup","outputAudioTranscription"],w);const v=u(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&f(e,["setup","realtimeInputConfig"],v);const S=u(t,["contextWindowCompression"]);e!==void 0&&S!=null&&f(e,["setup","contextWindowCompression"],S);const T=u(t,["proactivity"]);if(e!==void 0&&T!=null&&f(e,["setup","proactivity"],T),u(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function qN(t,e){const n={},r=u(e,["model"]);r!=null&&f(n,["setup","model"],me(t,r));const s=u(e,["config"]);return s!=null&&f(n,["config"],VN(s,n)),n}function HN(t){const e={},n=u(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=u(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=u(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=u(t,["fileData"]);o!=null&&f(e,["fileData"],$N(o));const i=u(t,["functionCall"]);i!=null&&f(e,["functionCall"],GN(i));const a=u(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const c=u(t,["inlineData"]);c!=null&&f(e,["inlineData"],UN(c));const d=u(t,["text"]);d!=null&&f(e,["text"],d);const h=u(t,["thought"]);h!=null&&f(e,["thought"],h);const p=u(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=u(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function WN(t){const e={},n=u(t,["handle"]);if(n!=null&&f(e,["handle"],n),u(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function JN(t){const e={};if(u(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=u(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=u(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=u(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),u(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=u(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=u(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],zN(i));const a=u(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],BN(a));const c=u(t,["googleSearchRetrieval"]);c!=null&&f(e,["googleSearchRetrieval"],c);const d=u(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KN(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const s=Object.keys(r).map(o=>`${n}.${o}`);e.push(...s)}else e.push(n)}return e.join(",")}function YN(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const s=t.fieldMask;if(n){const o=KN(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const i=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];s.length>0&&(a=s.map(d=>i.includes(d)?`generationConfig.${d}`:d));const c=[];o&&c.push(o),a.length>0&&c.push(...a),c.length>0?t.fieldMask=c.join(","):delete t.fieldMask}else delete t.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?t.fieldMask=s.join(","):delete t.fieldMask;return t}class QN extends kn{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=ON(this.apiClient,e);o=$("auth_tokens",a._url),i=a._query,delete a.config,delete a._url,delete a._query;const c=YN(a,e.config);return s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XN(t,e){const n={},r=u(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function ZN(t){const e={},n=u(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=u(t,["config"]);return r!=null&&XN(r,e),e}function eI(t){const e={},n=u(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function tI(t,e){const n={},r=u(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=u(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function nI(t){const e={},n=u(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const r=u(t,["config"]);return r!=null&&tI(r,e),e}function rI(t){const e={},n=u(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=u(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=u(t,["documents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sI extends kn{constructor(e){super(),this.apiClient=e,this.list=async n=>new Er(_n.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=eI(e);return o=$("{name}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,r;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=ZN(e);s=$("{name}",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=nI(e);return o=$("{parent}/documents",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=rI(c),h=new jk;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oI extends kn{constructor(e,n=new sI(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new Er(_n.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=KT(e);return o=$("fileSearchStores",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async get(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=XT(e);return o=$("{name}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,r;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=QT(e);s=$("{name}",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=sN(e);return o=$("fileSearchStores",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=oN(c),h=new Fk;return Object.assign(h,d),h})}}async uploadToFileSearchStoreInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=iN(e);return o=$("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=aN(c),h=new Ok;return Object.assign(h,d),h})}}async importFile(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tN(e);return o=$("{file_search_store_name}:importFile",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=eN(c),h=new ud;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let gy=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return gy=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const iI=()=>gy();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vc(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const qc=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zt extends Error{}class ut extends zt{constructor(e,n,r,s){super(`${ut.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.error=n}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new Oa({message:r,cause:qc(n)});const o=n;return e===400?new vy(e,o,r,s):e===401?new xy(e,o,r,s):e===403?new wy(e,o,r,s):e===404?new _y(e,o,r,s):e===409?new by(e,o,r,s):e===422?new Sy(e,o,r,s):e===429?new ky(e,o,r,s):e>=500?new Ey(e,o,r,s):new ut(e,o,r,s)}}class Hc extends ut{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Oa extends ut{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class yy extends Oa{constructor({message:e}={}){super({message:e??"Request timed out."})}}class vy extends ut{}class xy extends ut{}class wy extends ut{}class _y extends ut{}class by extends ut{}class Sy extends ut{}class ky extends ut{}class Ey extends ut{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aI=/^[a-z][a-z0-9+.-]*:/i,lI=t=>aI.test(t);let Wc=t=>(Wc=Array.isArray,Wc(t));const cI=Wc;let uI=cI;const Ip=uI;function dI(t){if(!t)return!0;for(const e in t)return!1;return!0}function fI(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const hI=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new zt(`${t} must be an integer`);if(e<0)throw new zt(`${t} must be a positive integer`);return e},pI=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mI=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fr="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gI(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const yI=()=>{var t,e,n,r,s;const o=gI();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Fr,"X-Stainless-OS":Rp(Deno.build.os),"X-Stainless-Arch":Ap(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Fr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Fr,"X-Stainless-OS":Rp((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":Ap((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const i=vI();return i?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Fr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${i.browser}`,"X-Stainless-Runtime-Version":i.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Fr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function vI(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:e,version:`${s}.${o}.${i}`}}}return null}const Ap=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Rp=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let ri;const xI=()=>ri??(ri=yI());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wI(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Cy(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function _I(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Cy({start(){},async pull(n){const{done:r,value:s}=await e.next();r?n.close():n.enqueue(s)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function Ty(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function bI(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const r=t.getReader(),s=r.cancel();r.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SI=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ny=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Cl(t,e,n){return Ny(),new File(t,e??"unknown_file",n)}function kI(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const EI=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Iy=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",CI=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Iy(t),TI=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function NI(t,e,n){if(Ny(),t=await t,CI(t))return t instanceof File?t:Cl([await t.arrayBuffer()],t.name);if(TI(t)){const s=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Cl(await Jc(s),e,n)}const r=await Jc(t);if(e||(e=kI(t)),!(n!=null&&n.type)){const s=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(n=Object.assign(Object.assign({},n),{type:s}))}return Cl(r,e,n)}async function Jc(t){var e,n,r,s,o;let i=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)i.push(t);else if(Iy(t))i.push(t instanceof Blob?t:await t.arrayBuffer());else if(EI(t))try{for(var a=!0,c=Zt(t),d;d=await c.next(),e=d.done,!e;a=!0){s=d.value,a=!1;const h=s;i.push(...await Jc(h))}}catch(h){n={error:h}}finally{try{!a&&!e&&(r=c.return)&&await r.call(c)}finally{if(n)throw n.error}}else{const h=(o=t==null?void 0:t.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof t}${h?`; constructor: ${h}`:""}${II(t)}`)}return i}function II(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ay{constructor(e){this._client=e}}Ay._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ry(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Pp=Object.freeze(Object.create(null)),AI=(t=Ry)=>function(n,...r){if(n.length===1)return n[0];let s=!1;const o=[],i=n.reduce((h,p,m)=>{var g,y,_;/[?#]/.test(p)&&(s=!0);const b=r[m];let x=(s?encodeURIComponent:t)(""+b);return m!==r.length&&(b==null||typeof b=="object"&&b.toString===((_=Object.getPrototypeOf((y=Object.getPrototypeOf((g=b.hasOwnProperty)!==null&&g!==void 0?g:Pp))!==null&&y!==void 0?y:Pp))===null||_===void 0?void 0:_.toString))&&(x=b+"",o.push({start:h.length+p.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(b).slice(8,-1)} is not a valid path parameter`})),h+p+(m===r.length?"":x)},""),a=i.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=c.exec(a))!==null;)o.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(o.sort((h,p)=>h.start-p.start),o.length>0){let h=0;const p=o.reduce((m,g)=>{const y=" ".repeat(g.start-h),_="^".repeat(g.length);return h=g.start+g.length,m+y+_},"");throw new zt(`Path parameters result in path with invalid segments:
${o.map(m=>m.error).join(`
`)}
${i}
${p}`)}return i},si=AI(Ry);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Py extends Ay{create(e,n){var r;const{api_version:s=this._client.apiVersion}=e,o=aa(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new zt("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new zt("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(si`/${s}/interactions`,Object.assign(Object.assign({body:o},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){const{api_version:s=this._client.apiVersion}=n??{};return this._client.delete(si`/${s}/interactions/${e}`,r)}cancel(e,n={},r){const{api_version:s=this._client.apiVersion}=n??{};return this._client.post(si`/${s}/interactions/${e}/cancel`,r)}get(e,n={},r){var s;const o=n??{},{api_version:i=this._client.apiVersion}=o,a=aa(o,["api_version"]);return this._client.get(si`/${i}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(s=n==null?void 0:n.stream)!==null&&s!==void 0?s:!1}))}}Py._key=Object.freeze(["interactions"]);class My extends Py{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RI(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}let oi;function yd(t){let e;return(oi??(e=new globalThis.TextEncoder,oi=e.encode.bind(e)))(t)}let ii;function Mp(t){let e;return(ii??(e=new globalThis.TextDecoder,ii=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $a{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?yd(e):e;this.buffer=RI([this.buffer,n]);const r=[];let s;for(;(s=PI(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){r.push(Mp(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,i=Mp(this.buffer.subarray(0,o));r.push(i),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}$a.NEWLINE_CHARS=new Set([`
`,"\r"]);$a.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function PI(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function MI(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const la={off:0,error:200,warn:300,info:400,debug:500},Dp=(t,e,n)=>{if(t){if(fI(la,t))return t;it(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(la))}`)}};function Bs(){}function ai(t,e,n){return!e||la[t]>la[n]?Bs:e[t].bind(e)}const DI={error:Bs,warn:Bs,info:Bs,debug:Bs};let Lp=new WeakMap;function it(t){var e;const n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return DI;const s=Lp.get(n);if(s&&s[0]===r)return s[1];const o={error:ai("error",n,r),warn:ai("warn",n,r),info:ai("info",n,r),debug:ai("debug",n,r)};return Lp.set(n,[r,o]),o}const sr=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zr{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let s=!1;const o=r?it(r):console;function i(){return Xt(this,arguments,function*(){var c,d,h,p;if(s)throw new zt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let m=!1;try{try{for(var g=!0,y=Zt(LI(e,n)),_;_=yield ae(y.next()),c=_.done,!c;g=!0){p=_.value,g=!1;const b=p;if(!m)if(b.data.startsWith("[DONE]")){m=!0;continue}else try{yield yield ae(JSON.parse(b.data))}catch(x){throw o.error("Could not parse message into JSON:",b.data),o.error("From chunk:",b.raw),x}}}catch(b){d={error:b}}finally{try{!g&&!c&&(h=y.return)&&(yield ae(h.call(y)))}finally{if(d)throw d.error}}m=!0}catch(b){if(Vc(b))return yield ae(void 0);throw b}finally{m||n.abort()}})}return new Zr(i,n,r)}static fromReadableStream(e,n,r){let s=!1;function o(){return Xt(this,arguments,function*(){var c,d,h,p;const m=new $a,g=Ty(e);try{for(var y=!0,_=Zt(g),b;b=yield ae(_.next()),c=b.done,!c;y=!0){p=b.value,y=!1;const x=p;for(const w of m.decode(x))yield yield ae(w)}}catch(x){d={error:x}}finally{try{!y&&!c&&(h=_.return)&&(yield ae(h.call(_)))}finally{if(d)throw d.error}}for(const x of m.flush())yield yield ae(x)})}function i(){return Xt(this,arguments,function*(){var c,d,h,p;if(s)throw new zt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let m=!1;try{try{for(var g=!0,y=Zt(o()),_;_=yield ae(y.next()),c=_.done,!c;g=!0){p=_.value,g=!1;const b=p;m||b&&(yield yield ae(JSON.parse(b)))}}catch(b){d={error:b}}finally{try{!g&&!c&&(h=y.return)&&(yield ae(h.call(y)))}finally{if(d)throw d.error}}m=!0}catch(b){if(Vc(b))return yield ae(void 0);throw b}finally{m||n.abort()}})}return new Zr(i,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=o=>({next:()=>{if(o.length===0){const i=r.next();e.push(i),n.push(i)}return o.shift()}});return[new Zr(()=>s(e),this.controller,this.client),new Zr(()=>s(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return Cy({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:s,done:o}=await n.next();if(o)return r.close();const i=yd(JSON.stringify(s)+`
`);r.enqueue(i)}catch(s){r.error(s)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}}function LI(t,e){return Xt(this,arguments,function*(){var r,s,o,i;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new zt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new zt("Attempted to iterate over a response with no body");const a=new jI,c=new $a,d=Ty(t.body);try{for(var h=!0,p=Zt(UI(d)),m;m=yield ae(p.next()),r=m.done,!r;h=!0){i=m.value,h=!1;const g=i;for(const y of c.decode(g)){const _=a.decode(y);_&&(yield yield ae(_))}}}catch(g){s={error:g}}finally{try{!h&&!r&&(o=p.return)&&(yield ae(o.call(p)))}finally{if(s)throw s.error}}for(const g of c.flush()){const y=a.decode(g);y&&(yield yield ae(y))}})}function UI(t){return Xt(this,arguments,function*(){var n,r,s,o;let i=new Uint8Array;try{for(var a=!0,c=Zt(t),d;d=yield ae(c.next()),n=d.done,!n;a=!0){o=d.value,a=!1;const h=o;if(h==null)continue;const p=h instanceof ArrayBuffer?new Uint8Array(h):typeof h=="string"?yd(h):h;let m=new Uint8Array(i.length+p.length);m.set(i),m.set(p,i.length),i=m;let g;for(;(g=MI(i))!==-1;)yield yield ae(i.slice(0,g)),i=i.slice(g)}}catch(h){r={error:h}}finally{try{!a&&!n&&(s=c.return)&&(yield ae(s.call(c)))}finally{if(r)throw r.error}}i.length>0&&(yield yield ae(i))})}class jI{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=FI(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function FI(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function OI(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:o}=e,i=await(async()=>{var a;if(e.options.stream)return it(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Zr.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const c=n.headers.get("content-type"),d=(a=c==null?void 0:c.split(";")[0])===null||a===void 0?void 0:a.trim();return(d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))?await n.json():await n.text()})();return it(t).debug(`[${r}] response parsed`,sr({retryOfRequestLogID:s,url:n.url,status:n.status,body:i,durationMs:Date.now()-o})),i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vd extends Promise{constructor(e,n,r=OI){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new vd(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dy=Symbol("brand.privateNullableHeaders");function*$I(t){if(!t)return;if(Dy in t){const{values:r,nulls:s}=t;yield*r.entries();for(const o of s)yield[o,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Ip(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const o=Ip(r[1])?r[1]:[r[1]];let i=!1;for(const a of o)a!==void 0&&(e&&!i&&(i=!0,yield[s,null]),yield[s,a])}}const js=t=>{const e=new Headers,n=new Set;for(const r of t){const s=new Set;for(const[o,i]of $I(r)){const a=o.toLowerCase();s.has(a)||(e.delete(o),s.add(a)),i===null?(e.delete(o),n.add(a)):(e.append(o,i),n.delete(a))}}return{[Dy]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tl=t=>{var e,n,r,s,o,i;if(typeof globalThis.process<"u")return(r=(n=(e=fk)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(i=(o=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||o===void 0?void 0:o.call(s,t))===null||i===void 0?void 0:i.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ly;class Ga{constructor(e){var n,r,s,o,i,a,c,{baseURL:d=Tl("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:h=(n=Tl("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:p="v1beta"}=e,m=aa(e,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:h,apiVersion:p},m),{baseURL:d||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(r=g.timeout)!==null&&r!==void 0?r:Ga.DEFAULT_TIMEOUT,this.logger=(s=g.logger)!==null&&s!==void 0?s:console;const y="warn";this.logLevel=y,this.logLevel=(i=(o=Dp(g.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:Dp(Tl("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&i!==void 0?i:y,this.fetchOptions=g.fetchOptions,this.maxRetries=(a=g.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(c=g.fetch)!==null&&c!==void 0?c:wI(),this.encoder=SI,this._options=g,this.apiKey=h,this.apiVersion=p,this.clientAdapter=g.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=js([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return js([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return js([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new zt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Fr}`}defaultIdempotencyKey(){return`stainless-node-retry-${iI()}`}makeStatusError(e,n,r,s){return ut.generate(e,n,r,s)}buildURL(e,n,r){const s=!this.baseURLOverridden()&&r||this.baseURL,o=lI(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return dI(i)||(n=Object.assign(Object.assign({},i),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(o.search=this.stringifyQuery(n)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(s=>Object.assign({method:e,path:n},s)))}request(e,n=null){return new vd(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var s,o,i;const a=await e,c=(s=a.maxRetries)!==null&&s!==void 0?s:this.maxRetries;n==null&&(n=c),await this.prepareOptions(a);const{req:d,url:h,timeout:p}=await this.buildRequest(a,{retryCount:c-n});await this.prepareRequest(d,{url:h,options:a});const m="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=r===void 0?"":`, retryOf: ${r}`,y=Date.now();if(it(this).debug(`[${m}] sending request`,sr({retryOfRequestLogID:r,method:a.method,url:h,options:a,headers:d.headers})),!((o=a.signal)===null||o===void 0)&&o.aborted)throw new Hc;const _=new AbortController,b=await this.fetchWithTimeout(h,d,p,_).catch(qc),x=Date.now();if(b instanceof globalThis.Error){const v=`retrying, ${n} attempts remaining`;if(!((i=a.signal)===null||i===void 0)&&i.aborted)throw new Hc;const S=Vc(b)||/timed? ?out/i.test(String(b)+("cause"in b?String(b.cause):""));if(n)return it(this).info(`[${m}] connection ${S?"timed out":"failed"} - ${v}`),it(this).debug(`[${m}] connection ${S?"timed out":"failed"} (${v})`,sr({retryOfRequestLogID:r,url:h,durationMs:x-y,message:b.message})),this.retryRequest(a,n,r??m);throw it(this).info(`[${m}] connection ${S?"timed out":"failed"} - error; no more retries left`),it(this).debug(`[${m}] connection ${S?"timed out":"failed"} (error; no more retries left)`,sr({retryOfRequestLogID:r,url:h,durationMs:x-y,message:b.message})),S?new yy:new Oa({cause:b})}const w=`[${m}${g}] ${d.method} ${h} ${b.ok?"succeeded":"failed"} with status ${b.status} in ${x-y}ms`;if(!b.ok){const v=await this.shouldRetry(b);if(n&&v){const R=`retrying, ${n} attempts remaining`;return await bI(b.body),it(this).info(`${w} - ${R}`),it(this).debug(`[${m}] response error (${R})`,sr({retryOfRequestLogID:r,url:b.url,status:b.status,headers:b.headers,durationMs:x-y})),this.retryRequest(a,n,r??m,b.headers)}const S=v?"error; no more retries left":"error; not retryable";it(this).info(`${w} - ${S}`);const T=await b.text().catch(R=>qc(R).message),E=pI(T),C=E?void 0:T;throw it(this).debug(`[${m}] response error (${S})`,sr({retryOfRequestLogID:r,url:b.url,status:b.status,headers:b.headers,message:C,durationMs:Date.now()-y})),this.makeStatusError(b.status,E,C,b.headers)}return it(this).info(w),it(this).debug(`[${m}] response start`,sr({retryOfRequestLogID:r,url:b.url,status:b.status,headers:b.headers,durationMs:x-y})),{response:b,options:a,controller:_,requestLogID:m,retryOfRequestLogID:r,startTime:y}}async fetchWithTimeout(e,n,r,s){const o=n||{},{signal:i,method:a}=o,c=aa(o,["signal","method"]);i&&i.addEventListener("abort",()=>s.abort());const d=setTimeout(()=>s.abort(),r),h=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,p=Object.assign(Object.assign(Object.assign({signal:s.signal},h?{duplex:"half"}:{}),{method:"GET"}),c);a&&(p.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,p)}finally{clearTimeout(d)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,s){var o;let i;const a=s==null?void 0:s.get("retry-after-ms");if(a){const d=parseFloat(a);Number.isNaN(d)||(i=d)}const c=s==null?void 0:s.get("retry-after");if(c&&!i){const d=parseFloat(c);Number.isNaN(d)?i=Date.parse(c)-Date.now():i=d*1e3}if(!(i&&0<=i&&i<60*1e3)){const d=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,d)}return await mI(i),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const o=n-e,i=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return i*a*1e3}async buildRequest(e,{retryCount:n=0}={}){var r,s,o;const i=Object.assign({},e),{method:a,path:c,query:d,defaultBaseURL:h}=i,p=this.buildURL(c,d,h);"timeout"in i&&hI("timeout",i.timeout),i.timeout=(r=i.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:m,body:g}=this.buildBody({options:i}),y=await this.buildHeaders({options:e,method:a,bodyHeaders:m,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:y},i.signal&&{signal:i.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(o=i.fetchOptions)!==null&&o!==void 0?o:{}),url:p,timeout:i.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:s}){let o={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const i=await this.authHeaders(e);let a=js([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),xI()),this._options.defaultHeaders,r,e.headers,i]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=js([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:_I(e)}:this.encoder({body:e,headers:r})}}Ga.DEFAULT_TIMEOUT=6e4;class qe extends Ga{constructor(){super(...arguments),this.interactions=new My(this)}}Ly=qe;qe.GeminiNextGenAPIClient=Ly;qe.GeminiNextGenAPIClientError=zt;qe.APIError=ut;qe.APIConnectionError=Oa;qe.APIConnectionTimeoutError=yy;qe.APIUserAbortError=Hc;qe.NotFoundError=_y;qe.ConflictError=by;qe.RateLimitError=ky;qe.BadRequestError=vy;qe.AuthenticationError=xy;qe.InternalServerError=Ey;qe.PermissionDeniedError=wy;qe.UnprocessableEntityError=Sy;qe.toFile=NI;qe.Interactions=My;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GI(t,e){const n={},r=u(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function zI(t,e){const n={},r=u(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function BI(t,e){const n={},r=u(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function VI(t,e){const n={},r=u(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function qI(t,e,n){const r={};if(u(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=u(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&f(e,["displayName"],s),u(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=u(t,["epochCount"]);e!==void 0&&o!=null&&f(e,["tuningTask","hyperparameters","epochCount"],o);const i=u(t,["learningRateMultiplier"]);if(i!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],i),u(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(u(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(u(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=u(t,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const c=u(t,["learningRate"]);if(e!==void 0&&c!=null&&f(e,["tuningTask","hyperparameters","learningRate"],c),u(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(u(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function HI(t,e,n){const r={};let s=u(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const g=u(t,["validationDataset"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec"],Up(g))}else if(s==="PREFERENCE_TUNING"){const g=u(t,["validationDataset"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec"],Up(g))}const o=u(t,["tunedModelDisplayName"]);e!==void 0&&o!=null&&f(e,["tunedModelDisplayName"],o);const i=u(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);let a=u(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const g=u(t,["epochCount"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(a==="PREFERENCE_TUNING"){const g=u(t,["epochCount"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let c=u(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const g=u(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(c==="PREFERENCE_TUNING"){const g=u(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let d=u(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const g=u(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(d==="PREFERENCE_TUNING"){const g=u(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let h=u(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const g=u(t,["adapterSize"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(h==="PREFERENCE_TUNING"){const g=u(t,["adapterSize"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(u(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(u(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const p=u(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=u(t,["beta"]);return e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],m),r}function WI(t,e){const n={},r=u(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const s=u(t,["preTunedModel"]);s!=null&&f(n,["preTunedModel"],s);const o=u(t,["trainingDataset"]);o!=null&&sA(o);const i=u(t,["config"]);return i!=null&&qI(i,n),n}function JI(t,e){const n={},r=u(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const s=u(t,["preTunedModel"]);s!=null&&f(n,["preTunedModel"],s);const o=u(t,["trainingDataset"]);o!=null&&oA(o,n,e);const i=u(t,["config"]);return i!=null&&HI(i,n,e),n}function KI(t,e){const n={},r=u(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function YI(t,e){const n={},r=u(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function QI(t,e,n){const r={},s=u(t,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const o=u(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const i=u(t,["filter"]);return e!==void 0&&i!=null&&f(e,["_query","filter"],i),r}function XI(t,e,n){const r={},s=u(t,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const o=u(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const i=u(t,["filter"]);return e!==void 0&&i!=null&&f(e,["_query","filter"],i),r}function ZI(t,e){const n={},r=u(t,["config"]);return r!=null&&QI(r,n),n}function eA(t,e){const n={},r=u(t,["config"]);return r!=null&&XI(r,n),n}function tA(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=u(t,["nextPageToken"]);s!=null&&f(n,["nextPageToken"],s);const o=u(t,["tunedModels"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>Uy(a))),f(n,["tuningJobs"],i)}return n}function nA(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=u(t,["nextPageToken"]);s!=null&&f(n,["nextPageToken"],s);const o=u(t,["tuningJobs"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>Kc(a))),f(n,["tuningJobs"],i)}return n}function rA(t,e){const n={},r=u(t,["name"]);r!=null&&f(n,["model"],r);const s=u(t,["name"]);return s!=null&&f(n,["endpoint"],s),n}function sA(t,e){const n={};if(u(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(u(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=u(t,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(n,["examples","examples"],s)}return n}function oA(t,e,n){const r={};let s=u(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const i=u(t,["gcsUri"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(s==="PREFERENCE_TUNING"){const i=u(t,["gcsUri"]);e!==void 0&&i!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],i)}let o=u(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const i=u(t,["vertexDatasetResource"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(o==="PREFERENCE_TUNING"){const i=u(t,["vertexDatasetResource"]);e!==void 0&&i!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],i)}if(u(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Uy(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=u(t,["name"]);s!=null&&f(n,["name"],s);const o=u(t,["state"]);o!=null&&f(n,["state"],X0(o));const i=u(t,["createTime"]);i!=null&&f(n,["createTime"],i);const a=u(t,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const c=u(t,["tuningTask","completeTime"]);c!=null&&f(n,["endTime"],c);const d=u(t,["updateTime"]);d!=null&&f(n,["updateTime"],d);const h=u(t,["description"]);h!=null&&f(n,["description"],h);const p=u(t,["baseModel"]);p!=null&&f(n,["baseModel"],p);const m=u(t,["_self"]);return m!=null&&f(n,["tunedModel"],rA(m)),n}function Kc(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=u(t,["name"]);s!=null&&f(n,["name"],s);const o=u(t,["state"]);o!=null&&f(n,["state"],X0(o));const i=u(t,["createTime"]);i!=null&&f(n,["createTime"],i);const a=u(t,["startTime"]);a!=null&&f(n,["startTime"],a);const c=u(t,["endTime"]);c!=null&&f(n,["endTime"],c);const d=u(t,["updateTime"]);d!=null&&f(n,["updateTime"],d);const h=u(t,["error"]);h!=null&&f(n,["error"],h);const p=u(t,["description"]);p!=null&&f(n,["description"],p);const m=u(t,["baseModel"]);m!=null&&f(n,["baseModel"],m);const g=u(t,["tunedModel"]);g!=null&&f(n,["tunedModel"],g);const y=u(t,["preTunedModel"]);y!=null&&f(n,["preTunedModel"],y);const _=u(t,["supervisedTuningSpec"]);_!=null&&f(n,["supervisedTuningSpec"],_);const b=u(t,["preferenceOptimizationSpec"]);b!=null&&f(n,["preferenceOptimizationSpec"],b);const x=u(t,["tuningDataStats"]);x!=null&&f(n,["tuningDataStats"],x);const w=u(t,["encryptionSpec"]);w!=null&&f(n,["encryptionSpec"],w);const v=u(t,["partnerModelTuningSpec"]);v!=null&&f(n,["partnerModelTuningSpec"],v);const S=u(t,["customBaseModel"]);S!=null&&f(n,["customBaseModel"],S);const T=u(t,["experiment"]);T!=null&&f(n,["experiment"],T);const E=u(t,["labels"]);E!=null&&f(n,["labels"],E);const C=u(t,["outputUri"]);C!=null&&f(n,["outputUri"],C);const P=u(t,["pipelineJob"]);P!=null&&f(n,["pipelineJob"],P);const R=u(t,["serviceAccount"]);R!=null&&f(n,["serviceAccount"],R);const I=u(t,["tunedModelDisplayName"]);I!=null&&f(n,["tunedModelDisplayName"],I);const V=u(t,["veoTuningSpec"]);return V!=null&&f(n,["veoTuningSpec"],V),n}function iA(t,e){const n={},r=u(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=u(t,["name"]);s!=null&&f(n,["name"],s);const o=u(t,["metadata"]);o!=null&&f(n,["metadata"],o);const i=u(t,["done"]);i!=null&&f(n,["done"],i);const a=u(t,["error"]);return a!=null&&f(n,["error"],a),n}function Up(t,e){const n={},r=u(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const s=u(t,["vertexDatasetResource"]);return s!=null&&f(n,["validationDatasetUri"],s),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aA extends kn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Er(_n.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const s={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(s.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:s});return o.baseModel=void 0,await this.tuneInternal(o)}else{const s=Object.assign({},n);return await this.tuneInternal(s)}else{const s=Object.assign({},n),o=await this.tuneMldevInternal(s);let i="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?i=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(i=o.name.split("/operations/")[0]),{name:i,state:jc.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=YI(e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>Kc(h))}else{const d=KI(e);return a=$("{name}",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>Uy(h))}}async listInternal(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=eA(e);return a=$("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=nA(h),m=new lp;return Object.assign(m,p),m})}else{const d=ZI(e);return a=$("tunedModels",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=tA(h),m=new lp;return Object.assign(m,p),m})}}async cancel(e){var n,r,s,o;let i,a="",c={};if(this.apiClient.isVertexAI()){const d=zI(e);return a=$("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=VI(h),m=new cp;return Object.assign(m,p),m})}else{const d=GI(e);return a=$("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=BI(h),m=new cp;return Object.assign(m,p),m})}}async tuneInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=JI(e,e);return o=$("tuningJobs",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),s.then(c=>Kc(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=WI(e);return o=$("tunedModels",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),s.then(c=>iA(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lA{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const cA=1024*1024*8,uA=3,dA=1e3,fA=2,ca="x-goog-upload-status";async function hA(t,e,n){var r;const s=await jy(t,e,n),o=await(s==null?void 0:s.json());if(((r=s==null?void 0:s.headers)===null||r===void 0?void 0:r[ca])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function pA(t,e,n){var r;const s=await jy(t,e,n),o=await(s==null?void 0:s.json());if(((r=s==null?void 0:s.headers)===null||r===void 0?void 0:r[ca])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const i=H0(o),a=new dd;return Object.assign(a,i),a}async function jy(t,e,n){var r,s;let o=0,i=0,a=new Fc(new Response),c="upload";for(o=t.size;i<o;){const d=Math.min(cA,o-i),h=t.slice(i,i+d);i+d>=o&&(c+=", finalize");let p=0,m=dA;for(;p<uA&&(a=await n.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(i),"Content-Length":String(d)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[ca]));)p++,await gA(m),m=m*fA;if(i+=d,((s=a==null?void 0:a.headers)===null||s===void 0?void 0:s[ca])!=="active")break;if(o<=i)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function mA(t){return{size:t.size,type:t.type}}function gA(t){return new Promise(e=>setTimeout(e,t))}class yA{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await hA(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await pA(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await mA(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vA{create(e,n,r){return new xA(e,n,r)}}class xA{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jp="x-goog-api-key";class wA{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(jp)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(jp,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _A="gl-node/";class za{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new qe({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=gk(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new wA(this.apiKey);this.apiClient=new mN({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:_A+"web",uploader:new yA,downloader:new lA}),this.models=new DN(this.apiClient),this.live=new NN(this.apiClient,s,new vA),this.batches=new qE(this.apiClient),this.chats=new C1(this.models,this.apiClient),this.caches=new S1(this.apiClient),this.files=new U1(this.apiClient),this.operations=new LN(this.apiClient),this.authTokens=new QN(this.apiClient),this.tunings=new aA(this.apiClient),this.fileSearchStores=new oI(this.apiClient)}}const bA=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",Fy=()=>{const t=bA();return console.log("Gemini Key Detected:","Yes",`(Length: ${t.length})`),new za({apiKey:t})},Oy=`
You are an expert AI nutritionist and mathematical calculator. 

SCENARIO 1: IMAGE/TEXT ESTIMATION
- Analyze food descriptions or images.
- Provide a detailed "receipt" breakdown of every ingredient.
- Estimate weights in grams (g) and calculate nutrition.

SCENARIO 2: STRICT RECALCULATION (User provided weights)
- If a list of ingredients with specific weights (grams) is provided, you MUST act as a precise calculator.
- IGNORE your previous estimations.
- Use the provided weights as the ABSOLUTE GROUND TRUTH.
- Calculate calories and macros strictly based on these weights.
- Return the recalculated totals.
`,$y=t=>{const e=(t==null?void 0:t.message)||String(t)||"",n=e.toLowerCase();return e.includes("429")||n.includes("quota")||n.includes("limit")||n.includes("exhausted")?"AI Limit Reached: You've sent too many requests. Please wait about 60 seconds for the quota to reset.":n.includes("api key")?"Configuration Error: Invalid API key. Please check your settings.":n.includes("network")||n.includes("fetch")?"Connection Error: Please check your internet connection and try again.":e||"An unexpected AI error occurred."};async function xd(t,e=2,n=2e3){try{return await t()}catch(r){const s=(r==null?void 0:r.message)||"";if((s.includes("429")||s.toLowerCase().includes("quota"))&&e>0)return console.warn(`Gemini Quota hit. Retrying in ${n}ms... (${e} retries left)`),await new Promise(i=>setTimeout(i,n)),xd(t,e-1,n*2);throw r}}const SA=async t=>{try{return await xd(async()=>{const n=await Fy().models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{mimeType:"image/jpeg",data:t}},{text:"Analyze this image. Breakdown into ingredients, weights in grams, calories, and total nutrition."}]},config:{systemInstruction:Oy,responseMimeType:"application/json",responseSchema:{type:oe.OBJECT,properties:{item:{type:oe.STRING},calories:{type:oe.INTEGER},protein:{type:oe.INTEGER},carbs:{type:oe.INTEGER},fat:{type:oe.INTEGER},confidence:{type:oe.NUMBER},ingredients:{type:oe.ARRAY,items:{type:oe.OBJECT,properties:{name:{type:oe.STRING},grams:{type:oe.INTEGER},calories:{type:oe.INTEGER}},required:["name","grams","calories"]}}},required:["item","calories","protein","carbs","fat","confidence","ingredients"]}}});return JSON.parse(n.text||"{}")})}catch(e){throw console.error("Gemini Analysis Error:",e),new Error($y(e))}},Fp=async(t,e)=>{try{return await xd(async()=>{let n="";e&&e.length>0?n=`USER MANUAL WEIGHT CORRECTION:
        The following ingredients have been updated with exact weights. 
        Perform a mathematical calculation for the nutrition of each item based strictly on these grams:
        
        ${e.map(i=>`- ${i.name}: ${i.grams}g`).join(`
`)}
        
        CRITICAL: 
        1. Calculate calories/macros from scratch for each item.
        2. Sum the totals.
        3. Do not adjust the weights provided.
        4. Return the new AnalysisResult.`:n=`Estimate nutrition for: "${t}".`;const s=await Fy().models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:n}]}],config:{systemInstruction:Oy,responseMimeType:"application/json",responseSchema:{type:oe.OBJECT,properties:{item:{type:oe.STRING},calories:{type:oe.INTEGER},protein:{type:oe.INTEGER},carbs:{type:oe.INTEGER},fat:{type:oe.INTEGER},confidence:{type:oe.NUMBER},ingredients:{type:oe.ARRAY,items:{type:oe.OBJECT,properties:{name:{type:oe.STRING},grams:{type:oe.INTEGER},calories:{type:oe.INTEGER}},required:["name","grams","calories"]}}},required:["item","calories","protein","carbs","fat","confidence","ingredients"]}}});return JSON.parse(s.text||"{}")})}catch(n){throw console.error("Gemini Text Analysis Error:",n),new Error($y(n))}};let li;const kA=new Uint8Array(16);function EA(){if(!li&&(li=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!li))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return li(kA)}const Ke=[];for(let t=0;t<256;++t)Ke.push((t+256).toString(16).slice(1));function CA(t,e=0){return Ke[t[e+0]]+Ke[t[e+1]]+Ke[t[e+2]]+Ke[t[e+3]]+"-"+Ke[t[e+4]]+Ke[t[e+5]]+"-"+Ke[t[e+6]]+Ke[t[e+7]]+"-"+Ke[t[e+8]]+Ke[t[e+9]]+"-"+Ke[t[e+10]]+Ke[t[e+11]]+Ke[t[e+12]]+Ke[t[e+13]]+Ke[t[e+14]]+Ke[t[e+15]]}const TA=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Op={randomUUID:TA};function Gy(t,e,n){if(Op.randomUUID&&!t)return Op.randomUUID();t=t||{};const r=t.random||(t.rng||EA)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,CA(r)}const zy=({isActive:t,onComplete:e,message:n="Analyzing Meal..."})=>{const[r,s]=k.useState(0);if(k.useEffect(()=>{t&&s(0)},[t]),k.useEffect(()=>{if(!t)return;const h=setInterval(()=>{s(p=>{if(p>=92)return 92;const m=p<30?2:p<60?1:.5;return Math.min(p+m,92)})},70);return()=>clearInterval(h)},[t]),k.useEffect(()=>{},[t]),!t)return null;const o=60,i=6,a=o-i*2,c=a*2*Math.PI,d=c-r/100*c;return l.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center pointer-events-none",children:[l.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity"}),l.jsxs("div",{className:"relative bg-[#1a1c26]/95 backdrop-blur-xl p-8 rounded-[40px] border border-white/10 shadow-2xl pointer-events-auto flex flex-col items-center animate-in zoom-in-95 duration-300 min-w-[300px]",children:[l.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 bg-royal-500/20 blur-3xl rounded-full animate-pulse pointer-events-none"}),l.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center mb-6",children:[l.jsx("div",{className:"absolute inset-0 border-4 border-royal-500/10 rounded-full border-t-royal-500/30 animate-[spin_3s_linear_infinite]"}),l.jsxs("svg",{height:o*2,width:o*2,className:"rotate-[-90deg] drop-shadow-[0_0_10px_rgba(124,58,237,0.3)]",children:[l.jsx("circle",{stroke:"rgba(255,255,255,0.1)",strokeWidth:i,fill:"transparent",r:a,cx:o,cy:o}),l.jsx("circle",{stroke:"url(#gradient)",strokeWidth:i,strokeDasharray:c+" "+c,style:{strokeDashoffset:d,transition:"stroke-dashoffset 0.1s linear"},strokeLinecap:"round",fill:"transparent",r:a,cx:o,cy:o}),l.jsx("defs",{children:l.jsxs("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[l.jsx("stop",{offset:"0%",stopColor:"#7c3aed"})," ",l.jsx("stop",{offset:"100%",stopColor:"#a78bfa"})," "]})})]}),l.jsx("div",{className:"absolute flex flex-col items-center justify-center text-white",children:l.jsxs("span",{className:"text-3xl font-black tracking-tighter tabular-nums text-transparent bg-clip-text bg-gradient-to-br from-white to-white/70",children:[Math.round(r),"%"]})})]}),l.jsxs("div",{className:"text-center space-y-2 relative z-10",children:[l.jsxs("h3",{className:"text-lg font-bold text-white tracking-tight flex items-center justify-center gap-2",children:[l.jsx(wt,{size:18,className:"text-yellow-400 animate-pulse"}),n]}),l.jsx("p",{className:"text-xs text-white/50 font-medium",children:"Identifying ingredients..."})]})]})]})},Yc="snapcal_streak_v1",Qc="snapcal_weight_goal_v1",NA=3,IA=7700,AA=75,RA=63,PA={sedentary:1.2,light:1.375,moderate:1.55,very:1.725,extra:1.9},MA=t=>{try{const e=localStorage.getItem(Yc);return e&&JSON.parse(e)[t]||null}catch{return null}},By=(t,e)=>{try{const n=localStorage.getItem(Yc),r=n?JSON.parse(n):{};r[t]=e,localStorage.setItem(Yc,JSON.stringify(r))}catch(n){console.error("Failed to save streak data:",n)}},DA=t=>{try{const e=localStorage.getItem(Qc);return e&&JSON.parse(e)[t]||null}catch{return null}},LA=(t,e)=>{try{const n=localStorage.getItem(Qc),r=n?JSON.parse(n):{};r[t]=e,localStorage.setItem(Qc,JSON.stringify(r))}catch(n){console.error("Failed to save weight goal:",n)}},Vy=async()=>{const t=await he();if(!t)return Xc();const e=MA(t.id);if(e)return e;if(le)try{const{data:n,error:r}=await ue.from("user_streaks").select("*").eq("user_id",t.id).single();if(!r&&n){const s={currentStreak:n.current_streak,longestStreak:n.longest_streak,lastLogDate:n.last_log_date,streakFreezes:n.streak_freezes,lastFreezeUsedDate:n.last_freeze_used_date,qualifyingDates:n.qualifying_dates||[]};return By(t.id,s),s}}catch(n){console.warn("Failed to fetch streak from Supabase:",n)}return Xc()},Xc=()=>({currentStreak:0,longestStreak:0,lastLogDate:null,streakFreezes:1,lastFreezeUsedDate:null,qualifyingDates:[]}),UA=async t=>await he()?(await ad()).filter(s=>s.date===t).length>=NA:!1,jA=async()=>{if(!await he())return Xc();const e=Qn(),n=await UA(e),r=await Vy();if(!n||r.qualifyingDates.includes(e))return r;const s=FA(),o=r.qualifyingDates.includes(s),i=r.lastFreezeUsedDate===s;let a;r.lastLogDate===null?a=1:o||i?a=r.currentStreak+1:r.lastLogDate===e?a=r.currentStreak:a=1;const c={currentStreak:a,longestStreak:Math.max(r.longestStreak,a),lastLogDate:e,streakFreezes:r.streakFreezes,lastFreezeUsedDate:r.lastFreezeUsedDate,qualifyingDates:[...r.qualifyingDates.slice(-30),e]};return await OA(c),window.dispatchEvent(new CustomEvent("streak-updated",{detail:c})),c},FA=()=>{const t=new Date;return t.setDate(t.getDate()-1),t.toISOString().split("T")[0]},OA=async t=>{const e=await he();if(e){if(By(e.id,t),le)try{await ue.from("user_streaks").upsert({user_id:e.id,current_streak:t.currentStreak,longest_streak:t.longestStreak,last_log_date:t.lastLogDate,streak_freezes:t.streakFreezes,last_freeze_used_date:t.lastFreezeUsedDate,qualifying_dates:t.qualifyingDates},{onConflict:"user_id"})}catch(n){console.warn("Failed to sync streak to Supabase:",n)}ct.invalidate($t.STREAK_DATA)}},$A=async()=>{const t=await he(),e=await Yn(),n=await ks(),r=e==null?void 0:e.targetWeight,s=r&&r>0?r:RA,o={startWeight:(e==null?void 0:e.weight)||AA,targetWeight:s,dailyCalorieLimit:n};if(!t)return o;const i=DA(t.id);return i?{...i,targetWeight:s,dailyCalorieLimit:n}:(LA(t.id,o),o)},GA=async()=>{const t=await Yn();if(!t||!t.weight||!t.height)return 2e3;const e=t.weight,n=t.height,r=t.age||25,s=t.gender!=="female";let o;s?o=10*e+6.25*n-5*r+5:o=10*e+6.25*n-5*r-161;const i=t.activityLevel||"sedentary",a=PA[i]||1.2;return Math.round(o*a)},zA=async()=>{const t=await Yn(),e=await $A(),n=await GA(),r=(t==null?void 0:t.weight)||e.startWeight,s=e.targetWeight,o=e.dailyCalorieLimit,i=n-o;if(i<=0||r<=s)return r<=s?{targetWeight:s,currentWeight:r,dailyDeficit:0,estimatedDate:new Date,daysRemaining:0,progressPercentage:100}:null;const c=(r-s)*IA,d=Math.ceil(c/i),h=new Date;h.setDate(h.getDate()+d);const p=e.startWeight-s,m=e.startWeight-r,g=p>0?Math.min(100,Math.max(0,m/p*100)):0;return{targetWeight:s,currentWeight:r,dailyDeficit:i,estimatedDate:h,daysRemaining:d,progressPercentage:g}},BA=t=>{if(t.daysRemaining===0)return" Congratulations! You've reached your goal!";const e={month:"long",day:"numeric",year:"numeric"},n=t.estimatedDate.toLocaleDateString("en-US",e);return`Keep this up, and you'll hit ${t.targetWeight}kg by ${n}!`};var Dt=(t=>(t.OPTIMAL="optimal",t.WARNING="warning",t.CRITICAL="critical",t))(Dt||{});const $p=3,Gp=18,wd="snapcal_last_log_timestamp",VA=()=>{try{return localStorage.getItem(wd)}catch{return null}},qA=()=>{try{localStorage.setItem(wd,new Date().toISOString()),window.dispatchEvent(new CustomEvent("avatar-state-changed"))}catch(t){console.error("Failed to update last log timestamp:",t)}},HA=t=>{if(!t)return 1/0;try{const e=new Date(t);return(new Date().getTime()-e.getTime())/(1e3*60*60)}catch{return 1/0}},WA=async()=>{const t=await he(),e={state:"critical",lastLogTimestamp:null,todayCalories:0,calorieLimit:1600,mealsLogged:0,hoursSinceLastLog:1/0,stateReason:"No logging activity detected"};if(!t)return e;const n=await ad(),r=Qn(),s=n.filter(m=>m.date===r),o=s.reduce((m,g)=>m+g.calories,0),i=s.length,a=await ks();let c=VA();if(!c&&n.length>0){const m=[...n].sort((g,y)=>{const _=new Date(`${g.date}T${g.time||"00:00"}`);return new Date(`${y.date}T${y.time||"00:00"}`).getTime()-_.getTime()});if(m.length>0){const g=m[0];c=new Date(`${g.date}T${g.time||"00:00"}`).toISOString();try{localStorage.setItem(wd,c)}catch{}}}const d=HA(c),{state:h,reason:p}=JA({todayCalories:o,calorieLimit:a,mealsLogged:i,hoursSinceLastLog:d});return{state:h,lastLogTimestamp:c,todayCalories:o,calorieLimit:a,mealsLogged:i,hoursSinceLastLog:d,stateReason:p}},JA=t=>{const{todayCalories:e,calorieLimit:n,mealsLogged:r,hoursSinceLastLog:s}=t;return s>Gp?{state:"critical",reason:`No activity for ${s===1/0?"a long time":`${Math.floor(s)} hours`}`}:e>n?{state:"warning",reason:`Over calorie limit by ${e-n} kcal`}:r>0&&r<$p?{state:"warning",reason:`Only ${r} meal(s) logged today`}:r===0&&s<=Gp?{state:"warning",reason:"No meals logged today yet"}:e<=n&&r>=$p?{state:"optimal",reason:"Great job! All meals logged and within limit"}:{state:"warning",reason:"Keep logging your meals!"}},KA=()=>{window.dispatchEvent(new CustomEvent("avatar-feed",{detail:{timestamp:Date.now()}})),qA()},YA=t=>(window.addEventListener("avatar-state-changed",t),window.addEventListener("avatar-feed",t),window.addEventListener("food-entry-updated",t),()=>{window.removeEventListener("avatar-state-changed",t),window.removeEventListener("avatar-feed",t),window.removeEventListener("food-entry-updated",t)}),QA=(t,e=600,n=150,r=!1)=>new Promise((s,o)=>{const i=t.size/1048576,a=new FileReader;a.readAsDataURL(t),a.onload=c=>{var h;const d=new Image;d.src=(h=c.target)==null?void 0:h.result,d.onload=()=>{const p=document.createElement("canvas");let m=d.width,g=d.height;m>e&&(g=e/m*g,m=e),p.width=m,p.height=g;const y=p.getContext("2d");y==null||y.drawImage(d,0,0,m,g);let _=.5,b=p.toDataURL("image/jpeg",_);const x=n*1024;if(b.split(",")[1].length*3/4>x&&(_=.35,b=p.toDataURL("image/jpeg",_),b.split(",")[1].length*3/4>x&&(_=.25,b=p.toDataURL("image/jpeg",_))),r){const S=b.split(",")[1].length*3/4/1024,T=(i*1024-S)/(i*1024)*100;console.log(` Image Optimization:
Original: ${i.toFixed(2)} MB(${d.width}${d.height}px)
Optimized: ${S.toFixed(0)} KB(${Math.round(m)}${Math.round(g)}px)
Quality: ${(_*100).toFixed(0)}%
  Saved: ${T.toFixed(0)}% `)}s(b)},d.onerror=p=>o(p)},a.onerror=c=>o(c)}),qy=({onClose:t,onSuccess:e,onOpenSharedMeal:n,editEntry:r})=>{const[s,o]=k.useState("scan"),[i,a]=k.useState(r?"details":"upload"),[c,d]=k.useState((r==null?void 0:r.imageUrl)||null),[h,p]=k.useState(!1),[m,g]=k.useState(!1),[y,_]=k.useState(!1),[b,x]=k.useState(null),w=k.useRef(null),[v,S]=k.useState(""),T=new Date,E=`${T.getHours().toString().padStart(2,"0")}:${T.getMinutes().toString().padStart(2,"0")} `,[C,P]=k.useState((r==null?void 0:r.date)||Qn()),[R,I]=k.useState((r==null?void 0:r.time)||E),[V,Y]=k.useState((r==null?void 0:r.food_item)||""),[Q,N]=k.useState((r==null?void 0:r.calories.toString())||""),[q,B]=k.useState((r==null?void 0:r.protein.toString())||""),[X,M]=k.useState((r==null?void 0:r.carbs.toString())||""),[F,j]=k.useState((r==null?void 0:r.fat.toString())||""),[J,U]=k.useState((r==null?void 0:r.ingredients)||[]),[Z,te]=k.useState((r==null?void 0:r.confidence)||null),[ce,D]=k.useState((r==null?void 0:r.originalAiResponse)||null),ie=async z=>{if(z.target.files&&z.target.files[0]){const Me=z.target.files[0];try{const A=await QA(Me,600,150,!0);d(A),x(null)}catch{x("Failed to process image.")}}},fe=async()=>{if(c){p(!0),x(null);try{const z=c.split(",")[1],Me=await SA(z);Rt(Me),D(Me),a("details")}catch(z){x(z.message)}finally{p(!1)}}},Ae=async()=>{if(v.trim()){p(!0),x(null);try{const z=await Fp(v);Rt(z),D(z),a("details")}catch(z){x(z.message)}finally{p(!1)}}},Rt=z=>{Y(z.item),N(z.calories.toString()),B(z.protein.toString()),M(z.carbs.toString()),j(z.fat.toString()),U(z.ingredients||[]),te(z.confidence)},ln=async()=>{g(!0),x(null);try{const z=await Fp(V,J);Rt(z)}catch(z){x(z.message)}finally{g(!1)}},cn=(z,Me,A)=>{const O=[...J];if(Me==="grams"||Me==="calories"){const ee=A===""?0:parseInt(A);O[z]={...O[z],[Me]:isNaN(ee)?0:ee}}else O[z]={...O[z],[Me]:A};U(O)},He=z=>{U(J.filter((Me,A)=>A!==z))},Ue=()=>{U([...J,{name:"",grams:100,calories:0}])},Cn=async()=>{if(!V.trim()||!Q){x("Please fill required fields.");return}try{const[z,Me,A]=C.split("-").map(Number),[O,ee]=R.split(":").map(Number),ne=new Date(z,Me-1,A,O,ee);if(isNaN(ne.getTime()))throw new Error("Invalid date or time selected.");const ge=ne.toISOString(),ye=Number(Q),be=Number(q)||0,ze=Number(X)||0,ht=Number(F)||0;if(isNaN(ye))throw new Error("Calories must be a valid number.");const pt={id:(r==null?void 0:r.id)||Gy(),timestamp:ge,date:C,time:R,food_item:V,calories:ye,protein:be,carbs:ze,fat:ht,confidence:Z||1,imageUrl:c||void 0,ingredients:J,originalAiResponse:ce};_(!0),x(null),await O0(pt),await jA(),KA(),e()}catch(z){console.error("Save failed:",z),x(z.message||"Failed to save record.")}finally{_(!1)}},un=b==null?void 0:b.includes("Limit Reached"),We=b==null?void 0:b.includes("Database Quota"),G=b==null?void 0:b.includes("Browser Storage Full");return l.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:[l.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] w-full max-w-md rounded-[40px] p-6 shadow-2xl border border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300 max-h-[95vh] overflow-y-auto no-scrollbar",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[i==="details"&&!r&&l.jsx("button",{onClick:()=>a("upload"),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-white/10 transition-all active:scale-95",children:l.jsx(_r,{size:24,className:"text-gray-900 dark:text-gray-50"})}),l.jsx("h2",{className:"text-3xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:r?"Edit Record":i==="upload"?"Track Meal":"Meal Receipt"})]}),l.jsx("button",{onClick:t,className:"p-2.5 bg-gray-100 dark:bg-white/10 rounded-full hover:bg-gray-200 dark:hover:bg-white/20 transition-all active:scale-90",children:l.jsx(Tt,{size:22,className:"text-gray-600 dark:text-gray-400"})})]}),b&&l.jsxs("div",{className:`mb-4 p-4 rounded-3xl flex flex-col gap-3 animate-in shake-1 duration-300 ${un?"bg-amber-50 dark:bg-amber-950/30 border border-amber-100 dark:border-amber-900/30 text-amber-700 dark:text-amber-400":We||G?"bg-orange-50 dark:bg-orange-950/30 border border-orange-100 dark:border-orange-900/30 text-orange-700 dark:text-orange-400":"bg-red-50 dark:bg-red-950/20 border border-red-100 dark:border-red-900/30 text-red-600 dark:text-red-400"} `,children:[l.jsxs("div",{className:"flex items-start gap-3",children:[un?l.jsx(Gw,{className:"shrink-0 mt-0.5",size:18}):We||G?l.jsx(l0,{className:"shrink-0 mt-0.5",size:18}):l.jsx(Ku,{className:"shrink-0 mt-0.5",size:18}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:un?"AI limit reached":G?"Phone Storage Full":We?"Cloud Storage Full":"Action Failed"}),l.jsx("p",{className:"text-xs font-semibold leading-relaxed",children:b})]})]}),!G&&(un||!We)&&l.jsxs("button",{onClick:()=>{x(null),i==="upload"?fe():ln()},className:"w-full py-2 bg-white/50 dark:bg-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-white/80 dark:hover:bg-white/20 transition-all",children:[l.jsx(t_,{size:14})," Try Again"]}),G&&l.jsx("div",{className:"pt-2 border-t border-orange-200 dark:border-orange-900/40",children:l.jsx("p",{className:"text-[10px] font-medium text-orange-600/70 dark:text-orange-400/70 italic",children:"Tip: Photos take up the most space. Delete old entries in the History tab to free up browser storage."})})]}),i==="upload"?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex p-1.5 bg-gray-100/80 dark:bg-white/5 rounded-[24px] backdrop-blur-sm border border-black/5 dark:border-white/5",children:[l.jsxs("button",{onClick:()=>o("scan"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="scan"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[l.jsx(pr,{size:18,className:s==="scan"?"animate-pulse":""}),l.jsx("span",{children:"Scan"})]}),l.jsxs("button",{onClick:()=>o("chat"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="chat"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[l.jsx(Ww,{size:18}),l.jsx("span",{children:"Chat"})]}),l.jsxs("button",{onClick:()=>o("shared"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="shared"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[l.jsx(Sc,{size:18}),l.jsx("span",{children:"Shared"})]}),l.jsxs("button",{onClick:()=>o("recipe"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="recipe"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[l.jsx(Yi,{size:18}),l.jsx("span",{children:"Recipe"})]})]}),s==="scan"&&l.jsxs(l.Fragment,{children:[c?l.jsxs("div",{className:"rounded-[32px] overflow-hidden h-64 relative mb-6 shadow-xl border border-white/10",children:[l.jsx("img",{src:c,className:"w-full h-full object-cover"}),l.jsx("button",{onClick:()=>d(null),className:"absolute top-4 right-4 bg-black/40 text-white p-2 rounded-full backdrop-blur-md",children:l.jsx(Tt,{size:20})})]}):l.jsxs("div",{onClick:()=>{var z;return(z=w.current)==null?void 0:z.click()},className:"border-2 border-dashed border-gray-200 dark:border-white/10 rounded-[32px] h-64 flex flex-col items-center justify-center cursor-pointer hover:border-royal-400 hover:bg-royal-50 dark:hover:bg-white/5 transition-all group",children:[l.jsx(pr,{size:48,className:"text-gray-300 group-hover:text-royal-600 mb-4 transition-colors"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-50 font-bold",children:"Snap or Upload Photo"}),l.jsx("p",{className:"text-gray-400 text-xs mt-1 italic",children:"Let AI do the calorie math"})]}),l.jsx("input",{type:"file",ref:w,accept:"image/*",onChange:ie,className:"hidden"}),l.jsx(Le,{className:"w-full py-5 text-lg font-black",disabled:!c||h,isLoading:h,onClick:fe,children:"Analyze Plate"})]}),s==="chat"&&l.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[l.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 p-5 rounded-[32px] border border-royal-100 dark:border-royal-900/30 transition-colors",children:[l.jsxs("p",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[l.jsx(wt,{size:14})," Describe your meal"]}),l.jsx("textarea",{value:v,onChange:z=>S(z.target.value),placeholder:"e.g. I had two slices of pepperoni pizza and a small Caesar salad with Italian dressing.",rows:4,className:"w-full bg-transparent border-none outline-none text-gray-900 dark:text-white font-medium text-sm resize-none placeholder-gray-400 dark:placeholder-gray-600"})]}),l.jsx(Le,{className:"w-full py-5 text-lg font-black shadow-xl shadow-royal-200",disabled:!v.trim()||h,isLoading:h,onClick:Ae,children:"Ask AI"})]}),s==="recipe"&&l.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300 text-center py-6",children:[l.jsx(Yi,{size:40,className:"mx-auto text-royal-400 mb-2"}),l.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"Recipe Mode Coming Soon"}),l.jsx("p",{className:"text-xs font-medium text-gray-400 px-8",children:"For now, use Chat mode to describe your recipe ingredients for estimation."}),l.jsx(Le,{className:"w-full py-3 mt-4 text-xs font-bold text-gray-400 hover:text-royal-500 bg-gray-50 dark:bg-white/5",onClick:()=>a("details"),children:"Enter Details Manually"})]}),s==="shared"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 p-4 rounded-[24px] mb-6 border border-royal-100 dark:border-royal-900/30 flex gap-3 items-start",children:[l.jsx("div",{className:"p-2 bg-royal-100 dark:bg-royal-900/50 rounded-full shrink-0",children:l.jsx(Sc,{size:16,className:"text-royal-600 dark:text-royal-400"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-white mb-1",children:"Shared Meal Mode"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed",children:"Upload a photo of the entire table. Connect directly to our multi-dish analysis engine."})]})]}),c?l.jsxs("div",{className:"rounded-[32px] overflow-hidden h-64 relative mb-6 shadow-xl border border-white/10 shadow-royal-200/20",children:[l.jsx("img",{src:c,className:"w-full h-full object-cover",alt:"preview"}),l.jsx("button",{onClick:()=>d(null),className:"absolute top-4 right-4 bg-black/40 text-white p-2 rounded-full backdrop-blur-md hover:bg-black/60 transition-colors",children:l.jsx(Tt,{size:20})}),l.jsx("div",{className:"absolute bottom-4 left-4 right-4 bg-black/60 backdrop-blur-md p-3 rounded-2xl border border-white/10",children:l.jsxs("p",{className:"text-white text-xs font-semibold text-center flex items-center justify-center gap-2",children:[l.jsx(wt,{size:14,className:"text-yellow-400"}),"Ready to analyze dishes"]})})]}):l.jsxs("div",{onClick:()=>{var z;return(z=w.current)==null?void 0:z.click()},className:"border-2 border-dashed border-gray-200 dark:border-white/10 rounded-[32px] h-64 flex flex-col items-center justify-center cursor-pointer hover:border-royal-400 hover:bg-royal-50 dark:hover:bg-white/5 transition-all group",children:[l.jsx(pr,{size:48,className:"text-gray-300 group-hover:text-royal-600 mb-4 transition-colors"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-50 font-bold",children:"Snap or Upload Photo"}),l.jsx("p",{className:"text-gray-400 text-xs mt-1 italic",children:"Capture the whole table"})]}),l.jsx("input",{type:"file",ref:w,accept:"image/*",onChange:ie,className:"hidden"}),l.jsx("div",{className:"flex gap-3",children:l.jsx(Le,{className:"w-full py-5 text-lg font-black shadow-xl shadow-royal-200 dark:shadow-none bg-emerald-500 hover:bg-emerald-600 text-white",disabled:!c,onClick:()=>n(c||void 0),children:"Start Shared Meal"})})]}),s!=="recipe"&&s!=="shared"&&l.jsxs("button",{onClick:()=>a("details"),className:"w-full py-4 text-sm font-bold text-gray-400 dark:text-gray-500 hover:text-royal-500 transition-all flex items-center justify-center gap-2 group",children:[l.jsx("span",{children:"Enter Details Manually"}),l.jsx(_r,{size:16,className:"rotate-180 opacity-0 group-hover:opacity-100 transition-all transform -translate-x-1 group-hover:translate-x-0"})]})]}):l.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"bg-royal-600 rounded-[32px] p-6 text-white shadow-xl shadow-royal-200 dark:shadow-none",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-royal-100 text-[10px] font-black uppercase tracking-widest mb-1",children:"Estimated Calories"}),l.jsxs("div",{className:"flex items-baseline gap-1",children:[l.jsx("input",{type:"number",value:Q,onChange:z=>N(z.target.value),className:"bg-transparent text-4xl font-black w-24 outline-none border-b-2 border-white/20 focus:border-white transition-colors"}),l.jsx("span",{className:"text-xl font-bold opacity-70",children:"kcal"})]})]}),l.jsx("div",{className:"bg-white/20 p-3 rounded-2xl backdrop-blur-md",children:l.jsx(Ju,{size:24})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{className:"bg-white/10 rounded-xl p-3 flex flex-col items-center",children:[l.jsxs("div",{className:"relative w-full",children:[l.jsx("input",{type:"number",value:q,onChange:z=>B(z.target.value),className:"bg-transparent text-xs font-black w-full outline-none border-b border-white/20 focus:border-white transition-colors text-center pb-1"}),l.jsx("span",{className:"absolute -bottom-0 right-0 text-[10px] font-bold opacity-50",children:"g"})]}),l.jsx("span",{className:"text-[8px] uppercase tracking-tighter opacity-70 mt-1",children:"Protein"})]}),l.jsxs("div",{className:"bg-white/10 rounded-xl p-3 flex flex-col items-center",children:[l.jsxs("div",{className:"relative w-full",children:[l.jsx("input",{type:"number",value:X,onChange:z=>M(z.target.value),className:"bg-transparent text-xs font-black w-full outline-none border-b border-white/20 focus:border-white transition-colors text-center pb-1"}),l.jsx("span",{className:"absolute -bottom-0 right-0 text-[10px] font-bold opacity-50",children:"g"})]}),l.jsx("span",{className:"text-[8px] uppercase tracking-tighter opacity-70 mt-1",children:"Carbs"})]}),l.jsxs("div",{className:"bg-white/10 rounded-xl p-3 flex flex-col items-center",children:[l.jsxs("div",{className:"relative w-full",children:[l.jsx("input",{type:"number",value:F,onChange:z=>j(z.target.value),className:"bg-transparent text-xs font-black w-full outline-none border-b border-white/20 focus:border-white transition-colors text-center pb-1"}),l.jsx("span",{className:"absolute -bottom-0 right-0 text-[10px] font-bold opacity-50",children:"g"})]}),l.jsx("span",{className:"text-[8px] uppercase tracking-tighter opacity-70 mt-1",children:"Fat"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-3 flex items-center gap-3 border border-gray-100 dark:border-white/5",children:[l.jsx(Hn,{size:18,className:"text-royal-400"}),l.jsx("input",{type:"date",value:C,onChange:z=>P(z.target.value),className:"bg-transparent text-sm font-bold w-full outline-none dark:text-white"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-3 flex items-center gap-3 border border-gray-100 dark:border-white/5",children:[l.jsx(i0,{size:18,className:"text-royal-400"}),l.jsx("input",{type:"time",value:R,onChange:z=>I(z.target.value),className:"bg-transparent text-sm font-bold w-full outline-none dark:text-white"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase ml-1",children:"Meal Title"}),l.jsx("input",{type:"text",value:V,onChange:z=>Y(z.target.value),className:"w-full p-4 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-2xl font-bold dark:text-white mt-1"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-[32px] p-5 border border-gray-100 dark:border-white/5",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("h3",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[l.jsx(wt,{size:14,className:"text-royal-500"})," Ingredient Receipt"]}),l.jsx("button",{onClick:Ue,className:"text-royal-500 hover:text-royal-600",children:l.jsx(e_,{size:18})})]}),l.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto no-scrollbar pr-1",children:J.map((z,Me)=>l.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left duration-200",children:[l.jsx("input",{type:"text",value:z.name,onChange:A=>cn(Me,"name",A.target.value),className:"flex-1 bg-white dark:bg-white/10 p-2.5 rounded-xl text-xs font-bold border border-gray-100 dark:border-white/10 outline-none focus:border-royal-300 dark:text-white",placeholder:"Ingredient"}),l.jsxs("div",{className:"relative w-20",children:[l.jsx("input",{type:"number",value:z.grams===0?"":z.grams,onChange:A=>cn(Me,"grams",A.target.value),className:"w-full bg-white dark:bg-white/10 p-2.5 pr-6 rounded-xl text-xs font-bold border border-gray-100 dark:border-white/10 outline-none text-right dark:text-white"}),l.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[8px] font-black text-gray-400",children:"g"})]}),l.jsx("button",{onClick:()=>He(Me),className:"text-red-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx(wo,{size:16})})]},Me))}),l.jsxs(Le,{variant:"ghost",className:"w-full mt-4 py-3 text-[10px] font-black uppercase tracking-widest text-royal-600 bg-royal-100/50 hover:bg-royal-100",onClick:ln,isLoading:m,children:[l.jsx(xo,{size:14,className:`mr-2 ${m?"animate-spin":""} `}),"Recalculate Totals"]})]}),l.jsx(Le,{className:"w-full py-5 text-lg font-black shadow-xl shadow-royal-200",onClick:Cn,isLoading:y,disabled:y,children:r?"Update Record":"Save & Track"})]})]}),l.jsx(zy,{isActive:h,message:s==="chat"?"Analyzing Request...":"Analyzing Meal..."})]})},XA=({currentGoal:t,onClose:e,onSave:n})=>{const[r,s]=k.useState(t.toString()),o=()=>{const i=parseInt(r,10);!isNaN(i)&&i>0&&n(i)};return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white w-full max-w-xs rounded-[32px] p-6 shadow-2xl border border-white/50 animate-in zoom-in-95 duration-200",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h2",{className:"text-lg font-extrabold text-gray-900",children:"Daily Calorie Goal"}),l.jsx("button",{onClick:e,className:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",children:l.jsx(Tt,{size:18,className:"text-gray-600"})})]}),l.jsxs("div",{className:"mb-8",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 ml-1",children:"Target Calories"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:r,onChange:i=>s(i.target.value),className:"w-full p-5 bg-gray-50 border border-gray-100 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 transition-all font-extrabold text-3xl text-center text-gray-900",autoFocus:!0}),l.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 text-gray-400 text-sm font-bold",children:"kcal"})]})]}),l.jsx(Le,{className:"w-full py-4 shadow-lg shadow-royal-200",onClick:o,children:"Update Goal"})]})})},Zc=({entry:t,onClose:e,onDelete:n,onEdit:r})=>{const[s,o]=k.useState(!1),[i,a]=k.useState(!1),c=async()=>{confirm("Permanently remove this record?")&&(o(!0),await n(t.id),e())},d=async()=>{if(confirm("Remove the photo to save storage space? Nutritional data will be kept.")){a(!0);try{await ZS(t.id),e(),window.dispatchEvent(new CustomEvent("food-entry-updated"))}catch(h){console.error("Failed to clear image",h),alert("Failed to clear image. Please try again.")}finally{a(!1)}}};return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 dark:bg-black/60 backdrop-blur-md p-4 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl dark:shadow-black border border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300 max-h-[95vh] overflow-y-auto no-scrollbar",children:[l.jsxs("div",{className:"relative h-64 bg-gray-100 dark:bg-white/5",children:[t.imageUrl?l.jsxs(l.Fragment,{children:[l.jsx("img",{src:t.imageUrl,className:"w-full h-full object-cover"}),l.jsxs("button",{onClick:d,disabled:i,className:"absolute bottom-4 right-4 p-2.5 bg-white/20 hover:bg-white/40 text-white rounded-full backdrop-blur-md border border-white/20 transition-all flex items-center gap-2",title:"Remove photo to save space",children:[i?l.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):l.jsx(zw,{size:18}),l.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Clear Image"})]})]}):l.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-300 dark:text-gray-700",children:[l.jsx(Yi,{size:48,className:"mb-2 opacity-50"}),l.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest opacity-40",children:"No Photo Attached"})]}),l.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 bg-white/80 dark:bg-black/40 text-gray-900 dark:text-white rounded-full backdrop-blur-md hover:bg-white dark:hover:bg-black/60 shadow-lg transition-colors z-10",children:l.jsx(Tt,{size:20})}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent pointer-events-none"}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 text-white pointer-events-none",children:[l.jsx("h2",{className:"text-3xl font-black leading-tight tracking-tight",children:t.food_item}),l.jsxs("div",{className:"flex items-center gap-4 text-xs text-white/70 font-bold mt-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(Hn,{size:14})," ",t.date]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(i0,{size:14})," ",t.time]})]})]})]}),l.jsxs("div",{className:"p-8 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[l.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/20 p-3 rounded-2xl flex flex-col items-center border border-royal-100/50",children:[l.jsx("span",{className:"text-lg font-black text-royal-600",children:t.calories}),l.jsx("span",{className:"text-[8px] font-black uppercase text-royal-400",children:"kcal"})]}),l.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-950/20 p-3 rounded-2xl flex flex-col items-center border border-emerald-100/50",children:[l.jsxs("span",{className:"text-lg font-black text-emerald-600",children:[t.protein,"g"]}),l.jsx("span",{className:"text-[8px] font-black uppercase text-emerald-400",children:"Prot"})]}),l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-3 rounded-2xl flex flex-col items-center border border-blue-100/50",children:[l.jsxs("span",{className:"text-lg font-black text-blue-600",children:[t.carbs,"g"]}),l.jsx("span",{className:"text-[8px] font-black uppercase text-blue-400",children:"Carb"})]}),l.jsxs("div",{className:"bg-orange-50 dark:bg-orange-950/20 p-3 rounded-2xl flex flex-col items-center border border-orange-100/50",children:[l.jsxs("span",{className:"text-lg font-black text-orange-600",children:[t.fat,"g"]}),l.jsx("span",{className:"text-[8px] font-black uppercase text-orange-400",children:"Fat"})]})]}),t.ingredients&&t.ingredients.length>0&&l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-3xl p-6 border border-gray-100 dark:border-white/5",children:[l.jsxs("h3",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[l.jsx(qw,{size:14})," Ingredient Receipt"]}),l.jsx("div",{className:"space-y-3",children:t.ingredients.map((h,p)=>l.jsxs("div",{className:"flex justify-between items-center text-sm font-bold border-b border-gray-100 dark:border-white/5 pb-2 last:border-0 last:pb-0",children:[l.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:h.name}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-gray-400",children:[h.grams,"g"]}),l.jsxs("span",{className:"text-royal-500 text-xs w-12 text-right",children:[h.calories,"cal"]})]})]},p))})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(Le,{variant:"ghost",className:"flex-1 text-red-500 py-4 font-black",onClick:c,isLoading:s,children:[l.jsx(wo,{size:18,className:"mr-2"})," Delete"]}),l.jsxs(Le,{className:"flex-[2] py-4 font-black shadow-lg shadow-royal-200",onClick:()=>r(t),children:[l.jsx(c0,{size:18,className:"mr-2"})," Edit Meal"]})]})]})]})})},ZA=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",e2=()=>{const t=ZA();return new za({apiKey:t})},t2=`You are a professional nutritionist and vision AI. Identify all food items in this shared meal image.

For each dish on the table, provide:
1. The dish name (be specific, e.g., "Grilled Chicken Breast" not just "Chicken")
2. A bounding box in [ymin, xmin, ymax, xmax] format with normalized coordinates (0-1000 scale)
3. Total calorie estimate for the ENTIRE portion visible on the table
4. Confidence score (0-1) based on how clearly you can identify the dish

IMPORTANT:
- Detect ALL distinct food items/dishes in the image
- Each dish should have its own bounding box
- Bounding boxes should tightly encompass each dish
- Calorie estimates are for the FULL portion shown, not per serving
- If the image contains no food, return an empty dishes array

Return ONLY a valid JSON object with this exact format:
{
  "dishes": [
    {
      "dish_name": "Dish name here",
      "bounding_box": [ymin, xmin, ymax, xmax],
      "estimated_total_calories": number,
      "confidence_score": 0.95
    }
  ]
}`,n2=t=>{const e=(t==null?void 0:t.message)||String(t)||"",n=e.toLowerCase();return e.includes("429")||n.includes("quota")||n.includes("limit")||n.includes("exhausted")?"AI Limit Reached: You've sent too many requests. Please wait about 60 seconds for the quota to reset.":n.includes("api key")?"Configuration Error: Invalid API key. Please check your settings.":n.includes("network")||n.includes("fetch")?"Connection Error: Please check your internet connection and try again.":e||"An unexpected AI error occurred."};async function Hy(t,e=2,n=2e3){try{return await t()}catch(r){const s=(r==null?void 0:r.message)||"";if((s.includes("429")||s.toLowerCase().includes("quota"))&&e>0)return console.warn(`Gemini Quota hit. Retrying in ${n}ms... (${e} retries left)`),await new Promise(i=>setTimeout(i,n)),Hy(t,e-1,n*2);throw r}}const zp=async t=>{try{return await Hy(async()=>{const n=await e2().models.generateContent({model:"gemini-2.0-flash-exp",contents:{parts:[{inlineData:{mimeType:"image/jpeg",data:t}},{text:"Analyze this shared meal image and identify all dishes with their locations and calorie estimates."}]},config:{systemInstruction:t2,responseMimeType:"application/json",responseSchema:{type:oe.OBJECT,properties:{dishes:{type:oe.ARRAY,items:{type:oe.OBJECT,properties:{dish_name:{type:oe.STRING},bounding_box:{type:oe.ARRAY,items:{type:oe.INTEGER}},estimated_total_calories:{type:oe.INTEGER},confidence_score:{type:oe.NUMBER}},required:["dish_name","bounding_box","estimated_total_calories","confidence_score"]}}},required:["dishes"]},temperature:.4,topP:.95}}),r=JSON.parse(n.text||"{}");if(!r.dishes||!Array.isArray(r.dishes))throw new Error("Invalid response format from AI");if(r.dishes.forEach((s,o)=>{if(!Array.isArray(s.bounding_box)||s.bounding_box.length!==4)throw new Error(`Invalid bounding box format for dish ${o+1}`);s.bounding_box=s.bounding_box.map(i=>Math.max(0,Math.min(1e3,i)))}),r.dishes.length===0)throw new Error("No dishes detected in this image. Please ensure the photo clearly shows food items on a table.");return r})}catch(e){throw console.error("Gemini Shared Meal Analysis Error:",e),new Error(n2(e))}},r2=(t,e=600,n=150)=>new Promise((r,s)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=i=>{var c;const a=new Image;a.src=(c=i.target)==null?void 0:c.result,a.onload=()=>{const d=document.createElement("canvas");let h=a.width,p=a.height;h>e&&(p=e/h*p,h=e),d.width=h,d.height=p;const m=d.getContext("2d");m==null||m.drawImage(a,0,0,h,p);let g=.5,y=d.toDataURL("image/jpeg",g);const _=n*1024;y.split(",")[1].length*3/4>_&&(g=.35,y=d.toDataURL("image/jpeg",g),y.split(",")[1].length*3/4>_&&(g=.25,y=d.toDataURL("image/jpeg",g))),r(y)},a.onerror=d=>s(d)},o.onerror=i=>s(i)}),s2=({onClose:t,onSuccess:e,initialImage:n})=>{const[r,s]=k.useState(n?"analyzing":"upload"),[o,i]=k.useState(n||null),[a,c]=k.useState([]),[d,h]=k.useState(new Map),[p,m]=k.useState(null),[g,y]=k.useState(50),[_,b]=k.useState(null),[x,w]=k.useState(!1),v=k.useRef(null),S=k.useRef(null),[T,E]=k.useState({width:0,height:0}),C=async N=>{if(N.target.files&&N.target.files[0]){const q=N.target.files[0];try{const B=await r2(q,600,150);i(B),b(null)}catch{b("Failed to process image.")}}};k.useEffect(()=>{n&&r==="analyzing"&&(async()=>{try{const q=n.split(",")[1],B=await zp(q);c(B.dishes),s("selection")}catch(q){b(q.message),s("upload")}})()},[n]);const P=async()=>{if(o){s("analyzing"),b(null);try{const N=o.split(",")[1],q=await zp(N);c(q.dishes),s("selection")}catch(N){b(N.message),s("upload")}}};k.useEffect(()=>{if(S.current&&r==="selection"){const N=()=>{S.current&&E({width:S.current.offsetWidth,height:S.current.offsetHeight})};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)}},[r]);const R=N=>{if(!S.current)return{x:0,y:0};const q=S.current,B=q.offsetWidth,X=q.offsetHeight,M=q.naturalWidth,F=q.naturalHeight,j=(N[1]+N[3])/2,J=(N[0]+N[2])/2,U=j/1e3,Z=J/1e3,te=M/F,ce=B/X;let D=B,ie=X,fe=0,Ae=0;return te>ce?(ie=B/te,Ae=(X-ie)/2):(D=X*te,fe=(B-D)/2),{x:U*D+fe,y:Z*ie+Ae}},I=N=>{m(N),y(d.get(N)||50)},V=()=>{if(p!==null){const N=new Map(d);g>0?N.set(p,g):N.delete(p),h(N),m(null)}},Y=()=>{let N=0;return d.forEach((q,B)=>{const X=a[B];N+=Math.round(X.estimated_total_calories*q/100)}),N},Q=async()=>{if(d.size===0){b("Please select at least one dish portion.");return}w(!0),b(null);try{const N=new Date,q=N.toISOString(),B=Qn(),X=`${N.getHours().toString().padStart(2,"0")}:${N.getMinutes().toString().padStart(2,"0")}`;for(const[M,F]of Array.from(d.entries())){const j=a[M],J=Math.round(j.estimated_total_calories*F/100),U={id:Gy(),timestamp:q,date:B,time:X,food_item:`${j.dish_name} (Shared Meal - ${F}%)`,calories:J,protein:0,carbs:0,fat:0,confidence:j.confidence_score,imageUrl:o||void 0,isManual:!1};await O0(U)}e()}catch(N){console.error("Save failed:",N),b(N.message||"Failed to save entries.")}finally{w(!1)}};return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] w-full max-w-md rounded-[40px] p-6 shadow-2xl border border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300 max-h-[95vh] overflow-y-auto no-scrollbar",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:r==="upload"?"Shared Meal":r==="analyzing"?"Analyzing...":r==="selection"?"Select Portions":"Confirm"}),l.jsx("button",{onClick:t,className:"p-2 bg-gray-100 dark:bg-white/5 rounded-full hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:l.jsx(Tt,{size:20,className:"text-gray-600 dark:text-gray-400"})})]}),_&&l.jsxs("div",{className:"mb-4 p-4 rounded-3xl flex items-start gap-3 bg-red-50 dark:bg-red-950/20 border border-red-100 dark:border-red-900/30 text-red-600 dark:text-red-400 animate-in shake-1 duration-300",children:[l.jsx(Ku,{className:"shrink-0 mt-0.5",size:18}),l.jsx("p",{className:"text-xs font-semibold leading-relaxed",children:_})]}),r==="upload"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 p-5 rounded-[32px] border border-royal-100 dark:border-royal-900/30",children:[l.jsx("p",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 mb-2",children:" Shared Meal Mode"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 leading-relaxed",children:"Take a photo of a table with multiple dishes. The AI will identify each dish and let you specify what percentage you ate."})]}),o?l.jsxs("div",{className:"rounded-[32px] overflow-hidden h-64 relative mb-6 shadow-xl border border-white/10",children:[l.jsx("img",{src:o,className:"w-full h-full object-cover",alt:"preview"}),l.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 bg-black/40 text-white p-2 rounded-full backdrop-blur-md",children:l.jsx(Tt,{size:20})})]}):l.jsxs("div",{onClick:()=>{var N;return(N=v.current)==null?void 0:N.click()},className:"border-2 border-dashed border-gray-200 dark:border-white/10 rounded-[32px] h-64 flex flex-col items-center justify-center cursor-pointer hover:border-royal-400 hover:bg-royal-50 dark:hover:bg-white/5 transition-all group",children:[l.jsx(pr,{size:48,className:"text-gray-300 group-hover:text-royal-600 mb-4 transition-colors"}),l.jsx("p",{className:"text-gray-900 dark:text-gray-50 font-bold",children:"Snap or Upload Photo"}),l.jsx("p",{className:"text-gray-400 text-xs mt-1 italic",children:"Capture the whole table"})]}),l.jsx("input",{type:"file",ref:v,accept:"image/*",onChange:C,className:"hidden"}),l.jsx(Le,{className:"w-full py-5 text-lg font-black",disabled:!o,onClick:P,children:"Detect Dishes"})]}),r==="analyzing"&&l.jsx(zy,{isActive:!0,message:"Analyzing Shared Meal..."}),r==="selection"&&o&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"relative rounded-[32px] overflow-hidden border border-white/10 shadow-xl",children:[l.jsx("img",{ref:S,src:o,className:"w-full h-auto object-contain max-h-[400px]",alt:"Shared meal",onLoad:()=>{S.current&&E({width:S.current.offsetWidth,height:S.current.offsetHeight})}}),a.map((N,q)=>{const B=R(N.bounding_box),X=d.has(q);return l.jsx("button",{onClick:()=>I(q),className:`absolute w-10 h-10 rounded-full flex items-center justify-center transition-all transform -translate-x-1/2 -translate-y-1/2 ${X?"bg-emerald-500 shadow-lg shadow-emerald-500/50 scale-110":"bg-royal-600 shadow-lg shadow-royal-600/50 hover:scale-110"}`,style:{left:`${B.x}px`,top:`${B.y}px`},children:X?l.jsx(Dw,{size:20,className:"text-white"}):l.jsx("span",{className:"text-white text-xs font-black",children:q+1})},q)})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-[32px] p-5 border border-gray-100 dark:border-white/5",children:[l.jsxs("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-3",children:["Detected Dishes (",a.length,")"]}),l.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto no-scrollbar",children:a.map((N,q)=>l.jsxs("button",{onClick:()=>I(q),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all ${d.has(q)?"bg-emerald-50 dark:bg-emerald-950/30 border border-emerald-200 dark:border-emerald-900/30":"bg-white dark:bg-white/5 border border-gray-100 dark:border-white/10 hover:border-royal-300"}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"w-6 h-6 rounded-full bg-royal-600 text-white text-xs font-black flex items-center justify-center",children:q+1}),l.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 truncate",children:N.dish_name})]}),d.has(q)&&l.jsxs("span",{className:"text-xs font-black text-emerald-600 dark:text-emerald-400",children:[d.get(q),"%"]})]},q))})]}),d.size>0&&l.jsxs(Le,{className:"w-full py-5 text-lg font-black",onClick:()=>s("confirmation"),children:["Review Selection (",d.size," ",d.size===1?"dish":"dishes",")"]})]}),r==="confirmation"&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-royal-600 rounded-[32px] p-6 text-white shadow-xl",children:[l.jsx("p",{className:"text-royal-100 text-[10px] font-black uppercase tracking-widest mb-1",children:"Total Calories"}),l.jsxs("div",{className:"flex items-baseline gap-1",children:[l.jsx("span",{className:"text-5xl font-black tracking-tighter",children:Y()}),l.jsx("span",{className:"text-xl font-bold opacity-70",children:"kcal"})]}),l.jsxs("p",{className:"text-xs text-white/70 mt-2",children:["From ",d.size," portion",d.size!==1?"s":""]})]}),l.jsx("div",{className:"space-y-3",children:Array.from(d.entries()).map(([N,q])=>{const B=a[N],X=Math.round(B.estimated_total_calories*q/100);return l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 text-sm",children:B.dish_name}),l.jsxs("span",{className:"text-xs font-black text-royal-600 dark:text-royal-400",children:[q,"%"]})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("span",{className:"text-xs text-gray-400",children:["Portion of ",B.estimated_total_calories," kcal"]}),l.jsxs("span",{className:"font-extrabold text-gray-900 dark:text-gray-50",children:[X," kcal"]})]})]},N)})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Le,{variant:"ghost",className:"flex-1 py-4",onClick:()=>s("selection"),children:"Edit"}),l.jsx(Le,{className:"flex-1 py-4 text-lg font-black",onClick:Q,isLoading:x,disabled:x,children:"Save All"})]})]}),p!==null&&r==="selection"&&l.jsx("div",{className:"fixed inset-x-0 bottom-0 z-[110] bg-white dark:bg-[#1a1c26] rounded-t-[40px] p-6 shadow-2xl border-t border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300",children:l.jsxs("div",{className:"max-w-md mx-auto",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-black text-gray-900 dark:text-gray-50",children:a[p].dish_name}),l.jsx("button",{onClick:()=>m(null),className:"p-2 bg-gray-100 dark:bg-white/5 rounded-full",children:l.jsx(o0,{size:20,className:"text-gray-600 dark:text-gray-400"})})]}),l.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 rounded-2xl p-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase flex items-center gap-1",children:[l.jsx(Xw,{size:14})," Your Portion"]}),l.jsxs("span",{className:"text-2xl font-black text-royal-600 dark:text-royal-400",children:[g,"%"]})]}),l.jsx("input",{type:"range",min:"0",max:"100",step:"5",value:g,onChange:N=>y(Number(N.target.value)),className:"w-full h-2 bg-royal-200 dark:bg-royal-900/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-6 [&::-webkit-slider-thumb]:h-6 [&::-webkit-slider-thumb]:bg-royal-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer"})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-4 mb-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-xs text-gray-400",children:"Your Calories"}),l.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[Math.round(a[p].estimated_total_calories*g/100)," kcal"]})]}),l.jsxs("div",{className:"text-[10px] text-gray-400 mt-1",children:["Total dish: ",a[p].estimated_total_calories," kcal"]})]}),l.jsx(Le,{className:"w-full py-4 text-lg font-black",onClick:V,children:"Confirm Selection"})]})})]})})},o2={sm:{container:"w-10 h-10",face:"w-8 h-8",fontSize:"text-lg"},md:{container:"w-14 h-14",face:"w-11 h-11",fontSize:"text-2xl"},lg:{container:"w-20 h-20",face:"w-16 h-16",fontSize:"text-4xl"}},i2={[Dt.OPTIMAL]:{bgGradient:"from-emerald-400 to-green-500",shadow:"shadow-emerald-200 dark:shadow-emerald-900/40",ring:"ring-emerald-300",pulse:!1},[Dt.WARNING]:{bgGradient:"from-amber-400 to-orange-500",shadow:"shadow-amber-200 dark:shadow-amber-900/40",ring:"ring-amber-300",pulse:!0},[Dt.CRITICAL]:{bgGradient:"from-red-400 to-rose-600",shadow:"shadow-red-200 dark:shadow-red-900/40",ring:"ring-red-300",pulse:!0}},a2=({size:t="md",showStatus:e=!1,onClick:n})=>{const[r,s]=k.useState(null),[o,i]=k.useState(!1),[a,c]=k.useState(!0),d=k.useCallback(async()=>{try{const g=await WA();s(g)}catch(g){console.error("Failed to load avatar status:",g)}finally{c(!1)}},[]);k.useEffect(()=>{d();const g=YA(()=>{d()}),y=()=>{i(!0),setTimeout(()=>i(!1),800)};return window.addEventListener("avatar-feed",y),()=>{g(),window.removeEventListener("avatar-feed",y)}},[d]);const h=o2[t],p=(r==null?void 0:r.state)||Dt.WARNING,m=i2[p];return a?l.jsx("div",{className:`${h.container} rounded-full bg-gray-200 dark:bg-white/10 animate-pulse`}):l.jsxs("div",{className:"relative inline-block",children:[l.jsxs("button",{onClick:n,className:`
          ${h.container} 
          relative rounded-full 
          bg-gradient-to-br ${m.bgGradient}
          shadow-lg ${m.shadow}
          flex items-center justify-center
          transition-all duration-500 ease-out
          hover:scale-110 active:scale-95
          ${m.pulse?"animate-pulse":""}
          ${o?"animate-bounce scale-125":""}
          ${n?"cursor-pointer":"cursor-default"}
        `,disabled:!n,type:"button",children:[l.jsx("div",{className:"absolute inset-1 bg-white/20 rounded-full blur-sm"}),l.jsx("div",{className:`${h.face} relative z-10 flex items-center justify-center`,children:l.jsx(l2,{state:p,fontSize:h.fontSize,isFeeding:o})}),o&&l.jsx(c2,{})]}),l.jsx("div",{className:`
        absolute -bottom-0.5 -right-0.5
        w-3 h-3 rounded-full
        border-2 border-white dark:border-[#0c0e17]
        ${p===Dt.OPTIMAL?"bg-emerald-500":p===Dt.WARNING?"bg-amber-500":"bg-red-500"}
        ${m.pulse?"animate-ping":""}
      `}),e&&r&&l.jsx("div",{className:`absolute top-full left-1/2 -translate-x-1/2 mt-2 
          bg-white dark:bg-[#1a1c26] rounded-xl px-3 py-2 
          shadow-lg border border-gray-100 dark:border-white/10
          whitespace-nowrap z-50
          animate-in fade-in slide-in-from-top-2 duration-300
        `,children:l.jsx("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:r.stateReason})})]})},l2=({state:t,fontSize:e,isFeeding:n})=>l.jsxs("svg",{viewBox:"0 0 100 100",className:"w-full h-full",children:[l.jsx("circle",{cx:"50",cy:"50",r:"45",fill:"#FFE4C4"}),l.jsx("circle",{cx:"25",cy:"55",r:"8",fill:"#FFB6C1",opacity:"0.5"}),l.jsx("circle",{cx:"75",cy:"55",r:"8",fill:"#FFB6C1",opacity:"0.5"}),t===Dt.OPTIMAL?l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M30 42 Q35 38 40 42",stroke:"#333",strokeWidth:"3",fill:"none",strokeLinecap:"round"}),l.jsx("path",{d:"M60 42 Q65 38 70 42",stroke:"#333",strokeWidth:"3",fill:"none",strokeLinecap:"round"})]}):t===Dt.WARNING?l.jsxs(l.Fragment,{children:[l.jsx("ellipse",{cx:"35",cy:"42",rx:"6",ry:"7",fill:"#333"}),l.jsx("ellipse",{cx:"65",cy:"42",rx:"6",ry:"7",fill:"#333"}),l.jsx("circle",{cx:"37",cy:"40",r:"2",fill:"white"}),l.jsx("circle",{cx:"67",cy:"40",r:"2",fill:"white"}),l.jsx("path",{d:"M78 35 Q80 40 78 45 Q76 40 78 35",fill:"#87CEEB"})]}):l.jsxs(l.Fragment,{children:[l.jsx("ellipse",{cx:"35",cy:"45",rx:"6",ry:"4",fill:"#333"}),l.jsx("ellipse",{cx:"65",cy:"45",rx:"6",ry:"4",fill:"#333"}),l.jsx("path",{d:"M28 38 L42 42",stroke:"#333",strokeWidth:"2",strokeLinecap:"round"}),l.jsx("path",{d:"M72 38 L58 42",stroke:"#333",strokeWidth:"2",strokeLinecap:"round"})]}),t===Dt.OPTIMAL?l.jsx("path",{d:"M35 60 Q50 78 65 60",stroke:"#333",strokeWidth:"3",fill:"none",strokeLinecap:"round"}):t===Dt.WARNING?l.jsx("path",{d:"M35 65 Q42 62 50 65 Q58 68 65 65",stroke:"#333",strokeWidth:"3",fill:"none",strokeLinecap:"round"}):l.jsx("path",{d:"M38 68 Q50 60 62 68",stroke:"#333",strokeWidth:"3",fill:"none",strokeLinecap:"round"}),n&&l.jsxs(l.Fragment,{children:[l.jsx("ellipse",{cx:"50",cy:"65",rx:"12",ry:"10",fill:"#FF6B6B"}),l.jsx("ellipse",{cx:"50",cy:"63",rx:"8",ry:"6",fill:"#1a1a1a"})]}),t===Dt.OPTIMAL&&l.jsxs(l.Fragment,{children:[l.jsx("path",{d:"M15 25 L17 30 L15 35 L13 30 Z",fill:"#FFD700"}),l.jsx("path",{d:"M85 20 L87 25 L85 30 L83 25 Z",fill:"#FFD700"})]})]}),c2=()=>l.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-visible",children:[0,1,2,3,4,5].map(t=>l.jsx("div",{className:"absolute animate-ping",style:{left:`${50+Math.cos(t*Math.PI/3)*60}%`,top:`${50+Math.sin(t*Math.PI/3)*60}%`,animationDelay:`${t*.1}s`,animationDuration:"0.6s"},children:l.jsx("span",{className:"text-yellow-400 text-lg",children:""})},t))}),u2=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(!1),[s,o]=k.useState(!1),[i,a]=k.useState(null),[c,d]=k.useState(null),[h,p]=k.useState(0),[m,g]=k.useState(0),[y,_]=k.useState(0),[b,x]=k.useState(0),[w,v]=k.useState(2e3),[S,T]=k.useState(0),[E,C]=k.useState(!0),[P,R]=k.useState(""),[I,V]=k.useState(!1),[Y,Q]=k.useState(null),[N,q]=k.useState(0),[B,X]=k.useState(null),[M,F]=k.useState(!1),j=async()=>{try{const D=await ad(),ie=Qn(),fe=D.filter(He=>He.date===ie);fe.sort((He,Ue)=>Ue.timestamp.localeCompare(He.timestamp)),e(fe),p(fe.reduce((He,Ue)=>He+Ue.calories,0)),g(fe.reduce((He,Ue)=>He+(Ue.protein||0),0)),_(fe.reduce((He,Ue)=>He+(Ue.carbs||0),0)),x(fe.reduce((He,Ue)=>He+(Ue.fat||0),0));const Ae=await ks();v(Ae);const Rt=await Yn();Rt!=null&&Rt.name&&R(Rt.name);const ln=await Vy();q(ln.currentStreak);const cn=await zA();X(cn)}catch(D){console.error("Failed to load dashboard data",D)}finally{C(!1)}};k.useEffect(()=>{j();const D=()=>j();window.addEventListener("food-entry-updated",D);const ie=()=>j();window.addEventListener("streak-updated",ie);const fe=()=>{console.log(" Dashboard: Midnight detected, reloading data..."),j()};return window.addEventListener("midnight-refresh",fe),()=>{window.removeEventListener("food-entry-updated",D),window.removeEventListener("streak-updated",ie),window.removeEventListener("midnight-refresh",fe)}},[]),k.useEffect(()=>{if(E)return;const D=Math.min(h/w*100,100),ie=setTimeout(()=>{T(D)},100);return()=>clearTimeout(ie)},[h,w,E]);const J=async D=>{await G0(D),await j()},U=D=>{a(null),d(D),r(!0)},Z=async D=>{await Pa(D),v(D),o(!1)},te=()=>{const D=h/w*100;if(D>=100)return{background:"repeating-linear-gradient(45deg, #facc15, #facc15 12px, #171717 12px, #171717 24px)",boxShadow:"0 0 12px rgba(250, 204, 21, 0.4)"};if(D<=60)return{background:"#10b981",boxShadow:"0 0 12px rgba(16, 185, 129, 0.4)"};if(D<=80)return{background:`linear-gradient(90deg, #10b981 0%, #10b981 ${60/D*100}%, #facc15 100%)`,boxShadow:"0 0 12px rgba(250, 204, 21, 0.3)"};const ie=60/D*100,fe=80/D*100;return{background:`linear-gradient(90deg, #10b981 0%, #10b981 ${ie}%, #facc15 ${fe}%, #f97316 100%)`,boxShadow:"0 0 12px rgba(249, 115, 22, 0.3)"}},ce=D=>{if(D.isManual)return D.imageUrl?l.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-amber-50 dark:bg-amber-950/20 text-amber-600 dark:text-amber-400 text-[10px] font-bold tracking-wide",children:[l.jsx(Yw,{size:10}),"EDITED"]}):l.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-gray-100 dark:bg-white/5 text-gray-500 dark:text-gray-400 text-[10px] font-bold tracking-wide",children:[l.jsx(xs,{size:10}),"MANUAL"]});const ie=Math.round(D.confidence*100),fe=ie>80?"bg-emerald-50 dark:bg-emerald-950/20 text-emerald-600 dark:text-emerald-400":ie>50?"bg-orange-50 dark:bg-orange-950/20 text-orange-600 dark:text-orange-400":"bg-rose-50 dark:bg-rose-950/20 text-rose-600 dark:text-rose-400";return l.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-[10px] font-bold tracking-wide ${fe}`,children:[l.jsx(wt,{size:10}),ie,"% AI"]})};return l.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-hidden relative",children:[l.jsxs("div",{className:"flex-shrink-0 px-6 pt-10 space-y-8 pb-4",children:[l.jsxs("header",{className:"flex justify-between items-end",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),l.jsxs("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight leading-none",children:["Hello ",P||"there",", ",l.jsx("br",{}),"Let's Eat Well."]})]}),l.jsx("div",{className:"relative",onMouseEnter:()=>F(!0),onMouseLeave:()=>F(!1),children:l.jsx(a2,{size:"md",showStatus:M})})]}),N>0&&l.jsxs("div",{className:"flex items-center gap-2 bg-gradient-to-r from-orange-500 to-amber-500 text-white px-4 py-2.5 rounded-2xl shadow-lg shadow-orange-200 dark:shadow-orange-900/30 animate-in slide-in-from-left duration-500",children:[l.jsx(a0,{size:20,className:"animate-pulse"}),l.jsxs("div",{children:[l.jsx("span",{className:"text-xl font-extrabold",children:N}),l.jsx("span",{className:"ml-1.5 text-sm font-bold text-white/90",children:"day streak!"})]}),N>=7&&N<14&&l.jsx("span",{className:"ml-2 text-xs bg-white/20 px-2 py-0.5 rounded-full",children:" Keep it up!"}),N>=14&&N<30&&l.jsx("span",{className:"ml-2 text-xs bg-white/20 px-2 py-0.5 rounded-full",children:" On fire!"}),N>=30&&l.jsx("span",{className:"ml-2 text-xs bg-white/20 px-2 py-0.5 rounded-full",children:" Legend!"})]}),l.jsxs("div",{className:`relative rounded-[32px] p-6 text-white overflow-hidden shadow-xl transition-all duration-500 ${h>w?"bg-red-500 shadow-red-200 dark:shadow-red-900/40":"bg-royal-600 shadow-royal-200 dark:shadow-royal-900/40"}`,children:[l.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-white/10 rounded-full blur-3xl"}),l.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-black/10 rounded-full blur-3xl"}),l.jsxs("div",{className:"relative z-10",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-white/70 text-xs font-bold uppercase tracking-widest mb-1",children:"Calories Consumed"}),l.jsxs("div",{className:"flex items-baseline gap-1",children:[l.jsx("span",{className:"text-5xl font-bold tracking-tighter",children:E?"...":h}),l.jsx("span",{className:"text-lg text-white/60 font-medium",children:"kcal"})]})]}),l.jsx("div",{className:"text-right",children:l.jsxs("div",{className:"flex items-center justify-end gap-2 text-white/80 mb-1",children:[l.jsxs("span",{className:"text-xs font-semibold",children:["Goal: ",w]}),l.jsx("button",{onClick:()=>o(!0),className:"p-1.5 rounded-full bg-white/20 hover:bg-white/30 transition-colors backdrop-blur-sm",children:l.jsx(c0,{size:10})})]})})]}),l.jsx("div",{className:"w-full bg-black/20 rounded-full h-4 mb-3 overflow-hidden backdrop-blur-sm relative",children:l.jsx("div",{className:"h-full rounded-full transition-all duration-1000 ease-out will-change-[width] flex items-center justify-center overflow-hidden",style:{width:`${S}%`,...te()},children:h/w>=1&&l.jsx("span",{className:"text-[10px] font-black tracking-tighter text-white drop-shadow-md animate-pulse",children:"OVER LIMIT"})})}),l.jsx("div",{className:"flex justify-end mb-6",children:h>w?l.jsxs("div",{className:"flex items-center gap-1.5 bg-white/20 backdrop-blur-md px-3 py-1 rounded-full animate-pulse",children:[l.jsx(Rw,{size:14,className:"text-white",fill:"white"}),l.jsxs("span",{className:"font-bold text-xs text-white",children:[Math.abs(w-h).toLocaleString()," kcal over limit"]})]}):l.jsxs("p",{className:"text-xs font-medium text-white/80",children:[Math.max(w-h,0).toLocaleString()," kcal remaining"]})}),l.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-5 pt-4 border-t border-white/10",children:[l.jsxs("div",{className:"flex flex-col items-center justify-center p-2 rounded-2xl bg-royal-800 border border-royal-700 shadow-sm relative overflow-hidden group",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-royal-400/10 to-transparent opacity-50"}),l.jsx("p",{className:"text-[9px] uppercase font-bold text-royal-200 mb-0.5 relative z-10 tracking-wider",children:"Protein"}),l.jsxs("div",{className:"flex items-baseline gap-0.5 relative z-10",children:[l.jsx("span",{className:"text-xl font-black text-white shadow-black/10 drop-shadow-sm",children:m}),l.jsx("span",{className:"text-[10px] font-bold text-royal-300",children:"g"})]})]}),l.jsxs("div",{className:"flex flex-col items-center justify-center p-2 rounded-2xl bg-royal-800 border border-royal-700 shadow-sm relative overflow-hidden group",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-royal-400/10 to-transparent opacity-50"}),l.jsx("p",{className:"text-[9px] uppercase font-bold text-royal-200 mb-0.5 relative z-10 tracking-wider",children:"Carbs"}),l.jsxs("div",{className:"flex items-baseline gap-0.5 relative z-10",children:[l.jsx("span",{className:"text-xl font-black text-white shadow-black/10 drop-shadow-sm",children:y}),l.jsx("span",{className:"text-[10px] font-bold text-royal-300",children:"g"})]})]}),l.jsxs("div",{className:"flex flex-col items-center justify-center p-2 rounded-2xl bg-royal-800 border border-royal-700 shadow-sm relative overflow-hidden group",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-royal-400/10 to-transparent opacity-50"}),l.jsx("p",{className:"text-[9px] uppercase font-bold text-royal-200 mb-0.5 relative z-10 tracking-wider",children:"Fat"}),l.jsxs("div",{className:"flex items-baseline gap-0.5 relative z-10",children:[l.jsx("span",{className:"text-xl font-black text-white shadow-black/10 drop-shadow-sm",children:b}),l.jsx("span",{className:"text-[10px] font-bold text-royal-300",children:"g"})]})]})]}),B&&B.daysRemaining>0&&l.jsxs("div",{className:"mt-5 pt-4 border-t border-white/10",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(vs,{size:14,className:"text-white/70"}),l.jsx("span",{className:"text-xs font-bold text-white/70 uppercase tracking-wider",children:"Weight Goal"})]}),l.jsxs("span",{className:"text-xs font-bold text-white/90",children:[B.currentWeight,"kg  ",B.targetWeight,"kg"]})]}),l.jsx("div",{className:"w-full bg-white/10 rounded-full h-2 mb-2 overflow-hidden",children:l.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-emerald-400 to-green-500 transition-all duration-1000",style:{width:`${B.progressPercentage}%`}})}),l.jsx("p",{className:"text-xs text-white/80 font-medium leading-relaxed",children:BA(B)})]})]})]})]}),l.jsx("div",{className:"flex-shrink-0 px-6 mb-4",children:l.jsxs("div",{className:"flex items-center justify-between px-1",children:[l.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-50",children:"Recent Meals"}),l.jsxs("span",{className:"text-xs font-medium text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-white/5 px-2 py-1 rounded-lg",children:[t.length," items"]})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar px-6 pb-32",children:E?l.jsx("div",{className:"space-y-4",children:[1,2].map(D=>l.jsx("div",{className:"h-24 bg-white dark:bg-[#1a1c26] rounded-[32px] animate-pulse shadow-sm border border-white/5 dark:border-white/5"},D))}):t.length===0?l.jsxs("div",{className:"text-center py-16 bg-white dark:bg-[#1a1c26] rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-50 dark:bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300 dark:text-gray-700",children:l.jsx(f0,{size:24})}),l.jsx("p",{className:"text-gray-400 dark:text-gray-500 font-medium mb-1",children:"No meals tracked today."}),l.jsx("p",{className:"text-xs text-gray-300 dark:text-gray-700",children:"Tap the + button to add one."})]}):l.jsx("div",{className:"space-y-4",children:t.map(D=>l.jsxs(rt,{className:"flex gap-4 items-center p-4 group",onClick:()=>a(D),children:[l.jsx("div",{className:"w-16 h-16 bg-gray-50 dark:bg-white/5 rounded-2xl overflow-hidden flex-shrink-0 shadow-inner",children:D.imageUrl?l.jsx("img",{src:D.imageUrl,alt:D.food_item,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 dark:text-gray-700",children:l.jsx(xs,{size:20})})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"flex items-center gap-2 mb-1",children:l.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 truncate text-base",children:D.food_item})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("p",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500",children:D.time}),ce(D)]})]}),l.jsxs("div",{className:"text-right pl-2",children:[l.jsx("span",{className:"block font-extrabold text-gray-900 dark:text-gray-50 text-lg",children:D.calories}),l.jsx("span",{className:"text-[10px] font-bold text-gray-400 dark:text-gray-500 uppercase",children:"kcal"})]})]},D.id))})}),l.jsx("button",{onClick:()=>{d(null),r(!0)},className:"absolute bottom-28 right-6 w-16 h-16 bg-royal-600 text-white rounded-[24px] shadow-[0_12px_24px_-6px_rgba(124,58,237,0.5)] flex items-center justify-center hover:scale-105 hover:bg-royal-700 active:scale-95 transition-all z-[60]",children:l.jsx(Qi,{size:32,strokeWidth:2.5})}),n&&l.jsx(qy,{editEntry:c,onClose:()=>{r(!1),d(null)},onSuccess:()=>{r(!1),d(null),j()},onOpenSharedMeal:D=>{r(!1),d(null),D&&Q(D),setTimeout(()=>V(!0),100)}}),s&&l.jsx(XA,{currentGoal:w,onClose:()=>o(!1),onSave:Z}),i&&l.jsx(Zc,{entry:i,onClose:()=>a(null),onDelete:J,onEdit:U}),I&&l.jsx(s2,{initialImage:Y,onClose:()=>{V(!1),Q(null)},onSuccess:()=>{V(!1),Q(null),j()}})]})},d2=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",f2=()=>{const t=d2();return new za({apiKey:t})},h2=`You are **Cal Coach**, an AI fitness and nutrition coach. Your mission is to provide simple, actionable advice to help users reach their goals.

**Core Principles:**
1. **Keep it Simple:** Use short, clear sentences. No jargon or complicated explanations.
2. **Focus on What Matters:** Only highlight the most important insights and actions.
3. **Be Encouraging:** Always stay positive and supportive, even when pointing out areas for improvement.
4. **Card-Friendly Format:** Structure responses to be visually scannable with emojis, bullet points, and short sections.

**Response Guidelines:**

When analyzing nutrition:
- Start with a simple status emoji ( Good /  Needs Work /  Excellent)
- Show only the most critical metrics (Calories, Protein)
- Use 2-3 bullet points max for observation
- Give 2-3 actionable next steps
- Keep total response under 150 words

When providing plans (workout/meal):
- Use simple bullet format, not complex tables
- Show only key exercises or meals (3-5 items max)
- Include specific numbers (reps, grams, servings)
- Add emoji indicators for visual appeal

When answering questions:
- Answer directly in 2-3 sentences
- Add one practical example if needed
- No lengthy explanations

**Formatting Style:**
 **Status**
Brief one-line summary

**Key Points:**
 Point 1 with number
 Point 2 with number
 Point 3 with number

**Action Steps:**
1. Simple action
2. Simple action

**Never:**
- Use complex tables with multiple columns
- Write long paragraphs
- Include technical disclaimers (assume user knows to consult doctors)
- Use phases like "Phase 1", "Phase 2"
- Repeat the user's data back to them

**Context Provided:**
You will receive user profile data and recent food tracking history in each message. Use this to provide personalized analysis and recommendations.`,Wy=async()=>{try{const t={},e=await Yn();e&&(t.userName=e.name,t.height=e.height,t.weight=e.weight,t.age=e.age,t.gender=e.gender,t.activityLevel=e.activityLevel,t.goal=e.goal,t.equipmentAccess=e.equipmentAccess);const n=await ks();t.dailyGoal=n;const r=await YS(),s=new Date().toISOString().split("T")[0],o=r.filter(a=>a.date===s);t.todayCalories=o.reduce((a,c)=>a+c.calories,0),t.todayProtein=o.reduce((a,c)=>a+c.protein,0),t.todayCarbs=o.reduce((a,c)=>a+c.carbs,0),t.todayFat=o.reduce((a,c)=>a+c.fat,0);const i=new Map;return r.forEach(a=>{i.has(a.date)||i.set(a.date,[]),i.get(a.date).push(a)}),t.recentEntries=Array.from(i.entries()).slice(0,30).map(([a,c])=>({date:a,totalCalories:c.reduce((d,h)=>d+h.calories,0),totalProtein:c.reduce((d,h)=>d+h.protein,0),totalCarbs:c.reduce((d,h)=>d+h.carbs,0),totalFat:c.reduce((d,h)=>d+h.fat,0),entryCount:c.length})),t}catch(t){return console.error("Failed to build coach context:",t),{}}},p2=t=>{let e=`**User Profile & Current Data:**

`;return t.userName&&(e+=`- Name: ${t.userName}
`),t.height&&(e+=`- Height: ${t.height} cm
`),t.weight&&(e+=`- Weight: ${t.weight} kg
`),t.age&&(e+=`- Age: ${t.age} years
`),t.gender&&(e+=`- Gender: ${t.gender.charAt(0).toUpperCase()+t.gender.slice(1)}
`),t.activityLevel&&(e+=`- Activity Level: ${{sedentary:"Sedentary",light:"Lightly Active",moderate:"Moderately Active",very:"Very Active",extra:"Extra Active"}[t.activityLevel]}
`),t.goal&&(e+=`- Goal: ${{cut:"Cut (Lose Fat)",bulk:"Bulk (Gain Muscle)",maintain:"Maintain"}[t.goal]}
`),t.equipmentAccess&&(e+=`- Equipment: ${{gym:"Gym Access",home:"Home Equipment",bodyweight:"Bodyweight Only"}[t.equipmentAccess]}
`),t.dailyGoal&&(e+=`- Daily Calorie Goal: ${t.dailyGoal} kcal
`),e+=`
**Today's Nutrition (${new Date().toLocaleDateString()}):**
`,e+=`- Calories: ${t.todayCalories||0} kcal
`,e+=`- Protein: ${t.todayProtein||0}g
`,e+=`- Carbs: ${t.todayCarbs||0}g
`,e+=`- Fat: ${t.todayFat||0}g
`,t.recentEntries&&t.recentEntries.length>0&&(e+=`
**Last 30 Days Summary:**
`,t.recentEntries.forEach(n=>{e+=`
${n.date}:
`,e+=`  - ${n.totalCalories} kcal | Protein: ${n.totalProtein}g | Carbs: ${n.totalCarbs}g | Fat: ${n.totalFat}g | Meals: ${n.entryCount}
`})),e+=`
---

`,e},Nl=async(t,e)=>{try{const n=f2(),r=await Wy(),s=e.slice(-4).map(a=>`${a.role==="user"?"User":"Coach"}: ${a.content}`).join(`

`),o=`${p2(r)}${s?`**Recent Conversation:**
${s}

`:""}**User's Current Message:**
${t}`;return(await n.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:o}]}],config:{systemInstruction:h2,temperature:.7,topP:.95}})).text||"I apologize, but I couldn't generate a response. Please try again."}catch(n){console.error("Coach message error:",n);const r=(n==null?void 0:n.message)||String(n);throw r.includes("429")||r.toLowerCase().includes("quota")?new Error("Rate limit reached. Please wait a moment and try again."):r.toLowerCase().includes("api key")?new Error("Configuration error. Please check your API settings."):new Error("Failed to get coach response. Please try again.")}},m2=t=>{t.toLowerCase();const e=/\b(workout|exercise|training|routine|fitness|gym)\b/i.test(t),n=/day\s+\d+:/i.test(t),r=/\d+\s*(sets?|reps?|x)/i.test(t)||/sets?:\s*\d+/i.test(t)||/\d+\s*x\s*\d+/i.test(t),s=/(push-?up|pull-?up|squat|deadlift|bench\s+press|plank|lunge|curl|press|row)/i.test(t);return e&&(r||n||s)},Bp=t=>{const e=[];let n="AI Workout Plan";const r=t.match(/(?:^|\n)(?:##?\s*)?([A-Z][\w\s&]+(?:Day|Workout|Training|Routine))/i);r&&(n=r[1].trim());const s=t.split(`
`).map(o=>o.trim());for(let o=0;o<s.length;o++){const i=s[o];if(!i||i.startsWith("#")||i.startsWith("**Action")||i.startsWith("**Key"))continue;let a="",c=3,d="10",h="60s",p=i.replace(/^[\-\*]\s*/,"").replace(/^\d+\.\s*/,"");const m=p.match(/(\d+)\s*(?:sets?|x)/i)||p.match(/sets?:\s*(\d+)/i);m&&(c=parseInt(m[1]));const g=p.match(/(\d+(?:-\d+)?)\s*reps?/i)||p.match(/reps?:\s*(\d+(?:-\d+)?)/i);if(g)d=g[1];else{const b=p.match(/\dx(\d+(?:-\d+)?)/i);b&&(d=b[1])}const y=p.match(/(\d+(?:s|sec|seconds?|min|minutes?))/i)||p.match(/rest:\s*(\d+(?:s|sec|min)?)/i);y&&(h=y[1].toLowerCase().replace("seconds","s").replace("sec","s").replace("minutes","min").replace("minute","min"));const _=p.match(/^([A-Za-z][\w\s\-'()]+?)(?:\s*[-:|]|\s+\d)/);_?a=_[1].trim():/^[A-Za-z][\w\s\-'()]+$/.test(p)&&p.length<50&&(a=p),a&&!a.match(/^(sets?|reps?|rest|action|next|step)/i)&&e.push({id:`ex-${Date.now()}-${e.length}`,name:a,sets:c,reps:d,rest:h,completed:!1})}return{title:n,exercises:e}},g2=t=>{const e=/Day\s+(\d+):?\s*(.+?)(?=Day\s+\d+:|$)/gis,n=Array.from(t.matchAll(e));if(n.length<2){const{title:s,exercises:o}=Bp(t);return{isMultiDay:!1,days:[{dayNumber:1,title:s,exercises:o,isRestDay:o.length===0}]}}const r=n.map(s=>{const o=parseInt(s[1]),i=s[2].trim(),a=/^(rest|recovery|off)\s*$/i.test(i)||i.toLowerCase().includes("rest day"),c=i.match(/repeat\s+day\s+(\d+)/i);if(a)return{dayNumber:o,title:"Rest Day",exercises:[],isRestDay:!0};if(c)return{dayNumber:o,title:i,exercises:[],isRestDay:!1,repeatsDayNumber:parseInt(c[1])};const{title:d,exercises:h}=Bp(i);return{dayNumber:o,title:d==="AI Workout Plan"?i.split(`
`)[0]:d,exercises:h,isRestDay:h.length===0}});return r.forEach(s=>{if(s.repeatsDayNumber){const o=s.repeatsDayNumber,i=r.find(a=>a.dayNumber===o);i&&(s.title=i.title,s.exercises=i.exercises.map(a=>({...a,id:`ex-${Date.now()}-${Math.random()}`}))),delete s.repeatsDayNumber}}),{isMultiDay:!0,days:r}},y2=({isOpen:t,onClose:e,workoutText:n})=>{const[r,s]=k.useState(new Date().toISOString().split("T")[0]),[o,i]=k.useState(!1),[a,c]=k.useState(null);if(k.useEffect(()=>{if(t&&n){const _=g2(n);c(_)}},[t,n]),!t)return null;const d=async()=>{if(a){i(!0);try{await ak(r,a.days);const _=a.days.length,b=a.isMultiDay?`${_}-day`:"single-day";alert(`${b} workout plan saved successfully! Go check it out in the Workout Plan page.`),e()}catch(_){console.error("Failed to save workout:",_),alert("Failed to save workout plan")}finally{i(!1)}}},h=()=>{if(!a||!a.isMultiDay)return null;const _=new Date(r),b=new Date(_);return b.setDate(b.getDate()+a.days.length-1),b.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),m=h(),g=(a==null?void 0:a.days.length)||0,y=(a==null?void 0:a.isMultiDay)||!1;return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300 px-6",children:l.jsxs(rt,{className:"w-full max-w-md animate-in zoom-in-95 duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-white/10",children:[l.jsx("h2",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50",children:"Save Workout Plan"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:l.jsx(Tt,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[y&&l.jsxs("div",{className:"p-4 bg-royal-50 dark:bg-royal-950/20 border-2 border-royal-200 dark:border-royal-800/50 rounded-xl",children:[l.jsxs("p",{className:"text-sm font-bold text-royal-900 dark:text-royal-100 mb-1",children:[" ",g,"-Day Workout Plan"]}),l.jsxs("p",{className:"text-xs text-royal-700 dark:text-royal-300",children:["Will be saved from ",l.jsx("strong",{children:p})," to ",l.jsx("strong",{children:m})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:y?"Choose Start Date":"Choose Date"}),l.jsx("input",{type:"date",value:r,onChange:_=>s(_.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"}),l.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:y?`Select the first day of your ${g}-day plan`:"Select which day you want to use this workout plan"})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-100 dark:border-white/10",children:[l.jsx("button",{onClick:e,disabled:o,className:"px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 rounded-xl font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),l.jsxs("button",{onClick:d,disabled:o,className:"flex items-center gap-2 px-6 py-3 bg-royal-600 hover:bg-royal-700 text-white rounded-xl font-semibold transition-colors disabled:opacity-50 shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:[l.jsx(Qu,{size:18}),l.jsx("span",{children:o?"Saving...":y?`Save ${g}-Day Plan`:"Save Plan"})]})]})]})})},v2=({onNavigate:t})=>{const[e,n]=k.useState([]),[r,s]=k.useState(""),[o,i]=k.useState(!1),[a,c]=k.useState(null),[d,h]=k.useState(!1),[p,m]=k.useState(new Set),[g,y]=k.useState(!1),[_,b]=k.useState(!0),[x,w]=k.useState(!1),[v,S]=k.useState(""),T=k.useRef(null),E=k.useRef(null),C=k.useRef(null),P=N=>!!(N.activityLevel&&N.goal&&N.equipmentAccess);k.useEffect(()=>{(async()=>{const q=await Wy();if(c(q),!P(q)){h(!0);return}await ik();const B=Qn(),X=await ok();if(X.length>0)n(X),m(new Set([B]));else{const M={id:crypto.randomUUID(),role:"assistant",content:` ** Hi ${q.userName||"there"} !I'm Cal Coach.**

How can I help you today?`,timestamp:Date.now()};n([M])}})()},[]),k.useEffect(()=>{var N;(N=T.current)==null||N.scrollIntoView({behavior:"smooth"})},[e]);const R=async()=>{var q;if(!r.trim()||o)return;const N={id:crypto.randomUUID(),role:"user",content:r,timestamp:Date.now()};n(B=>[...B,N]),s(""),i(!0),Dr(N).catch(B=>console.error("Failed to save user message:",B));try{const B=await Nl(r,e),X={id:crypto.randomUUID(),role:"assistant",content:B,timestamp:Date.now()};n(M=>[...M,X]),Dr(X).catch(M=>console.error("Failed to save assistant message:",M))}catch(B){const X={id:crypto.randomUUID(),role:"assistant",content:` ${B.message||"Failed to get response. Please try again."}`,timestamp:Date.now()};n(M=>[...M,X])}finally{i(!1),(q=E.current)==null||q.focus()}},I=N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),R())},V=()=>{t(ve.PROFILE)},Y=async()=>{if(!(g||!_)){y(!0);try{const q=Array.from(p).sort()[0];if(!q){b(!1);return}const B=new Date(q);B.setDate(B.getDate()-1);const X=B.toISOString().split("T")[0],M=new Date().toISOString().split("T")[0];if(Math.floor((new Date(M).getTime()-new Date(X).getTime())/(1e3*60*60*24))>=30){b(!1);return}const j=await V0(X);if(j.length>0){const J=C.current,U=(J==null?void 0:J.scrollHeight)||0;n(Z=>[...j,...Z]),m(Z=>new Set([...Z,X])),setTimeout(()=>{if(J){const Z=J.scrollHeight;J.scrollTop=Z-U}},0)}else m(J=>new Set([...J,X]))}catch(N){console.error("Failed to load previous day messages:",N)}finally{y(!1)}}},Q=()=>{const N=C.current;if(!N)return;const q=p.size>0;N.scrollTop<100&&!g&&_&&q&&Y()};return d?l.jsx("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:l.jsx("div",{className:"flex-1 flex items-center justify-center px-6",children:l.jsxs(rt,{className:"p-8 max-w-md w-full relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-32 h-32 bg-royal-100 dark:bg-royal-950/20 rounded-full blur-3xl"}),l.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-32 h-32 bg-royal-100 dark:bg-royal-950/20 rounded-full blur-3xl"}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-lg mx-auto mb-6",children:l.jsx(Mf,{size:32})}),l.jsx("h2",{className:"text-2xl font-extrabold text-gray-900 dark:text-gray-50 text-center mb-3",children:"Set Your Training Goals"}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6 leading-relaxed",children:["To provide you with personalized AI coaching, please complete your"," ",l.jsx("span",{className:"font-bold text-royal-600 dark:text-royal-400",children:"Training Goal Setting"})," ","in your Profile."]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-4 mb-6",children:[l.jsx("p",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-3",children:"We need to know:"}),l.jsxs("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:""}),l.jsx("span",{children:"Your activity level (sedentary to extra active)"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:""}),l.jsx("span",{children:"Your fitness goal (cut, bulk, or maintain)"})]}),l.jsxs("li",{className:"flex items-start gap-2",children:[l.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:""}),l.jsx("span",{children:"Your equipment access (gym, home, or bodyweight)"})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:V,className:"w-full flex items-center justify-center gap-2 py-4 bg-royal-600 hover:bg-royal-700 text-white rounded-[20px] font-bold transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[l.jsx(Mf,{size:20}),l.jsx("span",{children:"Go to Profile"}),l.jsx(Ki,{size:20})]}),l.jsx("button",{onClick:()=>h(!1),className:"w-full py-3 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 rounded-[20px] font-semibold transition-all text-sm",children:"I'll do this later"})]})]})]})})}):l.jsxs("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:[l.jsxs("header",{className:"flex justify-between items-end mb-6 flex-shrink-0",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:"Your Personal Coach"}),l.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight leading-none",children:"Cal Coach"})]}),l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-sm",children:l.jsx(wt,{size:20})})]}),l.jsxs("div",{ref:C,onScroll:Q,className:"flex-1 overflow-y-auto space-y-4 mb-4 no-scrollbar",children:[g&&l.jsx("div",{className:"flex justify-center py-3 animate-in fade-in duration-300",children:l.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 text-sm",children:[l.jsx(bi,{size:14,className:"animate-spin"}),l.jsx("span",{children:"Loading previous messages..."})]})}),!g&&_&&e.length>1&&l.jsx("div",{className:"flex justify-center py-2",children:l.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:" Scroll up to load older messages"})}),e.map(N=>l.jsx("div",{className:`flex ${N.role==="user"?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-2 duration-300`,children:l.jsx("div",{className:`max-w-[85%] ${N.role==="user"?"bg-royal-600 text-white rounded-[24px] px-5 py-3 shadow-lg":""}`,children:N.role==="assistant"?l.jsxs("div",{children:[l.jsx(rt,{className:"p-5",children:l.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:l.jsx("div",{className:"text-gray-800 dark:text-gray-200 leading-relaxed whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:N.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br/>")}})})}),m2(N.content)&&l.jsxs("button",{onClick:()=>{S(N.content),w(!0)},className:"mt-3 flex items-center gap-2 px-4 py-2 bg-royal-600 hover:bg-royal-700 text-white text-sm font-semibold rounded-xl transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[l.jsx(Qu,{size:16}),l.jsx("span",{children:"Save as Workout Plan"})]})]}):l.jsx("p",{className:"text-sm font-medium leading-relaxed",children:N.content})})},N.id)),e.length===1&&e[0].role==="assistant"&&!o&&l.jsx("div",{className:"grid grid-cols-1 gap-3 mt-4 animate-in fade-in slide-in-from-bottom-4 duration-500 delay-300",children:[{title:"Analyze Nutrition",desc:"Get insights on your recent eating habits",icon:"",text:"Analyze my recent nutrition",color:"from-blue-500/30 to-royal-500/30",baseBg:"bg-blue-50/40 dark:bg-blue-900/10",iconBg:"bg-blue-100 dark:bg-blue-900/40",iconBorder:"border-blue-200 dark:border-blue-700/50"},{title:"Workout Plan",desc:"Create a personalized fitness routine",icon:"",text:"Create a workout plan for me",color:"from-royal-500/30 to-indigo-500/30",baseBg:"bg-royal-50/40 dark:bg-royal-950/20",iconBg:"bg-royal-100 dark:bg-royal-950/40",iconBorder:"border-royal-200 dark:border-royal-700/50"},{title:"Calculate TDEE",desc:"Find out your daily energy expenditure",icon:"",text:"Calculate my TDEE",color:"from-orange-500/30 to-royal-500/30",baseBg:"bg-orange-50/40 dark:bg-orange-900/10",iconBg:"bg-orange-100 dark:bg-orange-900/40",iconBorder:"border-orange-200 dark:border-orange-700/50"},{title:"Macro Targets",desc:"Set optimal protein, carb, and fat goals",icon:"",text:"Help me set macro targets",color:"from-violet-500/30 to-fuchsia-500/30",baseBg:"bg-violet-50/40 dark:bg-violet-900/10",iconBg:"bg-violet-100 dark:bg-violet-900/40",iconBorder:"border-violet-200 dark:border-violet-700/50"}].map((N,q)=>l.jsxs("button",{onClick:()=>{(async X=>{if(o)return;const M={id:crypto.randomUUID(),role:"user",content:X,timestamp:Date.now()};n(F=>[...F,M]),i(!0),Dr(M).catch(F=>console.error("Failed to save user message:",F));try{const F=await Nl(X,e),j={id:crypto.randomUUID(),role:"assistant",content:F,timestamp:Date.now()};n(J=>[...J,j]),Dr(j).catch(J=>console.error("Failed to save assistant message:",J))}catch(F){const j={id:crypto.randomUUID(),role:"assistant",content:` ${F.message||"Failed to get response."}`,timestamp:Date.now()};n(J=>[...J,j])}finally{i(!1)}})(N.text)},className:`flex items-center gap-4 p-4 ${N.baseBg} border-2 border-gray-100 dark:border-white/10 rounded-2xl hover:border-royal-500 dark:hover:border-royal-400 hover:shadow-xl hover:shadow-royal-500/10 transition-all text-left group active:scale-[0.98] relative overflow-hidden`,children:[l.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${N.color} opacity-0 group-hover:opacity-100 transition-opacity`}),l.jsx("div",{className:`relative z-10 w-12 h-12 ${N.iconBg} ${N.iconBorder} border rounded-xl flex items-center justify-center text-2xl group-hover:scale-110 transition-transform shadow-sm group-hover:shadow-md`,children:N.icon}),l.jsxs("div",{className:"relative z-10 flex-1",children:[l.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 text-sm tracking-tight",children:N.title}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-0.5 font-semibold opacity-80",children:N.desc})]}),l.jsx("div",{className:"relative z-10 w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 dark:bg-white/10 group-hover:bg-royal-500 group-hover:text-white transition-all shadow-sm",children:l.jsx(Ki,{size:16,className:"text-gray-400 dark:text-gray-500 group-hover:text-white group-hover:translate-x-0.5 transition-all"})})]},q))}),o&&l.jsx("div",{className:"flex justify-start animate-in fade-in duration-300",children:l.jsx(rt,{className:"p-5",children:l.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[l.jsx(bi,{size:16,className:"animate-spin"}),l.jsx("span",{className:"text-sm",children:"Coach is thinking..."})]})})}),l.jsx("div",{ref:T})]}),e.length>1&&!o&&l.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 px-1 no-scrollbar animate-in fade-in slide-in-from-bottom-2 duration-500",children:[{title:"Analyze Nutrition",icon:"",text:"Analyze my recent nutrition",color:"from-blue-500/30 to-royal-500/30",baseBg:"bg-blue-50/40 dark:bg-blue-900/10",iconBg:"bg-blue-100 dark:bg-blue-900/40",iconBorder:"border-blue-200 dark:border-blue-700/50"},{title:"Workout Plan",icon:"",text:"Create a workout plan for me",color:"from-royal-500/30 to-indigo-500/30",baseBg:"bg-royal-50/40 dark:bg-royal-950/20",iconBg:"bg-royal-100 dark:bg-royal-950/40",iconBorder:"border-royal-200 dark:border-royal-700/50"},{title:"Calculate TDEE",icon:"",text:"Calculate my TDEE",color:"from-orange-500/30 to-royal-500/30",baseBg:"bg-orange-50/40 dark:bg-orange-900/10",iconBg:"bg-orange-100 dark:bg-orange-900/40",iconBorder:"border-orange-200 dark:border-orange-700/50"},{title:"Macro Targets",icon:"",text:"Help me set macro targets",color:"from-violet-500/30 to-fuchsia-500/30",baseBg:"bg-violet-50/40 dark:bg-violet-900/10",iconBg:"bg-violet-100 dark:bg-violet-900/40",iconBorder:"border-violet-200 dark:border-violet-700/50"}].map((N,q)=>l.jsxs("button",{onClick:()=>{(async X=>{if(o)return;const M={id:`user-${Date.now()}`,role:"user",content:X,timestamp:Date.now()};n(F=>[...F,M]),i(!0),Dr(M).catch(F=>console.error("Failed to save user message:",F));try{const F=await Nl(X,e),j={id:crypto.randomUUID(),role:"assistant",content:F,timestamp:Date.now()};n(J=>[...J,j]),Dr(j).catch(J=>console.error("Failed to save assistant message:",J))}catch(F){const j={id:`error-${Date.now()}`,role:"assistant",content:` ${F.message||"Failed to get response."}`,timestamp:Date.now()};n(J=>[...J,j])}finally{i(!1)}})(N.text)},className:`flex flex-shrink-0 items-center gap-3 p-3 min-w-[180px] ${N.baseBg} border-2 border-gray-100 dark:border-white/10 rounded-2xl hover:border-royal-500 dark:hover:border-royal-400 transition-all text-left group active:scale-[0.98] relative overflow-hidden`,children:[l.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${N.color} opacity-0 group-hover:opacity-100 transition-opacity`}),l.jsx("div",{className:`relative z-10 w-10 h-10 ${N.iconBg} ${N.iconBorder} border rounded-xl flex items-center justify-center text-xl group-hover:scale-110 transition-transform shadow-sm`,children:N.icon}),l.jsx("div",{className:"relative z-10 flex-1",children:l.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 text-xs tracking-tight leading-tight",children:N.title})})]},q))}),l.jsx("div",{className:"flex-shrink-0 bg-white dark:bg-[#1a1c26] rounded-[24px] p-3 shadow-diffused dark:shadow-diffused-dark border border-gray-100 dark:border-white/5",children:l.jsxs("div",{className:"flex gap-2 items-end",children:[l.jsx("textarea",{ref:E,value:r,onChange:N=>s(N.target.value),onKeyDown:I,placeholder:"Ask your coach anything...",className:"flex-1 bg-transparent text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 resize-none outline-none text-sm min-h-[40px] max-h-[120px] py-2 px-3",rows:1,disabled:o}),l.jsx("button",{onClick:R,disabled:!r.trim()||o,className:"flex-shrink-0 w-10 h-10 bg-royal-600 text-white rounded-[16px] flex items-center justify-center hover:bg-royal-700 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:o?l.jsx(bi,{size:18,className:"animate-spin"}):l.jsx(n_,{size:18})})]})}),l.jsx(y2,{isOpen:x,onClose:()=>w(!1),workoutText:v})]})},x2=[{id:"upper-body",name:"Upper Body",icon:"Dumbbell",color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-500",category:"strength",defaultExercises:[{name:"Bench Press",sets:4,reps:"8-10",rest:"90s"},{name:"Shoulder Press",sets:3,reps:"10-12",rest:"60s"},{name:"Bent Over Row",sets:4,reps:"8-10",rest:"90s"},{name:"Bicep Curls",sets:3,reps:"12-15",rest:"45s"},{name:"Tricep Dips",sets:3,reps:"10-12",rest:"45s"}]},{id:"lower-body",name:"Lower Body",icon:"Footprints",color:"text-red-600 dark:text-red-400",bgColor:"bg-red-500",category:"strength",defaultExercises:[{name:"Squats",sets:4,reps:"8-10",rest:"90s"},{name:"Romanian Deadlift",sets:3,reps:"10-12",rest:"90s"},{name:"Leg Press",sets:3,reps:"12-15",rest:"60s"},{name:"Lunges",sets:3,reps:"10 each leg",rest:"60s"},{name:"Calf Raises",sets:4,reps:"15-20",rest:"45s"}]},{id:"core",name:"Core",icon:"Target",color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-500",category:"strength",defaultExercises:[{name:"Plank",sets:3,reps:"60s hold",rest:"30s"},{name:"Russian Twists",sets:3,reps:"20 total",rest:"30s"},{name:"Bicycle Crunches",sets:3,reps:"20 total",rest:"30s"},{name:"Leg Raises",sets:3,reps:"12-15",rest:"30s"},{name:"Dead Bug",sets:3,reps:"10 each side",rest:"30s"}]},{id:"full-body",name:"Full Body",icon:"Zap",color:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-500",category:"strength",defaultExercises:[{name:"Deadlift",sets:4,reps:"6-8",rest:"120s"},{name:"Pull-ups",sets:3,reps:"8-10",rest:"90s"},{name:"Push-ups",sets:3,reps:"15-20",rest:"60s"},{name:"Goblet Squat",sets:3,reps:"12-15",rest:"60s"},{name:"Plank",sets:3,reps:"45s hold",rest:"30s"}]},{id:"running",name:"Running",icon:"PersonStanding",color:"text-green-600 dark:text-green-400",bgColor:"bg-green-500",category:"cardio",defaultExercises:[{name:"Warm-up Jog",sets:1,reps:"5 min",rest:"0s"},{name:"Interval Sprints",sets:6,reps:"30s sprint",rest:"60s"},{name:"Steady Run",sets:1,reps:"15 min",rest:"0s"},{name:"Cool-down Walk",sets:1,reps:"5 min",rest:"0s"}]},{id:"hiit",name:"HIIT",icon:"Flame",color:"text-rose-600 dark:text-rose-400",bgColor:"bg-rose-500",category:"cardio",defaultExercises:[{name:"Burpees",sets:4,reps:"10",rest:"30s"},{name:"Mountain Climbers",sets:4,reps:"20",rest:"30s"},{name:"Jump Squats",sets:4,reps:"15",rest:"30s"},{name:"High Knees",sets:4,reps:"30s",rest:"30s"},{name:"Box Jumps",sets:3,reps:"10",rest:"45s"}]},{id:"cycling",name:"Cycling",icon:"Bike",color:"text-cyan-600 dark:text-cyan-400",bgColor:"bg-cyan-500",category:"cardio",defaultExercises:[{name:"Warm-up Ride",sets:1,reps:"5 min",rest:"0s"},{name:"Hill Climbs",sets:4,reps:"3 min",rest:"2 min"},{name:"Flat Sprints",sets:6,reps:"1 min",rest:"1 min"},{name:"Endurance Pace",sets:1,reps:"20 min",rest:"0s"},{name:"Cool-down",sets:1,reps:"5 min",rest:"0s"}]},{id:"walking",name:"Walking",icon:"Footprints",color:"text-teal-600 dark:text-teal-400",bgColor:"bg-teal-500",category:"cardio",defaultExercises:[{name:"Brisk Walk",sets:1,reps:"30 min",rest:"0s"},{name:"Incline Walk",sets:3,reps:"5 min",rest:"2 min"},{name:"Power Walk",sets:2,reps:"10 min",rest:"5 min"}]},{id:"yoga",name:"Yoga",icon:"Leaf",color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-500",category:"flexibility",defaultExercises:[{name:"Sun Salutation",sets:3,reps:"5 breaths each",rest:"0s"},{name:"Warrior Poses",sets:2,reps:"5 breaths each",rest:"0s"},{name:"Downward Dog",sets:3,reps:"30s hold",rest:"0s"},{name:"Child's Pose",sets:2,reps:"1 min",rest:"0s"},{name:"Savasana",sets:1,reps:"5 min",rest:"0s"}]},{id:"stretching",name:"Stretching",icon:"Sparkles",color:"text-sky-600 dark:text-sky-400",bgColor:"bg-sky-500",category:"flexibility",defaultExercises:[{name:"Neck Stretches",sets:2,reps:"30s each side",rest:"0s"},{name:"Shoulder Stretch",sets:2,reps:"30s each",rest:"0s"},{name:"Hamstring Stretch",sets:2,reps:"45s each leg",rest:"0s"},{name:"Hip Flexor Stretch",sets:2,reps:"45s each",rest:"0s"},{name:"Quad Stretch",sets:2,reps:"30s each leg",rest:"0s"}]},{id:"pilates",name:"Pilates",icon:"Waves",color:"text-indigo-600 dark:text-indigo-400",bgColor:"bg-indigo-500",category:"flexibility",defaultExercises:[{name:"The Hundred",sets:1,reps:"100 pumps",rest:"30s"},{name:"Roll Up",sets:8,reps:"1 rep",rest:"0s"},{name:"Single Leg Circles",sets:2,reps:"10 each leg",rest:"0s"},{name:"Swimming",sets:3,reps:"30s",rest:"15s"},{name:"Spine Stretch",sets:3,reps:"5 reps",rest:"0s"}]},{id:"swimming",name:"Swimming",icon:"Waves",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-500",category:"sports",defaultExercises:[{name:"Freestyle",sets:4,reps:"100m",rest:"30s"},{name:"Backstroke",sets:3,reps:"50m",rest:"30s"},{name:"Breaststroke",sets:3,reps:"50m",rest:"30s"},{name:"Kickboard Drills",sets:4,reps:"50m",rest:"20s"},{name:"Cool-down Swim",sets:1,reps:"200m easy",rest:"0s"}]},{id:"martial-arts",name:"Martial Arts",icon:"Sword",color:"text-slate-600 dark:text-slate-400",bgColor:"bg-slate-500",category:"sports",defaultExercises:[{name:"Shadow Boxing",sets:3,reps:"3 min",rest:"1 min"},{name:"Bag Work",sets:4,reps:"3 min",rest:"1 min"},{name:"Kicks Practice",sets:3,reps:"20 each leg",rest:"30s"},{name:"Footwork Drills",sets:3,reps:"2 min",rest:"30s"},{name:"Cool-down Stretch",sets:1,reps:"5 min",rest:"0s"}]},{id:"dance",name:"Dance",icon:"Music",color:"text-pink-600 dark:text-pink-400",bgColor:"bg-pink-500",category:"sports",defaultExercises:[{name:"Warm-up Dance",sets:1,reps:"5 min",rest:"0s"},{name:"Choreography Practice",sets:3,reps:"10 min",rest:"2 min"},{name:"Freestyle",sets:2,reps:"5 min",rest:"1 min"},{name:"Cool-down Stretch",sets:1,reps:"5 min",rest:"0s"}]}],Vp=[{id:"strength",name:"Strength",icon:"Dumbbell"},{id:"cardio",name:"Cardio",icon:"Heart"},{id:"flexibility",name:"Flexibility",icon:"Leaf"},{id:"sports",name:"Sports",icon:"Trophy"}],w2={Dumbbell:ys,Heart:bc,Leaf:Vw,Trophy:o_,Footprints:Ow,Target:vs,Zap:Xu,Flame:a0,Bike:Mw,PersonStanding:Zw,Sparkles:wt,Waves:a_,Music:Kw,Sword:s_},_2=({isOpen:t,onClose:e,defaultDate:n,onSave:r})=>{var R;const[s,o]=k.useState("select"),[i,a]=k.useState(null),[c,d]=k.useState(n.toISOString().split("T")[0]),[h,p]=k.useState([]),[m,g]=k.useState(!1),[y,_]=k.useState("strength");if(!t)return null;const b=I=>{a(I),p([...I.defaultExercises]),o("customize")},x=()=>{o("select"),a(null),p([])},w=()=>{p([...h,{name:"",sets:3,reps:"10",rest:"60s"}])},v=I=>{p(h.filter((V,Y)=>Y!==I))},S=(I,V,Y)=>{const Q=[...h];Q[I]={...Q[I],[V]:Y},p(Q)},T=async()=>{if(!i)return;const I=h.filter(V=>V.name.trim());if(I.length===0){alert("Please add at least one exercise");return}g(!0);try{const V=I.map((Y,Q)=>({...Y,id:`ex-${Date.now()}-${Q}`,completed:!1}));await ra(c,i.name,V,void 0,i.id),o("select"),a(null),p([]),d(n.toISOString().split("T")[0]),r==null||r(),e()}catch(V){console.error("Failed to save workout:",V),alert("Failed to save workout plan")}finally{g(!1)}},E=()=>{o("select"),a(null),p([]),e()},C=x2.filter(I=>I.category===y),P=(I,V=24,Y="")=>{const Q=w2[I];return Q?l.jsx(Q,{size:V,className:Y}):null};return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300 px-4",children:l.jsxs(rt,{className:"w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col animate-in zoom-in-95 duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-100 dark:border-white/10",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[s==="customize"&&l.jsx("button",{onClick:x,className:"p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:l.jsx(_r,{size:20,className:"text-gray-500 dark:text-gray-400"})}),l.jsx("h2",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50",children:s==="select"?"Choose Workout":i==null?void 0:i.name})]}),l.jsx("button",{onClick:E,className:"p-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:l.jsx(Tt,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),s==="select"?l.jsxs("div",{className:"flex-1 overflow-y-auto p-5",children:[l.jsx("div",{className:"flex gap-2 mb-5 overflow-x-auto no-scrollbar pb-1",children:Vp.map(I=>l.jsxs("button",{onClick:()=>_(I.id),className:`
                                        flex items-center gap-2 px-4 py-2.5 rounded-full font-bold text-sm whitespace-nowrap transition-all
                                        ${y===I.id?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40":"bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-white/10"}
                                    `,children:[P(I.icon,16),l.jsx("span",{children:I.name})]},I.id))}),l.jsx("div",{className:"grid grid-cols-2 gap-3",children:C.map(I=>l.jsxs("button",{onClick:()=>b(I),className:"group relative p-5 bg-gray-50 dark:bg-white/5 hover:bg-gray-100 dark:hover:bg-white/10 rounded-2xl transition-all hover:scale-[1.02] active:scale-[0.98] text-left border-2 border-transparent hover:border-gray-200 dark:hover:border-white/10",children:[l.jsx("div",{className:`w-12 h-12 ${I.bgColor} rounded-xl flex items-center justify-center mb-3 shadow-lg group-hover:scale-110 transition-transform`,children:P(I.icon,24,"text-white")}),l.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 mb-1",children:I.name}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[I.defaultExercises.length," exercises"]})]},I.id))})]}):l.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-5",children:[i&&l.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-white/5 rounded-xl",children:[l.jsx("div",{className:`w-10 h-10 ${i.bgColor} rounded-lg flex items-center justify-center`,children:P(i.icon,20,"text-white")}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-semibold uppercase tracking-wide",children:(R=Vp.find(I=>I.id===i.category))==null?void 0:R.name}),l.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-50",children:i.name})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),l.jsx("input",{type:"date",value:c,onChange:I=>d(I.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300",children:"Exercises"}),l.jsxs("button",{onClick:w,className:"flex items-center gap-1 px-3 py-1.5 bg-royal-600 hover:bg-royal-700 text-white text-sm font-semibold rounded-lg transition-colors",children:[l.jsx(Qi,{size:16}),l.jsx("span",{children:"Add"})]})]}),l.jsx("div",{className:"space-y-3",children:h.map((I,V)=>l.jsx("div",{className:"p-4 bg-gray-50 dark:bg-white/5 rounded-xl border-2 border-gray-100 dark:border-white/5",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsxs("div",{className:"flex-1 space-y-3",children:[l.jsx("input",{type:"text",value:I.name,onChange:Y=>S(V,"name",Y.target.value),placeholder:"Exercise name",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1",children:"Sets"}),l.jsx("input",{type:"number",value:I.sets,onChange:Y=>S(V,"sets",parseInt(Y.target.value)||0),min:"1",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1",children:"Reps"}),l.jsx("input",{type:"text",value:I.reps,onChange:Y=>S(V,"reps",Y.target.value),placeholder:"8-10",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1",children:"Rest"}),l.jsx("input",{type:"text",value:I.rest,onChange:Y=>S(V,"rest",Y.target.value),placeholder:"60s",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]})]})]}),h.length>1&&l.jsx("button",{onClick:()=>v(V),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg transition-colors",children:l.jsx(wo,{size:18})})]})},V))})]})]}),s==="customize"&&l.jsxs("div",{className:"flex items-center justify-end gap-3 p-5 border-t border-gray-100 dark:border-white/10",children:[l.jsx("button",{onClick:E,disabled:m,className:"px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 rounded-xl font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),l.jsx("button",{onClick:T,disabled:m,className:"px-6 py-3 bg-royal-600 hover:bg-royal-700 text-white rounded-xl font-semibold transition-colors disabled:opacity-50 shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:m?"Saving...":"Save Workout"})]})]})})},b2=({isOpen:t,onClose:e,exercise:n,onSave:r})=>{const[s,o]=k.useState(""),[i,a]=k.useState(3),[c,d]=k.useState("10"),[h,p]=k.useState("60s"),[m,g]=k.useState(!1);if(k.useEffect(()=>{n&&(o(n.name),a(n.sets),d(n.reps),p(n.rest))},[n]),!t||!n)return null;const y=async()=>{if(!s.trim()){alert("Please enter an exercise name");return}g(!0);const _={...n,name:s.trim(),sets:i,reps:c.trim(),rest:h.trim()};r(_),g(!1)};return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300 px-6",children:l.jsxs(rt,{className:"w-full max-w-md animate-in zoom-in-95 duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-white/10",children:[l.jsx("h2",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50",children:"Edit Exercise"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:l.jsx(Tt,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Exercise Name"}),l.jsx("input",{type:"text",value:s,onChange:_=>o(_.target.value),placeholder:"e.g., Bench Press",className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Sets"}),l.jsx("input",{type:"number",value:i,onChange:_=>a(parseInt(_.target.value)||0),min:"1",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Reps"}),l.jsx("input",{type:"text",value:c,onChange:_=>d(_.target.value),placeholder:"8-10",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Rest"}),l.jsx("input",{type:"text",value:h,onChange:_=>p(_.target.value),placeholder:"60s",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-100 dark:border-white/10",children:[l.jsx("button",{onClick:e,disabled:m,className:"px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 rounded-xl font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),l.jsxs("button",{onClick:y,disabled:m,className:"flex items-center gap-2 px-6 py-3 bg-royal-600 hover:bg-royal-700 text-white rounded-xl font-semibold transition-colors disabled:opacity-50 shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:[l.jsx(Qu,{size:18}),l.jsx("span",{children:m?"Saving...":"Save Changes"})]})]})]})})},S2=({onNavigate:t})=>{const[e,n]=k.useState(new Date),[r,s]=k.useState(new Date),[o,i]=k.useState([]),[a,c]=k.useState(new Set),[d,h]=k.useState(!1),[p,m]=k.useState(!1),[g,y]=k.useState(null),[_,b]=k.useState(null),[x,w]=k.useState(!1),v=async()=>{const U=e.getFullYear(),Z=e.getMonth()+1,te=await oh(U,Z);c(new Set(te));const ce=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`,D=await sh(ce);i(D)};k.useEffect(()=>{(async()=>{const Z=e.getFullYear(),te=e.getMonth()+1,ce=await oh(Z,te);c(new Set(ce))})()},[e]),k.useEffect(()=>{(async()=>{h(!0);const Z=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`,te=await sh(Z);i(te),h(!1)})()},[r]);const T=(()=>{const U=e.getFullYear(),Z=e.getMonth(),te=new Date(U,Z,1),ce=new Date(U,Z+1,0),D=te.getDay(),ie=ce.getDate(),fe=[];for(let Ae=0;Ae<D;Ae++)fe.push(null);for(let Ae=1;Ae<=ie;Ae++)fe.push(new Date(U,Z,Ae));return fe})(),E=new Date;E.setHours(0,0,0,0);const C=(U,Z)=>U.getFullYear()===Z.getFullYear()&&U.getMonth()===Z.getMonth()&&U.getDate()===Z.getDate(),P=()=>{n(new Date(e.getFullYear(),e.getMonth()-1))},R=()=>{n(new Date(e.getFullYear(),e.getMonth()+1))},I=U=>{s(U)},V=(U,Z)=>{i(te=>te.map(ce=>ce.id===U?{...ce,exercises:ce.exercises.map(D=>D.id===Z?{...D,completed:!D.completed}:D)}:ce))},Y=(U,Z)=>{b(U),y(Z),w(!0)},Q=async(U,Z)=>{const te=o.find(ce=>ce.id===U);if(te&&confirm("Are you sure you want to delete this exercise?")){const ce=te.exercises.filter(ie=>ie.id!==Z);i(ie=>ie.map(fe=>fe.id===U?{...fe,exercises:ce}:fe));const D=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;await ra(D,te.title,ce,U)}},N=async U=>{confirm("Are you sure you want to delete this entire workout plan?")&&(await lk(U),await v())},q=async U=>{if(!_)return;const Z=o.find(D=>D.id===_);if(!Z)return;const te=Z.exercises.map(D=>D.id===U.id?U:D);i(D=>D.map(ie=>ie.id===_?{...ie,exercises:te}:ie));const ce=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;await ra(ce,Z.title,te,_),w(!1),y(null),b(null)},B=o.flatMap(U=>U.exercises),X=B.filter(U=>U.completed).length,M=B.length,F=M>0?X/M*100:0,j=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],J=["January","February","March","April","May","June","July","August","September","October","November","December"];return l.jsxs("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:[l.jsxs("header",{className:"flex justify-between items-end mb-6 flex-shrink-0",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:"Your Training Schedule"}),l.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight leading-none",children:"Workout Plan"})]}),l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-sm",children:l.jsx(ys,{size:20})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 no-scrollbar",children:[l.jsxs(rt,{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Hn,{size:16,className:"text-royal-600 dark:text-royal-400"}),l.jsxs("h2",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 uppercase tracking-wide",children:[J[e.getMonth()]," ",e.getFullYear()]})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:P,className:"p-1.5 hover:bg-gray-100 dark:hover:bg-white/5 rounded-lg transition-colors",children:l.jsx(_r,{size:18,className:"text-gray-600 dark:text-gray-400"})}),l.jsx("button",{onClick:R,className:"p-1.5 hover:bg-gray-100 dark:hover:bg-white/5 rounded-lg transition-colors",children:l.jsx(mr,{size:18,className:"text-gray-600 dark:text-gray-400"})})]})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:j.map((U,Z)=>l.jsx("div",{className:"text-center text-xs font-bold text-gray-400 dark:text-gray-500 py-1",children:U},Z))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:T.map((U,Z)=>{if(!U)return l.jsx("div",{className:"aspect-square"},`empty-${Z}`);const te=C(U,r),ce=C(U,E),D=`${U.getFullYear()}-${String(U.getMonth()+1).padStart(2,"0")}-${String(U.getDate()).padStart(2,"0")}`,ie=a.has(D);return l.jsxs("button",{onClick:()=>I(U),className:`
                                        aspect-square flex flex-col items-center justify-center p-1 rounded-xl transition-all relative text-sm
                                        ${te?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 scale-105 font-bold":"bg-gray-50 dark:bg-white/5 text-gray-700 dark:text-gray-300 hover:bg-royal-50 dark:hover:bg-royal-900/20 hover:scale-105"}
                                    `,children:[l.jsx("span",{children:U.getDate()}),ce&&!te&&l.jsx("div",{className:"absolute bottom-1 w-1 h-1 bg-royal-600 dark:bg-royal-400 rounded-full"}),ie&&l.jsx("div",{className:`absolute top-1 right-1 w-1.5 h-1.5 rounded-full ${te?"bg-white":"bg-royal-600 dark:bg-royal-400"}`})]},Z)})})]}),d?l.jsx(rt,{className:"p-8",children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsx("div",{className:"w-8 h-8 border-2 border-royal-600 border-t-transparent rounded-full animate-spin"})})}):o.length>0?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-extrabold text-gray-900 dark:text-gray-50",children:C(r,E)?"Today's Workouts":"Workout Plans"}),l.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-semibold mt-0.5",children:[o.length," ",o.length===1?"workout":"workouts"," scheduled"]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-2xl font-extrabold text-royal-600 dark:text-royal-400",children:[X,"/",M]}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-semibold",children:"Overall Progress"})]})]}),l.jsx("div",{className:"bg-gray-100 dark:bg-white/5 rounded-full h-2 overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-royal-500 to-royal-600 transition-all duration-500 ease-out rounded-full",style:{width:`${F}%`}})}),o.map(U=>{const Z=U.exercises.filter(D=>D.completed).length,te=U.exercises.length,ce=te>0?Z/te*100:0;return l.jsxs(rt,{className:"p-6 border-2 border-gray-200 dark:border-white/10",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-base font-extrabold text-gray-900 dark:text-gray-50 mb-1",children:U.title}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400",children:[Z,"/",te," completed"]}),l.jsx("span",{className:"text-xs text-gray-400",children:""}),l.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Math.round(ce),"%"]})]})]}),l.jsx("button",{onClick:()=>N(U.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete entire workout",children:l.jsx(wo,{size:16,className:"text-red-600 dark:text-red-400"})})]}),l.jsx("div",{className:"mb-4 bg-gray-100 dark:bg-white/5 rounded-full h-1.5 overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-royal-500 to-royal-600 transition-all duration-500 ease-out rounded-full",style:{width:`${ce}%`}})}),l.jsx("div",{className:"space-y-3",children:U.exercises.map(D=>l.jsx("button",{onClick:()=>V(U.id,D.id),className:`
                                                    w-full text-left transition-all active:scale-[0.98]
                                                    ${D.completed?"opacity-60":""}
                                                `,children:l.jsx(rt,{className:`p-4 ${D.completed?"bg-royal-50/50 dark:bg-royal-900/10":""}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"flex-shrink-0 mt-0.5",children:D.completed?l.jsx(_i,{size:20,className:"text-royal-600 dark:text-royal-400",strokeWidth:2.5}):l.jsx(Lw,{size:20,className:"text-gray-300 dark:text-gray-600",strokeWidth:2})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h4",{className:`
                                                                font-bold text-sm mb-1.5
                                                                ${D.completed?"text-gray-500 dark:text-gray-400 line-through":"text-gray-900 dark:text-gray-50"}
                                                            `,children:D.name}),l.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Sets:"}),l.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:D.sets})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Reps:"}),l.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:D.reps})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Rest:"}),l.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:D.rest})]})]})]}),l.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 ml-2",children:[l.jsx("button",{onClick:ie=>{ie.stopPropagation(),Y(U.id,D)},className:"p-1.5 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Edit exercise",children:l.jsx(Qw,{size:14,className:"text-blue-600 dark:text-blue-400"})}),l.jsx("button",{onClick:ie=>{ie.stopPropagation(),Q(U.id,D.id)},className:"p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete exercise",children:l.jsx(wo,{size:14,className:"text-red-600 dark:text-red-400"})})]})]})})},D.id))}),Z===te&&te>0&&l.jsx("div",{className:"mt-4 p-4 bg-gradient-to-br from-royal-50 to-royal-100 dark:from-royal-950/30 dark:to-royal-900/20 border-2 border-royal-200 dark:border-royal-800/50 rounded-xl",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(_i,{size:20,className:"text-royal-600 dark:text-royal-400",strokeWidth:2.5}),l.jsx("p",{className:"text-sm font-bold text-royal-900 dark:text-royal-100",children:"Workout Complete! "})]})})]},U.id)}),l.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-center gap-2 py-4 bg-white dark:bg-white/5 hover:bg-royal-50 dark:hover:bg-royal-900/20 text-gray-900 dark:text-gray-50 rounded-[20px] font-bold transition-all border-2 border-dashed border-gray-300 dark:border-white/20 hover:border-royal-400 dark:hover:border-royal-600 active:scale-95",children:[l.jsx(Qi,{size:20}),l.jsx("span",{children:"Add Another Workout"})]}),X===M&&M>0&&l.jsx(rt,{className:"p-6 bg-gradient-to-br from-royal-50 to-royal-100 dark:from-royal-950/30 dark:to-royal-900/20 border-2 border-royal-200 dark:border-royal-800/50 animate-in fade-in slide-in-from-bottom-4 duration-500",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-royal-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:l.jsx(_i,{size:32,className:"text-white",strokeWidth:2.5})}),l.jsx("h3",{className:"text-xl font-extrabold text-royal-900 dark:text-royal-100 mb-2",children:"All Workouts Complete! "}),l.jsxs("p",{className:"text-sm text-royal-700 dark:text-royal-300 font-semibold",children:["Amazing work! You've completed all exercises for ",C(r,E)?"today":"this day","."]})]})})]}):l.jsx(rt,{className:"p-8",children:l.jsxs("div",{className:"text-center max-w-sm mx-auto",children:[l.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-white/10 dark:to-white/5 rounded-full flex items-center justify-center mx-auto mb-6",children:l.jsx(ys,{size:32,className:"text-gray-400 dark:text-gray-500"})}),l.jsx("h3",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"No Workout Plan Yet"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6 leading-relaxed",children:C(r,E)?"Ready to crush today's workout? Get a personalized plan from your AI coach or create your own!":"No workout plan for this date. Add one to stay on track!"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>t==null?void 0:t(ve.CAL_COACH),className:"w-full flex items-center justify-center gap-2 py-4 bg-royal-600 hover:bg-royal-700 text-white rounded-[20px] font-bold transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[l.jsx(wt,{size:20}),l.jsx("span",{children:"Get AI Plan from Coach"})]}),l.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-center gap-2 py-4 bg-white dark:bg-white/5 hover:bg-gray-50 dark:hover:bg-white/10 text-gray-900 dark:text-gray-50 rounded-[20px] font-bold transition-all border-2 border-gray-200 dark:border-white/10 active:scale-95",children:[l.jsx(Qi,{size:20}),l.jsx("span",{children:"Create Custom Plan"})]})]})]})})]}),l.jsx(b2,{isOpen:x,onClose:()=>{w(!1),y(null),b(null)},exercise:g,onSave:q}),l.jsx(_2,{isOpen:p,onClose:()=>m(!1),defaultDate:r,onSave:v})]})},k2=({summary:t,onClose:e})=>{const n=new Date(t.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl border border-white/50 animate-in slide-in-from-bottom duration-300",children:[l.jsxs("div",{className:"relative bg-royal-50 p-8 pb-10",children:[l.jsx("div",{className:"absolute top-6 right-6",children:l.jsx("button",{onClick:e,className:"p-2 bg-white text-gray-900 rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:l.jsx(Tt,{size:20})})}),l.jsxs("div",{className:"flex items-center gap-2 text-royal-600 mb-3",children:[l.jsx(Hn,{size:20}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Daily Report"})]}),l.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 leading-tight",children:n})]}),l.jsxs("div",{className:"p-8 -mt-6 bg-white rounded-t-[32px] relative shadow-[-10px_-10px_30px_rgba(0,0,0,0.02)]",children:[l.jsxs("div",{className:"bg-white rounded-[32px] p-6 border border-gray-100 shadow-[0_10px_30px_-10px_rgba(0,0,0,0.05)] mb-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 block",children:"Total Consumed"}),l.jsxs("div",{className:"flex items-baseline gap-1",children:[l.jsx("span",{className:"text-5xl font-extrabold text-gray-900 tracking-tighter",children:t.totalCalories}),l.jsx("span",{className:"text-gray-400 font-bold text-lg",children:"kcal"})]})]}),l.jsx("div",{className:"w-14 h-14 rounded-2xl bg-royal-50 flex items-center justify-center text-royal-600",children:l.jsx(Ju,{size:28})})]}),l.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[l.jsx(Yi,{size:16})," Macro Breakdown"]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[l.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-emerald-50 hover:border-emerald-100 transition-colors",children:l.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[l.jsx("div",{className:"w-1.5 h-10 bg-emerald-400 rounded-full"}),l.jsxs("div",{children:[l.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[t.totalProtein,"g"]}),l.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Protein"})]})]})}),l.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-blue-50 hover:border-blue-100 transition-colors",children:l.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[l.jsx("div",{className:"w-1.5 h-10 bg-blue-400 rounded-full"}),l.jsxs("div",{children:[l.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[t.totalCarbs,"g"]}),l.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Carbs"})]})]})}),l.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-orange-50 hover:border-orange-100 transition-colors",children:l.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[l.jsx("div",{className:"w-1.5 h-10 bg-orange-400 rounded-full"}),l.jsxs("div",{children:[l.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[t.totalFat,"g"]}),l.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Fat"})]})]})})]}),l.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 flex justify-between items-center text-xs font-bold text-gray-400 uppercase tracking-wider",children:[l.jsxs("span",{children:[t.entries.length," meals tracked"]}),l.jsxs("span",{className:"flex items-center gap-1.5 text-royal-600",children:[l.jsx(is,{size:14}),"See History Tab"]})]})]})]})})},E2=({onClose:t,onConfirm:e})=>{const[n,r]=k.useState(0),[s,o]=k.useState(""),[i,a]=k.useState(!1),[c,d]=k.useState(!0),[h,p]=k.useState(!1),[m,g]=k.useState(null);k.useEffect(()=>{(async()=>{const b=await Yn();b&&(g(b),r(b.weight),o(b.weight.toString())),d(!1)})()},[]);const y=async()=>{const _=parseFloat(s)||n;if(i&&m&&_!==n){p(!0);try{await Ma({...m,weight:_}),r(_)}catch(b){console.error("Failed to save weight:",b)}p(!1)}e(_)};return c?l.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center animate-in fade-in duration-300",children:l.jsx("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-8 w-[90%] max-w-sm shadow-2xl",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("div",{className:"w-8 h-8 border-2 border-royal-200 dark:border-royal-800 border-t-royal-600 rounded-full animate-spin"})})})}):l.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-end sm:items-center justify-center animate-in fade-in duration-300",onClick:t,children:l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-t-[28px] sm:rounded-[28px] p-6 w-full sm:w-[90%] sm:max-w-sm shadow-2xl animate-in slide-in-from-bottom duration-500",onClick:_=>_.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-royal-100 dark:bg-royal-900/30 flex items-center justify-center",children:l.jsx(d0,{size:20,className:"text-royal-600 dark:text-royal-400"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-black text-gray-900 dark:text-gray-50",children:"Weight Check"}),l.jsx("p",{className:"text-[10px] text-gray-400 font-medium",children:"Before viewing your report"})]})]}),l.jsx("button",{onClick:t,className:"w-8 h-8 rounded-xl bg-gray-100 dark:bg-white/5 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:l.jsx(Tt,{size:16,className:"text-gray-400"})})]}),l.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-5 mb-6",children:[l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4 text-center",children:"Is your current weight still accurate?"}),i?l.jsxs("div",{className:"flex flex-col items-center gap-3",children:[l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:s,onChange:_=>o(_.target.value),className:"w-28 text-center text-3xl font-black text-gray-900 dark:text-gray-50 bg-white dark:bg-[#0F111A] border-2 border-royal-200 dark:border-royal-800 rounded-xl py-2 focus:outline-none focus:border-royal-500",step:"0.1",min:"20",max:"300",autoFocus:!0}),l.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm font-bold text-gray-400",children:"kg"})]}),l.jsx("button",{onClick:()=>{a(!1),o(n.toString())},className:"text-xs text-gray-400 font-medium hover:text-gray-600",children:"Cancel"})]}):l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-4xl font-black text-gray-900 dark:text-gray-50 mb-1",children:[n,l.jsx("span",{className:"text-lg font-bold text-gray-400 ml-1",children:"kg"})]}),l.jsxs("button",{onClick:()=>a(!0),className:"text-xs text-royal-600 dark:text-royal-400 font-bold flex items-center gap-1 mx-auto hover:underline",children:[l.jsx(xo,{size:12}),"Update weight"]})]})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:t,className:"flex-1 py-3.5 rounded-xl bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 font-bold text-sm hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:y,disabled:h,className:"flex-1 py-3.5 rounded-xl bg-royal-600 text-white font-bold text-sm hover:bg-royal-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:h?l.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):l.jsxs(l.Fragment,{children:[l.jsx(Yu,{size:16}),"Confirm"]})})]})]})})},C2=({report:t,reportType:e,onClose:n,onRegenerate:r,isRegenerating:s=!1})=>{const o=()=>{const a=new Date(t.periodStart),c=new Date(t.periodEnd);if(e==="daily")return a.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});if(e==="weekly"){const d=a.toLocaleDateString("en-US",{month:"short",day:"numeric"}),h=c.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${d} - ${h}`}return a.toLocaleDateString("en-US",{month:"long",year:"numeric"})},i=()=>{switch(e){case"daily":return"Daily Review";case"weekly":return"Weekly Summary";case"monthly":return"Monthly Report"}};return l.jsx("div",{className:"fixed inset-0 bg-[#F8F9FE] dark:bg-[#0F111A] z-[100] animate-in slide-in-from-right duration-300 overflow-y-auto",children:l.jsxs("div",{className:"min-h-screen pb-20",children:[l.jsx("div",{className:"sticky top-0 bg-[#F8F9FE]/80 dark:bg-[#0F111A]/80 backdrop-blur-xl z-10 px-6 pt-10 pb-4 border-b border-gray-100 dark:border-white/5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("button",{onClick:n,className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 hover:text-royal-600 transition-colors",children:[l.jsx(_r,{size:20}),l.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back"})]}),l.jsxs("button",{onClick:r,disabled:s,className:"flex items-center gap-2 text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl hover:bg-royal-100 dark:hover:bg-royal-900/30 transition-colors disabled:opacity-50",children:[l.jsx(xo,{size:12,className:s?"animate-spin":""}),s?"Generating...":"Regenerate"]})]})}),l.jsxs("div",{className:"px-6 pt-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(wt,{size:20,className:"text-royal-600 dark:text-royal-400"}),l.jsx("span",{className:"text-[10px] font-bold text-royal-600 dark:text-royal-400 uppercase tracking-widest",children:"Coach Tips"})]}),l.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight mb-1",children:i()}),l.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500",children:[l.jsx(Hn,{size:14}),l.jsx("span",{className:"text-sm font-medium",children:o()})]})]}),l.jsx("div",{className:"bg-gradient-to-br from-royal-500 to-royal-700 rounded-[24px] p-6 mb-6 shadow-lg shadow-royal-200/30 dark:shadow-royal-900/40",children:l.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0",children:l.jsx(is,{size:20,className:"text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-bold text-white/80 mb-1",children:"Summary"}),l.jsx("p",{className:"text-white text-sm leading-relaxed",children:t.summary})]})]})}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Period Metrics"}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-6 h-6 rounded-lg bg-orange-100 dark:bg-orange-500/10 flex items-center justify-center",children:l.jsx(f0,{size:12,className:"text-orange-600 dark:text-orange-400"})}),l.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Calories"})]}),l.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[t.metrics.avgCalories,l.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"kcal"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-6 h-6 rounded-lg bg-emerald-100 dark:bg-emerald-500/10 flex items-center justify-center",children:l.jsx("span",{className:"text-[10px] font-black text-emerald-600 dark:text-emerald-400",children:"P"})}),l.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Protein"})]}),l.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[t.metrics.avgProtein,l.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"g"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-6 h-6 rounded-lg bg-purple-100 dark:bg-purple-500/10 flex items-center justify-center",children:l.jsx(ys,{size:12,className:"text-purple-600 dark:text-purple-400"})}),l.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Workouts"})]}),l.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[t.metrics.workoutsCompleted,l.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"done"})]})]}),l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-6 h-6 rounded-lg bg-blue-100 dark:bg-blue-500/10 flex items-center justify-center",children:l.jsx(vs,{size:12,className:"text-blue-600 dark:text-blue-400"})}),l.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Rate"})]}),l.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[t.metrics.calorieGoalHitRate,l.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"%"})]})]})]})]}),l.jsxs("div",{className:"mb-8",children:[l.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Improvement Tips"}),l.jsx("div",{className:"space-y-3",children:t.tips.map((a,c)=>l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5 flex items-start gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-50 dark:bg-white/5 flex items-center justify-center flex-shrink-0 text-xl",children:a.emoji}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 mb-0.5",children:a.title}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed",children:a.description})]})]},c))})]}),t.weightAtReport&&l.jsxs("div",{className:"text-center text-xs text-gray-400 dark:text-gray-500",children:["Weight at report: ",l.jsxs("span",{className:"font-bold",children:[t.weightAtReport," kg"]})]})]})]})})},T2=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",N2=()=>new za({apiKey:T2()}),Jy="snapcal_coach_reports_v1",I2=`You are **Cal Coach**, providing personalized health and fitness reviews.

**Your Role:**
Generate concise, motivating, and actionable reports based on the user's tracking data.

**Report Guidelines:**
1. **Summary**: 2-3 sentences highlighting key achievements and areas for improvement
2. **Tips**: Exactly 3 specific, actionable tips 
3. **Tone**: Encouraging but honest. Celebrate wins, gently address gaps

**Tip Format:**
Each tip should have:
- emoji: A relevant emoji (, , , , , , etc.)
- title: Short action phrase (3-5 words)
- description: One sentence explaining the tip

**Never:**
- Be negative or discouraging
- Give generic advice that doesn't relate to the user's data
- Use medical disclaimers or suggest consulting doctors
- Repeat the same tip twice`,A2=async(t,e)=>{if(!le){const o=localStorage.getItem("snapcal_workouts");return o?JSON.parse(o).filter(a=>a.date>=t&&a.date<=e):[]}const n=await he();if(!n)return[];const{data:r,error:s}=await ue.from("workout_plans").select("*").eq("user_id",n.id).gte("date",t).lte("date",e);return s?(console.error("Failed to fetch workout plans:",s),[]):r.map(o=>({id:o.id,date:o.date,title:o.title,exercises:o.exercises||[]}))},R2=async(t,e,n)=>{const[r,s,o,i]=await Promise.all([Yn(),ks(),$0(),A2(e,n)]),a=o.filter(v=>v.date>=e&&v.date<=n),c=a.length,d=a.reduce((v,S)=>v+(S.totalCalories>0?1:0),0),h=c>0?Math.round(a.reduce((v,S)=>v+S.totalCalories,0)/c):0,p=c>0?Math.round(a.reduce((v,S)=>v+S.totalProtein,0)/c):0,m=c>0?Math.round(a.reduce((v,S)=>v+S.totalCarbs,0)/c):0,g=c>0?Math.round(a.reduce((v,S)=>v+S.totalFat,0)/c):0,y=a.filter(v=>Math.abs(v.totalCalories-s)<=s*.1).length,_=c>0?Math.round(y/c*100):0,b=i.filter(v=>v.exercises.some(S=>S.completed)).length,x={avgCalories:h,avgProtein:p,avgCarbs:m,avgFat:g,totalMeals:d,workoutsCompleted:b,daysTracked:c,calorieGoalHitRate:_},w=a.map(v=>({date:v.date,calories:v.totalCalories,protein:v.totalProtein,carbs:v.totalCarbs,fat:v.totalFat,meals:v.totalCalories>0?1:0}));return{profile:r,dailyGoal:s,periodStart:e,periodEnd:n,reportType:t,metrics:x,dailyBreakdown:w,workoutsCompleted:b}},P2=t=>{const{profile:e,dailyGoal:n,periodStart:r,periodEnd:s,reportType:o,metrics:i,dailyBreakdown:a}=t;let c=`**${o.charAt(0).toUpperCase()+o.slice(1)} Health Review**
`;return c+=`Period: ${r} to ${s}

`,e&&(c+=`**User Profile:**
`,e.name&&(c+=`- Name: ${e.name}
`),e.weight&&(c+=`- Weight: ${e.weight} kg
`),e.height&&(c+=`- Height: ${e.height} cm
`),e.goal&&(c+=`- Goal: ${{cut:"Lose weight",bulk:"Build muscle",maintain:"Maintain weight"}[e.goal]}
`),c+=`- Daily Calorie Goal: ${n} kcal

`),c+=`**Period Statistics:**
`,c+=`- Days tracked: ${i.daysTracked}
`,c+=`- Average daily calories: ${i.avgCalories} kcal (Goal: ${n})
`,c+=`- Average protein: ${i.avgProtein}g
`,c+=`- Average carbs: ${i.avgCarbs}g
`,c+=`- Average fat: ${i.avgFat}g
`,c+=`- Calorie goal hit rate: ${i.calorieGoalHitRate}%
`,c+=`- Workouts completed: ${i.workoutsCompleted}

`,a.length>0&&a.length<=7&&(c+=`**Daily Breakdown:**
`,a.forEach(d=>{c+=`- ${d.date}: ${d.calories} kcal, P: ${d.protein}g, C: ${d.carbs}g, F: ${d.fat}g
`})),c+=`
---

Provide a summary and 3 actionable tips based on this data.`,c},M2=async t=>{const e=N2(),n=P2(t),r=await e.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:n}]}],config:{systemInstruction:I2,responseMimeType:"application/json",responseSchema:{type:oe.OBJECT,properties:{summary:{type:oe.STRING},tips:{type:oe.ARRAY,items:{type:oe.OBJECT,properties:{emoji:{type:oe.STRING},title:{type:oe.STRING},description:{type:oe.STRING}},required:["emoji","title","description"]}}},required:["summary","tips"]}}});return JSON.parse(r.text||'{"summary": "", "tips": []}')},Ky=()=>{try{const t=localStorage.getItem(Jy);return t?JSON.parse(t):[]}catch{return[]}},D2=t=>{localStorage.setItem(Jy,JSON.stringify(t))},L2=async(t,e,n)=>{if(!le)return Ky().find(a=>a.reportType===t&&a.periodStart===e&&a.periodEnd===n)||null;const r=await he();if(!r)return null;const{data:s,error:o}=await ue.from("coach_reports").select("*").eq("user_id",r.id).eq("report_type",t).eq("period_start",e).eq("period_end",n).single();return o||!s?null:{id:s.id,userId:s.user_id,reportType:s.report_type,periodStart:s.period_start,periodEnd:s.period_end,summary:s.summary,tips:s.tips,metrics:s.metrics,weightAtReport:s.weight_at_report,createdAt:s.created_at}},U2=async t=>{if(!le){const s=Ky().filter(o=>!(o.reportType===t.reportType&&o.periodStart===t.periodStart&&o.periodEnd===t.periodEnd));s.push(t),D2(s);return}const e=await he();if(!e)throw new Error("User not authenticated");await ue.from("coach_reports").delete().eq("user_id",e.id).eq("report_type",t.reportType).eq("period_start",t.periodStart).eq("period_end",t.periodEnd);const{error:n}=await ue.from("coach_reports").insert({id:t.id,user_id:e.id,report_type:t.reportType,period_start:t.periodStart,period_end:t.periodEnd,summary:t.summary,tips:t.tips,metrics:t.metrics,weight_at_report:t.weightAtReport});if(n)throw console.error("Failed to save report:",n),new Error("Failed to save report")},j2=async(t,e,n,r)=>{var c;const s=await he();if(!s)throw new Error("User not authenticated");const o=await R2(t,e,n),i=await M2(o),a={id:`${t}_${e}_${Date.now()}`,userId:s.id,reportType:t,periodStart:e,periodEnd:n,summary:i.summary,tips:i.tips.slice(0,3),metrics:o.metrics,weightAtReport:r||((c=o.profile)==null?void 0:c.weight),createdAt:new Date().toISOString()};return await U2(a),a},qp=async(t,e,n,r=!1,s)=>{if(!r){const o=await L2(t,e,n);if(o)return o}return j2(t,e,n,s)},F2=(t,e)=>{if(t==="daily")return{start:e,end:e};if(t==="weekly"){const a=new Date(e),c=new Date(a);c.setDate(a.getDate()+6);const d=`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`;return{start:e,end:d}}const[n,r]=e.split("-").map(Number),s=new Date(n,r,0),o=`${n}-${String(r).padStart(2,"0")}-01`,i=`${n}-${String(r).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`;return{start:o,end:i}},O2=()=>{const[t,e]=k.useState([]),[n,r]=k.useState(2e3),[s,o]=k.useState(!0),[i,a]=k.useState("day"),[c,d]=k.useState(null),[h,p]=k.useState(null),[m,g]=k.useState(!1),[y,_]=k.useState(null),[b,x]=k.useState(!1),[w,v]=k.useState(!1),[S,T]=k.useState(null),[E,C]=k.useState(!1),[P,R]=k.useState(!1),[I,V]=k.useState(Qn()),[Y,Q]=k.useState(new Date().toISOString().substring(0,7)),[N,q]=k.useState(()=>{const A=new Date,O=A.getDay(),ee=O===0?-6:1-O,ne=new Date(A);ne.setDate(A.getDate()+ee);const ge=ne.getFullYear(),ye=String(ne.getMonth()+1).padStart(2,"0"),be=String(ne.getDate()).padStart(2,"0");return`${ge}-${ye}-${be}`}),[B,X]=k.useState(!1),[M,F]=k.useState({}),[j,J]=k.useState({}),[U,Z]=k.useState({}),[te,ce]=k.useState({}),D=k.useRef(null);document.documentElement.classList.contains("dark");const ie=k.useCallback(()=>{if(D.current){const A=D.current;A.scrollLeft=A.scrollWidth}},[]);k.useEffect(()=>{const A=setTimeout(ie,100);return()=>clearTimeout(A)},[i,ie]);const fe=async()=>{o(!0);try{const[A,O]=await Promise.all([$0(),ks()]);e(A),r(O),Ae(I)}catch(A){console.error("Failed to load history data",A)}finally{o(!1)}},Ae=k.useCallback(async A=>{if(!j[A]){Z(O=>({...O,[A]:!0}));try{const O=await QS(A);J(ee=>({...ee,[A]:O}))}catch(O){console.error(`Failed to load entries for ${A}`,O)}finally{Z(O=>({...O,[A]:!1}))}}},[j]),Rt=k.useCallback(async A=>{if(te[A]===void 0){ce(O=>({...O,[A]:null}));try{const O=await XS(A);ce(ee=>({...ee,[A]:O}))}catch(O){console.error(`Failed to load image for entry ${A}`,O)}}},[te]);k.useEffect(()=>{fe();const A=()=>{J({}),ce({}),fe()};return window.addEventListener("food-entry-updated",A),()=>window.removeEventListener("food-entry-updated",A)},[]),k.useEffect(()=>{I&&(i==="day"||i==="week")&&Ae(I)},[I,Ae,i]);const ln=async A=>{await G0(A),J({}),ce({}),await fe()},cn=A=>{d(null),_(A),g(!0)},He=async A=>{x(!1),C(!0);try{const O=i==="day"?"daily":i==="week"?"weekly":"monthly",ee=i==="day"?I:i==="week"?N:Y,{start:ne,end:ge}=F2(O,ee),ye=await qp(O,ne,ge,!1,A);T(ye),v(!0)}catch(O){console.error("Failed to generate report:",O),alert("Failed to generate AI report. Please try again.")}finally{C(!1)}},Ue=async()=>{if(S){R(!0);try{const A=await qp(S.reportType,S.periodStart,S.periodEnd,!0);T(A)}catch(A){console.error("Failed to regenerate report:",A),alert("Failed to regenerate report. Please try again.")}finally{R(!1)}}},Cn=A=>(te[A.id]===void 0&&Rt(A.id),{...A,imageUrl:te[A.id]||void 0}),un=k.useMemo(()=>{if(i==="day"){const A=[],O=new Date,ee=new Date(O.getFullYear(),O.getMonth(),1);for(let ne=new Date(ee);ne<=O;ne.setDate(ne.getDate()+1)){const ge=ne.getFullYear(),ye=String(ne.getMonth()+1).padStart(2,"0"),be=String(ne.getDate()).padStart(2,"0"),ze=`${ge}-${ye}-${be}`;A.push({id:ze,name:ne.toLocaleDateString("en-US",{weekday:"short"}),label:ne.getDate().toString(),date:ze})}return A}else if(i==="week"){const A=[],O=new Date,ee=O.getDay(),ne=ee===0?-6:1-ee,ge=new Date(O);ge.setDate(O.getDate()+ne);for(let ye=0;ye<8;ye++){const be=new Date(ge);be.setDate(ge.getDate()-ye*7);const ze=new Date(be);ze.setDate(be.getDate()+6);const ht=be.toLocaleDateString("en-US",{month:"short",day:"numeric"}),pt=ze.toLocaleDateString("en-US",{day:"numeric"}),Cr=be.getFullYear(),Qy=String(be.getMonth()+1).padStart(2,"0"),Xy=String(be.getDate()).padStart(2,"0"),_d=`${Cr}-${Qy}-${Xy}`;A.push({id:_d,name:"Week",label:`${ht} - ${pt}`,date:_d})}return A.reverse()}else{const A=new Set;return t.forEach(ee=>{const ne=ee.date.substring(0,7);A.add(ne)}),Array.from(A).sort().map(ee=>{const[ne,ge]=ee.split("-"),ye=new Date(parseInt(ne),parseInt(ge)-1,1);return{id:ee,name:ye.toLocaleDateString("en-US",{year:"2-digit"}),label:ye.toLocaleDateString("en-US",{month:"short"}),date:ee}})}},[i,t]),We=k.useMemo(()=>{if(i==="day")return t.find(A=>A.date===I)||{date:I,totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};if(i==="week"){if(!N)return{date:"",totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};const A=new Date(N),O=new Date(A);O.setDate(A.getDate()+6);const ee=N,ne=O.getFullYear(),ge=String(O.getMonth()+1).padStart(2,"0"),ye=String(O.getDate()).padStart(2,"0"),be=`${ne}-${ge}-${ye}`,ht=t.filter(pt=>pt.date>=ee&&pt.date<=be).reduce((pt,Cr)=>({totalCalories:pt.totalCalories+Cr.totalCalories,totalProtein:pt.totalProtein+Cr.totalProtein,totalCarbs:pt.totalCarbs+Cr.totalCarbs,totalFat:pt.totalFat+Cr.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:N,...ht}}else{const O=t.filter(ee=>ee.date.startsWith(Y)).reduce((ee,ne)=>({totalCalories:ee.totalCalories+ne.totalCalories,totalProtein:ee.totalProtein+ne.totalProtein,totalCarbs:ee.totalCarbs+ne.totalCarbs,totalFat:ee.totalFat+ne.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:Y,...O}}},[t,I,Y,N,i]),G=k.useMemo(()=>{if(i==="day")return[];const A=ee=>{if(i==="month")return ee.startsWith(Y);if(i==="week"&&N)try{const[ne,ge,ye]=N.split("-").map(Number),be=new Date(ne,ge-1,ye),ze=new Date(be);ze.setDate(be.getDate()+6);const ht=new Date(ee);return ht>=be&&ht<=ze}catch{return!1}return!1};return Object.entries(j).filter(([ee])=>A(ee)).flatMap(([ee,ne])=>ne).sort((ee,ne)=>ne.timestamp.localeCompare(ee.timestamp))},[j,Y,N,i]),z=k.useMemo(()=>{if(i==="day")return{};const A=ee=>{if(i==="month")return ee.startsWith(Y);if(i==="week"&&N)try{const[ne,ge,ye]=N.split("-").map(Number),be=new Date(ne,ge-1,ye),ze=new Date(be);ze.setDate(be.getDate()+6);const ht=new Date(ee);return ht>=be&&ht<=ze}catch{return!1}return!1},O={};return Object.entries(j).filter(([ee])=>A(ee)).forEach(([ee,ne])=>{ne.length>0&&(O[ee]=ne.sort((ge,ye)=>ye.timestamp.localeCompare(ge.timestamp)))}),O},[j,Y,N,i]),Me=A=>{F(O=>({...O,[A]:!O[A]}))};return k.useEffect(()=>{i==="month"&&t.filter(O=>O.date.startsWith(Y)).map(O=>O.date).forEach(O=>Ae(O))},[i,Y,t,Ae]),B?l.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in slide-in-from-right duration-500 bg-[#F8F9FE] dark:bg-[#0F111A]",children:[l.jsxs("div",{className:"px-6 pt-10 pb-32 overflow-y-auto no-scrollbar",children:[l.jsxs("button",{onClick:()=>X(!1),className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 mb-6 hover:text-royal-600 transition-colors",children:[l.jsx(_r,{size:20}),l.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back to Report"})]}),l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"History Log"}),l.jsx("div",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl border border-royal-100 dark:border-royal-800/50",children:i==="week"?new Date(I).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):new Date(Y+"-01").toLocaleDateString(void 0,{month:"long",year:"numeric"})})]}),l.jsx("div",{className:"space-y-4",children:i==="day"?U[I]?l.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(A=>l.jsx("div",{className:"h-20 bg-white dark:bg-[#1A1C26] rounded-[24px] animate-pulse border border-gray-100 dark:border-white/5"},A))}):(j[I]||[]).length>0?(j[I]||[]).map(A=>{const O=Cn(A);return l.jsxs("div",{onClick:()=>d(O),className:"bg-white dark:bg-[#1A1C26] p-4 flex justify-between items-center rounded-[24px] shadow-sm border border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer active:scale-[0.98]",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:O.imageUrl?l.jsx("img",{src:O.imageUrl,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:l.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold",children:A.food_item}),l.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:A.time})]})]}),l.jsxs("div",{className:"flex flex-col items-end",children:[l.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:A.calories}),l.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},A.id)}):l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[l.jsx(Hn,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),l.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:"No meals logged for this day."})]}):Object.keys(z).length>0?Object.entries(z).sort(([A],[O])=>O.localeCompare(A)).map(([A,O])=>{const ee=M[A],ne=O.reduce((ge,ye)=>ge+ye.calories,0);return l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] border border-gray-100 dark:border-white/5 overflow-hidden",children:[l.jsxs("button",{onClick:()=>Me(A),className:"w-full p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`transition-transform duration-200 ${ee?"rotate-90":""}`,children:l.jsx(mr,{size:16,className:"text-gray-400"})}),l.jsxs("div",{className:"flex flex-col items-start",children:[l.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:new Date(A).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),l.jsxs("span",{className:"text-[9px] font-medium text-gray-400",children:[O.length," meal",O.length!==1?"s":""]})]})]}),l.jsxs("div",{className:"flex flex-col items-end",children:[l.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:ne}),l.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]}),ee&&l.jsx("div",{className:"border-t border-gray-100 dark:border-white/5",children:O.map(ge=>{const ye=Cn(ge);return l.jsxs("div",{onClick:()=>d(ye),className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer border-b border-gray-50 dark:border-white/5 last:border-b-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:ye.imageUrl?l.jsx("img",{src:ye.imageUrl,className:"w-full h-full object-cover"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:l.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold leading-tight",children:ge.food_item}),l.jsx("span",{className:"text-[9px] text-gray-400 dark:text-gray-500",children:ge.time})]})]}),l.jsxs("div",{className:"flex flex-col items-end",children:[l.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:ge.calories}),l.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},ge.id)})})]},A)}):l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[l.jsx(Hn,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),l.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:["No data for this ",i==="month"?"month":"week","."]})]})})]}),c&&l.jsx(Zc,{entry:c,onClose:()=>d(null),onDelete:ln,onEdit:cn})]}):l.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-y-auto no-scrollbar relative bg-[#F8F9FE] dark:bg-[#0F111A]",children:[l.jsxs("div",{className:"px-6 pt-10 pb-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"Report"}),l.jsxs("div",{className:"flex p-1 bg-white dark:bg-[#1A1C26] rounded-xl border border-gray-100 dark:border-white/5 shadow-sm",children:[l.jsx("button",{onClick:()=>a("day"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${i==="day"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Daily"}),l.jsx("button",{onClick:()=>a("week"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${i==="week"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Weekly"}),l.jsx("button",{onClick:()=>a("month"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${i==="month"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Monthly"})]})]}),l.jsxs("div",{className:"relative mb-8",children:[l.jsx("div",{ref:D,className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1 snap-x",style:{WebkitOverflowScrolling:"touch"},children:un.map(A=>{const O=i==="day"?A.id===I:i==="week"?A.id===N:A.id===Y,ee=t.some(ne=>{if(i==="day")return ne.date===A.id;if(i==="week"){const[ge,ye,be]=A.id.split("-").map(Number),ze=new Date(ge,ye-1,be),ht=new Date(ze);ht.setDate(ze.getDate()+6);const pt=new Date(ne.date);return pt>=ze&&pt<=ht}return ne.date.startsWith(A.id)});return l.jsxs("button",{onClick:()=>{i==="day"?V(A.id):i==="week"?q(A.id):Q(A.id)},className:`flex-shrink-0 flex flex-col items-center justify-center ${i==="week"?"w-24":"w-12"} py-3 rounded-2xl transition-all duration-300 snap-center ${O?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 transform scale-110":"bg-white dark:bg-[#1A1C26] text-gray-400 dark:text-gray-500 border border-gray-100 dark:border-white/5"}`,children:[l.jsx("span",{className:`text-[9px] font-bold uppercase mb-1 ${O?"text-white/70":"text-gray-400"}`,children:A.name}),l.jsx("span",{className:"text-sm font-extrabold",children:A.label}),ee&&!O&&l.jsx("div",{className:"w-1 h-1 rounded-full bg-royal-400 mt-1"})]},A.id)})}),l.jsx("div",{className:"absolute top-0 left-0 bottom-2 w-8 bg-gradient-to-r from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"}),l.jsx("div",{className:"absolute top-0 right-0 bottom-2 w-8 bg-gradient-to-l from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"})]}),l.jsx("div",{className:"mb-8",children:l.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-6 shadow-sm border border-gray-100 dark:border-white/5 flex flex-col items-center",children:[l.jsx("span",{className:"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-1",children:i==="day"?"Daily Total":i==="week"?"Weekly Total":"Monthly Total"}),l.jsxs("div",{className:"flex flex-col items-center mb-6",children:[l.jsx("span",{className:"text-5xl font-black text-gray-900 dark:text-gray-50 tracking-tighter",children:Math.round(We.totalCalories)}),l.jsx("span",{className:"text-[10px] font-black text-royal-600 dark:text-royal-400 uppercase tracking-widest mt-0.5",children:"KCAL"})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2.5 w-full",children:[l.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-emerald-50/30 dark:bg-emerald-500/5 rounded-2xl border border-emerald-100/50 dark:border-emerald-500/10 transition-colors",children:[l.jsx("span",{className:"text-[8px] font-bold text-emerald-600/60 dark:text-emerald-400/60 uppercase mb-0.5",children:"Protein"}),l.jsxs("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:[Math.round(We.totalProtein),"g"]})]}),l.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-amber-50/30 dark:bg-amber-500/5 rounded-2xl border border-amber-100/50 dark:border-amber-500/10 transition-colors",children:[l.jsx("span",{className:"text-[8px] font-bold text-amber-600/60 dark:text-amber-400/60 uppercase mb-0.5",children:"Carbs"}),l.jsxs("span",{className:"text-sm font-black text-amber-600 dark:text-amber-400",children:[Math.round(We.totalCarbs),"g"]})]}),l.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-rose-50/30 dark:bg-rose-500/5 rounded-2xl border border-rose-100/50 dark:border-rose-500/10 transition-colors",children:[l.jsx("span",{className:"text-[8px] font-bold text-rose-600/60 dark:text-rose-400/60 uppercase mb-0.5",children:"Fat"}),l.jsxs("span",{className:"text-sm font-black text-rose-600 dark:text-rose-400",children:[Math.round(We.totalFat),"g"]})]})]})]})}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[l.jsxs(rt,{onClick:()=>x(!0),className:"p-5 flex flex-col justify-between h-36 bg-gradient-to-br from-royal-500 to-royal-700 text-white border-none shadow-royal-200/50 cursor-pointer active:scale-[0.98] transition-transform",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[l.jsx(wt,{size:12,className:"text-white/70"}),l.jsx("p",{className:"text-[10px] font-bold text-white/70 uppercase",children:i==="day"?"Coach Tips":"Report"})]}),l.jsx("h3",{className:"text-lg font-black leading-tight",children:i==="day"?"Daily Review":i==="week"?"Weekly Summary":l.jsxs(l.Fragment,{children:["Your Health",l.jsx("br",{}),"Summary"]})})]}),l.jsx("div",{className:"mt-2 py-2 bg-white/20 rounded-xl text-[10px] font-bold backdrop-blur-sm flex items-center justify-center gap-2",children:E?l.jsx(bi,{size:12,className:"animate-spin"}):l.jsxs(l.Fragment,{children:["VIEW INSIGHTS",l.jsx(mr,{size:12})]})})]}),l.jsxs("div",{className:"grid grid-rows-2 gap-4 h-36",children:[l.jsxs(rt,{onClick:()=>X(!0),className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5 active:scale-95 transition-transform cursor-pointer",children:[l.jsxs("div",{className:"flex justify-between items-center mb-1",children:[l.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"History Log"}),l.jsx(mr,{size:10,className:"text-gray-300"})]}),l.jsxs("p",{className:"text-xs font-black text-gray-900 dark:text-gray-50",children:[i==="day"?(j[I]||[]).length:G.length," Meals"]})]}),l.jsxs(rt,{className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5",children:[l.jsxs("div",{className:"flex justify-between items-center mb-1",children:[l.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Status"}),l.jsx(Bw,{size:10,className:"text-gray-300"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 h-1 bg-gray-100 dark:bg-white/5 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-royal-500 rounded-full",style:{width:`${Math.min(We.totalCalories/(i==="day"?n:i==="week"?n*7:n*30)*100,100)}%`}})}),l.jsxs("span",{className:"text-[10px] font-black text-gray-900 dark:text-gray-50",children:[Math.round(We.totalCalories/(i==="day"?n:i==="week"?n*7:n*30)*100),"%"]})]})]})]})]}),l.jsx("div",{className:"h-24"})]}),c&&l.jsx(Zc,{entry:c,onClose:()=>d(null),onDelete:ln,onEdit:cn}),h&&l.jsx(k2,{summary:h,onClose:()=>p(null)}),m&&l.jsx(qy,{editEntry:y,onClose:()=>{g(!1),_(null)},onSuccess:()=>{g(!1),_(null),J({}),ce({}),fe()},onOpenSharedMeal:()=>{g(!1)}}),b&&l.jsx(E2,{onClose:()=>x(!1),onConfirm:He}),w&&S&&l.jsx(C2,{report:S,reportType:S.reportType,onClose:()=>{v(!1),T(null)},onRegenerate:Ue,isRegenerating:P})]})},$2=()=>{const[t,e]=k.useState(!0),[n,r]=k.useState(""),[s,o]=k.useState(""),[i,a]=k.useState(null),[c,d]=k.useState(!1),[h,p]=k.useState(null),m=async g=>{g.preventDefault(),a(null),p(null),d(!0);try{t?await D0(n,s):(await BS(n,s),t||(p("Account created successfully!"),e(!0)))}catch(y){console.error(y),a(y.message||"Authentication failed")}finally{d(!1)}};return l.jsxs("div",{className:"min-h-screen bg-royal-50 flex flex-col items-center justify-center p-6 relative overflow-hidden",children:[l.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[l.jsx("div",{className:"absolute top-[-20%] right-[-20%] w-[500px] h-[500px] bg-royal-200/40 rounded-full blur-[100px]"}),l.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-80 h-80 bg-pink-200/40 rounded-full blur-[80px]"})]}),l.jsxs("div",{className:"w-full max-w-sm z-10",children:[l.jsxs("div",{className:"text-center mb-10",children:[l.jsx("div",{className:"w-20 h-20 bg-white rounded-[24px] flex items-center justify-center mx-auto mb-6 shadow-xl shadow-royal-200 rotate-3 transition-transform hover:rotate-0 duration-500",children:l.jsx(Xu,{size:36,className:"text-royal-600 fill-royal-600"})}),l.jsx("h1",{className:"text-4xl font-extrabold text-gray-900 tracking-tight mb-2",children:"SnapCal AI"}),l.jsx("p",{className:"text-gray-500 font-medium",children:"Track your vibe, not just calories."})]}),l.jsxs("div",{className:"bg-white/80 backdrop-blur-xl border border-white p-8 rounded-[40px] shadow-[0_20px_40px_-12px_rgba(0,0,0,0.05)]",children:[l.jsxs("div",{className:"flex p-1 bg-gray-100 rounded-[20px] mb-8",children:[l.jsx("button",{onClick:()=>{e(!0),a(null),p(null)},className:`flex-1 py-3 text-sm font-bold rounded-[16px] transition-all duration-300 ${t?"bg-white text-royal-700 shadow-sm":"text-gray-400 hover:text-gray-600"}`,children:"Sign In"}),l.jsx("button",{onClick:()=>{e(!1),a(null),p(null)},className:`flex-1 py-3 text-sm font-bold rounded-[16px] transition-all duration-300 ${t?"text-gray-400 hover:text-gray-600":"bg-white text-royal-700 shadow-sm"}`,children:"Sign Up"})]}),l.jsxs("form",{onSubmit:m,className:"space-y-5",children:[i&&l.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 rounded-2xl flex items-center gap-3 text-red-600 text-sm font-medium animate-in fade-in slide-in-from-top-2",children:[l.jsx(Ku,{size:18}),i]}),h&&l.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-100 rounded-2xl flex items-center gap-3 text-emerald-600 text-sm font-medium animate-in fade-in slide-in-from-top-2",children:[l.jsx(_i,{size:18}),h]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 ml-1",children:"Email"}),l.jsx("input",{type:"email",required:!0,value:n,onChange:g=>r(g.target.value),className:"w-full p-4 bg-gray-50 border border-gray-100 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 text-gray-900 transition-all placeholder:text-gray-400 font-medium",placeholder:"hello@snapcal.ai"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 ml-1",children:"Password"}),l.jsx("input",{type:"password",required:!0,value:s,onChange:g=>o(g.target.value),className:"w-full p-4 bg-gray-50 border border-gray-100 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 text-gray-900 transition-all placeholder:text-gray-400 font-medium",placeholder:"",minLength:6})]})]}),l.jsxs(Le,{className:"w-full mt-4 flex justify-between items-center group py-5",isLoading:c,children:[l.jsx("span",{children:t?"Sign In":"Create Account"}),!c&&l.jsx(Ki,{size:20,className:"group-hover:translate-x-1 transition-transform"})]})]})]}),l.jsx("p",{className:"text-center text-gray-400 text-xs mt-8 font-medium",children:t?"New here? Create an account above.":"Welcome back. Sign in above."})]})]})},Hp=`
-- Run this in your Supabase SQL Editor

-- 1. Create Food Entries Table
create table if not exists food_entries (
  id uuid primary key,
  user_id uuid not null references auth.users(id),
  timestamp text not null,
  date text not null,
  time text not null,
  food_item text not null,
  calories integer not null,
  protein integer default 0,
  carbs integer default 0,
  fat integer default 0,
  confidence float default 1.0,
  is_manual boolean default false,
  image_url text,
  ingredients jsonb default '[]'::jsonb,
  original_ai_response jsonb,
  created_at timestamp with time zone default timezone('utc'::text, now())
);

-- 2. Create User Profiles Table
create table if not exists user_profiles (
  user_id uuid primary key references auth.users(id),
  name text,
  height float,
  weight float,
  age integer,
  gender text check (gender in ('male', 'female')),
  activity_level text check (activity_level in ('sedentary', 'light', 'moderate', 'very', 'extra')),
  goal text check (goal in ('cut', 'bulk', 'maintain')),
  equipment_access text check (equipment_access in ('gym', 'home', 'bodyweight')),
  created_at timestamp with time zone default timezone('utc'::text, now())
);

-- 3. Create Settings Table
create table if not exists user_settings (
  user_id uuid primary key references auth.users(id),
  daily_goal integer default 2000,
  has_completed_onboarding boolean default false
);

-- 4. Create Summaries Table (Optional optimization)
create table if not exists daily_summaries (
  id text primary key, -- Composite key user_id + date usually
  user_id uuid not null references auth.users(id),
  date text not null,
  total_calories integer default 0,
  total_protein integer default 0,
  total_carbs integer default 0,
  total_fat integer default 0
);

-- 5. Enable Row Level Security (RLS)
alter table food_entries enable row level security;
alter table user_profiles enable row level security;
alter table user_settings enable row level security;
alter table daily_summaries enable row level security;

-- 6. Create Policies (Allow users to see/edit ONLY their own data)

-- Food Entries
create policy "Users can all own entries" on food_entries
  for all using (auth.uid() = user_id);

-- Profiles
create policy "Users can all own profile" on user_profiles
  for all using (auth.uid() = user_id);

-- Settings
create policy "Users can all own settings" on user_settings
  for all using (auth.uid() = user_id);

-- Summaries
create policy "Users can all own summaries" on daily_summaries
  for all using (auth.uid() = user_id);
`,G2=()=>{const[t,e]=k.useState(""),[n,r]=k.useState(""),[s,o]=k.useState(""),[i,a]=k.useState(""),[c,d]=k.useState(""),[h,p]=k.useState(""),[m,g]=k.useState(""),[y,_]=k.useState(""),[b,x]=k.useState(!1),[w,v]=k.useState(!1),[S,T]=k.useState(null),[E,C]=k.useState(document.documentElement.classList.contains("dark")),[P,R]=k.useState(!1),[I,V]=k.useState(!1),[Y,Q]=k.useState(!1),[N,q]=k.useState("checking"),[B,X]=k.useState(!1),[M,F]=k.useState(!1),[j,J]=k.useState("");k.useEffect(()=>{ce(),le?(V(ek()),U()):q("ok")},[]);const U=async()=>{const G=await nk();G.missingTables?q("missing_tables"):G.ok?q("ok"):q("error")},Z=()=>{const G=!E;C(G),G?(document.documentElement.classList.add("dark"),localStorage.setItem("snapcal-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("snapcal-theme","light"))},te=G=>{if(G===Lc())return;confirm(G==="local"?"Switching to Local Mode means your data will stay on this device only. You will be logged out of Cloud to create a local profile.":"Switching to Cloud Mode allows you to sync data across devices. You will be redirected to log in or sign up.")&&GS(G)},ce=async()=>{const G=await Yn();G&&(e(G.name),r(G.height.toString()),o(G.weight.toString()),G.age&&a(G.age.toString()),G.gender&&d(G.gender),G.activityLevel&&p(G.activityLevel),G.goal&&g(G.goal),G.equipmentAccess&&_(G.equipmentAccess),G.targetWeight&&J(G.targetWeight.toString()))},D=()=>{const G=parseFloat(n),z=parseFloat(s);return!G||!z?null:z/(G/100*(G/100))},ie=G=>G<18.5?{label:"Underweight",color:"text-blue-300"}:G<25?{label:"Healthy",color:"text-emerald-300"}:G<30?{label:"Overweight",color:"text-orange-300"}:{label:"Obese",color:"text-red-300"},fe=G=>{const A=(10*parseFloat(s)+6.25*parseFloat(n)-5*25+5)*1.2;return G<18.5?Math.round(A+400):G>25?Math.round(A-400):Math.round(A)},Ae=async()=>{if(!(!t||!n||!s)){x(!0);try{await Ma({name:t,height:parseFloat(n),weight:parseFloat(s),age:i?parseInt(i):void 0,gender:c||void 0,activityLevel:h||void 0,goal:m||void 0,equipmentAccess:y||void 0,targetWeight:j?parseFloat(j):void 0}),v(!0),setTimeout(()=>v(!1),2e3);const G=D();if(G){const z=fe(G);T(z)}}catch(G){console.error(G)}finally{x(!1)}}},Rt=async()=>{S&&(await Pa(S),alert(`Daily goal updated to ${S} kcal!`))},ln=async()=>{if(confirm("Are you sure you want to sign out?")){R(!0);try{await VS()}catch(G){console.error(G)}finally{R(!1)}}},cn=async()=>{if(confirm("This will upload your local history to your Supabase account and clear local storage. Continue?")){Q(!0);try{await tk(),V(!1),alert("Migration successful! Your local history is now in the cloud.")}catch(G){alert("Sync failed: "+G.message)}finally{Q(!1)}}},He=()=>{navigator.clipboard.writeText(Hp),alert("SQL Copied to clipboard! Paste it into the Supabase SQL Editor.")},Ue=D(),Cn=Ue?ie(Ue):null,un=Ue?fe(Ue):null,We=Lc();return l.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar pb-32 px-6 pt-10 space-y-8 animate-in fade-in duration-500",children:[l.jsxs("header",{children:[l.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:"My Profile"}),l.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight",children:"Personal Details"})]}),le&&I&&l.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-950/30 border border-indigo-100 dark:border-indigo-900/40 p-5 rounded-[32px] animate-in slide-in-from-top-4",children:l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/50 rounded-2xl text-indigo-600 dark:text-indigo-400",children:l.jsx(i_,{size:24})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-extrabold text-indigo-900 dark:text-indigo-200",children:"Local Data Found"}),l.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 mt-1 mb-3 leading-relaxed",children:"We found meal history on this device that isn't in the cloud yet. Sync now to secure your data."}),l.jsx(Le,{onClick:cn,isLoading:Y,className:"py-3 px-6 text-xs bg-indigo-600 hover:bg-indigo-700 shadow-lg shadow-indigo-200 dark:shadow-none",children:"Sync to Cloud"})]})]})}),le&&N==="missing_tables"&&l.jsx("div",{className:"bg-rose-50 dark:bg-rose-950/30 border border-rose-100 dark:border-rose-900/40 p-5 rounded-[32px] animate-in slide-in-from-top-4",children:l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"p-3 bg-rose-100 dark:bg-rose-900/50 rounded-2xl text-rose-600 dark:text-rose-400",children:l.jsx(Pf,{size:24})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-sm font-extrabold text-rose-900 dark:text-rose-200",children:"Database Setup Required"}),l.jsx("p",{className:"text-xs text-rose-700 dark:text-rose-300 mt-1 mb-3 leading-relaxed",children:"Your Supabase project is connected, but the required tables don't exist yet. Saving will fail until you run the setup script."}),l.jsxs("button",{onClick:()=>X(!B),className:"flex items-center gap-2 py-2 px-4 rounded-xl text-xs font-bold bg-white dark:bg-white/10 text-rose-600 dark:text-rose-200 shadow-sm",children:[l.jsx(jw,{size:14})," ",B?"Hide SQL":"View SQL Script"]}),B&&l.jsxs("div",{className:"mt-4 animate-in slide-in-from-top-2",children:[l.jsx("div",{className:"bg-gray-900 rounded-xl p-3 mb-2 overflow-x-auto border border-white/10",children:l.jsx("pre",{className:"text-[10px] text-emerald-400 font-mono leading-relaxed",children:Hp})}),l.jsxs(Le,{onClick:He,className:"w-full py-3 text-xs bg-rose-600 hover:bg-rose-700 text-white",children:[l.jsx(Fw,{size:14,className:"mr-2"})," Copy SQL to Clipboard"]}),l.jsx("p",{className:"text-[10px] text-rose-600/70 dark:text-rose-400/70 mt-2 italic text-center",children:"Paste this into the SQL Editor in your Supabase Dashboard."})]})]})]})}),l.jsx("div",{className:"bg-white dark:bg-[#1a1c26] p-6 rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-royal-50 dark:bg-royal-950/30 rounded-2xl flex items-center justify-center text-royal-600 dark:text-royal-400",children:E?l.jsx(Jw,{size:20}):l.jsx(r_,{size:20})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:"Dark Mode"}),l.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Optimize for low light"})]})]}),l.jsx("button",{onClick:Z,className:`w-14 h-8 rounded-full transition-all duration-300 relative ${E?"bg-royal-600":"bg-gray-200 dark:bg-gray-800"}`,children:l.jsx("div",{className:`absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-sm transition-transform duration-300 ${E?"translate-x-6":""}`})})]})}),Ue&&Cn&&un&&l.jsxs("div",{className:"relative rounded-[32px] p-6 text-white overflow-hidden shadow-xl bg-royal-600 shadow-royal-200 dark:shadow-royal-900/40 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-white/10 rounded-full blur-3xl"}),l.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-black/10 rounded-full blur-3xl"}),l.jsxs("div",{className:"relative z-10",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Ju,{size:16,className:"text-royal-200"}),l.jsx("span",{className:"text-royal-200 text-xs font-bold uppercase tracking-widest",children:"Body Insight"})]}),l.jsxs("h2",{className:"text-3xl font-extrabold tracking-tight",children:["BMI: ",Ue.toFixed(1)]})]}),l.jsx("div",{className:`px-3 py-1 rounded-full bg-white/10 backdrop-blur-md border border-white/10 text-sm font-bold ${Cn.color}`,children:Cn.label})]}),l.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-[24px] p-5 border border-white/5",children:[l.jsx("p",{className:"text-white/70 text-xs font-medium mb-3",children:"Based on your profile, we recommend a daily calorie limit of:"}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-baseline gap-1",children:[l.jsx("span",{className:"text-4xl font-extrabold tracking-tighter",children:un}),l.jsx("span",{className:"text-lg font-bold text-white/60",children:"kcal"})]}),l.jsx("button",{onClick:Rt,className:"w-10 h-10 bg-white text-royal-600 rounded-full flex items-center justify-center hover:scale-110 active:scale-95 transition-all shadow-lg",children:l.jsx(Ki,{size:20,strokeWidth:3})})]})]})]})]}),l.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] p-6 rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark space-y-5",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Display Name"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",value:t,onChange:G=>e(G.target.value),placeholder:"Enter your name",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),l.jsx(xs,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Height (cm)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:n,onChange:G=>r(G.target.value),placeholder:"175",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),l.jsx(u0,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Weight (kg)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:s,onChange:G=>o(G.target.value),placeholder:"70",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),l.jsx(h0,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Age"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:i,onChange:G=>a(G.target.value),placeholder:"25",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),l.jsx(Hn,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Gender"}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:c,onChange:G=>d(G.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[l.jsx("option",{value:"",children:"Select"}),l.jsx("option",{value:"male",children:"Male"}),l.jsx("option",{value:"female",children:"Female"})]}),l.jsx(Sc,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]})]}),l.jsxs("div",{className:"pt-4 border-t border-gray-100 dark:border-white/5",children:[l.jsxs("button",{type:"button",onClick:()=>F(!M),className:"w-full flex items-center justify-between mb-3 group",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(vs,{size:16,className:"text-royal-600 dark:text-royal-400"}),l.jsx("p",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-wider",children:"Training Goal Setting"})]}),l.jsx(o0,{size:18,className:`text-royal-600 dark:text-royal-400 transition-transform duration-300 ${M?"rotate-180":""}`})]}),l.jsx("p",{className:"text-[10px] text-gray-400 dark:text-gray-500 mb-3 ml-1",children:"Optional - Fill this for personalized AI Coach recommendations"}),M&&l.jsxs("div",{className:"space-y-5 animate-in slide-in-from-top-2 duration-300",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Activity Level"}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:h,onChange:G=>p(G.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[l.jsx("option",{value:"",children:"Select"}),l.jsx("option",{value:"sedentary",children:"Sedentary (Little or no exercise)"}),l.jsx("option",{value:"light",children:"Lightly Active (1-3 days/week)"}),l.jsx("option",{value:"moderate",children:"Moderately Active (3-5 days/week)"}),l.jsx("option",{value:"very",children:"Very Active (6-7 days/week)"}),l.jsx("option",{value:"extra",children:"Extra Active (Intense daily)"})]}),l.jsx(is,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Goal"}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:m,onChange:G=>g(G.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[l.jsx("option",{value:"",children:"Select"}),l.jsx("option",{value:"cut",children:"Cut (Lose Fat)"}),l.jsx("option",{value:"bulk",children:"Bulk (Gain Muscle)"}),l.jsx("option",{value:"maintain",children:"Maintain"})]}),l.jsx(vs,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Equipment"}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:y,onChange:G=>_(G.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[l.jsx("option",{value:"",children:"Select"}),l.jsx("option",{value:"gym",children:"Gym Access"}),l.jsx("option",{value:"home",children:"Home Equipment"}),l.jsx("option",{value:"bodyweight",children:"Bodyweight Only"})]}),l.jsx(ys,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]})]}),m==="cut"&&l.jsxs("div",{className:"mt-4 animate-in slide-in-from-top-2 duration-300",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Target Weight (kg)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:j,onChange:G=>J(G.target.value),placeholder:"e.g. 63",step:"0.1",min:"30",max:"200",className:"w-full p-4 pl-12 bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-950/30 dark:to-green-950/30 border border-emerald-200 dark:border-emerald-900/50 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-emerald-200 focus:border-emerald-400 font-bold text-gray-900 dark:text-gray-50 transition-all"}),l.jsx(d0,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-emerald-500",size:20})]}),l.jsx("p",{className:"text-[10px] text-emerald-600 dark:text-emerald-400 mt-2 ml-1 font-medium",children:"This powers your weight prediction on the Dashboard"})]})]})]}),l.jsx(Le,{className:"w-full py-5 text-lg shadow-lg shadow-royal-200 dark:shadow-royal-900/40",onClick:Ae,isLoading:b,children:w?l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx(Yu,{size:20})," Saved"]}):"Save Profile"})]}),ws&&l.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] p-6 rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-10 h-10 rounded-2xl flex items-center justify-center ${We==="cloud"?"bg-emerald-50 dark:bg-emerald-950/30 text-emerald-600":"bg-gray-100 dark:bg-white/10 text-gray-500"}`,children:We==="cloud"?l.jsx(Uw,{size:20}):l.jsx(l0,{size:20})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:"Storage Mode"}),l.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:We==="cloud"?"Connected to Supabase":"Device Storage Only"})]})]}),le&&l.jsx("button",{onClick:U,className:"p-2 text-gray-400 hover:text-royal-500 transition-colors",title:"Check Connection",children:l.jsx(xo,{size:16,className:N==="checking"?"animate-spin":""})})]}),l.jsxs("div",{className:"flex p-1 bg-gray-100 dark:bg-white/5 rounded-2xl",children:[l.jsx("button",{onClick:()=>te("local"),className:`flex-1 py-3 text-xs font-bold rounded-xl transition-all ${We==="local"?"bg-white dark:bg-white/10 text-gray-900 dark:text-white shadow-sm":"text-gray-400 hover:text-gray-600"}`,children:"Device Only"}),l.jsx("button",{onClick:()=>te("cloud"),className:`flex-1 py-3 text-xs font-bold rounded-xl transition-all ${We==="cloud"?"bg-emerald-500 text-white shadow-sm":"text-gray-400 hover:text-gray-600"}`,children:"Cloud Sync"})]})]}),l.jsx("div",{className:"pt-4",children:l.jsx("button",{onClick:ln,disabled:P,className:"w-full flex items-center justify-center gap-3 py-5 rounded-[24px] border border-red-200 dark:border-red-900/30 text-red-500 dark:text-red-400 font-bold hover:bg-red-50 dark:hover:bg-red-950/20 active:scale-95 transition-all shadow-sm",children:P?l.jsx(xo,{size:20,className:"animate-spin"}):l.jsxs(l.Fragment,{children:[l.jsx(Hw,{size:20}),l.jsx("span",{children:"Sign Out"})]})})}),l.jsx("div",{className:"text-center pt-4 pb-2",children:l.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full text-[10px] font-bold border transition-colors ${le?"bg-emerald-50 dark:bg-emerald-950/20 text-emerald-700 dark:text-emerald-400 border-emerald-100 dark:border-emerald-900/30":"bg-amber-50 dark:bg-amber-950/20 text-amber-700 dark:text-amber-400 border-amber-100 dark:border-amber-900/30"}`,children:[l.jsx(Pf,{size:12}),l.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${le?"bg-emerald-500 animate-pulse":"bg-amber-500"}`}),le?"Syncing to Supabase":"Local Storage Mode"]})})]})},z2=({user:t,onComplete:e})=>{const[n,r]=k.useState(0),[s,o]=k.useState(""),[i,a]=k.useState(""),[c,d]=k.useState(""),[h,p]=k.useState(!1),m=5,g=()=>{const E=parseFloat(i),C=parseFloat(c);return!E||!C?null:C/(E/100*(E/100))},y=E=>{const R=(10*parseFloat(c)+6.25*parseFloat(i)-5*25+5)*1.2;return E<18.5?Math.round(R+400):E>25?Math.round(R-400):Math.round(R)},_=()=>{n<m-1&&r(n+1)},b=()=>{n>0&&r(n-1)},x=async()=>{await sk(t),e()},w=async()=>{p(!0);try{if(s&&i&&c){await Ma({name:s,height:parseFloat(i),weight:parseFloat(c)});const E=g();if(E){const C=y(E);await Pa(C)}}await z0(t),e()}catch(E){console.error("Failed to save onboarding data:",E),alert("Failed to save your profile. Please try again.")}finally{p(!1)}},v=s&&i&&c,S=g(),T=S?y(S):null;return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-surface via-royal-50/30 to-royal-100/40 dark:from-surface-dark dark:via-royal-950/20 dark:to-black flex items-center justify-center p-4 relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-royal-200/20 dark:bg-royal-800/10 rounded-full blur-3xl animate-pulse"}),l.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-purple-200/20 dark:bg-purple-900/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),l.jsxs("button",{onClick:x,className:"absolute top-6 right-6 z-50 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors text-sm font-medium flex items-center gap-1",children:["Skip ",l.jsx(Tt,{size:16})]}),l.jsxs("div",{className:"relative z-10 w-full max-w-2xl",children:[l.jsx("div",{className:"flex justify-center gap-2 mb-8",children:Array.from({length:m}).map((E,C)=>l.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${C===n?"w-12 bg-royal-600 dark:bg-royal-500":C<n?"w-8 bg-royal-400 dark:bg-royal-600":"w-8 bg-gray-200 dark:bg-gray-700"}`},C))}),l.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] rounded-[40px] shadow-diffused-lg dark:shadow-diffused-dark p-8 md:p-12 min-h-[500px] flex flex-col",children:[n===0&&l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center animate-in fade-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:"relative mb-8",children:[l.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-royal-500 to-purple-600 rounded-[32px] flex items-center justify-center shadow-xl shadow-royal-200 dark:shadow-royal-900/40 animate-in zoom-in duration-700",children:l.jsx(wt,{size:48,className:"text-white",strokeWidth:2})}),l.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-yellow-400 rounded-full animate-bounce"})]}),l.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-gray-50 mb-4 tracking-tight",children:"Welcome to SnapCal AI"}),l.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 font-medium mb-2",children:"Your AI-Powered Nutrition Companion"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 max-w-md leading-relaxed",children:"Track calories effortlessly with the power of artificial intelligence. Just snap a photo of your meal and let AI do the rest."}),l.jsxs("div",{className:"mt-12 grid grid-cols-3 gap-6 w-full max-w-md",children:[l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("div",{className:"w-14 h-14 bg-royal-50 dark:bg-royal-950/30 rounded-2xl flex items-center justify-center",children:l.jsx(pr,{size:28,className:"text-royal-600 dark:text-royal-400"})}),l.jsx("span",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:"Snap"})]}),l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("div",{className:"w-14 h-14 bg-purple-50 dark:bg-purple-950/30 rounded-2xl flex items-center justify-center",children:l.jsx(Xu,{size:28,className:"text-purple-600 dark:text-purple-400"})}),l.jsx("span",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:"Analyze"})]}),l.jsxs("div",{className:"flex flex-col items-center gap-2",children:[l.jsx("div",{className:"w-14 h-14 bg-emerald-50 dark:bg-emerald-950/30 rounded-2xl flex items-center justify-center",children:l.jsx(is,{size:28,className:"text-emerald-600 dark:text-emerald-400"})}),l.jsx("span",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:"Track"})]})]})]}),n===1&&l.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-in fade-in slide-in-from-right-4 duration-500",children:[l.jsxs("div",{className:"mb-8 text-center",children:[l.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-royal-50 dark:bg-royal-950/30 rounded-full mb-4",children:[l.jsx(pr,{size:16,className:"text-royal-600 dark:text-royal-400"}),l.jsx("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-wider",children:"How It Works"})]}),l.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-gray-50 mb-3",children:"Instant Nutrition Insights"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm max-w-lg mx-auto",children:"Our AI analyzes your food photos to provide accurate calorie counts and nutritional breakdowns in seconds."})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start gap-4 p-5 bg-gray-50 dark:bg-white/5 rounded-[24px] border border-gray-100 dark:border-white/5",children:[l.jsx("div",{className:"w-12 h-12 bg-royal-100 dark:bg-royal-900/30 rounded-2xl flex items-center justify-center flex-shrink-0",children:l.jsx(pr,{size:24,className:"text-royal-600 dark:text-royal-400"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 mb-1",children:"1. Capture Your Meal"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Take a photo of any dish, snack, or beverage"})]})]}),l.jsxs("div",{className:"flex items-start gap-4 p-5 bg-gray-50 dark:bg-white/5 rounded-[24px] border border-gray-100 dark:border-white/5",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-2xl flex items-center justify-center flex-shrink-0",children:l.jsx(wt,{size:24,className:"text-purple-600 dark:text-purple-400"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 mb-1",children:"2. AI Recognition"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Advanced AI identifies ingredients and portions instantly"})]})]}),l.jsxs("div",{className:"flex items-start gap-4 p-5 bg-gray-50 dark:bg-white/5 rounded-[24px] border border-gray-100 dark:border-white/5",children:[l.jsx("div",{className:"w-12 h-12 bg-emerald-100 dark:bg-emerald-900/30 rounded-2xl flex items-center justify-center flex-shrink-0",children:l.jsx(is,{size:24,className:"text-emerald-600 dark:text-emerald-400"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 mb-1",children:"3. Get Detailed Breakdown"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Calories, protein, carbs, and fatsall automatically calculated"})]})]})]})]}),n===2&&l.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-in fade-in slide-in-from-right-4 duration-500",children:[l.jsxs("div",{className:"mb-8 text-center",children:[l.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-50 dark:bg-purple-950/30 rounded-full mb-4",children:[l.jsx(bc,{size:16,className:"text-purple-600 dark:text-purple-400"}),l.jsx("span",{className:"text-xs font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider",children:"Personalization"})]}),l.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-gray-50 mb-3",children:"Why Your Profile Matters"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm max-w-lg mx-auto",children:"Share a few details to unlock truly personalized nutrition recommendations tailored just for you."})]}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"p-6 bg-gradient-to-br from-royal-50 to-purple-50 dark:from-royal-950/20 dark:to-purple-950/20 rounded-[28px] border border-royal-100 dark:border-royal-900/30",children:[l.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:l.jsx(vs,{size:24,className:"text-royal-600 dark:text-royal-400"})}),l.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Accurate Goals"}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"Get a science-backed daily calorie target based on your unique body metrics and health objectives."})]}),l.jsxs("div",{className:"p-6 bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/20 dark:to-teal-950/20 rounded-[28px] border border-emerald-100 dark:border-emerald-900/30",children:[l.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:l.jsx(is,{size:24,className:"text-emerald-600 dark:text-emerald-400"})}),l.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Smart Insights"}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"Receive personalized BMI analysis and recommendations to help you reach your ideal weight."})]}),l.jsxs("div",{className:"p-6 bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-950/20 dark:to-amber-950/20 rounded-[28px] border border-orange-100 dark:border-orange-900/30",children:[l.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:l.jsx(wt,{size:24,className:"text-orange-600 dark:text-orange-400"})}),l.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Better Tracking"}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"See how your intake compares to your goals and adjust your habits for optimal results."})]}),l.jsxs("div",{className:"p-6 bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-950/20 dark:to-rose-950/20 rounded-[28px] border border-pink-100 dark:border-pink-900/30",children:[l.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:l.jsx(bc,{size:24,className:"text-pink-600 dark:text-pink-400"})}),l.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Long-term Success"}),l.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"Build sustainable habits with data-driven feedback tailored to your wellness journey."})]})]})]}),n===3&&l.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-in fade-in slide-in-from-right-4 duration-500",children:[l.jsxs("div",{className:"mb-6 text-center",children:[l.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-royal-50 dark:bg-royal-950/30 rounded-full mb-4",children:[l.jsx(xs,{size:16,className:"text-royal-600 dark:text-royal-400"}),l.jsx("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-wider",children:"Your Details"})]}),l.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-gray-50 mb-3",children:"Set Up Your Profile"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm max-w-lg mx-auto",children:"Just a few quick details to personalize your experience"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Display Name"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",value:s,onChange:E=>o(E.target.value),placeholder:"Enter your name",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),l.jsx(xs,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Height (cm)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:i,onChange:E=>a(E.target.value),placeholder:"175",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),l.jsx(u0,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Weight (kg)"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"number",value:c,onChange:E=>d(E.target.value),placeholder:"70",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),l.jsx(h0,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]})]}),S&&l.jsxs("div",{className:"p-5 bg-gradient-to-r from-royal-50 to-purple-50 dark:from-royal-950/20 dark:to-purple-950/20 rounded-[24px] border border-royal-100 dark:border-royal-900/30 animate-in slide-in-from-bottom-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-xs font-bold text-royal-700 dark:text-royal-300 uppercase tracking-wider",children:"Your BMI"}),l.jsx("span",{className:"text-2xl font-extrabold text-royal-900 dark:text-royal-100",children:S.toFixed(1)})]}),T&&l.jsxs("p",{className:"text-xs text-royal-600 dark:text-royal-400",children:["Recommended daily goal: ",l.jsxs("span",{className:"font-bold",children:[T," kcal"]})]})]})]})]}),n===4&&l.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center animate-in fade-in zoom-in duration-500",children:[l.jsxs("div",{className:"relative mb-8",children:[l.jsx("div",{className:"w-28 h-28 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center shadow-2xl shadow-emerald-200 dark:shadow-emerald-900/40 animate-in zoom-in duration-700",children:l.jsx(Yu,{size:56,className:"text-white",strokeWidth:3})}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-full animate-ping opacity-20"})]}),l.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-gray-50 mb-4 tracking-tight",children:"You're All Set!"}),l.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 font-medium mb-2",children:"Your personalized nutrition journey begins now"}),s&&T&&l.jsxs("div",{className:"mt-8 p-6 bg-gradient-to-br from-royal-50 to-purple-50 dark:from-royal-950/20 dark:to-purple-950/20 rounded-[28px] border border-royal-100 dark:border-royal-900/30 max-w-md w-full",children:[l.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Welcome, ",l.jsx("span",{className:"font-bold text-royal-600 dark:text-royal-400",children:s}),"!"]}),l.jsxs("div",{className:"flex items-baseline gap-2 justify-center",children:[l.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-500 font-medium",children:"Daily Goal:"}),l.jsx("span",{className:"text-3xl font-extrabold text-royal-900 dark:text-royal-100",children:T}),l.jsx("span",{className:"text-sm font-bold text-gray-500 dark:text-gray-500",children:"kcal"})]})]}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-6 max-w-md leading-relaxed",children:"Start snapping photos of your meals to track your nutrition effortlessly. We'll help you stay on track!"})]}),l.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-100 dark:border-white/5",children:[l.jsxs("button",{onClick:b,disabled:n===0,className:`flex items-center gap-2 px-5 py-3 rounded-[16px] font-bold text-sm transition-all ${n===0?"opacity-0 pointer-events-none":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:[l.jsx(_r,{size:20}),"Back"]}),n===m-1?l.jsxs(Le,{onClick:w,isLoading:h,className:"px-8 py-4 text-base shadow-xl shadow-royal-200 dark:shadow-royal-900/40",children:["Start Tracking",l.jsx(mr,{size:20,className:"ml-1"})]}):n===3?l.jsxs(Le,{onClick:_,disabled:!v,className:"px-8 py-4 text-base shadow-xl shadow-royal-200 dark:shadow-royal-900/40",children:["Continue",l.jsx(mr,{size:20,className:"ml-1"})]}):l.jsxs(Le,{onClick:_,className:"px-8 py-4 text-base shadow-xl shadow-royal-200 dark:shadow-royal-900/40",children:["Next",l.jsx(mr,{size:20,className:"ml-1"})]})]})]})]})]})};function B2(){const[t,e]=k.useState(ve.DASHBOARD),[n,r]=k.useState(null),[s,o]=k.useState(!0),[i,a]=k.useState(!1),[c,d]=k.useState(!0);k.useEffect(()=>{he().then(m=>{r(m),o(!1),m&&rh().catch(g=>console.error("Cleanup failed:",g))});const p=qS(m=>{r(m),o(!1),m&&rh().catch(g=>console.error("Cleanup failed:",g))});return()=>p()},[]),k.useEffect(()=>{dk()&&(console.log(" New day detected on app load! Clearing stale caches..."),ct.clearDateSensitiveCaches(),window.dispatchEvent(new CustomEvent("midnight-refresh")));const p=uk(()=>{console.log(" Midnight! Clearing caches and broadcasting refresh event..."),ct.clearDateSensitiveCaches(),window.dispatchEvent(new CustomEvent("midnight-refresh"))});return()=>{p()}},[]),k.useEffect(()=>{(async()=>{if(n){d(!0);const m=await rk(n);a(!m),d(!1)}else a(!1),d(!1)})()},[n]);const h=()=>{a(!1),e(ve.DASHBOARD)};return s||c?l.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:l.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"})}):n?i?l.jsx(z2,{user:n,onComplete:h}):l.jsxs(l_,{currentView:t,onNavigate:e,children:[t===ve.DASHBOARD&&l.jsx(u2,{}),t===ve.CAL_COACH&&l.jsx(v2,{onNavigate:e}),t===ve.WORKOUT_PLAN&&l.jsx(S2,{onNavigate:e}),t===ve.HISTORY&&l.jsx(O2,{}),t===ve.PROFILE&&l.jsx(G2,{})]}):l.jsx($2,{})}const Yy=document.getElementById("root");if(!Yy)throw new Error("Could not find root element to mount to");const V2=Il.createRoot(Yy);V2.render(l.jsx(yv.StrictMode,{children:l.jsx(B2,{})}));
