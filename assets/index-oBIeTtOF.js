var Py=Object.defineProperty;var My=(t,e,n)=>e in t?Py(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ca=(t,e,n)=>My(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function Dy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ip={exports:{}},Yi={},Ap={exports:{}},le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var po=Symbol.for("react.element"),Ly=Symbol.for("react.portal"),Uy=Symbol.for("react.fragment"),jy=Symbol.for("react.strict_mode"),Oy=Symbol.for("react.profiler"),Fy=Symbol.for("react.provider"),$y=Symbol.for("react.context"),Gy=Symbol.for("react.forward_ref"),Vy=Symbol.for("react.suspense"),By=Symbol.for("react.memo"),zy=Symbol.for("react.lazy"),id=Symbol.iterator;function qy(t){return t===null||typeof t!="object"?null:(t=id&&t[id]||t["@@iterator"],typeof t=="function"?t:null)}var Rp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pp=Object.assign,Mp={};function os(t,e,n){this.props=t,this.context=e,this.refs=Mp,this.updater=n||Rp}os.prototype.isReactComponent={};os.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};os.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Dp(){}Dp.prototype=os.prototype;function ju(t,e,n){this.props=t,this.context=e,this.refs=Mp,this.updater=n||Rp}var Ou=ju.prototype=new Dp;Ou.constructor=ju;Pp(Ou,os.prototype);Ou.isPureReactComponent=!0;var ad=Array.isArray,Lp=Object.prototype.hasOwnProperty,Fu={current:null},Up={key:!0,ref:!0,__self:!0,__source:!0};function jp(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)Lp.call(e,r)&&!Up.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var u=Array(a),d=0;d<a;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:po,type:t,key:o,ref:i,props:s,_owner:Fu.current}}function Hy(t,e){return{$$typeof:po,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $u(t){return typeof t=="object"&&t!==null&&t.$$typeof===po}function Wy(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ld=/\/+/g;function Na(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Wy(""+t.key):e.toString(36)}function Ko(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case po:case Ly:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+Na(i,0):r,ad(s)?(n="",t!=null&&(n=t.replace(ld,"$&/")+"/"),Ko(s,e,n,"",function(d){return d})):s!=null&&($u(s)&&(s=Hy(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(ld,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",ad(t))for(var a=0;a<t.length;a++){o=t[a];var u=r+Na(o,a);i+=Ko(o,e,n,u,s)}else if(u=qy(t),typeof u=="function")for(t=u.call(t),a=0;!(o=t.next()).done;)o=o.value,u=r+Na(o,a++),i+=Ko(o,e,n,u,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function So(t,e,n){if(t==null)return t;var r=[],s=0;return Ko(t,r,"","",function(o){return e.call(n,o,s++)}),r}function Jy(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var lt={current:null},Yo={transition:null},Ky={ReactCurrentDispatcher:lt,ReactCurrentBatchConfig:Yo,ReactCurrentOwner:Fu};function Op(){throw Error("act(...) is not supported in production builds of React.")}le.Children={map:So,forEach:function(t,e,n){So(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return So(t,function(){e++}),e},toArray:function(t){return So(t,function(e){return e})||[]},only:function(t){if(!$u(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};le.Component=os;le.Fragment=Uy;le.Profiler=Oy;le.PureComponent=ju;le.StrictMode=jy;le.Suspense=Vy;le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ky;le.act=Op;le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Pp({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=Fu.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(u in e)Lp.call(e,u)&&!Up.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&a!==void 0?a[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){a=Array(u);for(var d=0;d<u;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:po,type:t.type,key:s,ref:o,props:r,_owner:i}};le.createContext=function(t){return t={$$typeof:$y,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Fy,_context:t},t.Consumer=t};le.createElement=jp;le.createFactory=function(t){var e=jp.bind(null,t);return e.type=t,e};le.createRef=function(){return{current:null}};le.forwardRef=function(t){return{$$typeof:Gy,render:t}};le.isValidElement=$u;le.lazy=function(t){return{$$typeof:zy,_payload:{_status:-1,_result:t},_init:Jy}};le.memo=function(t,e){return{$$typeof:By,type:t,compare:e===void 0?null:e}};le.startTransition=function(t){var e=Yo.transition;Yo.transition={};try{t()}finally{Yo.transition=e}};le.unstable_act=Op;le.useCallback=function(t,e){return lt.current.useCallback(t,e)};le.useContext=function(t){return lt.current.useContext(t)};le.useDebugValue=function(){};le.useDeferredValue=function(t){return lt.current.useDeferredValue(t)};le.useEffect=function(t,e){return lt.current.useEffect(t,e)};le.useId=function(){return lt.current.useId()};le.useImperativeHandle=function(t,e,n){return lt.current.useImperativeHandle(t,e,n)};le.useInsertionEffect=function(t,e){return lt.current.useInsertionEffect(t,e)};le.useLayoutEffect=function(t,e){return lt.current.useLayoutEffect(t,e)};le.useMemo=function(t,e){return lt.current.useMemo(t,e)};le.useReducer=function(t,e,n){return lt.current.useReducer(t,e,n)};le.useRef=function(t){return lt.current.useRef(t)};le.useState=function(t){return lt.current.useState(t)};le.useSyncExternalStore=function(t,e,n){return lt.current.useSyncExternalStore(t,e,n)};le.useTransition=function(){return lt.current.useTransition()};le.version="18.3.1";Ap.exports=le;var E=Ap.exports;const Yy=Dy(E);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qy=E,Xy=Symbol.for("react.element"),Zy=Symbol.for("react.fragment"),ev=Object.prototype.hasOwnProperty,tv=Qy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nv={key:!0,ref:!0,__self:!0,__source:!0};function Fp(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)ev.call(e,r)&&!nv.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Xy,type:t,key:o,ref:i,props:s,_owner:tv.current}}Yi.Fragment=Zy;Yi.jsx=Fp;Yi.jsxs=Fp;Ip.exports=Yi;var c=Ip.exports,pl={},$p={exports:{}},bt={},Gp={exports:{}},Vp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(A,O){var I=A.length;A.push(O);e:for(;0<I;){var F=I-1>>>1,D=A[F];if(0<s(D,O))A[F]=O,A[I]=D,I=F;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var O=A[0],I=A.pop();if(I!==O){A[0]=I;e:for(var F=0,D=A.length,K=D>>>1;F<K;){var ee=2*(F+1)-1,Z=A[ee],H=ee+1,de=A[H];if(0>s(Z,I))H<D&&0>s(de,Z)?(A[F]=de,A[H]=I,F=H):(A[F]=Z,A[ee]=I,F=ee);else if(H<D&&0>s(de,I))A[F]=de,A[H]=I,F=H;else break e}}return O}function s(A,O){var I=A.sortIndex-O.sortIndex;return I!==0?I:A.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var u=[],d=[],h=1,p=null,m=3,g=!1,x=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(A){for(var O=n(d);O!==null;){if(O.callback===null)r(d);else if(O.startTime<=A)r(d),O.sortIndex=O.expirationTime,e(u,O);else break;O=n(d)}}function b(A){if(_=!1,w(A),!x)if(n(u)!==null)x=!0,z(C);else{var O=n(d);O!==null&&Q(b,O.startTime-A)}}function C(A,O){x=!1,_&&(_=!1,v(M),M=-1),g=!0;var I=m;try{for(w(O),p=n(u);p!==null&&(!(p.expirationTime>O)||A&&!X());){var F=p.callback;if(typeof F=="function"){p.callback=null,m=p.priorityLevel;var D=F(p.expirationTime<=O);O=t.unstable_now(),typeof D=="function"?p.callback=D:p===n(u)&&r(u),w(O)}else r(u);p=n(u)}if(p!==null)var K=!0;else{var ee=n(d);ee!==null&&Q(b,ee.startTime-O),K=!1}return K}finally{p=null,m=I,g=!1}}var k=!1,T=null,M=-1,R=5,U=-1;function X(){return!(t.unstable_now()-U<R)}function ye(){if(T!==null){var A=t.unstable_now();U=A;var O=!0;try{O=T(!0,A)}finally{O?se():(k=!1,T=null)}}else k=!1}var se;if(typeof y=="function")se=function(){y(ye)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,V=N.port2;N.port1.onmessage=ye,se=function(){V.postMessage(null)}}else se=function(){S(ye,0)};function z(A){T=A,k||(k=!0,se())}function Q(A,O){M=S(function(){A(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){x||g||(x=!0,z(C))},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(A){switch(m){case 1:case 2:case 3:var O=3;break;default:O=m}var I=m;m=O;try{return A()}finally{m=I}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(A,O){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var I=m;m=A;try{return O()}finally{m=I}},t.unstable_scheduleCallback=function(A,O,I){var F=t.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?F+I:F):I=F,A){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=I+D,A={id:h++,callback:O,priorityLevel:A,startTime:I,expirationTime:D,sortIndex:-1},I>F?(A.sortIndex=I,e(d,A),n(u)===null&&A===n(d)&&(_?(v(M),M=-1):_=!0,Q(b,I-F))):(A.sortIndex=D,e(u,A),x||g||(x=!0,z(C))),A},t.unstable_shouldYield=X,t.unstable_wrapCallback=function(A){var O=m;return function(){var I=m;m=O;try{return A.apply(this,arguments)}finally{m=I}}}})(Vp);Gp.exports=Vp;var rv=Gp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv=E,St=rv;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Bp=new Set,$s={};function cr(t,e){Yr(t,e),Yr(t+"Capture",e)}function Yr(t,e){for($s[t]=e,t=0;t<e.length;t++)Bp.add(e[t])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ml=Object.prototype.hasOwnProperty,ov=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ud={},cd={};function iv(t){return ml.call(cd,t)?!0:ml.call(ud,t)?!1:ov.test(t)?cd[t]=!0:(ud[t]=!0,!1)}function av(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function lv(t,e,n,r){if(e===null||typeof e>"u"||av(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ut(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Ye={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ye[t]=new ut(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ye[e]=new ut(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ye[t]=new ut(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ye[t]=new ut(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ye[t]=new ut(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ye[t]=new ut(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ye[t]=new ut(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ye[t]=new ut(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ye[t]=new ut(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gu=/[\-:]([a-z])/g;function Vu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gu,Vu);Ye[e]=new ut(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gu,Vu);Ye[e]=new ut(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gu,Vu);Ye[e]=new ut(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ye[t]=new ut(t,1,!1,t.toLowerCase(),null,!1,!1)});Ye.xlinkHref=new ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ye[t]=new ut(t,1,!1,t.toLowerCase(),null,!0,!0)});function Bu(t,e,n,r){var s=Ye.hasOwnProperty(e)?Ye[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(lv(e,n,s,r)&&(n=null),r||s===null?iv(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var pn=sv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bo=Symbol.for("react.element"),Tr=Symbol.for("react.portal"),Cr=Symbol.for("react.fragment"),zu=Symbol.for("react.strict_mode"),gl=Symbol.for("react.profiler"),zp=Symbol.for("react.provider"),qp=Symbol.for("react.context"),qu=Symbol.for("react.forward_ref"),yl=Symbol.for("react.suspense"),vl=Symbol.for("react.suspense_list"),Hu=Symbol.for("react.memo"),xn=Symbol.for("react.lazy"),Hp=Symbol.for("react.offscreen"),dd=Symbol.iterator;function fs(t){return t===null||typeof t!="object"?null:(t=dd&&t[dd]||t["@@iterator"],typeof t=="function"?t:null)}var Ie=Object.assign,Ia;function Ss(t){if(Ia===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ia=e&&e[1]||""}return`
`+Ia+t}var Aa=!1;function Ra(t,e){if(!t||Aa)return"";Aa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var u=`
`+s[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=a);break}}}finally{Aa=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ss(t):""}function uv(t){switch(t.tag){case 5:return Ss(t.type);case 16:return Ss("Lazy");case 13:return Ss("Suspense");case 19:return Ss("SuspenseList");case 0:case 2:case 15:return t=Ra(t.type,!1),t;case 11:return t=Ra(t.type.render,!1),t;case 1:return t=Ra(t.type,!0),t;default:return""}}function xl(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Cr:return"Fragment";case Tr:return"Portal";case gl:return"Profiler";case zu:return"StrictMode";case yl:return"Suspense";case vl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case qp:return(t.displayName||"Context")+".Consumer";case zp:return(t._context.displayName||"Context")+".Provider";case qu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Hu:return e=t.displayName||null,e!==null?e:xl(t.type)||"Memo";case xn:e=t._payload,t=t._init;try{return xl(t(e))}catch{}}return null}function cv(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xl(e);case 8:return e===zu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ln(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Wp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function dv(t){var e=Wp(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ko(t){t._valueTracker||(t._valueTracker=dv(t))}function Jp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Wp(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ci(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function wl(t,e){var n=e.checked;return Ie({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fd(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ln(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Kp(t,e){e=e.checked,e!=null&&Bu(t,"checked",e,!1)}function _l(t,e){Kp(t,e);var n=Ln(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Sl(t,e.type,n):e.hasOwnProperty("defaultValue")&&Sl(t,e.type,Ln(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function hd(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Sl(t,e,n){(e!=="number"||ci(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bs=Array.isArray;function Gr(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ln(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function bl(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Ie({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function pd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(bs(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ln(n)}}function Yp(t,e){var n=Ln(e.value),r=Ln(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function md(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Qp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kl(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Qp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Eo,Xp=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Eo=Eo||document.createElement("div"),Eo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Eo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gs(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ns={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fv=["Webkit","ms","Moz","O"];Object.keys(Ns).forEach(function(t){fv.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ns[e]=Ns[t]})});function Zp(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ns.hasOwnProperty(t)&&Ns[t]?(""+e).trim():e+"px"}function em(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Zp(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var hv=Ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function El(t,e){if(e){if(hv[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Tl(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cl=null;function Wu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Nl=null,Vr=null,Br=null;function gd(t){if(t=yo(t)){if(typeof Nl!="function")throw Error(L(280));var e=t.stateNode;e&&(e=ta(e),Nl(t.stateNode,t.type,e))}}function tm(t){Vr?Br?Br.push(t):Br=[t]:Vr=t}function nm(){if(Vr){var t=Vr,e=Br;if(Br=Vr=null,gd(t),e)for(t=0;t<e.length;t++)gd(e[t])}}function rm(t,e){return t(e)}function sm(){}var Pa=!1;function om(t,e,n){if(Pa)return t(e,n);Pa=!0;try{return rm(t,e,n)}finally{Pa=!1,(Vr!==null||Br!==null)&&(sm(),nm())}}function Vs(t,e){var n=t.stateNode;if(n===null)return null;var r=ta(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var Il=!1;if(un)try{var hs={};Object.defineProperty(hs,"passive",{get:function(){Il=!0}}),window.addEventListener("test",hs,hs),window.removeEventListener("test",hs,hs)}catch{Il=!1}function pv(t,e,n,r,s,o,i,a,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Is=!1,di=null,fi=!1,Al=null,mv={onError:function(t){Is=!0,di=t}};function gv(t,e,n,r,s,o,i,a,u){Is=!1,di=null,pv.apply(mv,arguments)}function yv(t,e,n,r,s,o,i,a,u){if(gv.apply(this,arguments),Is){if(Is){var d=di;Is=!1,di=null}else throw Error(L(198));fi||(fi=!0,Al=d)}}function dr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function im(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function yd(t){if(dr(t)!==t)throw Error(L(188))}function vv(t){var e=t.alternate;if(!e){if(e=dr(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return yd(s),t;if(o===r)return yd(s),e;o=o.sibling}throw Error(L(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function am(t){return t=vv(t),t!==null?lm(t):null}function lm(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lm(t);if(e!==null)return e;t=t.sibling}return null}var um=St.unstable_scheduleCallback,vd=St.unstable_cancelCallback,xv=St.unstable_shouldYield,wv=St.unstable_requestPaint,Pe=St.unstable_now,_v=St.unstable_getCurrentPriorityLevel,Ju=St.unstable_ImmediatePriority,cm=St.unstable_UserBlockingPriority,hi=St.unstable_NormalPriority,Sv=St.unstable_LowPriority,dm=St.unstable_IdlePriority,Qi=null,en=null;function bv(t){if(en&&typeof en.onCommitFiberRoot=="function")try{en.onCommitFiberRoot(Qi,t,void 0,(t.current.flags&128)===128)}catch{}}var Vt=Math.clz32?Math.clz32:Tv,kv=Math.log,Ev=Math.LN2;function Tv(t){return t>>>=0,t===0?32:31-(kv(t)/Ev|0)|0}var To=64,Co=4194304;function ks(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pi(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=ks(a):(o&=i,o!==0&&(r=ks(o)))}else i=n&~s,i!==0?r=ks(i):o!==0&&(r=ks(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Vt(e),s=1<<n,r|=t[n],e&=~s;return r}function Cv(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nv(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-Vt(o),a=1<<i,u=s[i];u===-1?(!(a&n)||a&r)&&(s[i]=Cv(a,e)):u<=e&&(t.expiredLanes|=a),o&=~a}}function Rl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fm(){var t=To;return To<<=1,!(To&4194240)&&(To=64),t}function Ma(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function mo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Vt(e),t[e]=n}function Iv(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Vt(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function Ku(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Vt(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ve=0;function hm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pm,Yu,mm,gm,ym,Pl=!1,No=[],Cn=null,Nn=null,In=null,Bs=new Map,zs=new Map,Sn=[],Av="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xd(t,e){switch(t){case"focusin":case"focusout":Cn=null;break;case"dragenter":case"dragleave":Nn=null;break;case"mouseover":case"mouseout":In=null;break;case"pointerover":case"pointerout":Bs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zs.delete(e.pointerId)}}function ps(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=yo(e),e!==null&&Yu(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Rv(t,e,n,r,s){switch(e){case"focusin":return Cn=ps(Cn,t,e,n,r,s),!0;case"dragenter":return Nn=ps(Nn,t,e,n,r,s),!0;case"mouseover":return In=ps(In,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Bs.set(o,ps(Bs.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,zs.set(o,ps(zs.get(o)||null,t,e,n,r,s)),!0}return!1}function vm(t){var e=Yn(t.target);if(e!==null){var n=dr(e);if(n!==null){if(e=n.tag,e===13){if(e=im(n),e!==null){t.blockedOn=e,ym(t.priority,function(){mm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Qo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ml(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Cl=r,n.target.dispatchEvent(r),Cl=null}else return e=yo(n),e!==null&&Yu(e),t.blockedOn=n,!1;e.shift()}return!0}function wd(t,e,n){Qo(t)&&n.delete(e)}function Pv(){Pl=!1,Cn!==null&&Qo(Cn)&&(Cn=null),Nn!==null&&Qo(Nn)&&(Nn=null),In!==null&&Qo(In)&&(In=null),Bs.forEach(wd),zs.forEach(wd)}function ms(t,e){t.blockedOn===e&&(t.blockedOn=null,Pl||(Pl=!0,St.unstable_scheduleCallback(St.unstable_NormalPriority,Pv)))}function qs(t){function e(s){return ms(s,t)}if(0<No.length){ms(No[0],t);for(var n=1;n<No.length;n++){var r=No[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Cn!==null&&ms(Cn,t),Nn!==null&&ms(Nn,t),In!==null&&ms(In,t),Bs.forEach(e),zs.forEach(e),n=0;n<Sn.length;n++)r=Sn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Sn.length&&(n=Sn[0],n.blockedOn===null);)vm(n),n.blockedOn===null&&Sn.shift()}var zr=pn.ReactCurrentBatchConfig,mi=!0;function Mv(t,e,n,r){var s=ve,o=zr.transition;zr.transition=null;try{ve=1,Qu(t,e,n,r)}finally{ve=s,zr.transition=o}}function Dv(t,e,n,r){var s=ve,o=zr.transition;zr.transition=null;try{ve=4,Qu(t,e,n,r)}finally{ve=s,zr.transition=o}}function Qu(t,e,n,r){if(mi){var s=Ml(t,e,n,r);if(s===null)Ba(t,e,r,gi,n),xd(t,r);else if(Rv(s,t,e,n,r))r.stopPropagation();else if(xd(t,r),e&4&&-1<Av.indexOf(t)){for(;s!==null;){var o=yo(s);if(o!==null&&pm(o),o=Ml(t,e,n,r),o===null&&Ba(t,e,r,gi,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Ba(t,e,r,null,n)}}var gi=null;function Ml(t,e,n,r){if(gi=null,t=Wu(r),t=Yn(t),t!==null)if(e=dr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=im(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gi=t,null}function xm(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_v()){case Ju:return 1;case cm:return 4;case hi:case Sv:return 16;case dm:return 536870912;default:return 16}default:return 16}}var En=null,Xu=null,Xo=null;function wm(){if(Xo)return Xo;var t,e=Xu,n=e.length,r,s="value"in En?En.value:En.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return Xo=s.slice(t,1<r?1-r:void 0)}function Zo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Io(){return!0}function _d(){return!1}function kt(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Io:_d,this.isPropagationStopped=_d,this}return Ie(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Io)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Io)},persist:function(){},isPersistent:Io}),e}var is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zu=kt(is),go=Ie({},is,{view:0,detail:0}),Lv=kt(go),Da,La,gs,Xi=Ie({},go,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ec,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==gs&&(gs&&t.type==="mousemove"?(Da=t.screenX-gs.screenX,La=t.screenY-gs.screenY):La=Da=0,gs=t),Da)},movementY:function(t){return"movementY"in t?t.movementY:La}}),Sd=kt(Xi),Uv=Ie({},Xi,{dataTransfer:0}),jv=kt(Uv),Ov=Ie({},go,{relatedTarget:0}),Ua=kt(Ov),Fv=Ie({},is,{animationName:0,elapsedTime:0,pseudoElement:0}),$v=kt(Fv),Gv=Ie({},is,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Vv=kt(Gv),Bv=Ie({},is,{data:0}),bd=kt(Bv),zv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Hv[t])?!!e[t]:!1}function ec(){return Wv}var Jv=Ie({},go,{key:function(t){if(t.key){var e=zv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Zo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?qv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ec,charCode:function(t){return t.type==="keypress"?Zo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Zo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Kv=kt(Jv),Yv=Ie({},Xi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kd=kt(Yv),Qv=Ie({},go,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ec}),Xv=kt(Qv),Zv=Ie({},is,{propertyName:0,elapsedTime:0,pseudoElement:0}),ex=kt(Zv),tx=Ie({},Xi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),nx=kt(tx),rx=[9,13,27,32],tc=un&&"CompositionEvent"in window,As=null;un&&"documentMode"in document&&(As=document.documentMode);var sx=un&&"TextEvent"in window&&!As,_m=un&&(!tc||As&&8<As&&11>=As),Ed=" ",Td=!1;function Sm(t,e){switch(t){case"keyup":return rx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nr=!1;function ox(t,e){switch(t){case"compositionend":return bm(e);case"keypress":return e.which!==32?null:(Td=!0,Ed);case"textInput":return t=e.data,t===Ed&&Td?null:t;default:return null}}function ix(t,e){if(Nr)return t==="compositionend"||!tc&&Sm(t,e)?(t=wm(),Xo=Xu=En=null,Nr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _m&&e.locale!=="ko"?null:e.data;default:return null}}var ax={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ax[t.type]:e==="textarea"}function km(t,e,n,r){tm(r),e=yi(e,"onChange"),0<e.length&&(n=new Zu("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Rs=null,Hs=null;function lx(t){Lm(t,0)}function Zi(t){var e=Rr(t);if(Jp(e))return t}function ux(t,e){if(t==="change")return e}var Em=!1;if(un){var ja;if(un){var Oa="oninput"in document;if(!Oa){var Nd=document.createElement("div");Nd.setAttribute("oninput","return;"),Oa=typeof Nd.oninput=="function"}ja=Oa}else ja=!1;Em=ja&&(!document.documentMode||9<document.documentMode)}function Id(){Rs&&(Rs.detachEvent("onpropertychange",Tm),Hs=Rs=null)}function Tm(t){if(t.propertyName==="value"&&Zi(Hs)){var e=[];km(e,Hs,t,Wu(t)),om(lx,e)}}function cx(t,e,n){t==="focusin"?(Id(),Rs=e,Hs=n,Rs.attachEvent("onpropertychange",Tm)):t==="focusout"&&Id()}function dx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Zi(Hs)}function fx(t,e){if(t==="click")return Zi(e)}function hx(t,e){if(t==="input"||t==="change")return Zi(e)}function px(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wt=typeof Object.is=="function"?Object.is:px;function Ws(t,e){if(Wt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!ml.call(e,s)||!Wt(t[s],e[s]))return!1}return!0}function Ad(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Rd(t,e){var n=Ad(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ad(n)}}function Cm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Cm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Nm(){for(var t=window,e=ci();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ci(t.document)}return e}function nc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mx(t){var e=Nm(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Cm(n.ownerDocument.documentElement,n)){if(r!==null&&nc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=Rd(n,o);var i=Rd(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gx=un&&"documentMode"in document&&11>=document.documentMode,Ir=null,Dl=null,Ps=null,Ll=!1;function Pd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ll||Ir==null||Ir!==ci(r)||(r=Ir,"selectionStart"in r&&nc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ps&&Ws(Ps,r)||(Ps=r,r=yi(Dl,"onSelect"),0<r.length&&(e=new Zu("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ir)))}function Ao(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ar={animationend:Ao("Animation","AnimationEnd"),animationiteration:Ao("Animation","AnimationIteration"),animationstart:Ao("Animation","AnimationStart"),transitionend:Ao("Transition","TransitionEnd")},Fa={},Im={};un&&(Im=document.createElement("div").style,"AnimationEvent"in window||(delete Ar.animationend.animation,delete Ar.animationiteration.animation,delete Ar.animationstart.animation),"TransitionEvent"in window||delete Ar.transitionend.transition);function ea(t){if(Fa[t])return Fa[t];if(!Ar[t])return t;var e=Ar[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Im)return Fa[t]=e[n];return t}var Am=ea("animationend"),Rm=ea("animationiteration"),Pm=ea("animationstart"),Mm=ea("transitionend"),Dm=new Map,Md="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jn(t,e){Dm.set(t,e),cr(e,[t])}for(var $a=0;$a<Md.length;$a++){var Ga=Md[$a],yx=Ga.toLowerCase(),vx=Ga[0].toUpperCase()+Ga.slice(1);jn(yx,"on"+vx)}jn(Am,"onAnimationEnd");jn(Rm,"onAnimationIteration");jn(Pm,"onAnimationStart");jn("dblclick","onDoubleClick");jn("focusin","onFocus");jn("focusout","onBlur");jn(Mm,"onTransitionEnd");Yr("onMouseEnter",["mouseout","mouseover"]);Yr("onMouseLeave",["mouseout","mouseover"]);Yr("onPointerEnter",["pointerout","pointerover"]);Yr("onPointerLeave",["pointerout","pointerover"]);cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cr("onBeforeInput",["compositionend","keypress","textInput","paste"]);cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Es="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Es));function Dd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,yv(r,e,void 0,t),t.currentTarget=null}function Lm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],u=a.instance,d=a.currentTarget;if(a=a.listener,u!==o&&s.isPropagationStopped())break e;Dd(s,a,d),o=u}else for(i=0;i<r.length;i++){if(a=r[i],u=a.instance,d=a.currentTarget,a=a.listener,u!==o&&s.isPropagationStopped())break e;Dd(s,a,d),o=u}}}if(fi)throw t=Al,fi=!1,Al=null,t}function _e(t,e){var n=e[$l];n===void 0&&(n=e[$l]=new Set);var r=t+"__bubble";n.has(r)||(Um(e,t,2,!1),n.add(r))}function Va(t,e,n){var r=0;e&&(r|=4),Um(n,t,r,e)}var Ro="_reactListening"+Math.random().toString(36).slice(2);function Js(t){if(!t[Ro]){t[Ro]=!0,Bp.forEach(function(n){n!=="selectionchange"&&(xx.has(n)||Va(n,!1,t),Va(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ro]||(e[Ro]=!0,Va("selectionchange",!1,e))}}function Um(t,e,n,r){switch(xm(e)){case 1:var s=Mv;break;case 4:s=Dv;break;default:s=Qu}n=s.bind(null,e,n,t),s=void 0,!Il||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Ba(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;i=i.return}for(;a!==null;){if(i=Yn(a),i===null)return;if(u=i.tag,u===5||u===6){r=o=i;continue e}a=a.parentNode}}r=r.return}om(function(){var d=o,h=Wu(n),p=[];e:{var m=Dm.get(t);if(m!==void 0){var g=Zu,x=t;switch(t){case"keypress":if(Zo(n)===0)break e;case"keydown":case"keyup":g=Kv;break;case"focusin":x="focus",g=Ua;break;case"focusout":x="blur",g=Ua;break;case"beforeblur":case"afterblur":g=Ua;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Sd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=jv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Xv;break;case Am:case Rm:case Pm:g=$v;break;case Mm:g=ex;break;case"scroll":g=Lv;break;case"wheel":g=nx;break;case"copy":case"cut":case"paste":g=Vv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=kd}var _=(e&4)!==0,S=!_&&t==="scroll",v=_?m!==null?m+"Capture":null:m;_=[];for(var y=d,w;y!==null;){w=y;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,v!==null&&(b=Vs(y,v),b!=null&&_.push(Ks(y,b,w)))),S)break;y=y.return}0<_.length&&(m=new g(m,x,null,n,h),p.push({event:m,listeners:_}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==Cl&&(x=n.relatedTarget||n.fromElement)&&(Yn(x)||x[cn]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(x=n.relatedTarget||n.toElement,g=d,x=x?Yn(x):null,x!==null&&(S=dr(x),x!==S||x.tag!==5&&x.tag!==6)&&(x=null)):(g=null,x=d),g!==x)){if(_=Sd,b="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(_=kd,b="onPointerLeave",v="onPointerEnter",y="pointer"),S=g==null?m:Rr(g),w=x==null?m:Rr(x),m=new _(b,y+"leave",g,n,h),m.target=S,m.relatedTarget=w,b=null,Yn(h)===d&&(_=new _(v,y+"enter",x,n,h),_.target=w,_.relatedTarget=S,b=_),S=b,g&&x)t:{for(_=g,v=x,y=0,w=_;w;w=pr(w))y++;for(w=0,b=v;b;b=pr(b))w++;for(;0<y-w;)_=pr(_),y--;for(;0<w-y;)v=pr(v),w--;for(;y--;){if(_===v||v!==null&&_===v.alternate)break t;_=pr(_),v=pr(v)}_=null}else _=null;g!==null&&Ld(p,m,g,_,!1),x!==null&&S!==null&&Ld(p,S,x,_,!0)}}e:{if(m=d?Rr(d):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var C=ux;else if(Cd(m))if(Em)C=hx;else{C=dx;var k=cx}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(C=fx);if(C&&(C=C(t,d))){km(p,C,n,h);break e}k&&k(t,m,d),t==="focusout"&&(k=m._wrapperState)&&k.controlled&&m.type==="number"&&Sl(m,"number",m.value)}switch(k=d?Rr(d):window,t){case"focusin":(Cd(k)||k.contentEditable==="true")&&(Ir=k,Dl=d,Ps=null);break;case"focusout":Ps=Dl=Ir=null;break;case"mousedown":Ll=!0;break;case"contextmenu":case"mouseup":case"dragend":Ll=!1,Pd(p,n,h);break;case"selectionchange":if(gx)break;case"keydown":case"keyup":Pd(p,n,h)}var T;if(tc)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Nr?Sm(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(_m&&n.locale!=="ko"&&(Nr||M!=="onCompositionStart"?M==="onCompositionEnd"&&Nr&&(T=wm()):(En=h,Xu="value"in En?En.value:En.textContent,Nr=!0)),k=yi(d,M),0<k.length&&(M=new bd(M,t,null,n,h),p.push({event:M,listeners:k}),T?M.data=T:(T=bm(n),T!==null&&(M.data=T)))),(T=sx?ox(t,n):ix(t,n))&&(d=yi(d,"onBeforeInput"),0<d.length&&(h=new bd("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=T))}Lm(p,e)})}function Ks(t,e,n){return{instance:t,listener:e,currentTarget:n}}function yi(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Vs(t,n),o!=null&&r.unshift(Ks(t,o,s)),o=Vs(t,e),o!=null&&r.push(Ks(t,o,s))),t=t.return}return r}function pr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ld(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,u=a.alternate,d=a.stateNode;if(u!==null&&u===r)break;a.tag===5&&d!==null&&(a=d,s?(u=Vs(n,o),u!=null&&i.unshift(Ks(n,u,a))):s||(u=Vs(n,o),u!=null&&i.push(Ks(n,u,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var wx=/\r\n?/g,_x=/\u0000|\uFFFD/g;function Ud(t){return(typeof t=="string"?t:""+t).replace(wx,`
`).replace(_x,"")}function Po(t,e,n){if(e=Ud(e),Ud(t)!==e&&n)throw Error(L(425))}function vi(){}var Ul=null,jl=null;function Ol(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fl=typeof setTimeout=="function"?setTimeout:void 0,Sx=typeof clearTimeout=="function"?clearTimeout:void 0,jd=typeof Promise=="function"?Promise:void 0,bx=typeof queueMicrotask=="function"?queueMicrotask:typeof jd<"u"?function(t){return jd.resolve(null).then(t).catch(kx)}:Fl;function kx(t){setTimeout(function(){throw t})}function za(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),qs(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);qs(e)}function An(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Od(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var as=Math.random().toString(36).slice(2),Zt="__reactFiber$"+as,Ys="__reactProps$"+as,cn="__reactContainer$"+as,$l="__reactEvents$"+as,Ex="__reactListeners$"+as,Tx="__reactHandles$"+as;function Yn(t){var e=t[Zt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cn]||n[Zt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Od(t);t!==null;){if(n=t[Zt])return n;t=Od(t)}return e}t=n,n=t.parentNode}return null}function yo(t){return t=t[Zt]||t[cn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Rr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function ta(t){return t[Ys]||null}var Gl=[],Pr=-1;function On(t){return{current:t}}function Se(t){0>Pr||(t.current=Gl[Pr],Gl[Pr]=null,Pr--)}function we(t,e){Pr++,Gl[Pr]=t.current,t.current=e}var Un={},rt=On(Un),ft=On(!1),sr=Un;function Qr(t,e){var n=t.type.contextTypes;if(!n)return Un;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function ht(t){return t=t.childContextTypes,t!=null}function xi(){Se(ft),Se(rt)}function Fd(t,e,n){if(rt.current!==Un)throw Error(L(168));we(rt,e),we(ft,n)}function jm(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(L(108,cv(t)||"Unknown",s));return Ie({},n,r)}function wi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Un,sr=rt.current,we(rt,t),we(ft,ft.current),!0}function $d(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=jm(t,e,sr),r.__reactInternalMemoizedMergedChildContext=t,Se(ft),Se(rt),we(rt,t)):Se(ft),we(ft,n)}var sn=null,na=!1,qa=!1;function Om(t){sn===null?sn=[t]:sn.push(t)}function Cx(t){na=!0,Om(t)}function Fn(){if(!qa&&sn!==null){qa=!0;var t=0,e=ve;try{var n=sn;for(ve=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}sn=null,na=!1}catch(s){throw sn!==null&&(sn=sn.slice(t+1)),um(Ju,Fn),s}finally{ve=e,qa=!1}}return null}var Mr=[],Dr=0,_i=null,Si=0,Et=[],Tt=0,or=null,on=1,an="";function Bn(t,e){Mr[Dr++]=Si,Mr[Dr++]=_i,_i=t,Si=e}function Fm(t,e,n){Et[Tt++]=on,Et[Tt++]=an,Et[Tt++]=or,or=t;var r=on;t=an;var s=32-Vt(r)-1;r&=~(1<<s),n+=1;var o=32-Vt(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,on=1<<32-Vt(e)+s|n<<s|r,an=o+t}else on=1<<o|n<<s|r,an=t}function rc(t){t.return!==null&&(Bn(t,1),Fm(t,1,0))}function sc(t){for(;t===_i;)_i=Mr[--Dr],Mr[Dr]=null,Si=Mr[--Dr],Mr[Dr]=null;for(;t===or;)or=Et[--Tt],Et[Tt]=null,an=Et[--Tt],Et[Tt]=null,on=Et[--Tt],Et[Tt]=null}var _t=null,wt=null,ke=!1,Gt=null;function $m(t,e){var n=Ct(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Gd(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,_t=t,wt=An(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,_t=t,wt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=or!==null?{id:on,overflow:an}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ct(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,_t=t,wt=null,!0):!1;default:return!1}}function Vl(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bl(t){if(ke){var e=wt;if(e){var n=e;if(!Gd(t,e)){if(Vl(t))throw Error(L(418));e=An(n.nextSibling);var r=_t;e&&Gd(t,e)?$m(r,n):(t.flags=t.flags&-4097|2,ke=!1,_t=t)}}else{if(Vl(t))throw Error(L(418));t.flags=t.flags&-4097|2,ke=!1,_t=t}}}function Vd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_t=t}function Mo(t){if(t!==_t)return!1;if(!ke)return Vd(t),ke=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ol(t.type,t.memoizedProps)),e&&(e=wt)){if(Vl(t))throw Gm(),Error(L(418));for(;e;)$m(t,e),e=An(e.nextSibling)}if(Vd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){wt=An(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}wt=null}}else wt=_t?An(t.stateNode.nextSibling):null;return!0}function Gm(){for(var t=wt;t;)t=An(t.nextSibling)}function Xr(){wt=_t=null,ke=!1}function oc(t){Gt===null?Gt=[t]:Gt.push(t)}var Nx=pn.ReactCurrentBatchConfig;function ys(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function Do(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Bd(t){var e=t._init;return e(t._payload)}function Vm(t){function e(v,y){if(t){var w=v.deletions;w===null?(v.deletions=[y],v.flags|=16):w.push(y)}}function n(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function r(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function s(v,y){return v=Dn(v,y),v.index=0,v.sibling=null,v}function o(v,y,w){return v.index=w,t?(w=v.alternate,w!==null?(w=w.index,w<y?(v.flags|=2,y):w):(v.flags|=2,y)):(v.flags|=1048576,y)}function i(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,y,w,b){return y===null||y.tag!==6?(y=Xa(w,v.mode,b),y.return=v,y):(y=s(y,w),y.return=v,y)}function u(v,y,w,b){var C=w.type;return C===Cr?h(v,y,w.props.children,b,w.key):y!==null&&(y.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===xn&&Bd(C)===y.type)?(b=s(y,w.props),b.ref=ys(v,y,w),b.return=v,b):(b=ii(w.type,w.key,w.props,null,v.mode,b),b.ref=ys(v,y,w),b.return=v,b)}function d(v,y,w,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=Za(w,v.mode,b),y.return=v,y):(y=s(y,w.children||[]),y.return=v,y)}function h(v,y,w,b,C){return y===null||y.tag!==7?(y=tr(w,v.mode,b,C),y.return=v,y):(y=s(y,w),y.return=v,y)}function p(v,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Xa(""+y,v.mode,w),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case bo:return w=ii(y.type,y.key,y.props,null,v.mode,w),w.ref=ys(v,null,y),w.return=v,w;case Tr:return y=Za(y,v.mode,w),y.return=v,y;case xn:var b=y._init;return p(v,b(y._payload),w)}if(bs(y)||fs(y))return y=tr(y,v.mode,w,null),y.return=v,y;Do(v,y)}return null}function m(v,y,w,b){var C=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:a(v,y,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case bo:return w.key===C?u(v,y,w,b):null;case Tr:return w.key===C?d(v,y,w,b):null;case xn:return C=w._init,m(v,y,C(w._payload),b)}if(bs(w)||fs(w))return C!==null?null:h(v,y,w,b,null);Do(v,w)}return null}function g(v,y,w,b,C){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(w)||null,a(y,v,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case bo:return v=v.get(b.key===null?w:b.key)||null,u(y,v,b,C);case Tr:return v=v.get(b.key===null?w:b.key)||null,d(y,v,b,C);case xn:var k=b._init;return g(v,y,w,k(b._payload),C)}if(bs(b)||fs(b))return v=v.get(w)||null,h(y,v,b,C,null);Do(y,b)}return null}function x(v,y,w,b){for(var C=null,k=null,T=y,M=y=0,R=null;T!==null&&M<w.length;M++){T.index>M?(R=T,T=null):R=T.sibling;var U=m(v,T,w[M],b);if(U===null){T===null&&(T=R);break}t&&T&&U.alternate===null&&e(v,T),y=o(U,y,M),k===null?C=U:k.sibling=U,k=U,T=R}if(M===w.length)return n(v,T),ke&&Bn(v,M),C;if(T===null){for(;M<w.length;M++)T=p(v,w[M],b),T!==null&&(y=o(T,y,M),k===null?C=T:k.sibling=T,k=T);return ke&&Bn(v,M),C}for(T=r(v,T);M<w.length;M++)R=g(T,v,M,w[M],b),R!==null&&(t&&R.alternate!==null&&T.delete(R.key===null?M:R.key),y=o(R,y,M),k===null?C=R:k.sibling=R,k=R);return t&&T.forEach(function(X){return e(v,X)}),ke&&Bn(v,M),C}function _(v,y,w,b){var C=fs(w);if(typeof C!="function")throw Error(L(150));if(w=C.call(w),w==null)throw Error(L(151));for(var k=C=null,T=y,M=y=0,R=null,U=w.next();T!==null&&!U.done;M++,U=w.next()){T.index>M?(R=T,T=null):R=T.sibling;var X=m(v,T,U.value,b);if(X===null){T===null&&(T=R);break}t&&T&&X.alternate===null&&e(v,T),y=o(X,y,M),k===null?C=X:k.sibling=X,k=X,T=R}if(U.done)return n(v,T),ke&&Bn(v,M),C;if(T===null){for(;!U.done;M++,U=w.next())U=p(v,U.value,b),U!==null&&(y=o(U,y,M),k===null?C=U:k.sibling=U,k=U);return ke&&Bn(v,M),C}for(T=r(v,T);!U.done;M++,U=w.next())U=g(T,v,M,U.value,b),U!==null&&(t&&U.alternate!==null&&T.delete(U.key===null?M:U.key),y=o(U,y,M),k===null?C=U:k.sibling=U,k=U);return t&&T.forEach(function(ye){return e(v,ye)}),ke&&Bn(v,M),C}function S(v,y,w,b){if(typeof w=="object"&&w!==null&&w.type===Cr&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case bo:e:{for(var C=w.key,k=y;k!==null;){if(k.key===C){if(C=w.type,C===Cr){if(k.tag===7){n(v,k.sibling),y=s(k,w.props.children),y.return=v,v=y;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===xn&&Bd(C)===k.type){n(v,k.sibling),y=s(k,w.props),y.ref=ys(v,k,w),y.return=v,v=y;break e}n(v,k);break}else e(v,k);k=k.sibling}w.type===Cr?(y=tr(w.props.children,v.mode,b,w.key),y.return=v,v=y):(b=ii(w.type,w.key,w.props,null,v.mode,b),b.ref=ys(v,y,w),b.return=v,v=b)}return i(v);case Tr:e:{for(k=w.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(v,y.sibling),y=s(y,w.children||[]),y.return=v,v=y;break e}else{n(v,y);break}else e(v,y);y=y.sibling}y=Za(w,v.mode,b),y.return=v,v=y}return i(v);case xn:return k=w._init,S(v,y,k(w._payload),b)}if(bs(w))return x(v,y,w,b);if(fs(w))return _(v,y,w,b);Do(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(n(v,y.sibling),y=s(y,w),y.return=v,v=y):(n(v,y),y=Xa(w,v.mode,b),y.return=v,v=y),i(v)):n(v,y)}return S}var Zr=Vm(!0),Bm=Vm(!1),bi=On(null),ki=null,Lr=null,ic=null;function ac(){ic=Lr=ki=null}function lc(t){var e=bi.current;Se(bi),t._currentValue=e}function zl(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function qr(t,e){ki=t,ic=Lr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dt=!0),t.firstContext=null)}function Rt(t){var e=t._currentValue;if(ic!==t)if(t={context:t,memoizedValue:e,next:null},Lr===null){if(ki===null)throw Error(L(308));Lr=t,ki.dependencies={lanes:0,firstContext:t}}else Lr=Lr.next=t;return e}var Qn=null;function uc(t){Qn===null?Qn=[t]:Qn.push(t)}function zm(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,uc(e)):(n.next=s.next,s.next=n),e.interleaved=n,dn(t,r)}function dn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var wn=!1;function cc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ln(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ce&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,dn(t,n)}return s=r.interleaved,s===null?(e.next=e,uc(r)):(e.next=s.next,s.next=e),r.interleaved=e,dn(t,n)}function ei(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ku(t,n)}}function zd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ei(t,e,n,r){var s=t.updateQueue;wn=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var u=a,d=u.next;u.next=null,i===null?o=d:i.next=d,i=u;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==i&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=u))}if(o!==null){var p=s.baseState;i=0,h=d=u=null,a=o;do{var m=a.lane,g=a.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var x=t,_=a;switch(m=e,g=n,_.tag){case 1:if(x=_.payload,typeof x=="function"){p=x.call(g,p,m);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=_.payload,m=typeof x=="function"?x.call(g,p,m):x,m==null)break e;p=Ie({},p,m);break e;case 2:wn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[a]:m.push(a))}else g={eventTime:g,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=g,u=p):h=h.next=g,i|=m;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;m=a,a=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);ar|=i,t.lanes=i,t.memoizedState=p}}function qd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(L(191,s));s.call(r)}}}var vo={},tn=On(vo),Qs=On(vo),Xs=On(vo);function Xn(t){if(t===vo)throw Error(L(174));return t}function dc(t,e){switch(we(Xs,e),we(Qs,t),we(tn,vo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kl(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=kl(e,t)}Se(tn),we(tn,e)}function es(){Se(tn),Se(Qs),Se(Xs)}function Hm(t){Xn(Xs.current);var e=Xn(tn.current),n=kl(e,t.type);e!==n&&(we(Qs,t),we(tn,n))}function fc(t){Qs.current===t&&(Se(tn),Se(Qs))}var Ce=On(0);function Ti(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ha=[];function hc(){for(var t=0;t<Ha.length;t++)Ha[t]._workInProgressVersionPrimary=null;Ha.length=0}var ti=pn.ReactCurrentDispatcher,Wa=pn.ReactCurrentBatchConfig,ir=0,Ne=null,Fe=null,Ge=null,Ci=!1,Ms=!1,Zs=0,Ix=0;function Xe(){throw Error(L(321))}function pc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Wt(t[n],e[n]))return!1;return!0}function mc(t,e,n,r,s,o){if(ir=o,Ne=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ti.current=t===null||t.memoizedState===null?Mx:Dx,t=n(r,s),Ms){o=0;do{if(Ms=!1,Zs=0,25<=o)throw Error(L(301));o+=1,Ge=Fe=null,e.updateQueue=null,ti.current=Lx,t=n(r,s)}while(Ms)}if(ti.current=Ni,e=Fe!==null&&Fe.next!==null,ir=0,Ge=Fe=Ne=null,Ci=!1,e)throw Error(L(300));return t}function gc(){var t=Zs!==0;return Zs=0,t}function Xt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ge===null?Ne.memoizedState=Ge=t:Ge=Ge.next=t,Ge}function Pt(){if(Fe===null){var t=Ne.alternate;t=t!==null?t.memoizedState:null}else t=Fe.next;var e=Ge===null?Ne.memoizedState:Ge.next;if(e!==null)Ge=e,Fe=t;else{if(t===null)throw Error(L(310));Fe=t,t={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},Ge===null?Ne.memoizedState=Ge=t:Ge=Ge.next=t}return Ge}function eo(t,e){return typeof e=="function"?e(t):e}function Ja(t){var e=Pt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=Fe,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,u=null,d=o;do{var h=d.lane;if((ir&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(a=u=p,i=r):u=u.next=p,Ne.lanes|=h,ar|=h}d=d.next}while(d!==null&&d!==o);u===null?i=r:u.next=a,Wt(r,e.memoizedState)||(dt=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,Ne.lanes|=o,ar|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ka(t){var e=Pt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);Wt(o,e.memoizedState)||(dt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function Wm(){}function Jm(t,e){var n=Ne,r=Pt(),s=e(),o=!Wt(r.memoizedState,s);if(o&&(r.memoizedState=s,dt=!0),r=r.queue,yc(Qm.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Ge!==null&&Ge.memoizedState.tag&1){if(n.flags|=2048,to(9,Ym.bind(null,n,r,s,e),void 0,null),Ve===null)throw Error(L(349));ir&30||Km(n,e,s)}return s}function Km(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ym(t,e,n,r){e.value=n,e.getSnapshot=r,Xm(e)&&Zm(t)}function Qm(t,e,n){return n(function(){Xm(e)&&Zm(t)})}function Xm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Wt(t,n)}catch{return!0}}function Zm(t){var e=dn(t,1);e!==null&&Bt(e,t,1,-1)}function Hd(t){var e=Xt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eo,lastRenderedState:t},e.queue=t,t=t.dispatch=Px.bind(null,Ne,t),[e.memoizedState,t]}function to(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ne.updateQueue,e===null?(e={lastEffect:null,stores:null},Ne.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function eg(){return Pt().memoizedState}function ni(t,e,n,r){var s=Xt();Ne.flags|=t,s.memoizedState=to(1|e,n,void 0,r===void 0?null:r)}function ra(t,e,n,r){var s=Pt();r=r===void 0?null:r;var o=void 0;if(Fe!==null){var i=Fe.memoizedState;if(o=i.destroy,r!==null&&pc(r,i.deps)){s.memoizedState=to(e,n,o,r);return}}Ne.flags|=t,s.memoizedState=to(1|e,n,o,r)}function Wd(t,e){return ni(8390656,8,t,e)}function yc(t,e){return ra(2048,8,t,e)}function tg(t,e){return ra(4,2,t,e)}function ng(t,e){return ra(4,4,t,e)}function rg(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function sg(t,e,n){return n=n!=null?n.concat([t]):null,ra(4,4,rg.bind(null,e,t),n)}function vc(){}function og(t,e){var n=Pt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&pc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ig(t,e){var n=Pt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&pc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ag(t,e,n){return ir&21?(Wt(n,e)||(n=fm(),Ne.lanes|=n,ar|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,dt=!0),t.memoizedState=n)}function Ax(t,e){var n=ve;ve=n!==0&&4>n?n:4,t(!0);var r=Wa.transition;Wa.transition={};try{t(!1),e()}finally{ve=n,Wa.transition=r}}function lg(){return Pt().memoizedState}function Rx(t,e,n){var r=Mn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ug(t))cg(e,n);else if(n=zm(t,e,n,r),n!==null){var s=it();Bt(n,t,r,s),dg(n,e,r)}}function Px(t,e,n){var r=Mn(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ug(t))cg(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,Wt(a,i)){var u=e.interleaved;u===null?(s.next=s,uc(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=zm(t,e,s,r),n!==null&&(s=it(),Bt(n,t,r,s),dg(n,e,r))}}function ug(t){var e=t.alternate;return t===Ne||e!==null&&e===Ne}function cg(t,e){Ms=Ci=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function dg(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ku(t,n)}}var Ni={readContext:Rt,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useInsertionEffect:Xe,useLayoutEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useMutableSource:Xe,useSyncExternalStore:Xe,useId:Xe,unstable_isNewReconciler:!1},Mx={readContext:Rt,useCallback:function(t,e){return Xt().memoizedState=[t,e===void 0?null:e],t},useContext:Rt,useEffect:Wd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ni(4194308,4,rg.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ni(4194308,4,t,e)},useInsertionEffect:function(t,e){return ni(4,2,t,e)},useMemo:function(t,e){var n=Xt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Xt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Rx.bind(null,Ne,t),[r.memoizedState,t]},useRef:function(t){var e=Xt();return t={current:t},e.memoizedState=t},useState:Hd,useDebugValue:vc,useDeferredValue:function(t){return Xt().memoizedState=t},useTransition:function(){var t=Hd(!1),e=t[0];return t=Ax.bind(null,t[1]),Xt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ne,s=Xt();if(ke){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),Ve===null)throw Error(L(349));ir&30||Km(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,Wd(Qm.bind(null,r,o,t),[t]),r.flags|=2048,to(9,Ym.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Xt(),e=Ve.identifierPrefix;if(ke){var n=an,r=on;n=(r&~(1<<32-Vt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Zs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Ix++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Dx={readContext:Rt,useCallback:og,useContext:Rt,useEffect:yc,useImperativeHandle:sg,useInsertionEffect:tg,useLayoutEffect:ng,useMemo:ig,useReducer:Ja,useRef:eg,useState:function(){return Ja(eo)},useDebugValue:vc,useDeferredValue:function(t){var e=Pt();return ag(e,Fe.memoizedState,t)},useTransition:function(){var t=Ja(eo)[0],e=Pt().memoizedState;return[t,e]},useMutableSource:Wm,useSyncExternalStore:Jm,useId:lg,unstable_isNewReconciler:!1},Lx={readContext:Rt,useCallback:og,useContext:Rt,useEffect:yc,useImperativeHandle:sg,useInsertionEffect:tg,useLayoutEffect:ng,useMemo:ig,useReducer:Ka,useRef:eg,useState:function(){return Ka(eo)},useDebugValue:vc,useDeferredValue:function(t){var e=Pt();return Fe===null?e.memoizedState=t:ag(e,Fe.memoizedState,t)},useTransition:function(){var t=Ka(eo)[0],e=Pt().memoizedState;return[t,e]},useMutableSource:Wm,useSyncExternalStore:Jm,useId:lg,unstable_isNewReconciler:!1};function jt(t,e){if(t&&t.defaultProps){e=Ie({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ql(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ie({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var sa={isMounted:function(t){return(t=t._reactInternals)?dr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=it(),s=Mn(t),o=ln(r,s);o.payload=e,n!=null&&(o.callback=n),e=Rn(t,o,s),e!==null&&(Bt(e,t,s,r),ei(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=it(),s=Mn(t),o=ln(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Rn(t,o,s),e!==null&&(Bt(e,t,s,r),ei(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=it(),r=Mn(t),s=ln(n,r);s.tag=2,e!=null&&(s.callback=e),e=Rn(t,s,r),e!==null&&(Bt(e,t,r,n),ei(e,t,r))}};function Jd(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!Ws(n,r)||!Ws(s,o):!0}function fg(t,e,n){var r=!1,s=Un,o=e.contextType;return typeof o=="object"&&o!==null?o=Rt(o):(s=ht(e)?sr:rt.current,r=e.contextTypes,o=(r=r!=null)?Qr(t,s):Un),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=sa,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Kd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&sa.enqueueReplaceState(e,e.state,null)}function Hl(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},cc(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Rt(o):(o=ht(e)?sr:rt.current,s.context=Qr(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(ql(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&sa.enqueueReplaceState(s,s.state,null),Ei(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ts(t,e){try{var n="",r=e;do n+=uv(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Ya(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Wl(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Ux=typeof WeakMap=="function"?WeakMap:Map;function hg(t,e,n){n=ln(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ai||(Ai=!0,ru=r),Wl(t,e)},n}function pg(t,e,n){n=ln(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Wl(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Wl(t,e),typeof r!="function"&&(Pn===null?Pn=new Set([this]):Pn.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function Yd(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Ux;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Yx.bind(null,t,e,n),e.then(t,t))}function Qd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Xd(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ln(-1,1),e.tag=2,Rn(n,e,1))),n.lanes|=1),t)}var jx=pn.ReactCurrentOwner,dt=!1;function ot(t,e,n,r){e.child=t===null?Bm(e,null,n,r):Zr(e,t.child,n,r)}function Zd(t,e,n,r,s){n=n.render;var o=e.ref;return qr(e,s),r=mc(t,e,n,r,o,s),n=gc(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fn(t,e,s)):(ke&&n&&rc(e),e.flags|=1,ot(t,e,r,s),e.child)}function ef(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!Tc(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,mg(t,e,o,r,s)):(t=ii(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ws,n(i,r)&&t.ref===e.ref)return fn(t,e,s)}return e.flags|=1,t=Dn(o,r),t.ref=e.ref,t.return=e,e.child=t}function mg(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Ws(o,r)&&t.ref===e.ref)if(dt=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(dt=!0);else return e.lanes=t.lanes,fn(t,e,s)}return Jl(t,e,n,r,s)}function gg(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},we(jr,yt),yt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,we(jr,yt),yt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,we(jr,yt),yt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,we(jr,yt),yt|=r;return ot(t,e,s,n),e.child}function yg(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Jl(t,e,n,r,s){var o=ht(n)?sr:rt.current;return o=Qr(e,o),qr(e,s),n=mc(t,e,n,r,o,s),r=gc(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,fn(t,e,s)):(ke&&r&&rc(e),e.flags|=1,ot(t,e,n,s),e.child)}function tf(t,e,n,r,s){if(ht(n)){var o=!0;wi(e)}else o=!1;if(qr(e,s),e.stateNode===null)ri(t,e),fg(e,n,r),Hl(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var u=i.context,d=n.contextType;typeof d=="object"&&d!==null?d=Rt(d):(d=ht(n)?sr:rt.current,d=Qr(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||u!==d)&&Kd(e,i,r,d),wn=!1;var m=e.memoizedState;i.state=m,Ei(e,r,i,s),u=e.memoizedState,a!==r||m!==u||ft.current||wn?(typeof h=="function"&&(ql(e,n,h,r),u=e.memoizedState),(a=wn||Jd(e,n,a,r,m,u,d))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=d,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,qm(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:jt(e.type,a),i.props=d,p=e.pendingProps,m=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Rt(u):(u=ht(n)?sr:rt.current,u=Qr(e,u));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==p||m!==u)&&Kd(e,i,r,u),wn=!1,m=e.memoizedState,i.state=m,Ei(e,r,i,s);var x=e.memoizedState;a!==p||m!==x||ft.current||wn?(typeof g=="function"&&(ql(e,n,g,r),x=e.memoizedState),(d=wn||Jd(e,n,d,r,m,x,u)||!1)?(h||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,x,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,x,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=x),i.props=r,i.state=x,i.context=u,r=d):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Kl(t,e,n,r,o,s)}function Kl(t,e,n,r,s,o){yg(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&$d(e,n,!1),fn(t,e,o);r=e.stateNode,jx.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=Zr(e,t.child,null,o),e.child=Zr(e,null,a,o)):ot(t,e,a,o),e.memoizedState=r.state,s&&$d(e,n,!0),e.child}function vg(t){var e=t.stateNode;e.pendingContext?Fd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Fd(t,e.context,!1),dc(t,e.containerInfo)}function nf(t,e,n,r,s){return Xr(),oc(s),e.flags|=256,ot(t,e,n,r),e.child}var Yl={dehydrated:null,treeContext:null,retryLane:0};function Ql(t){return{baseLanes:t,cachePool:null,transitions:null}}function xg(t,e,n){var r=e.pendingProps,s=Ce.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),we(Ce,s&1),t===null)return Bl(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=aa(i,r,0,null),t=tr(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Ql(n),e.memoizedState=Yl,t):xc(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Ox(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Dn(s,u),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Dn(a,o):(o=tr(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?Ql(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=Yl,r}return o=t.child,t=o.sibling,r=Dn(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function xc(t,e){return e=aa({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Lo(t,e,n,r){return r!==null&&oc(r),Zr(e,t.child,null,n),t=xc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Ox(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Ya(Error(L(422))),Lo(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=aa({mode:"visible",children:r.children},s,0,null),o=tr(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Zr(e,t.child,null,i),e.child.memoizedState=Ql(i),e.memoizedState=Yl,o);if(!(e.mode&1))return Lo(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(L(419)),r=Ya(o,r,void 0),Lo(t,e,i,r)}if(a=(i&t.childLanes)!==0,dt||a){if(r=Ve,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,dn(t,s),Bt(r,t,s,-1))}return Ec(),r=Ya(Error(L(421))),Lo(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Qx.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,wt=An(s.nextSibling),_t=e,ke=!0,Gt=null,t!==null&&(Et[Tt++]=on,Et[Tt++]=an,Et[Tt++]=or,on=t.id,an=t.overflow,or=e),e=xc(e,r.children),e.flags|=4096,e)}function rf(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),zl(t.return,e,n)}function Qa(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function wg(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(ot(t,e,r.children,n),r=Ce.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&rf(t,n,e);else if(t.tag===19)rf(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(we(Ce,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ti(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Qa(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ti(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Qa(e,!0,n,null,o);break;case"together":Qa(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ri(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ar|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=Dn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Dn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Fx(t,e,n){switch(e.tag){case 3:vg(e),Xr();break;case 5:Hm(e);break;case 1:ht(e.type)&&wi(e);break;case 4:dc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;we(bi,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(we(Ce,Ce.current&1),e.flags|=128,null):n&e.child.childLanes?xg(t,e,n):(we(Ce,Ce.current&1),t=fn(t,e,n),t!==null?t.sibling:null);we(Ce,Ce.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return wg(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),we(Ce,Ce.current),r)break;return null;case 22:case 23:return e.lanes=0,gg(t,e,n)}return fn(t,e,n)}var _g,Xl,Sg,bg;_g=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xl=function(){};Sg=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Xn(tn.current);var o=null;switch(n){case"input":s=wl(t,s),r=wl(t,r),o=[];break;case"select":s=Ie({},s,{value:void 0}),r=Ie({},r,{value:void 0}),o=[];break;case"textarea":s=bl(t,s),r=bl(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=vi)}El(n,r);var i;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&($s.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var u=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==a&&(u!=null||a!=null))if(d==="style")if(a){for(i in a)!a.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&a[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,a=a?a.__html:void 0,u!=null&&a!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&($s.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&_e("scroll",t),o||a===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};bg=function(t,e,n,r){n!==r&&(e.flags|=4)};function vs(t,e){if(!ke)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ze(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function $x(t,e,n){var r=e.pendingProps;switch(sc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(e),null;case 1:return ht(e.type)&&xi(),Ze(e),null;case 3:return r=e.stateNode,es(),Se(ft),Se(rt),hc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Mo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gt!==null&&(iu(Gt),Gt=null))),Xl(t,e),Ze(e),null;case 5:fc(e);var s=Xn(Xs.current);if(n=e.type,t!==null&&e.stateNode!=null)Sg(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return Ze(e),null}if(t=Xn(tn.current),Mo(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Zt]=e,r[Ys]=o,t=(e.mode&1)!==0,n){case"dialog":_e("cancel",r),_e("close",r);break;case"iframe":case"object":case"embed":_e("load",r);break;case"video":case"audio":for(s=0;s<Es.length;s++)_e(Es[s],r);break;case"source":_e("error",r);break;case"img":case"image":case"link":_e("error",r),_e("load",r);break;case"details":_e("toggle",r);break;case"input":fd(r,o),_e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},_e("invalid",r);break;case"textarea":pd(r,o),_e("invalid",r)}El(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Po(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Po(r.textContent,a,t),s=["children",""+a]):$s.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&_e("scroll",r)}switch(n){case"input":ko(r),hd(r,o,!0);break;case"textarea":ko(r),md(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=vi)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Qp(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[Zt]=e,t[Ys]=r,_g(t,e,!1,!1),e.stateNode=t;e:{switch(i=Tl(n,r),n){case"dialog":_e("cancel",t),_e("close",t),s=r;break;case"iframe":case"object":case"embed":_e("load",t),s=r;break;case"video":case"audio":for(s=0;s<Es.length;s++)_e(Es[s],t);s=r;break;case"source":_e("error",t),s=r;break;case"img":case"image":case"link":_e("error",t),_e("load",t),s=r;break;case"details":_e("toggle",t),s=r;break;case"input":fd(t,r),s=wl(t,r),_e("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ie({},r,{value:void 0}),_e("invalid",t);break;case"textarea":pd(t,r),s=bl(t,r),_e("invalid",t);break;default:s=r}El(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var u=a[o];o==="style"?em(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Xp(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Gs(t,u):typeof u=="number"&&Gs(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&($s.hasOwnProperty(o)?u!=null&&o==="onScroll"&&_e("scroll",t):u!=null&&Bu(t,o,u,i))}switch(n){case"input":ko(t),hd(t,r,!1);break;case"textarea":ko(t),md(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ln(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Gr(t,!!r.multiple,o,!1):r.defaultValue!=null&&Gr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=vi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ze(e),null;case 6:if(t&&e.stateNode!=null)bg(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=Xn(Xs.current),Xn(tn.current),Mo(e)){if(r=e.stateNode,n=e.memoizedProps,r[Zt]=e,(o=r.nodeValue!==n)&&(t=_t,t!==null))switch(t.tag){case 3:Po(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Po(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Zt]=e,e.stateNode=r}return Ze(e),null;case 13:if(Se(Ce),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ke&&wt!==null&&e.mode&1&&!(e.flags&128))Gm(),Xr(),e.flags|=98560,o=!1;else if(o=Mo(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(L(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(L(317));o[Zt]=e}else Xr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ze(e),o=!1}else Gt!==null&&(iu(Gt),Gt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ce.current&1?$e===0&&($e=3):Ec())),e.updateQueue!==null&&(e.flags|=4),Ze(e),null);case 4:return es(),Xl(t,e),t===null&&Js(e.stateNode.containerInfo),Ze(e),null;case 10:return lc(e.type._context),Ze(e),null;case 17:return ht(e.type)&&xi(),Ze(e),null;case 19:if(Se(Ce),o=e.memoizedState,o===null)return Ze(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)vs(o,!1);else{if($e!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Ti(t),i!==null){for(e.flags|=128,vs(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return we(Ce,Ce.current&1|2),e.child}t=t.sibling}o.tail!==null&&Pe()>ns&&(e.flags|=128,r=!0,vs(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ti(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!ke)return Ze(e),null}else 2*Pe()-o.renderingStartTime>ns&&n!==1073741824&&(e.flags|=128,r=!0,vs(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Pe(),e.sibling=null,n=Ce.current,we(Ce,r?n&1|2:n&1),e):(Ze(e),null);case 22:case 23:return kc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?yt&1073741824&&(Ze(e),e.subtreeFlags&6&&(e.flags|=8192)):Ze(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function Gx(t,e){switch(sc(e),e.tag){case 1:return ht(e.type)&&xi(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return es(),Se(ft),Se(rt),hc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return fc(e),null;case 13:if(Se(Ce),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Xr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Se(Ce),null;case 4:return es(),null;case 10:return lc(e.type._context),null;case 22:case 23:return kc(),null;case 24:return null;default:return null}}var Uo=!1,et=!1,Vx=typeof WeakSet=="function"?WeakSet:Set,q=null;function Ur(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Re(t,e,r)}else n.current=null}function Zl(t,e,n){try{n()}catch(r){Re(t,e,r)}}var sf=!1;function Bx(t,e){if(Ul=mi,t=Nm(),nc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,u=-1,d=0,h=0,p=t,m=null;t:for(;;){for(var g;p!==n||s!==0&&p.nodeType!==3||(a=i+s),p!==o||r!==0&&p.nodeType!==3||(u=i+r),p.nodeType===3&&(i+=p.nodeValue.length),(g=p.firstChild)!==null;)m=p,p=g;for(;;){if(p===t)break t;if(m===n&&++d===s&&(a=i),m===o&&++h===r&&(u=i),(g=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=g}n=a===-1||u===-1?null:{start:a,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(jl={focusedElem:t,selectionRange:n},mi=!1,q=e;q!==null;)if(e=q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,q=t;else for(;q!==null;){e=q;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var _=x.memoizedProps,S=x.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?_:jt(e.type,_),S);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(b){Re(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,q=t;break}q=e.return}return x=sf,sf=!1,x}function Ds(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Zl(e,n,o)}s=s.next}while(s!==r)}}function oa(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function eu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function kg(t){var e=t.alternate;e!==null&&(t.alternate=null,kg(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Zt],delete e[Ys],delete e[$l],delete e[Ex],delete e[Tx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Eg(t){return t.tag===5||t.tag===3||t.tag===4}function of(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Eg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vi));else if(r!==4&&(t=t.child,t!==null))for(tu(t,e,n),t=t.sibling;t!==null;)tu(t,e,n),t=t.sibling}function nu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(nu(t,e,n),t=t.sibling;t!==null;)nu(t,e,n),t=t.sibling}var Je=null,Ft=!1;function vn(t,e,n){for(n=n.child;n!==null;)Tg(t,e,n),n=n.sibling}function Tg(t,e,n){if(en&&typeof en.onCommitFiberUnmount=="function")try{en.onCommitFiberUnmount(Qi,n)}catch{}switch(n.tag){case 5:et||Ur(n,e);case 6:var r=Je,s=Ft;Je=null,vn(t,e,n),Je=r,Ft=s,Je!==null&&(Ft?(t=Je,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Je.removeChild(n.stateNode));break;case 18:Je!==null&&(Ft?(t=Je,n=n.stateNode,t.nodeType===8?za(t.parentNode,n):t.nodeType===1&&za(t,n),qs(t)):za(Je,n.stateNode));break;case 4:r=Je,s=Ft,Je=n.stateNode.containerInfo,Ft=!0,vn(t,e,n),Je=r,Ft=s;break;case 0:case 11:case 14:case 15:if(!et&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Zl(n,e,i),s=s.next}while(s!==r)}vn(t,e,n);break;case 1:if(!et&&(Ur(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Re(n,e,a)}vn(t,e,n);break;case 21:vn(t,e,n);break;case 22:n.mode&1?(et=(r=et)||n.memoizedState!==null,vn(t,e,n),et=r):vn(t,e,n);break;default:vn(t,e,n)}}function af(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Vx),e.forEach(function(r){var s=Xx.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Lt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Je=a.stateNode,Ft=!1;break e;case 3:Je=a.stateNode.containerInfo,Ft=!0;break e;case 4:Je=a.stateNode.containerInfo,Ft=!0;break e}a=a.return}if(Je===null)throw Error(L(160));Tg(o,i,s),Je=null,Ft=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Re(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Cg(e,t),e=e.sibling}function Cg(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Lt(e,t),Qt(t),r&4){try{Ds(3,t,t.return),oa(3,t)}catch(_){Re(t,t.return,_)}try{Ds(5,t,t.return)}catch(_){Re(t,t.return,_)}}break;case 1:Lt(e,t),Qt(t),r&512&&n!==null&&Ur(n,n.return);break;case 5:if(Lt(e,t),Qt(t),r&512&&n!==null&&Ur(n,n.return),t.flags&32){var s=t.stateNode;try{Gs(s,"")}catch(_){Re(t,t.return,_)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Kp(s,o),Tl(a,i);var d=Tl(a,o);for(i=0;i<u.length;i+=2){var h=u[i],p=u[i+1];h==="style"?em(s,p):h==="dangerouslySetInnerHTML"?Xp(s,p):h==="children"?Gs(s,p):Bu(s,h,p,d)}switch(a){case"input":_l(s,o);break;case"textarea":Yp(s,o);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?Gr(s,!!o.multiple,g,!1):m!==!!o.multiple&&(o.defaultValue!=null?Gr(s,!!o.multiple,o.defaultValue,!0):Gr(s,!!o.multiple,o.multiple?[]:"",!1))}s[Ys]=o}catch(_){Re(t,t.return,_)}}break;case 6:if(Lt(e,t),Qt(t),r&4){if(t.stateNode===null)throw Error(L(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(_){Re(t,t.return,_)}}break;case 3:if(Lt(e,t),Qt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qs(e.containerInfo)}catch(_){Re(t,t.return,_)}break;case 4:Lt(e,t),Qt(t);break;case 13:Lt(e,t),Qt(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Sc=Pe())),r&4&&af(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(et=(d=et)||h,Lt(e,t),et=d):Lt(e,t),Qt(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(q=t,h=t.child;h!==null;){for(p=q=h;q!==null;){switch(m=q,g=m.child,m.tag){case 0:case 11:case 14:case 15:Ds(4,m,m.return);break;case 1:Ur(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(_){Re(r,n,_)}}break;case 5:Ur(m,m.return);break;case 22:if(m.memoizedState!==null){uf(p);continue}}g!==null?(g.return=m,q=g):uf(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=p.stateNode,u=p.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,a.style.display=Zp("display",i))}catch(_){Re(t,t.return,_)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(_){Re(t,t.return,_)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Lt(e,t),Qt(t),r&4&&af(t);break;case 21:break;default:Lt(e,t),Qt(t)}}function Qt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Eg(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Gs(s,""),r.flags&=-33);var o=of(t);nu(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=of(t);tu(t,a,i);break;default:throw Error(L(161))}}catch(u){Re(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zx(t,e,n){q=t,Ng(t)}function Ng(t,e,n){for(var r=(t.mode&1)!==0;q!==null;){var s=q,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Uo;if(!i){var a=s.alternate,u=a!==null&&a.memoizedState!==null||et;a=Uo;var d=et;if(Uo=i,(et=u)&&!d)for(q=s;q!==null;)i=q,u=i.child,i.tag===22&&i.memoizedState!==null?cf(s):u!==null?(u.return=i,q=u):cf(s);for(;o!==null;)q=o,Ng(o),o=o.sibling;q=s,Uo=a,et=d}lf(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,q=o):lf(t)}}function lf(t){for(;q!==null;){var e=q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:et||oa(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!et)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:jt(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&qd(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}qd(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&qs(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}et||e.flags&512&&eu(e)}catch(m){Re(e,e.return,m)}}if(e===t){q=null;break}if(n=e.sibling,n!==null){n.return=e.return,q=n;break}q=e.return}}function uf(t){for(;q!==null;){var e=q;if(e===t){q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,q=n;break}q=e.return}}function cf(t){for(;q!==null;){var e=q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{oa(4,e)}catch(u){Re(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Re(e,s,u)}}var o=e.return;try{eu(e)}catch(u){Re(e,o,u)}break;case 5:var i=e.return;try{eu(e)}catch(u){Re(e,i,u)}}}catch(u){Re(e,e.return,u)}if(e===t){q=null;break}var a=e.sibling;if(a!==null){a.return=e.return,q=a;break}q=e.return}}var qx=Math.ceil,Ii=pn.ReactCurrentDispatcher,wc=pn.ReactCurrentOwner,Nt=pn.ReactCurrentBatchConfig,ce=0,Ve=null,Ue=null,Ke=0,yt=0,jr=On(0),$e=0,no=null,ar=0,ia=0,_c=0,Ls=null,ct=null,Sc=0,ns=1/0,nn=null,Ai=!1,ru=null,Pn=null,jo=!1,Tn=null,Ri=0,Us=0,su=null,si=-1,oi=0;function it(){return ce&6?Pe():si!==-1?si:si=Pe()}function Mn(t){return t.mode&1?ce&2&&Ke!==0?Ke&-Ke:Nx.transition!==null?(oi===0&&(oi=fm()),oi):(t=ve,t!==0||(t=window.event,t=t===void 0?16:xm(t.type)),t):1}function Bt(t,e,n,r){if(50<Us)throw Us=0,su=null,Error(L(185));mo(t,n,r),(!(ce&2)||t!==Ve)&&(t===Ve&&(!(ce&2)&&(ia|=n),$e===4&&bn(t,Ke)),pt(t,r),n===1&&ce===0&&!(e.mode&1)&&(ns=Pe()+500,na&&Fn()))}function pt(t,e){var n=t.callbackNode;Nv(t,e);var r=pi(t,t===Ve?Ke:0);if(r===0)n!==null&&vd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&vd(n),e===1)t.tag===0?Cx(df.bind(null,t)):Om(df.bind(null,t)),bx(function(){!(ce&6)&&Fn()}),n=null;else{switch(hm(r)){case 1:n=Ju;break;case 4:n=cm;break;case 16:n=hi;break;case 536870912:n=dm;break;default:n=hi}n=Ug(n,Ig.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Ig(t,e){if(si=-1,oi=0,ce&6)throw Error(L(327));var n=t.callbackNode;if(Hr()&&t.callbackNode!==n)return null;var r=pi(t,t===Ve?Ke:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Pi(t,r);else{e=r;var s=ce;ce|=2;var o=Rg();(Ve!==t||Ke!==e)&&(nn=null,ns=Pe()+500,er(t,e));do try{Jx();break}catch(a){Ag(t,a)}while(!0);ac(),Ii.current=o,ce=s,Ue!==null?e=0:(Ve=null,Ke=0,e=$e)}if(e!==0){if(e===2&&(s=Rl(t),s!==0&&(r=s,e=ou(t,s))),e===1)throw n=no,er(t,0),bn(t,r),pt(t,Pe()),n;if(e===6)bn(t,r);else{if(s=t.current.alternate,!(r&30)&&!Hx(s)&&(e=Pi(t,r),e===2&&(o=Rl(t),o!==0&&(r=o,e=ou(t,o))),e===1))throw n=no,er(t,0),bn(t,r),pt(t,Pe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:zn(t,ct,nn);break;case 3:if(bn(t,r),(r&130023424)===r&&(e=Sc+500-Pe(),10<e)){if(pi(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){it(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Fl(zn.bind(null,t,ct,nn),e);break}zn(t,ct,nn);break;case 4:if(bn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-Vt(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=Pe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*qx(r/1960))-r,10<r){t.timeoutHandle=Fl(zn.bind(null,t,ct,nn),r);break}zn(t,ct,nn);break;case 5:zn(t,ct,nn);break;default:throw Error(L(329))}}}return pt(t,Pe()),t.callbackNode===n?Ig.bind(null,t):null}function ou(t,e){var n=Ls;return t.current.memoizedState.isDehydrated&&(er(t,e).flags|=256),t=Pi(t,e),t!==2&&(e=ct,ct=n,e!==null&&iu(e)),t}function iu(t){ct===null?ct=t:ct.push.apply(ct,t)}function Hx(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!Wt(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bn(t,e){for(e&=~_c,e&=~ia,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Vt(e),r=1<<n;t[n]=-1,e&=~r}}function df(t){if(ce&6)throw Error(L(327));Hr();var e=pi(t,0);if(!(e&1))return pt(t,Pe()),null;var n=Pi(t,e);if(t.tag!==0&&n===2){var r=Rl(t);r!==0&&(e=r,n=ou(t,r))}if(n===1)throw n=no,er(t,0),bn(t,e),pt(t,Pe()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zn(t,ct,nn),pt(t,Pe()),null}function bc(t,e){var n=ce;ce|=1;try{return t(e)}finally{ce=n,ce===0&&(ns=Pe()+500,na&&Fn())}}function lr(t){Tn!==null&&Tn.tag===0&&!(ce&6)&&Hr();var e=ce;ce|=1;var n=Nt.transition,r=ve;try{if(Nt.transition=null,ve=1,t)return t()}finally{ve=r,Nt.transition=n,ce=e,!(ce&6)&&Fn()}}function kc(){yt=jr.current,Se(jr)}function er(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Sx(n)),Ue!==null)for(n=Ue.return;n!==null;){var r=n;switch(sc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&xi();break;case 3:es(),Se(ft),Se(rt),hc();break;case 5:fc(r);break;case 4:es();break;case 13:Se(Ce);break;case 19:Se(Ce);break;case 10:lc(r.type._context);break;case 22:case 23:kc()}n=n.return}if(Ve=t,Ue=t=Dn(t.current,null),Ke=yt=e,$e=0,no=null,_c=ia=ar=0,ct=Ls=null,Qn!==null){for(e=0;e<Qn.length;e++)if(n=Qn[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}Qn=null}return t}function Ag(t,e){do{var n=Ue;try{if(ac(),ti.current=Ni,Ci){for(var r=Ne.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ci=!1}if(ir=0,Ge=Fe=Ne=null,Ms=!1,Zs=0,wc.current=null,n===null||n.return===null){$e=1,no=e,Ue=null;break}e:{var o=t,i=n.return,a=n,u=e;if(e=Ke,a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Qd(i);if(g!==null){g.flags&=-257,Xd(g,i,a,o,e),g.mode&1&&Yd(o,d,e),e=g,u=d;var x=e.updateQueue;if(x===null){var _=new Set;_.add(u),e.updateQueue=_}else x.add(u);break e}else{if(!(e&1)){Yd(o,d,e),Ec();break e}u=Error(L(426))}}else if(ke&&a.mode&1){var S=Qd(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Xd(S,i,a,o,e),oc(ts(u,a));break e}}o=u=ts(u,a),$e!==4&&($e=2),Ls===null?Ls=[o]:Ls.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var v=hg(o,u,e);zd(o,v);break e;case 1:a=u;var y=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Pn===null||!Pn.has(w)))){o.flags|=65536,e&=-e,o.lanes|=e;var b=pg(o,a,e);zd(o,b);break e}}o=o.return}while(o!==null)}Mg(n)}catch(C){e=C,Ue===n&&n!==null&&(Ue=n=n.return);continue}break}while(!0)}function Rg(){var t=Ii.current;return Ii.current=Ni,t===null?Ni:t}function Ec(){($e===0||$e===3||$e===2)&&($e=4),Ve===null||!(ar&268435455)&&!(ia&268435455)||bn(Ve,Ke)}function Pi(t,e){var n=ce;ce|=2;var r=Rg();(Ve!==t||Ke!==e)&&(nn=null,er(t,e));do try{Wx();break}catch(s){Ag(t,s)}while(!0);if(ac(),ce=n,Ii.current=r,Ue!==null)throw Error(L(261));return Ve=null,Ke=0,$e}function Wx(){for(;Ue!==null;)Pg(Ue)}function Jx(){for(;Ue!==null&&!xv();)Pg(Ue)}function Pg(t){var e=Lg(t.alternate,t,yt);t.memoizedProps=t.pendingProps,e===null?Mg(t):Ue=e,wc.current=null}function Mg(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Gx(n,e),n!==null){n.flags&=32767,Ue=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$e=6,Ue=null;return}}else if(n=$x(n,e,yt),n!==null){Ue=n;return}if(e=e.sibling,e!==null){Ue=e;return}Ue=e=t}while(e!==null);$e===0&&($e=5)}function zn(t,e,n){var r=ve,s=Nt.transition;try{Nt.transition=null,ve=1,Kx(t,e,n,r)}finally{Nt.transition=s,ve=r}return null}function Kx(t,e,n,r){do Hr();while(Tn!==null);if(ce&6)throw Error(L(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Iv(t,o),t===Ve&&(Ue=Ve=null,Ke=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||jo||(jo=!0,Ug(hi,function(){return Hr(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Nt.transition,Nt.transition=null;var i=ve;ve=1;var a=ce;ce|=4,wc.current=null,Bx(t,n),Cg(n,t),mx(jl),mi=!!Ul,jl=Ul=null,t.current=n,zx(n),wv(),ce=a,ve=i,Nt.transition=o}else t.current=n;if(jo&&(jo=!1,Tn=t,Ri=s),o=t.pendingLanes,o===0&&(Pn=null),bv(n.stateNode),pt(t,Pe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ai)throw Ai=!1,t=ru,ru=null,t;return Ri&1&&t.tag!==0&&Hr(),o=t.pendingLanes,o&1?t===su?Us++:(Us=0,su=t):Us=0,Fn(),null}function Hr(){if(Tn!==null){var t=hm(Ri),e=Nt.transition,n=ve;try{if(Nt.transition=null,ve=16>t?16:t,Tn===null)var r=!1;else{if(t=Tn,Tn=null,Ri=0,ce&6)throw Error(L(331));var s=ce;for(ce|=4,q=t.current;q!==null;){var o=q,i=o.child;if(q.flags&16){var a=o.deletions;if(a!==null){for(var u=0;u<a.length;u++){var d=a[u];for(q=d;q!==null;){var h=q;switch(h.tag){case 0:case 11:case 15:Ds(8,h,o)}var p=h.child;if(p!==null)p.return=h,q=p;else for(;q!==null;){h=q;var m=h.sibling,g=h.return;if(kg(h),h===d){q=null;break}if(m!==null){m.return=g,q=m;break}q=g}}}var x=o.alternate;if(x!==null){var _=x.child;if(_!==null){x.child=null;do{var S=_.sibling;_.sibling=null,_=S}while(_!==null)}}q=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,q=i;else e:for(;q!==null;){if(o=q,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ds(9,o,o.return)}var v=o.sibling;if(v!==null){v.return=o.return,q=v;break e}q=o.return}}var y=t.current;for(q=y;q!==null;){i=q;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,q=w;else e:for(i=y;q!==null;){if(a=q,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:oa(9,a)}}catch(C){Re(a,a.return,C)}if(a===i){q=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,q=b;break e}q=a.return}}if(ce=s,Fn(),en&&typeof en.onPostCommitFiberRoot=="function")try{en.onPostCommitFiberRoot(Qi,t)}catch{}r=!0}return r}finally{ve=n,Nt.transition=e}}return!1}function ff(t,e,n){e=ts(n,e),e=hg(t,e,1),t=Rn(t,e,1),e=it(),t!==null&&(mo(t,1,e),pt(t,e))}function Re(t,e,n){if(t.tag===3)ff(t,t,n);else for(;e!==null;){if(e.tag===3){ff(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Pn===null||!Pn.has(r))){t=ts(n,t),t=pg(e,t,1),e=Rn(e,t,1),t=it(),e!==null&&(mo(e,1,t),pt(e,t));break}}e=e.return}}function Yx(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=it(),t.pingedLanes|=t.suspendedLanes&n,Ve===t&&(Ke&n)===n&&($e===4||$e===3&&(Ke&130023424)===Ke&&500>Pe()-Sc?er(t,0):_c|=n),pt(t,e)}function Dg(t,e){e===0&&(t.mode&1?(e=Co,Co<<=1,!(Co&130023424)&&(Co=4194304)):e=1);var n=it();t=dn(t,e),t!==null&&(mo(t,e,n),pt(t,n))}function Qx(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Dg(t,n)}function Xx(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),Dg(t,n)}var Lg;Lg=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ft.current)dt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return dt=!1,Fx(t,e,n);dt=!!(t.flags&131072)}else dt=!1,ke&&e.flags&1048576&&Fm(e,Si,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ri(t,e),t=e.pendingProps;var s=Qr(e,rt.current);qr(e,n),s=mc(null,e,r,t,s,n);var o=gc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ht(r)?(o=!0,wi(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,cc(e),s.updater=sa,e.stateNode=s,s._reactInternals=e,Hl(e,r,t,n),e=Kl(null,e,r,!0,o,n)):(e.tag=0,ke&&o&&rc(e),ot(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ri(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=ew(r),t=jt(r,t),s){case 0:e=Jl(null,e,r,t,n);break e;case 1:e=tf(null,e,r,t,n);break e;case 11:e=Zd(null,e,r,t,n);break e;case 14:e=ef(null,e,r,jt(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jt(r,s),Jl(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jt(r,s),tf(t,e,r,s,n);case 3:e:{if(vg(e),t===null)throw Error(L(387));r=e.pendingProps,o=e.memoizedState,s=o.element,qm(t,e),Ei(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=ts(Error(L(423)),e),e=nf(t,e,r,n,s);break e}else if(r!==s){s=ts(Error(L(424)),e),e=nf(t,e,r,n,s);break e}else for(wt=An(e.stateNode.containerInfo.firstChild),_t=e,ke=!0,Gt=null,n=Bm(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xr(),r===s){e=fn(t,e,n);break e}ot(t,e,r,n)}e=e.child}return e;case 5:return Hm(e),t===null&&Bl(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,Ol(r,s)?i=null:o!==null&&Ol(r,o)&&(e.flags|=32),yg(t,e),ot(t,e,i,n),e.child;case 6:return t===null&&Bl(e),null;case 13:return xg(t,e,n);case 4:return dc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Zr(e,null,r,n):ot(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jt(r,s),Zd(t,e,r,s,n);case 7:return ot(t,e,e.pendingProps,n),e.child;case 8:return ot(t,e,e.pendingProps.children,n),e.child;case 12:return ot(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,we(bi,r._currentValue),r._currentValue=i,o!==null)if(Wt(o.value,i)){if(o.children===s.children&&!ft.current){e=fn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var u=a.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=ln(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),zl(o.return,n,e),a.lanes|=n;break}u=u.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(L(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),zl(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}ot(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,qr(e,n),s=Rt(s),r=r(s),e.flags|=1,ot(t,e,r,n),e.child;case 14:return r=e.type,s=jt(r,e.pendingProps),s=jt(r.type,s),ef(t,e,r,s,n);case 15:return mg(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:jt(r,s),ri(t,e),e.tag=1,ht(r)?(t=!0,wi(e)):t=!1,qr(e,n),fg(e,r,s),Hl(e,r,s,n),Kl(null,e,r,!0,t,n);case 19:return wg(t,e,n);case 22:return gg(t,e,n)}throw Error(L(156,e.tag))};function Ug(t,e){return um(t,e)}function Zx(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ct(t,e,n,r){return new Zx(t,e,n,r)}function Tc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ew(t){if(typeof t=="function")return Tc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===qu)return 11;if(t===Hu)return 14}return 2}function Dn(t,e){var n=t.alternate;return n===null?(n=Ct(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ii(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")Tc(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Cr:return tr(n.children,s,o,e);case zu:i=8,s|=8;break;case gl:return t=Ct(12,n,e,s|2),t.elementType=gl,t.lanes=o,t;case yl:return t=Ct(13,n,e,s),t.elementType=yl,t.lanes=o,t;case vl:return t=Ct(19,n,e,s),t.elementType=vl,t.lanes=o,t;case Hp:return aa(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case zp:i=10;break e;case qp:i=9;break e;case qu:i=11;break e;case Hu:i=14;break e;case xn:i=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=Ct(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function tr(t,e,n,r){return t=Ct(7,t,r,e),t.lanes=n,t}function aa(t,e,n,r){return t=Ct(22,t,r,e),t.elementType=Hp,t.lanes=n,t.stateNode={isHidden:!1},t}function Xa(t,e,n){return t=Ct(6,t,null,e),t.lanes=n,t}function Za(t,e,n){return e=Ct(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function tw(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ma(0),this.expirationTimes=Ma(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ma(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Cc(t,e,n,r,s,o,i,a,u){return t=new tw(t,e,n,a,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Ct(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},cc(o),t}function nw(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function jg(t){if(!t)return Un;t=t._reactInternals;e:{if(dr(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ht(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(ht(n))return jm(t,n,e)}return e}function Og(t,e,n,r,s,o,i,a,u){return t=Cc(n,r,!0,t,s,o,i,a,u),t.context=jg(null),n=t.current,r=it(),s=Mn(n),o=ln(r,s),o.callback=e??null,Rn(n,o,s),t.current.lanes=s,mo(t,s,r),pt(t,r),t}function la(t,e,n,r){var s=e.current,o=it(),i=Mn(s);return n=jg(n),e.context===null?e.context=n:e.pendingContext=n,e=ln(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Rn(s,e,i),t!==null&&(Bt(t,s,i,o),ei(t,s,i)),i}function Mi(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function hf(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Nc(t,e){hf(t,e),(t=t.alternate)&&hf(t,e)}function rw(){return null}var Fg=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ic(t){this._internalRoot=t}ua.prototype.render=Ic.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));la(t,e,null,null)};ua.prototype.unmount=Ic.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;lr(function(){la(null,t,null,null)}),e[cn]=null}};function ua(t){this._internalRoot=t}ua.prototype.unstable_scheduleHydration=function(t){if(t){var e=gm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Sn.length&&e!==0&&e<Sn[n].priority;n++);Sn.splice(n,0,t),n===0&&vm(t)}};function Ac(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ca(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pf(){}function sw(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var d=Mi(i);o.call(d)}}var i=Og(e,r,t,0,null,!1,!1,"",pf);return t._reactRootContainer=i,t[cn]=i.current,Js(t.nodeType===8?t.parentNode:t),lr(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Mi(u);a.call(d)}}var u=Cc(t,0,!1,null,null,!1,!1,"",pf);return t._reactRootContainer=u,t[cn]=u.current,Js(t.nodeType===8?t.parentNode:t),lr(function(){la(e,u,n,r)}),u}function da(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var u=Mi(i);a.call(u)}}la(e,i,t,s)}else i=sw(n,e,t,s,r);return Mi(i)}pm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ks(e.pendingLanes);n!==0&&(Ku(e,n|1),pt(e,Pe()),!(ce&6)&&(ns=Pe()+500,Fn()))}break;case 13:lr(function(){var r=dn(t,1);if(r!==null){var s=it();Bt(r,t,1,s)}}),Nc(t,1)}};Yu=function(t){if(t.tag===13){var e=dn(t,134217728);if(e!==null){var n=it();Bt(e,t,134217728,n)}Nc(t,134217728)}};mm=function(t){if(t.tag===13){var e=Mn(t),n=dn(t,e);if(n!==null){var r=it();Bt(n,t,e,r)}Nc(t,e)}};gm=function(){return ve};ym=function(t,e){var n=ve;try{return ve=t,e()}finally{ve=n}};Nl=function(t,e,n){switch(e){case"input":if(_l(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ta(r);if(!s)throw Error(L(90));Jp(r),_l(r,s)}}}break;case"textarea":Yp(t,n);break;case"select":e=n.value,e!=null&&Gr(t,!!n.multiple,e,!1)}};rm=bc;sm=lr;var ow={usingClientEntryPoint:!1,Events:[yo,Rr,ta,tm,nm,bc]},xs={findFiberByHostInstance:Yn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iw={bundleType:xs.bundleType,version:xs.version,rendererPackageName:xs.rendererPackageName,rendererConfig:xs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=am(t),t===null?null:t.stateNode},findFiberByHostInstance:xs.findFiberByHostInstance||rw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oo.isDisabled&&Oo.supportsFiber)try{Qi=Oo.inject(iw),en=Oo}catch{}}bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ow;bt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ac(e))throw Error(L(200));return nw(t,e,null,n)};bt.createRoot=function(t,e){if(!Ac(t))throw Error(L(299));var n=!1,r="",s=Fg;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Cc(t,1,!1,null,null,n,!1,r,s),t[cn]=e.current,Js(t.nodeType===8?t.parentNode:t),new Ic(e)};bt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=am(e),t=t===null?null:t.stateNode,t};bt.flushSync=function(t){return lr(t)};bt.hydrate=function(t,e,n){if(!ca(e))throw Error(L(200));return da(null,t,e,!0,n)};bt.hydrateRoot=function(t,e,n){if(!Ac(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=Fg;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=Og(e,null,t,1,n??null,s,!1,o,i),t[cn]=e.current,Js(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new ua(e)};bt.render=function(t,e,n){if(!ca(e))throw Error(L(200));return da(null,t,e,!1,n)};bt.unmountComponentAtNode=function(t){if(!ca(t))throw Error(L(40));return t._reactRootContainer?(lr(function(){da(null,null,t,!1,function(){t._reactRootContainer=null,t[cn]=null})}),!0):!1};bt.unstable_batchedUpdates=bc;bt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ca(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return da(t,e,n,!1,r)};bt.version="18.3.1-next-f1338f8080-20240426";function $g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($g)}catch(t){console.error(t)}}$g(),$p.exports=bt;var aw=$p.exports,mf=aw;pl.createRoot=mf.createRoot,pl.hydrateRoot=mf.hydrateRoot;var ge=(t=>(t.DASHBOARD="DASHBOARD",t.CAL_COACH="CAL_COACH",t.WORKOUT_PLAN="WORKOUT_PLAN",t.HISTORY="HISTORY",t.PROFILE="PROFILE",t.ONBOARDING="ONBOARDING",t))(ge||{});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uw=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),J=(t,e)=>{const n=E.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:a="",children:u,...d},h)=>E.createElement("svg",{ref:h,...lw,width:s,height:s,stroke:r,strokeWidth:i?Number(o)*24/Number(s):o,className:["lucide",`lucide-${uw(t)}`,a].join(" "),...d},[...e.map(([p,m])=>E.createElement(p,m)),...Array.isArray(u)?u:[u]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=J("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=J("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=J("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=J("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=J("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=J("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=J("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=J("ChefHat",[["path",{d:"M6 13.87A4 4 0 0 1 7.41 6a5.11 5.11 0 0 1 1.05-1.54 5 5 0 0 1 7.08 0A5.11 5.11 0 0 1 16.59 6 4 4 0 0 1 18 13.87V21H6Z",key:"z3ra2g"}],["line",{x1:"6",x2:"18",y1:"17",y2:"17",key:"12q60k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vg=J("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=J("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=J("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hw=J("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pw=J("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mw=J("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=J("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=J("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ui=J("Dumbbell",[["path",{d:"m6.5 6.5 11 11",key:"f7oqzb"}],["path",{d:"m21 21-1-1",key:"cpc6if"}],["path",{d:"m3 3 1 1",key:"d3rpuf"}],["path",{d:"m18 22 4-4",key:"1e32o6"}],["path",{d:"m2 6 4-4",key:"189tqz"}],["path",{d:"m3 10 7-7",key:"1bxui2"}],["path",{d:"m14 21 7-7",key:"16x78n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zg=J("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=J("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=J("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=J("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=J("ImageOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=J("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=J("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=J("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=J("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=J("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=J("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=J("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qg=J("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tw=J("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=J("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=J("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=J("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hg=J("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=J("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=J("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=J("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=J("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=J("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lu=J("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const so=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=J("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=J("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=J("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=J("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=J("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"1ogz0v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=J("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jg=J("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Kg(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=Kg(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Wn(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=Kg(t))&&(r&&(r+=" "),r+=e);return r}const Mw=({children:t,currentView:e,onNavigate:n})=>c.jsxs("div",{className:"h-[100dvh] bg-surface dark:bg-surface-dark flex flex-col max-w-md mx-auto relative shadow-2xl shadow-gray-200 dark:shadow-black/50 overflow-hidden border-x border-gray-100/50 dark:border-white/5 transition-colors duration-300",children:[c.jsx("main",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:t}),c.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-white/60 dark:bg-[#0f111a]/60 backdrop-blur-md pointer-events-auto z-40"}),c.jsx("div",{className:"absolute bottom-8 left-6 right-6 z-50",children:c.jsxs("nav",{className:"bg-white/80 dark:bg-[#1a1c26]/80 backdrop-blur-xl rounded-[32px] p-2 shadow-diffused-lg dark:shadow-diffused-dark border border-white dark:border-white/5 flex justify-between items-center",children:[c.jsxs("button",{onClick:()=>n(ge.DASHBOARD),className:Wn("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ge.DASHBOARD?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[c.jsx(yw,{size:22,strokeWidth:e===ge.DASHBOARD?2.5:2}),e===ge.DASHBOARD&&c.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-left-2 duration-300",children:"Today"})]}),c.jsxs("button",{onClick:()=>n(ge.CAL_COACH),className:Wn("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ge.CAL_COACH?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[c.jsx(zt,{size:22,strokeWidth:e===ge.CAL_COACH?2.5:2}),e===ge.CAL_COACH&&c.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-left-2 duration-300",children:"Coach"})]}),c.jsxs("button",{onClick:()=>n(ge.WORKOUT_PLAN),className:Wn("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ge.WORKOUT_PLAN?"flex-[2] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[c.jsx(Ui,{size:22,strokeWidth:e===ge.WORKOUT_PLAN?2.5:2}),e===ge.WORKOUT_PLAN&&c.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-left-2 duration-300",children:"Workout"})]}),c.jsxs("button",{onClick:()=>n(ge.HISTORY),className:Wn("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ge.HISTORY?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[c.jsx(dw,{size:22,strokeWidth:e===ge.HISTORY?2.5:2}),e===ge.HISTORY&&c.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-right-2 duration-300",children:"Report"})]}),c.jsxs("button",{onClick:()=>n(ge.PROFILE),className:Wn("flex items-center justify-center gap-2 py-3 rounded-[24px] transition-all duration-500",e===ge.PROFILE?"flex-[1.6] bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 px-4":"flex-1 text-gray-400 dark:text-gray-500 hover:text-royal-500 dark:hover:text-royal-400 hover:bg-royal-50/50 dark:hover:bg-white/5"),children:[c.jsx(rs,{size:22,strokeWidth:e===ge.PROFILE?2.5:2}),e===ge.PROFILE&&c.jsx("span",{className:"text-sm font-semibold animate-in fade-in slide-in-from-right-2 duration-300",children:"Profile"})]})]})})]}),tt=({children:t,className:e,onClick:n})=>c.jsx("div",{onClick:n,className:Wn("bg-white dark:bg-[#1a1c26] rounded-[32px] p-5 shadow-diffused dark:shadow-diffused-dark border border-white/60 dark:border-white/5",n&&"cursor-pointer active:scale-[0.98] transition-all hover:shadow-diffused-lg dark:hover:shadow-diffused-dark hover:-translate-y-0.5",e),children:t});function fa(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Dw(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function a(h){try{d(r.next(h))}catch(p){i(p)}}function u(h){try{d(r.throw(h))}catch(p){i(p)}}function d(h){h.done?o(h.value):s(h.value).then(a,u)}d((r=r.apply(t,e||[])).next())})}const Lw=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Dc extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class Uw extends Dc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class wf extends Dc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class _f extends Dc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var cu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(cu||(cu={}));class jw{constructor(e,{headers:n={},customFetch:r,region:s=cu.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=Lw(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Dw(this,arguments,void 0,function*(n,r={}){var s;let o,i;try{const{headers:a,method:u,body:d,signal:h,timeout:p}=r;let m={},{region:g}=r;g||(g=this.region);const x=new URL(`${this.url}/${n}`);g&&g!=="any"&&(m["x-region"]=g,x.searchParams.set("forceFunctionRegion",g));let _;d&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",_=d):typeof d=="string"?(m["Content-Type"]="text/plain",_=d):typeof FormData<"u"&&d instanceof FormData?_=d:(m["Content-Type"]="application/json",_=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?_=JSON.stringify(d):_=d;let S=h;p&&(i=new AbortController,o=setTimeout(()=>i.abort(),p),h?(S=i.signal,h.addEventListener("abort",()=>i.abort())):S=i.signal);const v=yield this.fetch(x.toString(),{method:u||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),a),body:_,signal:S}).catch(C=>{throw new Uw(C)}),y=v.headers.get("x-relay-error");if(y&&y==="true")throw new wf(v);if(!v.ok)throw new _f(v);let w=((s=v.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),b;return w==="application/json"?b=yield v.json():w==="application/octet-stream"||w==="application/pdf"?b=yield v.blob():w==="text/event-stream"?b=v:w==="multipart/form-data"?b=yield v.formData():b=yield v.text(),{data:b,error:null,response:v}}catch(a){return{data:null,error:a,response:a instanceof _f||a instanceof wf?a.context:void 0}}finally{o&&clearTimeout(o)}})}}var Ow=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},Fw=class{constructor(t){var e,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let i=null,a=null,u=null,d=o.status,h=o.statusText;if(o.ok){var p,m;if(n.method!=="HEAD"){var g;const v=await o.text();v===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((g=n.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?a=v:a=JSON.parse(v))}const _=(p=n.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),S=(m=o.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");_&&S&&S.length>1&&(u=parseInt(S[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(a)&&(a.length>1?(i={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,u=null,d=406,h="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var x;const _=await o.text();try{i=JSON.parse(_),Array.isArray(i)&&o.status===404&&(a=[],i=null,d=200,h="OK")}catch{o.status===404&&_===""?(d=204,h="No Content"):i={message:_}}if(i&&n.isMaybeSingle&&(!(i==null||(x=i.details)===null||x===void 0)&&x.includes("0 rows"))&&(i=null,d=200,h="OK"),i&&n.shouldThrowOnError)throw new Ow(i)}return{error:i,data:a,count:u,status:d,statusText:h}});return this.shouldThrowOnError||(s=s.catch(o=>{var i;let a="";const u=o==null?void 0:o.cause;if(u){var d,h,p,m;const x=(d=u==null?void 0:u.message)!==null&&d!==void 0?d:"",_=(h=u==null?void 0:u.code)!==null&&h!==void 0?h:"";a=`${(p=o==null?void 0:o.name)!==null&&p!==void 0?p:"FetchError"}: ${o==null?void 0:o.message}`,a+=`

Caused by: ${(m=u==null?void 0:u.name)!==null&&m!==void 0?m:"Error"}: ${x}`,_&&(a+=` (${_})`),u!=null&&u.stack&&(a+=`
${u.stack}`)}else{var g;a=(g=o==null?void 0:o.stack)!==null&&g!==void 0?g:""}return{error:{message:`${(i=o==null?void 0:o.name)!==null&&i!==void 0?i:"FetchError"}: ${o==null?void 0:o.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(t,e)}returns(){return this}overrideTypes(){return this}},$w=class extends Fw{select(t){let e=!1;const n=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",i=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${i?`${i},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(o,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var i;const a=[t?"analyze":null,e?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Sf=new RegExp("[,()]");var Sr=class extends $w{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Sf.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(r=>typeof r=="string"&&Sf.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${o}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},Gw=class{constructor(t,{headers:e={},schema:n,fetch:r}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:n=!1,count:r}=e??{},s=n?"HEAD":"GET";let o=!1;const i=(t??"*").split("").map(d=>/\s/.test(d)&&!o?"":(d==='"'&&(o=!o),d)).join(""),{url:a,headers:u}=this.cloneRequestState();return a.searchParams.set("select",i),r&&u.append("Prefer",`count=${r}`),new Sr({method:s,url:a,headers:u,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:n=!0}={}){var r;const s="POST",{url:o,headers:i}=this.cloneRequestState();if(e&&i.append("Prefer",`count=${e}`),n||i.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(a.length>0){const u=[...new Set(a)].map(d=>`"${d}"`);o.searchParams.set("columns",u.join(","))}}return new Sr({method:s,url:o,headers:i,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}={}){var o;const i="POST",{url:a,headers:u}=this.cloneRequestState();if(u.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&a.searchParams.set("on_conflict",e),r&&u.append("Prefer",`count=${r}`),s||u.append("Prefer","missing=default"),Array.isArray(t)){const d=t.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(d.length>0){const h=[...new Set(d)].map(p=>`"${p}"`);a.searchParams.set("columns",h.join(","))}}return new Sr({method:i,url:a,headers:u,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:e}={}){var n;const r="PATCH",{url:s,headers:o}=this.cloneRequestState();return e&&o.append("Prefer",`count=${e}`),new Sr({method:r,url:s,headers:o,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var e;const n="DELETE",{url:r,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Sr({method:n,url:r,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},Vw=class Yg{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Gw(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Yg(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:o}={}){var i;let a;const u=new URL(`${this.url}/rpc/${e}`);let d;const h=g=>g!==null&&typeof g=="object"&&(!Array.isArray(g)||g.some(h)),p=r&&Object.values(n).some(h);p?(a="POST",d=n):r||s?(a=r?"HEAD":"GET",Object.entries(n).filter(([g,x])=>x!==void 0).map(([g,x])=>[g,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([g,x])=>{u.searchParams.append(g,x)})):(a="POST",d=n);const m=new Headers(this.headers);return p?m.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&m.set("Prefer",`count=${o}`),new Sr({method:a,url:u,headers:m,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class Bw{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const r=n.versions;if(r&&r.node){const s=r.node,o=parseInt(s.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const zw="2.90.1",qw=`realtime-js/${zw}`,Qg="1.0.0",Hw="2.0.0",bf=Qg,du=1e4,Ww=1e3,Jw=100;var _n;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(_n||(_n={}));var Oe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Oe||(Oe={}));var $t;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})($t||($t={}));var fu;(function(t){t.websocket="websocket"})(fu||(fu={}));var Jn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Jn||(Jn={}));class Kw{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var n,r;const s=(r=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},i=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(e,n,r){var s,o;const i=e.topic,a=(s=e.ref)!==null&&s!==void 0?s:"",u=(o=e.join_ref)!==null&&o!==void 0?o:"",d=e.payload.event,h=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},p=Object.keys(h).length===0?"":JSON.stringify(h);if(u.length>255)throw new Error(`joinRef length ${u.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+a.length+i.length+d.length+p.length,g=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(g),_=0;x.setUint8(_++,this.KINDS.userBroadcastPush),x.setUint8(_++,u.length),x.setUint8(_++,a.length),x.setUint8(_++,i.length),x.setUint8(_++,d.length),x.setUint8(_++,p.length),x.setUint8(_++,n),Array.from(u,v=>x.setUint8(_++,v.charCodeAt(0))),Array.from(a,v=>x.setUint8(_++,v.charCodeAt(0))),Array.from(i,v=>x.setUint8(_++,v.charCodeAt(0))),Array.from(d,v=>x.setUint8(_++,v.charCodeAt(0))),Array.from(p,v=>x.setUint8(_++,v.charCodeAt(0)));var S=new Uint8Array(g.byteLength+r.byteLength);return S.set(new Uint8Array(g),0),S.set(new Uint8Array(r),g.byteLength),S.buffer}decode(e,n){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return n(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,o,i,a,u]=r;return n({join_ref:s,ref:o,topic:i,event:a,payload:u})}return n({})}_binaryDecode(e){const n=new DataView(e),r=n.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,n,s)}}_decodeUserBroadcast(e,n,r){const s=n.getUint8(1),o=n.getUint8(2),i=n.getUint8(3),a=n.getUint8(4);let u=this.HEADER_LENGTH+4;const d=r.decode(e.slice(u,u+s));u=u+s;const h=r.decode(e.slice(u,u+o));u=u+o;const p=r.decode(e.slice(u,u+i));u=u+i;const m=e.slice(u,e.byteLength),g=a===this.JSON_ENCODING?JSON.parse(r.decode(m)):m,x={type:this.BROADCAST_EVENT,event:h,payload:g};return i>0&&(x.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e==null?void 0:e.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>n.includes(r)))}}class Xg{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var xe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(xe||(xe={}));const kf=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((o,i)=>(o[i]=Yw(i,t,e,s),o),{}):{}},Yw=(t,e,n,r)=>{const s=e.find(a=>a.name===t),o=s==null?void 0:s.type,i=n[t];return o&&!r.includes(o)?Zg(o,i):hu(i)},Zg=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return e_(e,n)}switch(t){case xe.bool:return Qw(e);case xe.float4:case xe.float8:case xe.int2:case xe.int4:case xe.int8:case xe.numeric:case xe.oid:return Xw(e);case xe.json:case xe.jsonb:return Zw(e);case xe.timestamp:return t_(e);case xe.abstime:case xe.date:case xe.daterange:case xe.int4range:case xe.int8range:case xe.money:case xe.reltime:case xe.text:case xe.time:case xe.timestamptz:case xe.timetz:case xe.tsrange:case xe.tstzrange:return hu(e);default:return hu(e)}},hu=t=>t,Qw=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Xw=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Zw=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},e_=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let o;const i=t.slice(1,n);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(a=>Zg(e,a))}return t},t_=t=>typeof t=="string"?t.replace(" ","T"):t,e0=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class tl{constructor(e,n,r={},s=du){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ef;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Ef||(Ef={}));class Os{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Os.syncState(this.state,s,o,i),this.pendingDiffs.forEach(u=>{this.state=Os.syncDiff(this.state,u,o,i)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Os.syncDiff(this.state,s,o,i),a())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const o=this.cloneDeep(e),i=this.transformState(n),a={},u={};return this.map(o,(d,h)=>{i[d]||(u[d]=h)}),this.map(i,(d,h)=>{const p=o[d];if(p){const m=h.map(S=>S.presence_ref),g=p.map(S=>S.presence_ref),x=h.filter(S=>g.indexOf(S.presence_ref)<0),_=p.filter(S=>m.indexOf(S.presence_ref)<0);x.length>0&&(a[d]=x),_.length>0&&(u[d]=_)}else a[d]=h}),this.syncDiff(o,{joins:a,leaves:u},r,s)}static syncDiff(e,n,r,s){const{joins:o,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(o,(a,u)=>{var d;const h=(d=e[a])!==null&&d!==void 0?d:[];if(e[a]=this.cloneDeep(u),h.length>0){const p=e[a].map(g=>g.presence_ref),m=h.filter(g=>p.indexOf(g.presence_ref)<0);e[a].unshift(...m)}r(a,h,u)}),this.map(i,(a,u)=>{let d=e[a];if(!d)return;const h=u.map(p=>p.presence_ref);d=d.filter(p=>h.indexOf(p.presence_ref)<0),e[a]=d,s(a,d,u),d.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Tf;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Tf||(Tf={}));var Fs;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Fs||(Fs={}));var rn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(rn||(rn={}));class Or{constructor(e,n={config:{}},r){var s,o;if(this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Oe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new tl(this,$t.join,this.params,this.timeout),this.rejoinTimer=new Xg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Oe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Oe.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this._on($t.reply,{},(i,a)=>{this._trigger(this._replyEventName(a),i)}),this.presence=new Os(this),this.broadcastEndpointURL=e0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var r,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Oe.closed){const{config:{broadcast:i,presence:a,private:u}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[Fs.PRESENCE]&&this.bindings[Fs.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,p={},m={broadcast:i,presence:Object.assign(Object.assign({},a),{enabled:h}),postgres_changes:d,private:u};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(rn.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(rn.CLOSED)),this.updateJoinPayload(Object.assign({config:m},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),g===void 0){e==null||e(rn.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,S=(x=_==null?void 0:_.length)!==null&&x!==void 0?x:0,v=[];for(let y=0;y<S;y++){const w=_[y],{filter:{event:b,schema:C,table:k,filter:T}}=w,M=g&&g[y];if(M&&M.event===b&&Or.isFilterValueEqual(M.schema,C)&&Or.isFilterValueEqual(M.table,k)&&Or.isFilterValueEqual(M.filter,T))v.push(Object.assign(Object.assign({},w),{id:M.id}));else{this.unsubscribe(),this.state=Oe.errored,e==null||e(rn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(rn.SUBSCRIBED);return}}).receive("error",g=>{this.state=Oe.errored,e==null||e(rn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(rn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Oe.joined&&e===Fs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,r)}async httpSend(e,n,r={}){var s;if(n==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(a.status===202)return{success:!0};let u=a.statusText;try{const d=await a.json();u=d.error||d.message||u}catch{}return Promise.reject(new Error(u))}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:i}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,a,u;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||u===void 0)&&u.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Oe.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($t.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new tl(this,$t.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Oe.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,o=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(o),i}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new tl(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Jw){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,o;const i=e.toLocaleLowerCase(),{close:a,error:u,leave:d,join:h}=$t;if(r&&[a,u,d,h].indexOf(i)>=0&&r!==this._joinRef())return;let m=this._onMessage(i,n,r);if(n&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var x,_,S;return((x=g.filter)===null||x===void 0?void 0:x.event)==="*"||((S=(_=g.filter)===null||_===void 0?void 0:_.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===i}).map(g=>g.callback(m,r)):(o=this.bindings[i])===null||o===void 0||o.filter(g=>{var x,_,S,v,y,w,b,C;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const k=g.id,T=(x=g.filter)===null||x===void 0?void 0:x.event;return k&&((_=n.ids)===null||_===void 0?void 0:_.includes(k))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))&&(!(!((v=g.filter)===null||v===void 0)&&v.table)||g.filter.table===((y=n.data)===null||y===void 0?void 0:y.table))}else{const k=(b=(w=g==null?void 0:g.filter)===null||w===void 0?void 0:w.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return k==="*"||k===((C=n==null?void 0:n.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof m=="object"&&"ids"in m){const x=m.data,{schema:_,table:S,commit_timestamp:v,type:y,errors:w}=x;m=Object.assign(Object.assign({},{schema:_,table:S,commit_timestamp:v,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(x))}g.callback(m,r)})}_isClosed(){return this.state===Oe.closed}_isJoined(){return this.state===Oe.joined}_isJoining(){return this.state===Oe.joining}_isLeaving(){return this.state===Oe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),o={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&Or.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on($t.close,{},e)}_onError(e){this._on($t.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Oe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=kf(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=kf(e.columns,e.old_record)),n}}const nl=()=>{},Fo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},n_=[1e3,2e3,5e3,1e4],r_=1e4,s_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class o_{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=du,this.transport=null,this.heartbeatIntervalMs=Fo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nl,this.ref=0,this.reconnectTimer=null,this.vsn=bf,this.logger=nl,this.conn=null,this.sendBuffer=[],this.serializer=new Kw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...o)=>s(...o):(...o)=>fetch(...o),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${fu.websocket}`,this.httpEndpoint=e0(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Bw.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case _n.connecting:return Jn.Connecting;case _n.open:return Jn.Open;case _n.closing:return Jn.Closing;default:return Jn.Closed}}isConnected(){return this.connectionState()===Jn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(o=>o.topic===r);if(s)return s;{const o=new Or(`realtime:${e}`,n,this);return this.channels.push(o),o}}push(e){const{topic:n,event:r,payload:s,ref:o}=e,i=()=>{this.encode(e,a=>{var u;(u=this.conn)===null||u===void 0||u.send(a)})};this.log("push",`${n} ${r} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ww,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Fo.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",d)}catch(h){this.log("error","error in heartbeat callback",h)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:r,event:s,payload:o,ref:i}=n,a=i?`(${i})`:"",u=o.status||"";this.log("receive",`${u} ${r} ${s} ${a}`.trim(),o),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,o,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===_n.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===_n.open||this.conn.readyState===_n.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger($t.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([s_],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,r=!1;if(e)n=e,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const o={access_token:n,version:qw};n&&s.updateJoinPayload(o),s.joinedOnce&&s._isJoined()&&s._push($t.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Xg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,o,i,a,u,d,h,p,m,g;switch(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:du,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Fo.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:nl,this.vsn=(u=e==null?void 0:e.vsn)!==null&&u!==void 0?u:bf,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e==null?void 0:e.reconnectAfterMs)!==null&&d!==void 0?d:x=>n_[x-1]||r_,this.vsn){case Qg:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:(x,_)=>_(JSON.stringify(x)),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:(x,_)=>_(JSON.parse(x));break;case Hw:this.encode=(m=e==null?void 0:e.encode)!==null&&m!==void 0?m:this.serializer.encode.bind(this.serializer),this.decode=(g=e==null?void 0:e.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var oo=class extends Error{constructor(t,e){var n;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((n=e.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function i_(t,e,n){const r=new URL(e,t);if(n)for(const[s,o]of Object.entries(n))o!==void 0&&r.searchParams.set(s,o);return r.toString()}async function a_(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function l_(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:s,body:o,headers:i}){const a=i_(t.baseUrl,r,s),u=await a_(t.auth),d=await e(a,{method:n,headers:{...o?{"Content-Type":"application/json"}:{},...u,...i},body:o?JSON.stringify(o):void 0}),h=await d.text(),p=(d.headers.get("content-type")||"").includes("application/json"),m=p&&h?JSON.parse(h):h;if(!d.ok){const g=p?m:void 0,x=g==null?void 0:g.error;throw new oo((x==null?void 0:x.message)??`Request failed with status ${d.status}`,{status:d.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:g})}return{status:d.status,headers:d.headers,data:m}}}}function $o(t){return t.join("")}var u_=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:$o(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$o(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$o(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$o(t.namespace)}`}),!0}catch(e){if(e instanceof oo&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof oo&&n.status===409)return;throw n}}};function mr(t){return t.join("")}var c_=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mr(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mr(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mr(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${mr(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mr(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${mr(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof oo&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof oo&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},d_=class{constructor(t){var r;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=l_({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(r=t.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new u_(this.client,e),this.tableOps=new c_(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},ha=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function Te(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var f_=class extends ha{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},pu=class extends ha{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const Lc=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),h_=()=>Response,mu=t=>{if(Array.isArray(t))return t.map(n=>mu(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[s]=mu(r)}),e},p_=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},m_=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function io(t){"@babel/helpers - typeof";return io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},io(t)}function g_(t,e){if(io(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(io(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function y_(t){var e=g_(t,"string");return io(e)=="symbol"?e:e+""}function v_(t,e,n){return(e=y_(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function re(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Cf(Object(n),!0).forEach(function(r){v_(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cf(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const rl=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},x_=async(t,e,n)=>{t instanceof await h_()&&!(n!=null&&n.noResolveJson)?t.json().then(r=>{const s=t.status||500,o=(r==null?void 0:r.statusCode)||s+"";e(new f_(rl(r),s,o))}).catch(r=>{e(new pu(rl(r),r))}):e(new pu(rl(t),t))},w_=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(p_(r)?(s.headers=re({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),re(re({},s),n))};async function xo(t,e,n,r,s,o){return new Promise((i,a)=>{t(n,w_(e,r,s,o)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>x_(u,a,r))})}async function ao(t,e,n,r){return xo(t,"GET",e,n,r)}async function Ot(t,e,n,r,s){return xo(t,"POST",e,r,s,n)}async function gu(t,e,n,r,s){return xo(t,"PUT",e,r,s,n)}async function __(t,e,n,r){return xo(t,"HEAD",e,re(re({},n),{},{noResolveJson:!0}),r)}async function Uc(t,e,n,r,s){return xo(t,"DELETE",e,r,s,n)}var S_=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Te(e))return{data:null,error:e};throw e}}};let t0;t0=Symbol.toStringTag;var b_=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[t0]="BlobDownloadBuilder",this.promise=null}asStream(){return new S_(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Te(e))return{data:null,error:e};throw e}}};const k_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Nf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var E_=class{constructor(t,e={},n,r){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=Lc(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,n,r){var s=this;try{let o;const i=re(re({},Nf),r);let a=re(re({},s.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),u&&o.append("metadata",s.encodeMetadata(u)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.has("cacheControl")||o.append("cacheControl",i.cacheControl),u&&!o.has("metadata")&&o.append("metadata",s.encodeMetadata(u))):(o=n,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,u&&(a["x-metadata"]=s.toBase64(s.encodeMetadata(u))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!i.duplex&&(i.duplex="half")),r!=null&&r.headers&&(a=re(re({},a),r.headers));const d=s._removeEmptyFolders(e),h=s._getFinalPath(d),p=await(t=="PUT"?gu:Ot)(s.fetch,`${s.url}/object/${h}`,o,re({headers:a},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(o){if(s.shouldThrowOnError)throw o;if(Te(o))return{data:null,error:o};throw o}}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,r){var s=this;const o=s._removeEmptyFolders(t),i=s._getFinalPath(o),a=new URL(s.url+`/object/upload/sign/${i}`);a.searchParams.set("token",e);try{let u;const d=re({upsert:Nf.upsert},r),h=re(re({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",d.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",d.cacheControl)):(u=n,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType),{data:{path:o,fullPath:(await gu(s.fetch,a.toString(),u,{headers:h})).Key},error:null}}catch(u){if(s.shouldThrowOnError)throw u;if(Te(u))return{data:null,error:u};throw u}}async createSignedUploadUrl(t,e){var n=this;try{let r=n._getFinalPath(t);const s=re({},n.headers);e!=null&&e.upsert&&(s["x-upsert"]="true");const o=await Ot(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(n.url+o.url),a=i.searchParams.get("token");if(!a)throw new ha("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:a},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var r=this;try{return{data:await Ot(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Te(s))return{data:null,error:s};throw s}}async copy(t,e,n){var r=this;try{return{data:{path:(await Ot(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers})).Key},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Te(s))return{data:null,error:s};throw s}}async createSignedUrl(t,e,n){var r=this;try{let s=r._getFinalPath(t),o=await Ot(r.fetch,`${r.url}/object/sign/${s}`,re({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:r.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${r.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Te(s))return{data:null,error:s};throw s}}async createSignedUrls(t,e,n){var r=this;try{const s=await Ot(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:e,paths:t},{headers:r.headers}),o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>re(re({},i),{},{signedUrl:i.signedURL?encodeURI(`${r.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Te(s))return{data:null,error:s};throw s}}download(t,e){const n=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),s=r?`?${r}`:"",o=this._getFinalPath(t),i=()=>ao(this.fetch,`${this.url}/${n}/${o}${s}`,{headers:this.headers,noResolveJson:!0});return new b_(i,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);try{return{data:mu(await ao(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await __(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Te(r)&&r instanceof pu){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}}getPublicUrl(t,e){const n=this._getFinalPath(t),r=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&r.push(s);const o=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});i!==""&&r.push(i);let a=r.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${a}`)}}}async remove(t){var e=this;try{return{data:await Uc(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async list(t,e,n){var r=this;try{const s=re(re(re({},k_),e),{},{prefix:t||""});return{data:await Ot(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},n),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Te(s))return{data:null,error:s};throw s}}async listV2(t,e){var n=this;try{const r=re({},t);return{data:await Ot(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},e),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const n0="2.90.1",r0={"X-Client-Info":`storage-js/${n0}`};var T_=class{constructor(t,e={},n,r){this.shouldThrowOnError=!1;const s=new URL(t);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=re(re({},r0),e),this.fetch=Lc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const n=e.listBucketOptionsToQueryString(t);return{data:await ao(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await ao(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async createBucket(t,e={public:!1}){var n=this;try{return{data:await Ot(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async updateBucket(t,e){var n=this;try{return{data:await gu(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Te(r))return{data:null,error:r};throw r}}async emptyBucket(t){var e=this;try{return{data:await Ot(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Uc(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},C_=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=re(re({},r0),e),this.fetch=Lc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Ot(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async listBuckets(t){var e=this;try{const n=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&n.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&n.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&n.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&n.set("sortOrder",t.sortOrder),t!=null&&t.search&&n.set("search",t.search);const r=n.toString(),s=r?`${e.url}/bucket?${r}`:`${e.url}/bucket`;return{data:await ao(e.fetch,s,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await Uc(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Te(n))return{data:null,error:n};throw n}}from(t){var e=this;if(!m_(t))throw new ha("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new d_({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(s,o){const i=s[o];return typeof i!="function"?i:async(...a)=>{try{return{data:await i.apply(s,a),error:null}}catch(u){if(r)throw u;return{data:null,error:u}}}}})}};const jc={"X-Client-Info":`storage-js/${n0}`,"Content-Type":"application/json"};var s0=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function vt(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var sl=class extends s0{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},N_=class extends s0{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Oc=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),I_=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},If=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),A_=async(t,e,n)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(n!=null&&n.noResolveJson)){const r=t.status||500,s=t;if(typeof s.json=="function")s.json().then(o=>{const i=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||r+"";e(new sl(If(o),r,i))}).catch(()=>{const o=r+"";e(new sl(s.statusText||`HTTP ${r} error`,r,o))});else{const o=r+"";e(new sl(s.statusText||`HTTP ${r} error`,r,o))}}else e(new N_(If(t),t))},R_=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return r?(I_(r)?(s.headers=re({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,re(re({},s),n)):s};async function P_(t,e,n,r,s,o){return new Promise((i,a)=>{t(n,R_(e,r,s,o)).then(u=>{if(!u.ok)throw u;if(r!=null&&r.noResolveJson)return u;const d=u.headers.get("content-type");return!d||!d.includes("application/json")?{}:u.json()}).then(u=>i(u)).catch(u=>A_(u,a,r))})}async function xt(t,e,n,r,s){return P_(t,"POST",e,r,s,n)}var M_=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=re(re({},jc),e),this.fetch=Oc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async getIndex(t,e){var n=this;try{return{data:await xt(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}}async listIndexes(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async deleteIndex(t,e){var n=this;try{return{data:await xt(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}}},D_=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=re(re({},jc),e),this.fetch=Oc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await xt(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async getVectors(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await xt(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async queryVectors(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await xt(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}},L_=class{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=re(re({},jc),e),this.fetch=Oc(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async getBucket(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async listBuckets(t={}){var e=this;try{return{data:await xt(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}async deleteBucket(t){var e=this;try{return{data:await xt(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(vt(n))return{data:null,error:n};throw n}}},U_=class extends L_{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new j_(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},j_=class extends M_{constructor(t,e,n,r){super(t,e,r),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,re(re({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,re(re({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new O_(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},O_=class extends D_{constructor(t,e,n,r,s){super(t,e,s),this.vectorBucketName=n,this.indexName=r}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,re(re({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,re(re({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,re(re({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,re(re({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,re(re({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},F_=class extends T_{constructor(t,e={},n,r){super(t,e,n,r)}from(t){return new E_(this.url,this.headers,t,this.fetch)}get vectors(){return new U_(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new C_(this.url+"/iceberg",this.headers,this.fetch)}};const o0="2.90.1",br=30*1e3,yu=3,ol=yu*br,$_="http://localhost:9999",G_="supabase.auth.token",V_={"X-Client-Info":`gotrue-js/${o0}`},vu="X-Supabase-Api-Version",i0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},B_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,z_=10*60*1e3;class lo extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function W(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class q_ extends lo{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function H_(t){return W(t)&&t.name==="AuthApiError"}class Kn extends lo{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class mn extends lo{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class gt extends mn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function W_(t){return W(t)&&t.name==="AuthSessionMissingError"}class gr extends mn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Go extends mn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Vo extends mn{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function J_(t){return W(t)&&t.name==="AuthImplicitGrantRedirectError"}class Af extends mn{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class K_ extends mn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class xu extends mn{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function il(t){return W(t)&&t.name==="AuthRetryableFetchError"}class Rf extends mn{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class wu extends mn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Oi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Pf=` 	
\r=`.split(""),Y_=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Pf.length;e+=1)t[Pf[e].charCodeAt(0)]=-2;for(let e=0;e<Oi.length;e+=1)t[Oi[e].charCodeAt(0)]=e;return t})();function Mf(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Oi[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Oi[r]),e.queuedBits-=6}}function a0(t,e,n){const r=Y_[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Df(t){const e=[],n=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{Z_(i,r,n)};for(let i=0;i<t.length;i+=1)a0(t.charCodeAt(i),s,o);return e.join("")}function Q_(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function X_(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}Q_(r,e)}}function Z_(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Wr(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)a0(t.charCodeAt(s),n,r);return new Uint8Array(e)}function eS(t){const e=[];return X_(t,n=>e.push(n)),new Uint8Array(e)}function Zn(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>Mf(s,n,r)),Mf(null,n,r),e.join("")}function tS(t){return Math.round(Date.now()/1e3)+t}function nS(){return Symbol("auth-callback")}const We=()=>typeof window<"u"&&typeof document<"u",Gn={tested:!1,writable:!1},l0=()=>{if(!We())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Gn.tested)return Gn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Gn.tested=!0,Gn.writable=!0}catch{Gn.tested=!0,Gn.writable=!1}return Gn.writable};function rS(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const u0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),sS=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",kr=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Vn=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},qe=async(t,e)=>{await t.removeItem(e)};class pa{constructor(){this.promise=new pa.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}pa.promiseConstructor=Promise;function al(t){const e=t.split(".");if(e.length!==3)throw new wu("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!B_.test(e[r]))throw new wu("JWT not in base64url format");return{header:JSON.parse(Df(e[0])),payload:JSON.parse(Df(e[1])),signature:Wr(e[2]),raw:{header:e[0],payload:e[1]}}}async function oS(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function iS(t,e){return new Promise((r,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await t(o);if(!e(o,null,i)){r(i);return}}catch(i){if(!e(o,i)){s(i);return}}})()})}function aS(t){return("0"+t.toString(16)).substr(-2)}function lS(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let o=0;o<56;o++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,aS).join("")}async function uS(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function cS(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await uS(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yr(t,e,n=!1){const r=lS();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await kr(t,`${e}-code-verifier`,s);const o=await cS(r);return[o,r===o?"plain":"s256"]}const dS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function fS(t){const e=t.headers.get(vu);if(!e||!e.match(dS))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function hS(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function pS(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const mS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function vr(t){if(!mS.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ll(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function gS(t,e){return new Proxy(t,{get:(n,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const o=r.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,r,s)}})}function Lf(t){return JSON.parse(JSON.stringify(t))}const qn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),yS=[502,503,504];async function Uf(t){var e;if(!sS(t))throw new xu(qn(t),0);if(yS.includes(t.status))throw new xu(qn(t),t.status);let n;try{n=await t.json()}catch(o){throw new Kn(qn(o),o)}let r;const s=fS(t);if(s&&s.getTime()>=i0["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Rf(qn(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new gt}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new Rf(qn(n),t.status,n.weak_password.reasons);throw new q_(qn(n),t.status||500,r)}const vS=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function ne(t,e,n,r){var s;const o=Object.assign({},r==null?void 0:r.headers);o[vu]||(o[vu]=i0["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const i=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await xS(t,e,n+a,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function xS(t,e,n,r,s,o){const i=vS(e,r,s,o);let a;try{a=await t(n,Object.assign({},i))}catch(u){throw console.error(u),new xu(qn(u),0)}if(a.ok||await Uf(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(u){await Uf(u)}}function Ut(t){var e;let n=null;SS(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=tS(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function jf(t){const e=Ut(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function kn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function wS(t){return{data:t,error:null}}function _S(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o}=t,i=fa(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o},u=Object.assign({},i);return{data:{properties:a,user:u},error:null}}function Of(t){return t}function SS(t){return t.access_token&&t.refresh_token&&t.expires_in}const ul=["global","local","others"];class bS{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=u0(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=ul[0]){if(ul.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ul.join(", ")}`);try{return await ne(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(W(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:kn})}catch(r){if(W(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=fa(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:_S,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(W(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await ne(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:kn})}catch(n){if(W(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,o,i,a,u;try{const d={nextPage:null,lastPage:0,total:0},h=await ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:Of});if(h.error)throw h.error;const p=await h.json(),m=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(u=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(x=>{const _=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);d[`${S}Page`]=_}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(W(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){vr(e);try{return await ne(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:kn})}catch(n){if(W(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){vr(e);try{return await ne(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:kn})}catch(r){if(W(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){vr(e);try{return await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:kn})}catch(r){if(W(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){vr(e.userId);try{const{data:n,error:r}=await ne(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(W(n))return{data:null,error:n};throw n}}async _deleteFactor(e){vr(e.userId),vr(e.id);try{return{data:await ne(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(W(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,r,s,o,i,a,u;try{const d={nextPage:null,lastPage:0,total:0},h=await ne(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:Of});if(h.error)throw h.error;const p=await h.json(),m=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(u=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(x=>{const _=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(x.split(";")[1].split("=")[1]);d[`${S}Page`]=_}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(W(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await ne(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(W(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await ne(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(W(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await ne(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(W(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await ne(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(W(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await ne(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(W(n))return{data:null,error:n};throw n}}}function Ff(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const xr={debug:!!(globalThis&&l0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class c0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class kS extends c0{}async function ES(t,e,n){xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),xr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new kS(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(xr.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function TS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function d0(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function CS(t){return parseInt(t,16)}function NS(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function IS(t){var e;const{chainId:n,domain:r,expirationTime:s,issuedAt:o=new Date,nonce:i,notBefore:a,requestId:u,resources:d,scheme:h,uri:p,version:m}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(m!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const g=d0(t.address),x=h?`${h}://${r}`:r,_=t.statement?`${t.statement}
`:"",S=`${x} wants you to sign in with your Ethereum account:
${g}

${_}`;let v=`URI: ${p}
Version: ${m}
Chain ID: ${n}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(s&&(v+=`
Expiration Time: ${s.toISOString()}`),a&&(v+=`
Not Before: ${a.toISOString()}`),u&&(v+=`
Request ID: ${u}`),d){let y=`
Resources:`;for(const w of d){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);y+=`
- ${w}`}v+=y}return`${S}
${v}`}class Le extends Error{constructor({message:e,code:n,cause:r,name:s}){var o;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(o=s??(r instanceof Error?r.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=n}}class Fi extends Le{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function AS({error:t,options:e}){var n,r,s;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Le({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Le({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((r=o.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Le({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Le({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Le({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Le({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new Le({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Le({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(f0(i)){if(o.rp.id!==i)return new Le({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Le({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Le({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Le({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Le({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function RS({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Le({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Le({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const r=window.location.hostname;if(f0(r)){if(n.rpId!==r)return new Le({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Le({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Le({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Le({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class PS{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const MS=new PS;function DS(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:r}=t,s=fa(t,["challenge","user","excludeCredentials"]),o=Wr(e).buffer,i=Object.assign(Object.assign({},n),{id:Wr(n.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:o,user:i});if(r&&r.length>0){a.excludeCredentials=new Array(r.length);for(let u=0;u<r.length;u++){const d=r[u];a.excludeCredentials[u]=Object.assign(Object.assign({},d),{id:Wr(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return a}function LS(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,r=fa(t,["challenge","allowCredentials"]),s=Wr(e).buffer,o=Object.assign(Object.assign({},r),{challenge:s});if(n&&n.length>0){o.allowCredentials=new Array(n.length);for(let i=0;i<n.length;i++){const a=n[i];o.allowCredentials[i]=Object.assign(Object.assign({},a),{id:Wr(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return o}function US(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Zn(new Uint8Array(t.response.attestationObject)),clientDataJSON:Zn(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function jS(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,r=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Zn(new Uint8Array(s.authenticatorData)),clientDataJSON:Zn(new Uint8Array(s.clientDataJSON)),signature:Zn(new Uint8Array(s.signature)),userHandle:s.userHandle?Zn(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function f0(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function $f(){var t,e;return!!(We()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function OS(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Fi("Browser returned unexpected credential type",e)}:{data:null,error:new Fi("Empty credential response",e)}}catch(e){return{data:null,error:AS({error:e,options:t})}}}async function FS(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Fi("Browser returned unexpected credential type",e)}:{data:null,error:new Fi("Empty credential response",e)}}catch(e){return{data:null,error:RS({error:e,options:t})}}}const $S={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},GS={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function $i(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),n=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of t)if(s)for(const o in s){const i=s[o];if(i!==void 0)if(Array.isArray(i))r[o]=i;else if(n(i))r[o]=i;else if(e(i)){const a=r[o];e(a)?r[o]=$i(a,i):r[o]=$i(i)}else r[o]=i}return r}function VS(t,e){return $i($S,t,e||{})}function BS(t,e){return $i(GS,t,e||{})}class zS{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:r,signal:s},o){try{const{data:i,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!i)return{data:null,error:a};const u=s??MS.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=VS(i.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:h,error:p}=await OS({publicKey:d,signal:u});return h?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const d=BS(i.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:h,error:p}=await FS(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:u}));return h?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(i){return W(i)?{data:null,error:i}:{data:null,error:new Kn("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},o){if(!n)return{data:null,error:new lo("rpId is required for WebAuthn authentication")};try{if(!$f())return{data:null,error:new Kn("Browser does not support WebAuthn",null)};const{data:i,error:a}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:r},signal:s},{request:o});if(!i)return{data:null,error:a};const{webauthn:u}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:u.type,rpId:n,rpOrigins:r,credential_response:u.credential_response}})}catch(i){return W(i)?{data:null,error:i}:{data:null,error:new Kn("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},o){if(!n)return{data:null,error:new lo("rpId is required for WebAuthn registration")};try{if(!$f())return{data:null,error:new Kn("Browser does not support WebAuthn",null)};const{data:i,error:a}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(m=>m.factor_type==="webauthn"&&m.friendly_name===e&&m.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:a};const{data:u,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:s},{create:o});return u?this._verify({factorId:i.id,challengeId:u.challengeId,webauthn:{rpId:n,rpOrigins:r,type:u.webauthn.type,credential_response:u.webauthn.credential_response}}):{data:null,error:d}}catch(i){return W(i)?{data:null,error:i}:{data:null,error:new Kn("Unexpected error in register",i)}}}}TS();const qS={url:$_,storageKey:G_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:V_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Gf(t,e,n){return await n()}const wr={};class uo{get jwks(){var e,n;return(n=(e=wr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){wr[this.storageKey]=Object.assign(Object.assign({},wr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=wr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){wr[this.storageKey]=Object.assign(Object.assign({},wr[this.storageKey]),{cachedAt:e})}constructor(e){var n,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},qS),e);if(this.storageKey=o.storageKey,this.instanceID=(n=uo.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,uo.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&We()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new bS({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=u0(o.fetch),this.lock=o.lock||Gf,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&We()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=ES:this.lock=Gf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new zS(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:l0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ff(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Ff(this.memoryStorage)),We()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${o0}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},r="none";if(We()&&(n=rS(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),We()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),J_(o)){const u=(e=o.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:i,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return W(n)?this._returnResult({error:n}):this._returnResult({error:new Kn("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const o=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ut}),{data:i,error:a}=o;if(a||!i)return this._returnResult({data:{user:null,session:null},error:a});const u=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:d,session:u},error:null})}catch(o){if(W(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var n,r,s;try{let o;if("email"in e){const{email:h,password:p,options:m}=e;let g=null,x=null;this.flowType==="pkce"&&([g,x]=await yr(this.storage,this.storageKey)),o=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:h,password:p,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:g,code_challenge_method:x},xform:Ut})}else if("phone"in e){const{phone:h,password:p,options:m}=e;o=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},channel:(s=m==null?void 0:m.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:Ut})}else throw new Go("You must provide either an email or phone number and a password");const{data:i,error:a}=o;if(a||!i)return await qe(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const u=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),this._returnResult({data:{user:d,session:u},error:null})}catch(o){if(await qe(this.storage,`${this.storageKey}-code-verifier`),W(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:i,options:a}=e;n=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:jf})}else if("phone"in e){const{phone:o,password:i,options:a}=e;n=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:jf})}else throw new Go("You must provide either an email or phone number and a password");const{data:r,error:s}=n;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const o=new gr;return this._returnResult({data:{user:null,session:null},error:o})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(W(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,r,s,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,r,s,o,i,a,u,d,h,p,m;let g,x;if("message"in e)g=e.message,x=e.signature;else{const{chain:_,wallet:S,statement:v,options:y}=e;let w;if(We())if(typeof S=="object")w=S;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")w=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=S}const b=new URL((n=y==null?void 0:y.url)!==null&&n!==void 0?n:window.location.href),C=await w.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=d0(C[0]);let T=(r=y==null?void 0:y.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!T){const R=await w.request({method:"eth_chainId"});T=CS(R)}const M={domain:b.host,address:k,statement:v,uri:b.href,version:"1",chainId:T,nonce:(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.notBefore,requestId:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=y==null?void 0:y.signInWithEthereum)===null||h===void 0?void 0:h.resources};g=IS(M),x=await w.request({method:"personal_sign",params:[NS(g),k]})}try{const{data:_,error:S}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:x},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Ut});if(S)throw S;if(!_||!_.session||!_.user){const v=new gr;return this._returnResult({data:{user:null,session:null},error:v})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:S})}catch(_){if(W(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var n,r,s,o,i,a,u,d,h,p,m,g;let x,_;if("message"in e)x=e.message,_=e.signature;else{const{chain:S,wallet:v,statement:y,options:w}=e;let b;if(We())if(typeof v=="object")b=v;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))b=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=v}const C=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in b&&b.signIn){const k=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),y?{statement:y}:null));let T;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")T=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)T=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)x=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),_=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${C.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(s=(r=w==null?void 0:w.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((u=w==null?void 0:w.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w==null?void 0:w.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((p=(h=w==null?void 0:w.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...w.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const k=await b.signMessage(new TextEncoder().encode(x),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=k}}try{const{data:S,error:v}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:Zn(_)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Ut});if(v)throw v;if(!S||!S.session||!S.user){const y=new gr;return this._returnResult({data:{user:null,session:null},error:y})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:v})}catch(S){if(W(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(e){const n=await Vn(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new K_;const{data:o,error:i}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ut});if(await qe(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!o||!o.session||!o.user){const a=new gr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(await qe(this.storage,`${this.storageKey}-code-verifier`),W(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:o,nonce:i}=e,a=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ut}),{data:u,error:d}=a;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u||!u.session||!u.user){const h=new gr;return this._returnResult({data:{user:null,session:null},error:h})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:u,error:d})}catch(n){if(W(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,r,s,o,i;try{if("email"in e){const{email:a,options:u}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await yr(this.storage,this.storageKey));const{error:p}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:u==null?void 0:u.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:a,options:u}=e,{data:d,error:h}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(o=u==null?void 0:u.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h})}throw new Go("You must provide either an email or phone number.")}catch(a){if(await qe(this.storage,`${this.storageKey}-code-verifier`),W(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var n,r;try{let s,o;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:a}=await ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:Ut});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,d=i.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),this._returnResult({data:{user:d,session:u},error:null})}catch(s){if(W(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var n,r,s,o,i;try{let a=null,u=null;this.flowType==="pkce"&&([a,u]=await yr(this.storage,this.storageKey));const d=await ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:u}),headers:this.headers,xform:wS});return!((o=d.data)===null||o===void 0)&&o.url&&We()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(a){if(await qe(this.storage,`${this.storageKey}-code-verifier`),W(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new gt;const{error:s}=await ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(W(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:o}=e,{error:i}=await ne(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:r,type:s,options:o}=e,{data:i,error:a}=await ne(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:a})}throw new Go("You must provide either an email or phone number and a type")}catch(n){if(W(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Vn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ol:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const i=await Vn(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=ll()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=gS(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:kn}):await this._useSession(async n=>{var r,s,o;const{data:i,error:a}=n;if(a)throw a;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gt}:await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:kn})})}catch(n){if(W(n))return W_(n)&&(await this._removeSession(),await qe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:o}=r;if(o)throw o;if(!s.session)throw new gt;const i=s.session;let a=null,u=null;this.flowType==="pkce"&&e.email!=null&&([a,u]=await yr(this.storage,this.storageKey));const{data:d,error:h}=await ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:u}),jwt:i.access_token,xform:kn});if(h)throw h;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(r){if(await qe(this.storage,`${this.storageKey}-code-verifier`),W(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new gt;const n=Date.now()/1e3;let r=n,s=!0,o=null;const{payload:i}=al(e.access_token);if(i.exp&&(r=i.exp,s=r<=n),s){const{data:a,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!a)return{data:{user:null,session:null},error:null};o=a}else{const{data:a,error:u}=await this._getUser(e.access_token);if(u)throw u;o={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(n){if(W(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:i,error:a}=n;if(a)throw a;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new gt;const{data:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(W(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!We())throw new Vo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Vo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Af("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vo("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Af("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:a,expires_at:u,token_type:d}=e;if(!o||!a||!i||!d)throw new Vo("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(a);let m=h+p;u&&(m=parseInt(u));const g=m-h;g*1e3<=br&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${p}s`);const x=m-p;h-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,m,h):h-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,m,h);const{data:_,error:S}=await this._getUser(o);if(S)throw S;const v={provider_token:r,provider_refresh_token:s,access_token:o,expires_in:p,expires_at:m,refresh_token:i,token_type:d,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:e.type},error:null})}catch(r){if(W(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Vn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return this._returnResult({error:o});const i=(r=s.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(H_(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await qe(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=nS(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:o},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await yr(this.storage,this.storageKey,!0));try{return await ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(await qe(this.storage,`${this.storageKey}-code-verifier`),W(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:r,error:s}=await this._useSession(async o=>{var i,a,u,d,h;const{data:p,error:m}=o;if(m)throw m;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await ne(this.fetch,"GET",g,{headers:this.headers,jwt:(h=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return We()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(W(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var r;try{const{error:s,data:{session:o}}=n;if(s)throw s;const{options:i,provider:a,token:u,access_token:d,nonce:h}=e,p=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=o==null?void 0:o.access_token)!==null&&r!==void 0?r:void 0,body:{provider:a,id_token:u,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Ut}),{data:m,error:g}=p;return g?this._returnResult({data:{user:null,session:null},error:g}):!m||!m.session||!m.user?this._returnResult({data:{user:null,session:null},error:new gr}):(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("USER_UPDATED",m.session)),this._returnResult({data:m,error:g}))}catch(s){if(await qe(this.storage,`${this.storageKey}-code-verifier`),W(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)throw i;return await ne(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await iS(async s=>(s>0&&await oS(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ut})),(s,o)=>{const i=200*Math.pow(2,s);return o&&il(o)&&Date.now()+i-r<br})}catch(r){if(this._debug(n,"error",r),W(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),We()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Vn(this.storage,this.storageKey);if(s&&this.userStorage){let i=await Vn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await kr(this.userStorage,this.storageKey+"-user",i)),s.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:ll()}else if(s&&!s.user&&!s.user){const i=await Vn(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await qe(this.storage,this.storageKey+"-user"),await kr(this.storage,this.storageKey,s)):s.user=ll()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const o=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<ol;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${ol}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),il(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:a}=await this._getUser(s.access_token);!a&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new gt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new pa;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new gt;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const a={data:o.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(o){if(this._debug(s,"error",o),W(o)){const i={data:null,error:o};return il(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(u){o.push(u)}});if(await Promise.all(i),o.length>0){for(let a=0;a<o.length;a+=1)console.error(o[a]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await qe(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await kr(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const o=Lf(s);await kr(this.storage,this.storageKey,o)}else{const s=Lf(n);await kr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await qe(this.storage,this.storageKey),await qe(this.storage,this.storageKey+"-code-verifier"),await qe(this.storage,this.storageKey+"-user"),this.userStorage&&await qe(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&We()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),br);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/br);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${br}ms, refresh threshold is ${yu} ticks`),s<=yu&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof c0)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!We()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,i]=await yr(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(a.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);s.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?this._returnResult({data:null,error:o}):await ne(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)return this._returnResult({data:null,error:i});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:u,error:d}=await ne(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&u.type==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),this._returnResult({data:u,error:null}))})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return this._returnResult({data:null,error:o});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?US(e.webauthn.credential_response):jS(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:u}=await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:u}))})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return this._returnResult({data:null,error:o});const i=await ne(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(i.error)return i;const{data:a}=i;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:DS(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:LS(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=n==null?void 0:n.factors)!==null&&e!==void 0?e:[])s.all.push(o),o.status==="verified"&&s[o.factor_type].push(o);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,n;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=al(r.access_token);let i=null;o.aal&&(i=o.aal);let a=i;((n=(e=r.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(a="aal2");const d=o.amr||[];return{data:{currentLevel:i,nextLevel:a,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?await ne(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new gt})})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:o}=r;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new gt});const i=await ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return i.data&&i.data.redirect_url&&We()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(W(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,n){try{return await this._useSession(async r=>{const{data:{session:s},error:o}=r;if(o)return this._returnResult({data:null,error:o});if(!s)return this._returnResult({data:null,error:new gt});const i=await ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return i.data&&i.data.redirect_url&&We()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(W(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;return r?this._returnResult({data:null,error:r}):n?await ne(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new gt})})}catch(e){if(W(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?(await ne(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new gt})})}catch(n){if(W(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+z_>s)return r;const{data:o,error:i}=await ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,r=o.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:g,error:x}=await this.getSession();if(x||!g.session)return this._returnResult({data:null,error:x});r=g.session.access_token}const{header:s,payload:o,signature:i,raw:{header:a,payload:u}}=al(r);n!=null&&n.allowExpired||hS(o.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!d){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:o,header:s,signature:i},error:null}}const h=pS(s.alg),p=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,i,eS(`${a}.${u}`)))throw new wu("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(r){if(W(r))return this._returnResult({data:null,error:r});throw r}}}uo.nextInstanceID={};const HS=uo,WS="2.90.1";let Ts="";typeof Deno<"u"?Ts="deno":typeof document<"u"?Ts="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ts="react-native":Ts="node";const JS={"X-Client-Info":`supabase-js-${Ts}/${WS}`},KS={headers:JS},YS={schema:"public"},QS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},XS={};function co(t){"@babel/helpers - typeof";return co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},co(t)}function ZS(t,e){if(co(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(co(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eb(t){var e=ZS(t,"string");return co(e)=="symbol"?e:e+""}function tb(t,e,n){return(e=eb(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Ae(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Vf(Object(n),!0).forEach(function(r){tb(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vf(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const nb=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),rb=()=>Headers,sb=(t,e,n)=>{const r=nb(n),s=rb();return async(o,i)=>{var a;const u=(a=await e())!==null&&a!==void 0?a:t;let d=new s(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${u}`),r(o,Ae(Ae({},i),{},{headers:d}))}};function ob(t){return t.endsWith("/")?t:t+"/"}function ib(t,e){var n,r;const{db:s,auth:o,realtime:i,global:a}=t,{db:u,auth:d,realtime:h,global:p}=e,m={db:Ae(Ae({},u),s),auth:Ae(Ae({},d),o),realtime:Ae(Ae({},h),i),storage:{},global:Ae(Ae(Ae({},p),a),{},{headers:Ae(Ae({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(r=a==null?void 0:a.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return t.accessToken?m.accessToken=t.accessToken:delete m.accessToken,m}function ab(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ob(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var lb=class extends HS{constructor(t){super(t)}},ub=class{constructor(t,e,n){var r,s;this.supabaseUrl=t,this.supabaseKey=e;const o=ab(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const i=`sb-${o.hostname.split(".")[0]}-auth-token`,a={db:YS,realtime:XS,auth:Ae(Ae({},QS),{},{storageKey:i}),global:KS},u=ib(n??{},a);if(this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=u.global.headers)!==null&&s!==void 0?s:{},u.accessToken)this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=u.auth)!==null&&d!==void 0?d:{},this.headers,u.global.fetch)}this.fetch=sb(e,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Ae({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new Vw(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new F_(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new jw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:r}=await t.auth.getSession();return(e=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,storageKey:o,flowType:i,lock:a,debug:u,throwOnError:d},h,p){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new lb({url:this.authUrl.href,headers:Ae(Ae({},m),h),storageKey:o,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:r,userStorage:s,flowType:i,lock:a,debug:u,throwOnError:d,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new o_(this.realtimeUrl.href,Ae(Ae({},t),{},{params:Ae(Ae({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const cb=(t,e,n)=>new ub(t,e,n);function db(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const n=e.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}db()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Fc="https://vsqytdzbxxhketbvcoif.supabase.co",h0=`sb_publishable_m-b7gwiZtZu4k0eaXHPoTg_mM_qFuvG
`;console.log("Supabase URL Detected:","Yes",`(Length: ${Fc.length})`);console.log("Supabase Key Detected:","Yes",`(Length: ${h0.length})`);const ss=Fc.startsWith("http"),p0="snapcal_mode_preference",_u=()=>ss?localStorage.getItem(p0)==="local"?"local":"cloud":"local",fb=t=>{localStorage.setItem(p0,t),window.location.reload()},ae=ss&&_u()==="cloud";ss?ae||console.log("Supabase configured but user prefers Local Storage."):console.log("Supabase is not configured. Using Mock Auth & Local Storage.");const fe=cb(ss?Fc:"https://placeholder.supabase.co",ss?h0:"placeholder"),ma="snapcal_mock_session",Gi="snapcal_auth_change",hb=t=>new Promise(e=>setTimeout(e,t)),m0=async(t,e)=>{var n,r;if(ae){const{data:s,error:o}=await fe.auth.signInWithPassword({email:t,password:e});if(o)throw new Error(o.message);return{user:{id:((n=s.user)==null?void 0:n.id)||"",email:(r=s.user)==null?void 0:r.email}}}else{await hb(600);const s={id:btoa(t.toLowerCase()),email:t};return localStorage.setItem(ma,JSON.stringify(s)),window.dispatchEvent(new Event(Gi)),{user:s}}},pb=async(t,e)=>{var n,r;if(ae){const{data:s,error:o}=await fe.auth.signUp({email:t,password:e});if(o)throw new Error(o.message);return{user:{id:((n=s.user)==null?void 0:n.id)||"",email:(r=s.user)==null?void 0:r.email}}}else return m0(t,e)},mb=async()=>{if(ae){const{error:t}=await fe.auth.signOut();if(t)throw t}else localStorage.removeItem(ma),window.dispatchEvent(new Event(Gi))},Ee=async()=>{if(ae){const{data:t}=await fe.auth.getUser();return t.user?{id:t.user.id,email:t.user.email}:null}else{const t=localStorage.getItem(ma);return t?JSON.parse(t):null}},gb=t=>{if(ae){const{data:e}=fe.auth.onAuthStateChange((n,r)=>{r!=null&&r.user?t({id:r.user.id,email:r.user.email}):t(null)});return()=>e.subscription.unsubscribe()}else{const e=()=>{const n=localStorage.getItem(ma);t(n?JSON.parse(n):null)};return window.addEventListener(Gi,e),window.addEventListener("storage",e),()=>{window.removeEventListener(Gi,e),window.removeEventListener("storage",e)}}};class yb{constructor(){Ca(this,"cache",new Map);Ca(this,"defaultTTL",5*60*1e3)}get(e){const n=this.cache.get(e);return n?Date.now()-n.timestamp>n.ttl?(this.cache.delete(e),null):n.data:null}set(e,n,r){this.cache.set(e,{data:n,timestamp:Date.now(),ttl:r||this.defaultTTL})}has(e){return this.get(e)!==null}invalidate(e){this.cache.delete(e)}invalidatePattern(e){const n=[];this.cache.forEach((r,s)=>{e.test(s)&&n.push(s)}),n.forEach(r=>this.cache.delete(r))}clear(){this.cache.clear()}clearDateSensitiveCaches(){console.log(" Clearing date-sensitive caches..."),this.invalidatePattern(/^food:/),console.log(" Date-sensitive caches cleared")}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const mt=new yb,Jt={ENTRIES:"food:entries",ENTRIES_LITE:"food:entries:lite",DAILY_SUMMARIES:"food:summaries",DAILY_SUMMARIES_LITE:"food:summaries:lite",DAILY_GOAL:"user:goal",USER_PROFILE:"user:profile",entriesForDate:t=>`food:entries:${t}`,entryImage:t=>`food:image:${t}`};async function fr(t,e,n){const r=mt.get(t);if(r!==null)return r;const s=await e();return mt.set(t,s,n),s}const $c="snapcal_data_v1",fo="snapcal_settings_v1",ho="snapcal_profile_v1",Gc="snapcal_summaries_v1",g0="snapcal_coach_messages_v1",y0="snapcal_workout_plans_v1",vb="id, user_id, timestamp, date, time, food_item, calories, protein, carbs, fat, confidence, image_url, is_manual, ingredients, original_ai_response",v0="id, user_id, timestamp, date, time, food_item, calories, protein, carbs, fat, confidence, is_manual, ingredients",xb="id, date, calories, protein, carbs, fat",Mt=()=>{try{const t=localStorage.getItem($c);return t?JSON.parse(t):[]}catch{return[]}},ga=t=>{try{localStorage.setItem($c,JSON.stringify(t))}catch(e){throw e.name==="QuotaExceededError"||e.name==="NS_ERROR_DOM_QUOTA_REACHED"||String(e).toLowerCase().includes("quota")?new Error("Browser Storage Full: Your local history (with photos) has reached the browser's 5MB limit. Please delete some old entries in the History tab or connect to Supabase for unlimited cloud storage."):e}},x0=()=>{try{const t=localStorage.getItem(Gc);return t?JSON.parse(t):[]}catch{return[]}},wb=t=>{try{localStorage.setItem(Gc,JSON.stringify(t))}catch{throw new Error("Browser Storage Full: Cannot even save simple summaries. Please clear your browser data.")}},ya=t=>({id:t.id,user_id:t.user_id,timestamp:t.timestamp,date:t.date,time:t.time,food_item:t.food_item,calories:t.calories,protein:t.protein||0,carbs:t.carbs||0,fat:t.fat||0,confidence:t.confidence,imageUrl:t.image_url,isManual:t.is_manual,ingredients:t.ingredients||[],originalAiResponse:t.original_ai_response}),wo=(t,e)=>{console.error(`Supabase ${e} Error:`,t);const n=(t==null?void 0:t.message)||String(t)||"",r=n.toLowerCase();throw r.includes("quota")||r.includes("limit")||r.includes("tier")?new Error("Cloud Quota Reached: Your Supabase storage limit has been exceeded. Try deleting old entries."):r.includes("relation")||r.includes("column")||r.includes("does not exist")?new Error("Database Setup Required: It looks like the 'food_entries' table is missing in Supabase. Please check the Profile tab for the setup SQL script."):r.includes("policy")||r.includes("permission")||r.includes("row-level security")?new Error("Permission Denied: Supabase RLS policies are blocking this save. Ensure authenticated users have 'INSERT' and 'UPDATE' access."):new Error(`Cloud Save Failed: ${n}`)},w0=async t=>{const e=await Ee();if(!e)throw new Error("User must be logged in to save.");if(!ae){const r=Mt(),s=r.findIndex(i=>i.id===t.id),o={...t,user_id:e.id};s>=0?r[s]=o:r.push(o),ga(r),mt.invalidatePattern(/^food:/);return}const{error:n}=await fe.from("food_entries").upsert({id:t.id,user_id:e.id,timestamp:t.timestamp,date:t.date,time:t.time,food_item:t.food_item,calories:t.calories,protein:t.protein,carbs:t.carbs,fat:t.fat,confidence:t.confidence,is_manual:t.isManual,image_url:t.imageUrl===void 0?null:t.imageUrl,ingredients:t.ingredients,original_ai_response:t.originalAiResponse});n&&wo(n,"Save Entry"),mt.invalidatePattern(/^food:/)},_b=async()=>fr(Jt.ENTRIES,async()=>{const t=await Ee();if(!t)return[];if(!ae)return Mt().filter(r=>r.user_id===t.id).sort((r,s)=>s.timestamp.localeCompare(r.timestamp));const{data:e,error:n}=await fe.from("food_entries").select(vb).eq("user_id",t.id).order("timestamp",{ascending:!1}).limit(200);return n?(console.error("Supabase Fetch Error:",n),n.message.includes("relation")?[]:[]):e?e.map(ya):[]},3*60*1e3),Sb=async()=>fr(Jt.ENTRIES_LITE,async()=>{const t=await Ee();if(!t)return[];if(!ae)return Mt().filter(r=>r.user_id===t.id).map(r=>({...r,imageUrl:void 0,originalAiResponse:void 0})).sort((r,s)=>s.timestamp.localeCompare(r.timestamp));const{data:e,error:n}=await fe.from("food_entries").select(v0).eq("user_id",t.id).order("timestamp",{ascending:!1}).limit(200);return n?(console.error("Supabase Fetch Lite Error:",n),[]):e?e.map(ya):[]},3*60*1e3),bb=async()=>fr(Jt.DAILY_SUMMARIES_LITE,async()=>{const t=await Ee();if(!t)return[];if(!ae){const s=Mt().filter(u=>u.user_id===t.id),o={};s.forEach(u=>{o[u.date]||(o[u.date]=[]),o[u.date].push(u)});const i=x0().filter(u=>u.user_id===t.id),a={};return i.forEach(u=>{a[u.date]={date:u.date,totalCalories:u.total_calories||u.totalCalories,totalProtein:u.total_protein||u.totalProtein||0,totalCarbs:u.total_carbs||u.totalCarbs||0,totalFat:u.total_fat||u.totalFat||0}}),Object.keys(o).forEach(u=>{const d=o[u];a[u]={date:u,totalCalories:d.reduce((h,p)=>h+p.calories,0),totalProtein:d.reduce((h,p)=>h+(p.protein||0),0),totalCarbs:d.reduce((h,p)=>h+(p.carbs||0),0),totalFat:d.reduce((h,p)=>h+(p.fat||0),0)}}),Object.values(a).sort((u,d)=>new Date(d.date).getTime()-new Date(u.date).getTime())}const{data:e,error:n}=await fe.from("food_entries").select("date, calories, protein, carbs, fat").eq("user_id",t.id).order("date",{ascending:!1});if(n)return console.error("Supabase summary fetch error:",n),[];const r={};(e||[]).forEach(s=>{r[s.date]||(r[s.date]={calories:0,protein:0,carbs:0,fat:0}),r[s.date].calories+=s.calories||0,r[s.date].protein+=s.protein||0,r[s.date].carbs+=s.carbs||0,r[s.date].fat+=s.fat||0});try{const{data:s}=await fe.from("daily_summaries").select("date, total_calories, total_protein, total_carbs, total_fat").eq("user_id",t.id);(s||[]).forEach(o=>{r[o.date]||(r[o.date]={calories:o.total_calories,protein:o.total_protein,carbs:o.total_carbs,fat:o.total_fat})})}catch{}return Object.entries(r).map(([s,o])=>({date:s,totalCalories:o.calories,totalProtein:o.protein,totalCarbs:o.carbs,totalFat:o.fat})).sort((s,o)=>new Date(o.date).getTime()-new Date(s.date).getTime())},3*60*1e3),kb=async t=>fr(Jt.entriesForDate(t),async()=>{const e=await Ee();if(!e)return[];if(!ae)return Mt().filter(s=>s.user_id===e.id&&s.date===t).map(s=>({...s,imageUrl:void 0,originalAiResponse:void 0})).sort((s,o)=>o.timestamp.localeCompare(s.timestamp));const{data:n,error:r}=await fe.from("food_entries").select(v0).eq("user_id",e.id).eq("date",t).order("timestamp",{ascending:!1});return r?(console.error("Supabase date fetch error:",r),[]):n?n.map(ya):[]},5*60*1e3),Eb=async t=>fr(Jt.entryImage(t),async()=>{const e=await Ee();if(!e)return null;if(!ae){const o=Mt().find(i=>i.id===t&&i.user_id===e.id);return(o==null?void 0:o.imageUrl)||null}const{data:n,error:r}=await fe.from("food_entries").select("image_url").eq("id",t).eq("user_id",e.id).single();return r||!n?null:n.image_url},30*60*1e3),Bf=async()=>{const t=await Ee();if(!t)return;const e=new Date;e.setDate(e.getDate()-7);const n=e.toISOString().split("T")[0];let r=[];if(!ae)r=Mt().filter(o=>o.user_id===t.id&&o.date<n);else try{const{data:o}=await fe.from("food_entries").select(xb).eq("user_id",t.id).lt("date",n);o&&(r=o.map(ya))}catch{return}if(r.length===0)return;const s={};r.forEach(o=>{s[o.date]||(s[o.date]=[]),s[o.date].push(o)});for(const o of Object.keys(s)){const i=s[o],a={id:`${t.id}_${o}`,user_id:t.id,date:o,total_calories:i.reduce((u,d)=>u+d.calories,0),total_protein:i.reduce((u,d)=>u+(d.protein||0),0),total_carbs:i.reduce((u,d)=>u+(d.carbs||0),0),total_fat:i.reduce((u,d)=>u+(d.fat||0),0)};if(ae)await fe.from("daily_summaries").upsert(a),await fe.from("food_entries").delete().eq("user_id",t.id).eq("date",o);else{const u=x0(),d=u.findIndex(p=>p.user_id===t.id&&p.date===o);d>=0?u[d]=a:u.push(a),wb(u);const h=Mt().filter(p=>!(p.user_id===t.id&&p.date===o));ga(h)}}},_0=async t=>{const e=await Ee();if(!e)throw new Error("Not logged in");if(!ae){const r=Mt().filter(s=>!(s.id===t&&s.user_id===e.id));ga(r),mt.invalidatePattern(/^food:/);return}const{error:n}=await fe.from("food_entries").delete().eq("id",t).eq("user_id",e.id);n&&wo(n,"Delete Entry"),mt.invalidatePattern(/^food:/)},Tb=async t=>{const e=await Ee();if(!e)throw new Error("Not logged in");if(!ae){const r=Mt(),s=r.findIndex(o=>o.id===t&&o.user_id===e.id);s>=0&&(r[s].imageUrl=void 0,ga(r)),mt.invalidatePattern(/^food:/);return}const{error:n}=await fe.from("food_entries").update({image_url:null}).eq("id",t).eq("user_id",e.id);n&&wo(n,"Clear Image"),mt.invalidatePattern(/^food:/)},Vc=async()=>fr(Jt.DAILY_GOAL,async()=>{const t=await Ee();if(!t)return 2e3;if(!ae){const r=localStorage.getItem(fo);return(r?JSON.parse(r):{})[t.id]||2e3}const{data:e,error:n}=await fe.from("user_settings").select("daily_goal").eq("user_id",t.id).single();return n||!e?2e3:e.daily_goal},10*60*1e3),va=async t=>{const e=await Ee();if(!e)throw new Error("Not logged in");if(!ae){const r=localStorage.getItem(fo),s=r?JSON.parse(r):{};s[e.id]=t,localStorage.setItem(fo,JSON.stringify(s)),mt.invalidate(Jt.DAILY_GOAL);return}const{error:n}=await fe.from("user_settings").upsert({user_id:e.id,daily_goal:t},{onConflict:"user_id"});n&&wo(n,"Save Daily Goal"),mt.invalidate(Jt.DAILY_GOAL)},Bc=async()=>fr(Jt.USER_PROFILE,async()=>{const t=await Ee();if(!t)return null;if(!ae){const r=localStorage.getItem(ho);return(r?JSON.parse(r):{})[t.id]||null}const{data:e,error:n}=await fe.from("user_profiles").select("name, height, weight, age, gender, activity_level, goal, equipment_access").eq("user_id",t.id).single();return n||!e?null:{name:e.name,height:e.height,weight:e.weight,age:e.age,gender:e.gender,activityLevel:e.activity_level,goal:e.goal,equipmentAccess:e.equipment_access}},10*60*1e3),zc=async t=>{const e=await Ee();if(!e)throw new Error("Not logged in");if(!ae){const r=localStorage.getItem(ho),s=r?JSON.parse(r):{};s[e.id]=t,localStorage.setItem(ho,JSON.stringify(s)),mt.invalidate(Jt.USER_PROFILE);return}const{error:n}=await fe.from("user_profiles").upsert({user_id:e.id,name:t.name,height:t.height,weight:t.weight,age:t.age,gender:t.gender,activity_level:t.activityLevel,goal:t.goal,equipment_access:t.equipmentAccess},{onConflict:"user_id"});n&&wo(n,"Save Profile"),mt.invalidate(Jt.USER_PROFILE)},Cb=()=>Mt().length>0,Nb=async()=>{if(!ae)throw new Error("Must be in Cloud Mode to sync");const t=await Ee();if(!t)throw new Error("Must be logged in to sync");const e=Mt();if(e.length>0){const s=e.map(i=>({id:i.id,user_id:t.id,timestamp:i.timestamp,date:i.date,time:i.time,food_item:i.food_item,calories:i.calories,protein:i.protein,carbs:i.carbs,fat:i.fat,confidence:i.confidence,is_manual:i.isManual,image_url:i.imageUrl,ingredients:i.ingredients,original_ai_response:i.originalAiResponse})),o=5;for(let i=0;i<s.length;i+=o){const a=s.slice(i,i+o),{error:u}=await fe.from("food_entries").upsert(a);if(u)throw console.error("Chunk upload failed",u),new Error(`Sync failed at item ${i+1}: `+u.message)}}const n=localStorage.getItem(fo);if(n){const s=JSON.parse(n),o=Object.keys(s)[0];o&&s[o]&&await va(s[o])}const r=localStorage.getItem(ho);if(r){const s=JSON.parse(r),o=Object.keys(s)[0];o&&s[o]&&await zc(s[o])}localStorage.removeItem($c),localStorage.removeItem(Gc),localStorage.removeItem(fo),localStorage.removeItem(ho)},Ib=async()=>{if(!ae)return{ok:!0};if(!await Ee())return{ok:!0};const{error:e}=await fe.from("food_entries").select("id").limit(1);return e?e.message.includes("relation")||e.code==="42P01"?{ok:!1,missingTables:!0,error:"Tables missing"}:{ok:!1,error:e.message}:{ok:!0}},Vi="snapcal_onboarding_v1",Ab=async t=>{if(!t||!t.id)return!1;const e=localStorage.getItem(Vi),n=e?JSON.parse(e):{};if(n[t.id]===!0)return!0;if(!ae)return!1;try{const{data:r,error:s}=await fe.from("user_settings").select("has_completed_onboarding").eq("user_id",t.id).maybeSingle(),o=(r==null?void 0:r.has_completed_onboarding)||!1;return o&&(n[t.id]=!0,localStorage.setItem(Vi,JSON.stringify(n))),o}catch{return!1}},S0=async t=>{if(!t||!t.id)return;const e=localStorage.getItem(Vi),n=e?JSON.parse(e):{};if(n[t.id]=!0,localStorage.setItem(Vi,JSON.stringify(n)),ae)try{const{error:r}=await fe.from("user_settings").upsert({user_id:t.id,has_completed_onboarding:!0},{onConflict:"user_id"});r&&console.error("Cloud mark onboarding error:",r)}catch(r){console.error("Cloud mark onboarding exception:",r)}},Rb=async t=>{await S0(t)},qc=()=>{try{const t=localStorage.getItem(g0);return t?JSON.parse(t):[]}catch{return[]}},b0=t=>{try{localStorage.setItem(g0,JSON.stringify(t))}catch(e){console.error("Failed to save chat messages to local storage:",e)}},_r=async t=>{const e=await Ee();if(!e){console.warn("User not logged in, cannot save chat message");return}const n=new Date(t.timestamp).toISOString().split("T")[0];if(!ae){const r=qc(),s={...t,user_id:e.id,date:n};r.push(s),b0(r);return}try{const{error:r}=await fe.from("coach_messages").insert({id:t.id,user_id:e.id,role:t.role,content:t.content,timestamp:t.timestamp,date:n});r&&console.error("Failed to save chat message to Supabase:",r)}catch(r){console.error("Exception saving chat message:",r)}},k0=async t=>{const e=await Ee();if(!e)return[];if(!ae)return qc().filter(r=>r.user_id===e.id&&r.date===t).sort((r,s)=>r.timestamp-s.timestamp);try{const{data:n,error:r}=await fe.from("coach_messages").select("id, role, content, timestamp").eq("user_id",e.id).eq("date",t).order("timestamp",{ascending:!0});return r?(console.error("Failed to fetch chat messages:",r),[]):n||[]}catch(n){return console.error("Exception fetching chat messages:",n),[]}},Pb=async()=>{const t=new Date().toISOString().split("T")[0];return k0(t)},Mb=async()=>{const t=await Ee();if(!t)return;const e=new Date;e.setDate(e.getDate()-7);const n=e.toISOString().split("T")[0];if(!ae){const s=qc().filter(o=>o.user_id!==t.id||o.date>=n);b0(s);return}try{const{error:r}=await fe.from("coach_messages").delete().eq("user_id",t.id).lt("date",n);r&&console.error("Failed to cleanup old chat messages:",r)}catch(r){console.error("Exception during chat cleanup:",r)}},xa=()=>{try{const t=localStorage.getItem(y0);return t?JSON.parse(t):[]}catch{return[]}},E0=t=>{try{localStorage.setItem(y0,JSON.stringify(t))}catch(e){console.error("Failed to save workout plans to local storage:",e)}},Bi=async(t,e,n,r)=>{const s=await Ee();if(!s)return console.warn("User not logged in, cannot save workout plan"),"";const o=r||`${s.id}_${t}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:o,user_id:s.id,date:t,title:e,exercises:n},a=xa(),u=a.findIndex(d=>d.id===o);if(u>=0?a[u]=i:a.push(i),E0(a),ae)try{const{error:d}=await fe.from("workout_plans").upsert({id:o,user_id:s.id,date:t,title:e,exercises:n});d&&console.warn("Supabase save failed, using localStorage fallback:",d.message)}catch(d){console.warn("Exception saving workout plan to Supabase, using localStorage fallback:",d)}return o},zf=async t=>{const e=await Ee();if(!e)return[];const n=[];if(xa().filter(o=>o.user_id===e.id&&o.date===t).forEach(o=>{n.push({id:o.id,date:o.date,title:o.title,exercises:o.exercises})}),ae)try{const{data:o,error:i}=await fe.from("workout_plans").select("id, date, title, exercises").eq("user_id",e.id).eq("date",t);if(!i&&o){const a=new Set(n.map(u=>u.id));o.forEach(u=>{a.has(u.id)||n.push({id:u.id,date:u.date,title:u.title,exercises:u.exercises})})}}catch(o){console.warn("Exception fetching workout plans from Supabase, using localStorage only:",o)}return n},qf=async(t,e)=>{const n=await Ee();if(!n)return[];const r=`${t}-${String(e).padStart(2,"0")}-01`,s=`${t}-${String(e).padStart(2,"0")}-31`,i=xa().filter(a=>a.user_id===n.id&&a.date>=r&&a.date<=s).map(a=>a.date);if(ae)try{const{data:a,error:u}=await fe.from("workout_plans").select("date").eq("user_id",n.id).gte("date",r).lte("date",s);if(!u&&a){const d=a.map(h=>h.date);return Array.from(new Set([...i,...d]))}}catch(a){console.warn("Exception fetching workout plans from Supabase, using localStorage only:",a)}return i},Db=async(t,e)=>{if(!await Ee()){console.warn("User not logged in, cannot save multi-day workout plan");return}const r=new Date(t);for(let s=0;s<e.length;s++){const o=e[s];if(o.isRestDay)continue;const i=new Date(r);i.setDate(i.getDate()+s);const a=i.toISOString().split("T")[0];await Bi(a,o.title,o.exercises)}},Lb=async t=>{const e=await Ee();if(!e){console.warn("User not logged in, cannot delete workout plan");return}const r=xa().filter(s=>s.id!==t);if(E0(r),ae)try{const{error:s}=await fe.from("workout_plans").delete().eq("id",t).eq("user_id",e.id);s&&console.warn("Failed to delete workout plan from Supabase:",s.message)}catch(s){console.warn("Exception deleting workout plan from Supabase:",s)}},Ub=()=>{const t=new Date,e=new Date(t);return e.setHours(24,0,0,0),e.getTime()-t.getTime()},jb=t=>{let e;const n=()=>{const r=Ub();console.log(` Scheduling midnight refresh in ${Math.round(r/1e3/60)} minutes`),e=setTimeout(()=>{console.log(" Midnight detected! Running callback..."),t(),n()},r)};return n(),()=>{e&&(clearTimeout(e),console.log(" Midnight timer canceled"))}},ls=()=>{const t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${r}`},cl="snapcal_last_active_date",Ob=()=>{const t=ls(),e=localStorage.getItem(cl);if(!e)return localStorage.setItem(cl,t),!1;const n=e!==t;return n&&(console.log(` Day changed detected: ${e}  ${t}`),localStorage.setItem(cl,t)),n},Me=({className:t,variant:e="primary",isLoading:n,children:r,...s})=>{const o="inline-flex items-center justify-center px-6 py-4 rounded-[24px] font-semibold transition-all duration-300 active:scale-95 disabled:opacity-50 disabled:pointer-events-none text-sm tracking-wide",i={primary:"bg-royal-600 text-white hover:bg-royal-700 shadow-[0_10px_20px_-10px_rgba(124,58,237,0.5)]",secondary:"bg-royal-50 text-royal-700 hover:bg-royal-100",ghost:"bg-transparent text-gray-500 hover:text-royal-600 hover:bg-royal-50"};return c.jsx("button",{className:Wn(o,i[e],t),disabled:n||s.disabled,...s,children:n?c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):r})};var Fb={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let $b,Gb;function Vb(){return{geminiUrl:$b,vertexUrl:Gb}}function Bb(t,e,n,r){var s,o;if(!(t!=null&&t.baseUrl)){const i=Vb();return e?(s=i.vertexUrl)!==null&&s!==void 0?s:n:(o=i.geminiUrl)!==null&&o!==void 0?o:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gn{}function G(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const o=e[s];return o!=null?String(o):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function f(t,e,n){for(let o=0;o<e.length-1;o++){const i=e[o];if(i.endsWith("[]")){const a=i.slice(0,-2);if(!(a in t))if(Array.isArray(n))t[a]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${i}`);if(Array.isArray(t[a])){const u=t[a];if(Array.isArray(n))for(let d=0;d<u.length;d++){const h=u[d];f(h,e.slice(o+1),n[d])}else for(const d of u)f(d,e.slice(o+1),n)}return}else if(i.endsWith("[0]")){const a=i.slice(0,-3);a in t||(t[a]=[{}]);const u=t[a];f(u[0],e.slice(o+1),n);return}(!t[i]||typeof t[i]!="object")&&(t[i]={}),t=t[i]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function l(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let r=0;r<e.length;r++){if(typeof t!="object"||t===null)return n;const s=e[r];if(s.endsWith("[]")){const o=s.slice(0,-2);if(o in t){const i=t[o];return Array.isArray(i)?i.map(a=>l(a,e.slice(r+1),n)):n}else return n}else t=t[s]}return t}catch(r){if(r instanceof TypeError)return n;throw r}}function zb(t,e){for(const[n,r]of Object.entries(e)){const s=n.split("."),o=r.split("."),i=new Set;let a=-1;for(let u=0;u<s.length;u++)if(s[u]==="*"){a=u;break}if(a!==-1&&o.length>a)for(let u=a;u<o.length;u++){const d=o[u];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&i.add(d)}Su(t,s,o,0,i)}}function Su(t,e,n,r,s){if(r>=e.length||typeof t!="object"||t===null)return;const o=e[r];if(o.endsWith("[]")){const i=o.slice(0,-2),a=t;if(i in a&&Array.isArray(a[i]))for(const u of a[i])Su(u,e,n,r+1,s)}else if(o==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const i=t,a=Object.keys(i).filter(d=>!d.startsWith("_")&&!s.has(d)),u={};for(const d of a)u[d]=i[d];for(const[d,h]of Object.entries(u)){const p=[];for(const m of n.slice(r))m==="*"?p.push(d):p.push(m);f(i,p,h)}for(const d of a)delete i[d]}}else{const i=t;o in i&&Su(i[o],e,n,r+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hc(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qb(t){const e={},n=l(t,["operationName"]);n!=null&&f(e,["operationName"],n);const r=l(t,["resourceName"]);return r!=null&&f(e,["_url","resourceName"],r),e}function Hb(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["response","generateVideoResponse"]);return i!=null&&f(e,["response"],Jb(i)),e}function Wb(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["response"]);return i!=null&&f(e,["response"],Kb(i)),e}function Jb(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Yb(i))),f(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=l(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function Kb(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>Qb(i))),f(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=l(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function Yb(t){const e={},n=l(t,["video"]);return n!=null&&f(e,["video"],rk(n)),e}function Qb(t){const e={},n=l(t,["_self"]);return n!=null&&f(e,["video"],sk(n)),e}function Xb(t){const e={},n=l(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function Zb(t){const e={},n=l(t,["operationName"]);return n!=null&&f(e,["_url","operationName"],n),e}function ek(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["response"]);return i!=null&&f(e,["response"],tk(i)),e}function tk(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["parent"]);r!=null&&f(e,["parent"],r);const s=l(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function T0(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["response"]);return i!=null&&f(e,["response"],nk(i)),e}function nk(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["parent"]);r!=null&&f(e,["parent"],r);const s=l(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function rk(t){const e={},n=l(t,["uri"]);n!=null&&f(e,["uri"],n);const r=l(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],Hc(r));const s=l(t,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function sk(t){const e={},n=l(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],Hc(r));const s=l(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hf;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Hf||(Hf={}));var Wf;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Wf||(Wf={}));var Jf;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Jf||(Jf={}));var ie;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(ie||(ie={}));var Kf;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Kf||(Kf={}));var Yf;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Yf||(Yf={}));var Qf;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Qf||(Qf={}));var Xf;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Xf||(Xf={}));var Zf;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Zf||(Zf={}));var eh;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(eh||(eh={}));var th;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(th||(th={}));var nh;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(nh||(nh={}));var rh;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(rh||(rh={}));var sh;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(sh||(sh={}));var oh;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(oh||(oh={}));var ih;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(ih||(ih={}));var ah;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(ah||(ah={}));var lh;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(lh||(lh={}));var uh;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(uh||(uh={}));var ch;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(ch||(ch={}));var dh;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(dh||(dh={}));var zi;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(zi||(zi={}));var fh;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(fh||(fh={}));var hh;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(hh||(hh={}));var ph;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ph||(ph={}));var bu;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(bu||(bu={}));var mh;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(mh||(mh={}));var gh;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(gh||(gh={}));var yh;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(yh||(yh={}));var vh;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(vh||(vh={}));var xh;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(xh||(xh={}));var wh;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(wh||(wh={}));var _h;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(_h||(_h={}));var Sh;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Sh||(Sh={}));var bh;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(bh||(bh={}));var kh;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(kh||(kh={}));var Eh;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Eh||(Eh={}));var Th;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Th||(Th={}));var Ch;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Ch||(Ch={}));var Nh;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Nh||(Nh={}));var Ih;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Ih||(Ih={}));var Ah;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Ah||(Ah={}));var Rh;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(Rh||(Rh={}));var Ph;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Ph||(Ph={}));var Mh;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED",t.REGISTERED="REGISTERED"})(Mh||(Mh={}));var Dh;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Dh||(Dh={}));var Lh;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Lh||(Lh={}));var Uh;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Uh||(Uh={}));var jh;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(jh||(jh={}));var Oh;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Oh||(Oh={}));var Fh;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Fh||(Fh={}));var $h;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})($h||($h={}));var Gh;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Gh||(Gh={}));var Vh;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(Vh||(Vh={}));var Fr;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Fr||(Fr={}));class ku{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ws{get text(){var e,n,r,s,o,i,a,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const m of(u=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&u!==void 0?u:[]){for(const[g,x]of Object.entries(m))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(x!==null||x!==void 0)&&p.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;h=!0,d+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,n,r,s,o,i,a,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(u=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&u!==void 0?u:[]){for(const[m,g]of Object.entries(p))m!=="inlineData"&&(g!==null||g!==void 0)&&h.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,r,s,o,i,a,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(u=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||u===void 0?void 0:u.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,n,r,s,o,i,a,u,d;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(u=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||u===void 0?void 0:u.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,r,s,o,i,a,u,d;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(u=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||u===void 0?void 0:u.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class Bh{}class zh{}class ok{}class ik{}class ak{}class lk{}class qh{}class Hh{}class Wh{}class uk{}class qi{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new qi;let s;const o=e;return n?s=Wb(o):s=Hb(o),Object.assign(r,s),r}}class Jh{}class Kh{}class Yh{}class Qh{}class ck{}class dk{}class fk{}class Wc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Wc,o=ek(e);return Object.assign(r,o),r}}class hk{}class pk{}class mk{}class Xh{}class gk{get text(){var e,n,r;let s="",o=!1;const i=[];for(const a of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(a))u!=="text"&&u!=="thought"&&d!==null&&i.push(u);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;o=!0,s+=a.text}}return i.length>0&&console.warn(`there are non-text parts ${i} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?s:void 0}get data(){var e,n,r;let s="";const o=[];for(const i of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[a,u]of Object.entries(i))a!=="inlineData"&&u!==null&&o.push(a);i.inlineData&&typeof i.inlineData.data=="string"&&(s+=atob(i.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class yk{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Jc{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const r=new Jc,o=T0(e);return Object.assign(r,o),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function he(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function C0(t,e){const n=he(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function N0(t){return Array.isArray(t)?t.map(e=>Hi(e)):[Hi(t)]}function Hi(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function I0(t){const e=Hi(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function A0(t){const e=Hi(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Zh(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function R0(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Zh(e)):[Zh(t)]}function Eu(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function ep(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function tp(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function nt(t){if(t==null)throw new Error("ContentUnion is required");return Eu(t)?t:{role:"user",parts:R0(t)}}function Kc(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=nt(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=nt(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>nt(n)):[nt(e)]}function At(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(ep(t)||tp(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[nt(t)]}const e=[],n=[],r=Eu(t[0]);for(const s of t){const o=Eu(s);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(s);else{if(ep(s)||tp(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return r||e.push({role:"user",parts:R0(n)}),e}function vk(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(ie).includes(n[0].toUpperCase())?n[0].toUpperCase():ie.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(ie).includes(r.toUpperCase())?r.toUpperCase():ie.TYPE_UNSPECIFIED})}}function Jr(t){const e={},n=["items"],r=["anyOf"],s=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&vk(t.type,e);for(const[i,a]of Object.entries(t))if(a!=null)if(i=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(ie).includes(a.toUpperCase())?a.toUpperCase():ie.TYPE_UNSPECIFIED}else if(n.includes(i))e[i]=Jr(a);else if(r.includes(i)){const u=[];for(const d of a){if(d.type=="null"){e.nullable=!0;continue}u.push(Jr(d))}e[i]=u}else if(s.includes(i)){const u={};for(const[d,h]of Object.entries(a))u[d]=Jr(h);e[i]=u}else{if(i==="additionalProperties")continue;e[i]=a}return e}function Yc(t){return Jr(t)}function Qc(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Xc(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function us(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Jr(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Jr(e.response));return t}function cs(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function xk(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function yn(t,e){if(typeof e!="string")throw new Error("name must be a string");return xk(t,e,"cachedContents")}function P0(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function $n(t){return Hc(t)}function wk(t){return t!=null&&typeof t=="object"&&"name"in t}function _k(t){return t!=null&&typeof t=="object"&&"video"in t}function Sk(t){return t!=null&&typeof t=="object"&&"uri"in t}function M0(t){var e;let n;if(wk(t)&&(n=t.name),!(Sk(t)&&(n=t.uri,n===void 0))&&!(_k(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const s=n.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${n}`);n=s[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function D0(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function L0(t){for(const e of["models","tunedModels","publisherModels"])if(bk(t,e))return t[e];return[]}function bk(t,e){return t!==null&&typeof t=="object"&&e in t}function kk(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function Ek(t,e={}){const n=[],r=new Set;for(const s of t){const o=s.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const i=kk(s,e);i.functionDeclarations&&n.push(...i.functionDeclarations)}return{functionDeclarations:n}}function U0(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,s=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(s>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Tk(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function j0(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const s=n.inlinedResponses;if(!Array.isArray(s)||s.length===0)return t;let o=!1;for(const i of s){if(typeof i!="object"||i===null)continue;const u=i.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function ds(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function O0(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ck(t){const e={},n=l(t,["responsesFile"]);n!=null&&f(e,["fileName"],n);const r=l(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>aE(i))),f(e,["inlinedResponses"],o)}const s=l(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["inlinedEmbedContentResponses"],o)}return e}function Nk(t){const e={},n=l(t,["predictionsFormat"]);n!=null&&f(e,["format"],n);const r=l(t,["gcsDestination","outputUriPrefix"]);r!=null&&f(e,["gcsUri"],r);const s=l(t,["bigqueryDestination","outputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function Ik(t){const e={},n=l(t,["format"]);n!=null&&f(e,["predictionsFormat"],n);const r=l(t,["gcsUri"]);r!=null&&f(e,["gcsDestination","outputUriPrefix"],r);const s=l(t,["bigqueryUri"]);if(s!=null&&f(e,["bigqueryDestination","outputUri"],s),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(l(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function li(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata","displayName"]);r!=null&&f(e,["displayName"],r);const s=l(t,["metadata","state"]);s!=null&&f(e,["state"],O0(s));const o=l(t,["metadata","createTime"]);o!=null&&f(e,["createTime"],o);const i=l(t,["metadata","endTime"]);i!=null&&f(e,["endTime"],i);const a=l(t,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const u=l(t,["metadata","model"]);u!=null&&f(e,["model"],u);const d=l(t,["metadata","output"]);return d!=null&&f(e,["dest"],Ck(j0(d))),e}function Tu(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=l(t,["state"]);s!=null&&f(e,["state"],O0(s));const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["createTime"]);i!=null&&f(e,["createTime"],i);const a=l(t,["startTime"]);a!=null&&f(e,["startTime"],a);const u=l(t,["endTime"]);u!=null&&f(e,["endTime"],u);const d=l(t,["updateTime"]);d!=null&&f(e,["updateTime"],d);const h=l(t,["model"]);h!=null&&f(e,["model"],h);const p=l(t,["inputConfig"]);p!=null&&f(e,["src"],Ak(p));const m=l(t,["outputConfig"]);m!=null&&f(e,["dest"],Nk(j0(m)));const g=l(t,["completionStats"]);return g!=null&&f(e,["completionStats"],g),e}function Ak(t){const e={},n=l(t,["instancesFormat"]);n!=null&&f(e,["format"],n);const r=l(t,["gcsSource","uris"]);r!=null&&f(e,["gcsUri"],r);const s=l(t,["bigquerySource","inputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function Rk(t,e){const n={};if(l(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=l(e,["fileName"]);r!=null&&f(n,["fileName"],r);const s=l(e,["inlinedRequests"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>iE(t,i))),f(n,["requests","requests"],o)}return n}function Pk(t){const e={},n=l(t,["format"]);n!=null&&f(e,["instancesFormat"],n);const r=l(t,["gcsUri"]);r!=null&&f(e,["gcsSource","uris"],r);const s=l(t,["bigqueryUri"]);if(s!=null&&f(e,["bigquerySource","inputUri"],s),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Mk(t){const e={},n=l(t,["data"]);if(n!=null&&f(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Dk(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],ds(t,r)),n}function Lk(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],ds(t,r)),n}function Uk(t){const e={},n=l(t,["content"]);n!=null&&f(e,["content"],n);const r=l(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],jk(r));const s=l(t,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const o=l(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const i=l(t,["avgLogprobs"]);i!=null&&f(e,["avgLogprobs"],i);const a=l(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const u=l(t,["index"]);u!=null&&f(e,["index"],u);const d=l(t,["logprobsResult"]);d!=null&&f(e,["logprobsResult"],d);const h=l(t,["safetyRatings"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["safetyRatings"],m)}const p=l(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function jk(t){const e={},n=l(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["citations"],r)}return e}function F0(t){const e={},n=l(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>pE(o))),f(e,["parts"],s)}const r=l(t,["role"]);return r!=null&&f(e,["role"],r),e}function Ok(t,e){const n={},r=l(t,["displayName"]);if(e!==void 0&&r!=null&&f(e,["batch","displayName"],r),l(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function Fk(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=l(t,["dest"]);return e!==void 0&&s!=null&&f(e,["outputConfig"],Ik(Tk(s))),n}function np(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["src"]);s!=null&&f(n,["batch","inputConfig"],Rk(t,U0(t,s)));const o=l(e,["config"]);return o!=null&&Ok(o,n),n}function $k(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["model"],he(t,r));const s=l(e,["src"]);s!=null&&f(n,["inputConfig"],Pk(U0(t,s)));const o=l(e,["config"]);return o!=null&&Fk(o,n),n}function Gk(t,e){const n={},r=l(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["batch","displayName"],r),n}function Vk(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["src"]);s!=null&&f(n,["batch","inputConfig"],Kk(t,s));const o=l(e,["config"]);return o!=null&&Gk(o,n),n}function Bk(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],ds(t,r)),n}function zk(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],ds(t,r)),n}function qk(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&f(e,["name"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);return o!=null&&f(e,["error"],o),e}function Hk(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&f(e,["name"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);return o!=null&&f(e,["error"],o),e}function Wk(t,e){const n={},r=l(e,["contents"]);if(r!=null){let o=Kc(t,r);Array.isArray(o)&&(o=o.map(i=>i)),f(n,["requests[]","request","content"],o)}const s=l(e,["config"]);return s!=null&&(f(n,["_self"],Jk(s,n)),zb(n,{"requests[].*":"requests[].request.*"})),n}function Jk(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const s=l(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Kk(t,e){const n={},r=l(e,["fileName"]);r!=null&&f(n,["file_name"],r);const s=l(e,["inlinedRequests"]);return s!=null&&f(n,["requests"],Wk(t,s)),n}function Yk(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Qk(t){const e={},n=l(t,["id"]);n!=null&&f(e,["id"],n);const r=l(t,["args"]);r!=null&&f(e,["args"],r);const s=l(t,["name"]);if(s!=null&&f(e,["name"],s),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Xk(t){const e={},n=l(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=l(t,["mode"]);if(r!=null&&f(e,["mode"],r),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Zk(t,e,n){const r={},s=l(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],F0(nt(s)));const o=l(e,["temperature"]);o!=null&&f(r,["temperature"],o);const i=l(e,["topP"]);i!=null&&f(r,["topP"],i);const a=l(e,["topK"]);a!=null&&f(r,["topK"],a);const u=l(e,["candidateCount"]);u!=null&&f(r,["candidateCount"],u);const d=l(e,["maxOutputTokens"]);d!=null&&f(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=l(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const x=l(e,["frequencyPenalty"]);x!=null&&f(r,["frequencyPenalty"],x);const _=l(e,["seed"]);_!=null&&f(r,["seed"],_);const S=l(e,["responseMimeType"]);S!=null&&f(r,["responseMimeType"],S);const v=l(e,["responseSchema"]);v!=null&&f(r,["responseSchema"],Yc(v));const y=l(e,["responseJsonSchema"]);if(y!=null&&f(r,["responseJsonSchema"],y),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=l(e,["safetySettings"]);if(n!==void 0&&w!=null){let se=w;Array.isArray(se)&&(se=se.map(N=>mE(N))),f(n,["safetySettings"],se)}const b=l(e,["tools"]);if(n!==void 0&&b!=null){let se=cs(b);Array.isArray(se)&&(se=se.map(N=>yE(us(N)))),f(n,["tools"],se)}const C=l(e,["toolConfig"]);if(n!==void 0&&C!=null&&f(n,["toolConfig"],gE(C)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=l(e,["cachedContent"]);n!==void 0&&k!=null&&f(n,["cachedContent"],yn(t,k));const T=l(e,["responseModalities"]);T!=null&&f(r,["responseModalities"],T);const M=l(e,["mediaResolution"]);M!=null&&f(r,["mediaResolution"],M);const R=l(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],Qc(R)),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=l(e,["thinkingConfig"]);U!=null&&f(r,["thinkingConfig"],U);const X=l(e,["imageConfig"]);X!=null&&f(r,["imageConfig"],oE(X));const ye=l(e,["enableEnhancedCivicAnswers"]);return ye!=null&&f(r,["enableEnhancedCivicAnswers"],ye),r}function eE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>Uk(d))),f(e,["candidates"],u)}const s=l(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const o=l(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const i=l(t,["responseId"]);i!=null&&f(e,["responseId"],i);const a=l(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function tE(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],ds(t,r)),n}function nE(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],ds(t,r)),n}function rE(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function sE(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function oE(t){const e={},n=l(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=l(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),l(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(l(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(l(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function iE(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["request","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let a=At(s);Array.isArray(a)&&(a=a.map(u=>F0(u))),f(n,["request","contents"],a)}const o=l(e,["metadata"]);o!=null&&f(n,["metadata"],o);const i=l(e,["config"]);return i!=null&&f(n,["request","generationConfig"],Zk(t,i,l(n,["request"],{}))),n}function aE(t){const e={},n=l(t,["response"]);n!=null&&f(e,["response"],eE(n));const r=l(t,["error"]);return r!=null&&f(e,["error"],r),e}function lE(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=l(t,["pageToken"]);if(e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),l(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function uE(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=l(t,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const o=l(t,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),n}function cE(t){const e={},n=l(t,["config"]);return n!=null&&lE(n,e),e}function dE(t){const e={},n=l(t,["config"]);return n!=null&&uE(n,e),e}function fE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["operations"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>li(i))),f(e,["batchJobs"],o)}return e}function hE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["batchPredictionJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>Tu(i))),f(e,["batchJobs"],o)}return e}function pE(t){const e={},n=l(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=l(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=l(t,["fileData"]);o!=null&&f(e,["fileData"],Yk(o));const i=l(t,["functionCall"]);i!=null&&f(e,["functionCall"],Qk(i));const a=l(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&f(e,["inlineData"],Mk(u));const d=l(t,["text"]);d!=null&&f(e,["text"],d);const h=l(t,["thought"]);h!=null&&f(e,["thought"],h);const p=l(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=l(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function mE(t){const e={},n=l(t,["category"]);if(n!=null&&f(e,["category"],n),l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=l(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function gE(t){const e={},n=l(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=l(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],Xk(r)),e}function yE(t){const e={};if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=l(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=l(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=l(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=l(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],rE(i));const a=l(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],sE(a));const u=l(t,["googleSearchRetrieval"]);u!=null&&f(e,["googleSearchRetrieval"],u);const d=l(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var hn;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(hn||(hn={}));class hr{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let i={config:{}};!r||Object.keys(r).length===0?i={config:{}}:typeof r=="object"?i=Object.assign({},r):i=r,i.config&&(i.config.pageToken=n.nextPageToken),this.paramsInternal=i,this.pageInternalSize=(o=(s=i.config)===null||s===void 0?void 0:s.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vE extends gn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new hr(hn.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=np(this.apiClient,e),r=n._url,s=G("{model}:batchGenerateContent",r),a=n.batch.inputConfig.requests,u=a.requests,d=[];for(const h of u){const p=Object.assign({},h);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const g=p.request;g.systemInstruction=m,p.request=g}d.push(p)}return a.requests=d,delete n.config,delete n._url,delete n._query,{path:s,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},s=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${s}`),r.dest===void 0){const o=this.getGcsUri(e),i=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${s}`;else if(i)r.dest=`${i}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=$k(this.apiClient,e);return a=G("batchPredictionJobs",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>Tu(h))}else{const d=np(this.apiClient,e);return a=G("{model}:batchGenerateContent",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>li(h))}}async createEmbeddingsInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Vk(this.apiClient,e);return o=G("{model}:asyncBatchEmbedContent",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>li(u))}}async get(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=nE(this.apiClient,e);return a=G("batchPredictionJobs/{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>Tu(h))}else{const d=tE(this.apiClient,e);return a=G("batches/{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>li(h))}}async cancel(e){var n,r,s,o;let i="",a={};if(this.apiClient.isVertexAI()){const u=Lk(this.apiClient,e);i=G("batchPredictionJobs/{name}:cancel",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=Dk(this.apiClient,e);i=G("batches/{name}:cancel",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=dE(e);return a=G("batchPredictionJobs",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=hE(h),m=new Xh;return Object.assign(m,p),m})}else{const d=cE(e);return a=G("batches",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=fE(h),m=new Xh;return Object.assign(m,p),m})}}async delete(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=zk(this.apiClient,e);return a=G("batchPredictionJobs/{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>Hk(h))}else{const d=Bk(this.apiClient,e);return a=G("batches/{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>qk(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xE(t){const e={},n=l(t,["data"]);if(n!=null&&f(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function rp(t){const e={},n=l(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>VE(o))),f(e,["parts"],s)}const r=l(t,["role"]);return r!=null&&f(e,["role"],r),e}function wE(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=l(t,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const o=l(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const i=l(t,["contents"]);if(e!==void 0&&i!=null){let h=At(i);Array.isArray(h)&&(h=h.map(p=>rp(p))),f(e,["contents"],h)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],rp(nt(a)));const u=l(t,["tools"]);if(e!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(p=>zE(p))),f(e,["tools"],h)}const d=l(t,["toolConfig"]);if(e!==void 0&&d!=null&&f(e,["toolConfig"],BE(d)),l(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function _E(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=l(t,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const o=l(t,["displayName"]);e!==void 0&&o!=null&&f(e,["displayName"],o);const i=l(t,["contents"]);if(e!==void 0&&i!=null){let p=At(i);Array.isArray(p)&&(p=p.map(m=>m)),f(e,["contents"],p)}const a=l(t,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],nt(a));const u=l(t,["tools"]);if(e!==void 0&&u!=null){let p=u;Array.isArray(p)&&(p=p.map(m=>qE(m))),f(e,["tools"],p)}const d=l(t,["toolConfig"]);e!==void 0&&d!=null&&f(e,["toolConfig"],d);const h=l(t,["kmsKeyName"]);return e!==void 0&&h!=null&&f(e,["encryption_spec","kmsKeyName"],h),n}function SE(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["model"],C0(t,r));const s=l(e,["config"]);return s!=null&&wE(s,n),n}function bE(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["model"],C0(t,r));const s=l(e,["config"]);return s!=null&&_E(s,n),n}function kE(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],yn(t,r)),n}function EE(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],yn(t,r)),n}function TE(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function CE(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function NE(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function IE(t){const e={},n=l(t,["id"]);n!=null&&f(e,["id"],n);const r=l(t,["args"]);r!=null&&f(e,["args"],r);const s=l(t,["name"]);if(s!=null&&f(e,["name"],s),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function AE(t){const e={},n=l(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=l(t,["mode"]);if(r!=null&&f(e,["mode"],r),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function RE(t){const e={},n=l(t,["description"]);n!=null&&f(e,["description"],n);const r=l(t,["name"]);r!=null&&f(e,["name"],r);const s=l(t,["parameters"]);s!=null&&f(e,["parameters"],s);const o=l(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const i=l(t,["response"]);i!=null&&f(e,["response"],i);const a=l(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function PE(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],yn(t,r)),n}function ME(t,e){const n={},r=l(e,["name"]);return r!=null&&f(n,["_url","name"],yn(t,r)),n}function DE(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function LE(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function UE(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=l(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function jE(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=l(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function OE(t){const e={},n=l(t,["config"]);return n!=null&&UE(n,e),e}function FE(t){const e={},n=l(t,["config"]);return n!=null&&jE(n,e),e}function $E(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["cachedContents"],o)}return e}function GE(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["cachedContents"],o)}return e}function VE(t){const e={},n=l(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=l(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=l(t,["fileData"]);o!=null&&f(e,["fileData"],NE(o));const i=l(t,["functionCall"]);i!=null&&f(e,["functionCall"],IE(i));const a=l(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&f(e,["inlineData"],xE(u));const d=l(t,["text"]);d!=null&&f(e,["text"],d);const h=l(t,["thought"]);h!=null&&f(e,["thought"],h);const p=l(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=l(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function BE(t){const e={},n=l(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=l(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],AE(r)),e}function zE(t){const e={};if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=l(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=l(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=l(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=l(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],DE(i));const a=l(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],LE(a));const u=l(t,["googleSearchRetrieval"]);u!=null&&f(e,["googleSearchRetrieval"],u);const d=l(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function qE(t){const e={},n=l(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=l(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const o=l(t,["enterpriseWebSearch"]);o!=null&&f(e,["enterpriseWebSearch"],o);const i=l(t,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>RE(m))),f(e,["functionDeclarations"],p)}const a=l(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const u=l(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const d=l(t,["googleSearchRetrieval"]);d!=null&&f(e,["googleSearchRetrieval"],d);const h=l(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function HE(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=l(t,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),n}function WE(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&f(e,["ttl"],r);const s=l(t,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),n}function JE(t,e){const n={},r=l(e,["name"]);r!=null&&f(n,["_url","name"],yn(t,r));const s=l(e,["config"]);return s!=null&&HE(s,n),n}function KE(t,e){const n={},r=l(e,["name"]);r!=null&&f(n,["_url","name"],yn(t,r));const s=l(e,["config"]);return s!=null&&WE(s,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YE extends gn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new hr(hn.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=bE(this.apiClient,e);return a=G("cachedContents",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>h)}else{const d=SE(this.apiClient,e);return a=G("cachedContents",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async get(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=ME(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>h)}else{const d=PE(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=EE(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=CE(h),m=new Yh;return Object.assign(m,p),m})}else{const d=kE(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=TE(h),m=new Yh;return Object.assign(m,p),m})}}async update(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=KE(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>h)}else{const d=JE(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async listInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=FE(e);return a=G("cachedContents",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=GE(h),m=new Qh;return Object.assign(m,p),m})}else{const d=OE(e);return a=G("cachedContents",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=$E(h),m=new Qh;return Object.assign(m,p),m})}}}function Wi(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function sp(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function oe(t){return this instanceof oe?(this.v=t,this):new oe(t)}function qt(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(g){return function(x){return Promise.resolve(x).then(g,p)}}function a(g,x){r[g]&&(s[g]=function(_){return new Promise(function(S,v){o.push([g,_,S,v])>1||u(g,_)})},x&&(s[g]=x(s[g])))}function u(g,x){try{d(r[g](x))}catch(_){m(o[0][3],_)}}function d(g){g.value instanceof oe?Promise.resolve(g.value.v).then(h,p):m(o[0][2],g)}function h(g){u("next",g)}function p(g){u("throw",g)}function m(g,x){g(x),o.shift(),o.length&&u(o[0][0],o[0][1])}}function Ht(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof sp=="function"?sp(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(i){return new Promise(function(a,u){i=t[o](i),s(a,u,i.done,i.value)})}}function s(o,i,a,u){Promise.resolve(u).then(function(d){o({value:d,done:a})},i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QE(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:$0(n)}function $0(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function XE(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function op(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const s=[];let o=!0;for(;r<n&&t[r].role==="model";)s.push(t[r]),o&&!$0(t[r])&&(o=!1),r++;o?e.push(...s):e.pop()}return e}class ZE{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new eT(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class eT{constructor(e,n,r,s={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),XE(o)}async sendMessage(e){var n;await this.sendPromise;const r=nt(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,i,a;const u=await s,d=(i=(o=u.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content,h=u.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];h!=null&&(m=(a=h.slice(p))!==null&&a!==void 0?a:[]);const g=d?[d]:[];this.recordHistory(r,g,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var n;await this.sendPromise;const r=nt(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,r)}getHistory(e=!1){const n=e?op(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return qt(this,arguments,function*(){var s,o,i,a,u,d;const h=[];try{for(var p=!0,m=Ht(e),g;g=yield oe(m.next()),s=g.done,!s;p=!0){a=g.value,p=!1;const x=a;if(QE(x)){const _=(d=(u=x.candidates)===null||u===void 0?void 0:u[0])===null||d===void 0?void 0:d.content;_!==void 0&&h.push(_)}yield yield oe(x)}}catch(x){o={error:x}}finally{try{!p&&!s&&(i=m.return)&&(yield oe(i.call(m)))}finally{if(o)throw o.error}}this.recordHistory(n,h)})}recordHistory(e,n,r){let s=[];n.length>0&&n.every(o=>o.role!==void 0)?s=n:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...op(r)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wa extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,wa.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tT(t){const e={},n=l(t,["file"]);return n!=null&&f(e,["file"],n),e}function nT(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function rT(t){const e={},n=l(t,["name"]);return n!=null&&f(e,["_url","file"],M0(n)),e}function sT(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function oT(t){const e={},n=l(t,["name"]);return n!=null&&f(e,["_url","file"],M0(n)),e}function iT(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=l(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function aT(t){const e={},n=l(t,["config"]);return n!=null&&iT(n,e),e}function lT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["files"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uT extends gn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new hr(hn.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=aT(e);return o=G("files",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),s.then(u=>{const d=lT(u),h=new hk;return Object.assign(h,d),h})}}async createInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tT(e);return o=G("upload/v1beta/files",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>{const d=nT(u),h=new pk;return Object.assign(h,d),h})}}async get(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=oT(e);return o=G("files/{file}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>u)}}async delete(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=rT(e);return o=G("files/{file}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),s.then(u=>{const d=sT(u),h=new mk;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ui(t){const e={},n=l(t,["data"]);if(n!=null&&f(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function cT(t){const e={},n=l(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>TT(o))),f(e,["parts"],s)}const r=l(t,["role"]);return r!=null&&f(e,["role"],r),e}function dT(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function fT(t){const e={},n=l(t,["id"]);n!=null&&f(e,["id"],n);const r=l(t,["args"]);r!=null&&f(e,["args"],r);const s=l(t,["name"]);if(s!=null&&f(e,["name"],s),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function hT(t){const e={},n=l(t,["description"]);n!=null&&f(e,["description"],n);const r=l(t,["name"]);r!=null&&f(e,["name"],r);const s=l(t,["parameters"]);s!=null&&f(e,["parameters"],s);const o=l(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const i=l(t,["response"]);i!=null&&f(e,["response"],i);const a=l(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function pT(t){const e={},n=l(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=l(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const s=l(t,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const o=l(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const i=l(t,["enableAffectiveDialog"]);i!=null&&f(e,["enableAffectiveDialog"],i);const a=l(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const u=l(t,["logprobs"]);u!=null&&f(e,["logprobs"],u);const d=l(t,["maxOutputTokens"]);d!=null&&f(e,["maxOutputTokens"],d);const h=l(t,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=l(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=l(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const g=l(t,["responseMimeType"]);g!=null&&f(e,["responseMimeType"],g);const x=l(t,["responseModalities"]);x!=null&&f(e,["responseModalities"],x);const _=l(t,["responseSchema"]);_!=null&&f(e,["responseSchema"],_);const S=l(t,["routingConfig"]);S!=null&&f(e,["routingConfig"],S);const v=l(t,["seed"]);v!=null&&f(e,["seed"],v);const y=l(t,["speechConfig"]);y!=null&&f(e,["speechConfig"],y);const w=l(t,["stopSequences"]);w!=null&&f(e,["stopSequences"],w);const b=l(t,["temperature"]);b!=null&&f(e,["temperature"],b);const C=l(t,["thinkingConfig"]);C!=null&&f(e,["thinkingConfig"],C);const k=l(t,["topK"]);k!=null&&f(e,["topK"],k);const T=l(t,["topP"]);if(T!=null&&f(e,["topP"],T),l(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function mT(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function gT(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function yT(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const s=l(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const o=l(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const i=l(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=l(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const u=l(t,["maxOutputTokens"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","maxOutputTokens"],u);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],Xc(p));const m=l(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=l(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const x=l(t,["systemInstruction"]);e!==void 0&&x!=null&&f(e,["setup","systemInstruction"],cT(nt(x)));const _=l(t,["tools"]);if(e!==void 0&&_!=null){let k=cs(_);Array.isArray(k)&&(k=k.map(T=>NT(us(T)))),f(e,["setup","tools"],k)}const S=l(t,["sessionResumption"]);e!==void 0&&S!=null&&f(e,["setup","sessionResumption"],CT(S));const v=l(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const y=l(t,["outputAudioTranscription"]);e!==void 0&&y!=null&&f(e,["setup","outputAudioTranscription"],y);const w=l(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&f(e,["setup","realtimeInputConfig"],w);const b=l(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const C=l(t,["proactivity"]);if(e!==void 0&&C!=null&&f(e,["setup","proactivity"],C),l(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function vT(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],pT(r));const s=l(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const o=l(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const i=l(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=l(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const u=l(t,["maxOutputTokens"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","maxOutputTokens"],u);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],Xc(p));const m=l(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=l(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const x=l(t,["systemInstruction"]);e!==void 0&&x!=null&&f(e,["setup","systemInstruction"],nt(x));const _=l(t,["tools"]);if(e!==void 0&&_!=null){let T=cs(_);Array.isArray(T)&&(T=T.map(M=>IT(us(M)))),f(e,["setup","tools"],T)}const S=l(t,["sessionResumption"]);e!==void 0&&S!=null&&f(e,["setup","sessionResumption"],S);const v=l(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const y=l(t,["outputAudioTranscription"]);e!==void 0&&y!=null&&f(e,["setup","outputAudioTranscription"],y);const w=l(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&f(e,["setup","realtimeInputConfig"],w);const b=l(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const C=l(t,["proactivity"]);e!==void 0&&C!=null&&f(e,["setup","proactivity"],C);const k=l(t,["explicitVadSignal"]);return e!==void 0&&k!=null&&f(e,["setup","explicitVadSignal"],k),n}function xT(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["setup","model"],he(t,r));const s=l(e,["config"]);return s!=null&&f(n,["config"],yT(s,n)),n}function wT(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["setup","model"],he(t,r));const s=l(e,["config"]);return s!=null&&f(n,["config"],vT(s,n)),n}function _T(t){const e={},n=l(t,["musicGenerationConfig"]);return n!=null&&f(e,["musicGenerationConfig"],n),e}function ST(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["weightedPrompts"],r)}return e}function bT(t){const e={},n=l(t,["media"]);if(n!=null){let d=N0(n);Array.isArray(d)&&(d=d.map(h=>ui(h))),f(e,["mediaChunks"],d)}const r=l(t,["audio"]);r!=null&&f(e,["audio"],ui(A0(r)));const s=l(t,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const o=l(t,["video"]);o!=null&&f(e,["video"],ui(I0(o)));const i=l(t,["text"]);i!=null&&f(e,["text"],i);const a=l(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const u=l(t,["activityEnd"]);return u!=null&&f(e,["activityEnd"],u),e}function kT(t){const e={},n=l(t,["media"]);if(n!=null){let d=N0(n);Array.isArray(d)&&(d=d.map(h=>h)),f(e,["mediaChunks"],d)}const r=l(t,["audio"]);r!=null&&f(e,["audio"],A0(r));const s=l(t,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const o=l(t,["video"]);o!=null&&f(e,["video"],I0(o));const i=l(t,["text"]);i!=null&&f(e,["text"],i);const a=l(t,["activityStart"]);a!=null&&f(e,["activityStart"],a);const u=l(t,["activityEnd"]);return u!=null&&f(e,["activityEnd"],u),e}function ET(t){const e={},n=l(t,["setupComplete"]);n!=null&&f(e,["setupComplete"],n);const r=l(t,["serverContent"]);r!=null&&f(e,["serverContent"],r);const s=l(t,["toolCall"]);s!=null&&f(e,["toolCall"],s);const o=l(t,["toolCallCancellation"]);o!=null&&f(e,["toolCallCancellation"],o);const i=l(t,["usageMetadata"]);i!=null&&f(e,["usageMetadata"],AT(i));const a=l(t,["goAway"]);a!=null&&f(e,["goAway"],a);const u=l(t,["sessionResumptionUpdate"]);u!=null&&f(e,["sessionResumptionUpdate"],u);const d=l(t,["voiceActivityDetectionSignal"]);return d!=null&&f(e,["voiceActivityDetectionSignal"],d),e}function TT(t){const e={},n=l(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=l(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=l(t,["fileData"]);o!=null&&f(e,["fileData"],dT(o));const i=l(t,["functionCall"]);i!=null&&f(e,["functionCall"],fT(i));const a=l(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&f(e,["inlineData"],ui(u));const d=l(t,["text"]);d!=null&&f(e,["text"],d);const h=l(t,["thought"]);h!=null&&f(e,["thought"],h);const p=l(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=l(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function CT(t){const e={},n=l(t,["handle"]);if(n!=null&&f(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function NT(t){const e={};if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=l(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=l(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=l(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=l(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],mT(i));const a=l(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],gT(a));const u=l(t,["googleSearchRetrieval"]);u!=null&&f(e,["googleSearchRetrieval"],u);const d=l(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function IT(t){const e={},n=l(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=l(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const o=l(t,["enterpriseWebSearch"]);o!=null&&f(e,["enterpriseWebSearch"],o);const i=l(t,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>hT(m))),f(e,["functionDeclarations"],p)}const a=l(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const u=l(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const d=l(t,["googleSearchRetrieval"]);d!=null&&f(e,["googleSearchRetrieval"],d);const h=l(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function AT(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&f(e,["promptTokenCount"],n);const r=l(t,["cachedContentTokenCount"]);r!=null&&f(e,["cachedContentTokenCount"],r);const s=l(t,["candidatesTokenCount"]);s!=null&&f(e,["responseTokenCount"],s);const o=l(t,["toolUsePromptTokenCount"]);o!=null&&f(e,["toolUsePromptTokenCount"],o);const i=l(t,["thoughtsTokenCount"]);i!=null&&f(e,["thoughtsTokenCount"],i);const a=l(t,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const u=l(t,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>x)),f(e,["promptTokensDetails"],g)}const d=l(t,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(x=>x)),f(e,["cacheTokensDetails"],g)}const h=l(t,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(x=>x)),f(e,["responseTokensDetails"],g)}const p=l(t,["toolUsePromptTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(x=>x)),f(e,["toolUsePromptTokensDetails"],g)}const m=l(t,["trafficType"]);return m!=null&&f(e,["trafficType"],m),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RT(t){const e={},n=l(t,["data"]);if(n!=null&&f(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function PT(t){const e={},n=l(t,["content"]);n!=null&&f(e,["content"],n);const r=l(t,["citationMetadata"]);r!=null&&f(e,["citationMetadata"],MT(r));const s=l(t,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const o=l(t,["finishReason"]);o!=null&&f(e,["finishReason"],o);const i=l(t,["avgLogprobs"]);i!=null&&f(e,["avgLogprobs"],i);const a=l(t,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const u=l(t,["index"]);u!=null&&f(e,["index"],u);const d=l(t,["logprobsResult"]);d!=null&&f(e,["logprobsResult"],d);const h=l(t,["safetyRatings"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>g)),f(e,["safetyRatings"],m)}const p=l(t,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function MT(t){const e={},n=l(t,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),f(e,["citations"],r)}return e}function DT(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let o=At(s);Array.isArray(o)&&(o=o.map(i=>i)),f(n,["contents"],o)}return n}function LT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["tokensInfo"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["tokensInfo"],s)}return e}function UT(t){const e={},n=l(t,["values"]);n!=null&&f(e,["values"],n);const r=l(t,["statistics"]);return r!=null&&f(e,["statistics"],jT(r)),e}function jT(t){const e={},n=l(t,["truncated"]);n!=null&&f(e,["truncated"],n);const r=l(t,["token_count"]);return r!=null&&f(e,["tokenCount"],r),e}function _a(t){const e={},n=l(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>HC(o))),f(e,["parts"],s)}const r=l(t,["role"]);return r!=null&&f(e,["role"],r),e}function OT(t){const e={},n=l(t,["controlType"]);n!=null&&f(e,["controlType"],n);const r=l(t,["enableControlImageComputation"]);return r!=null&&f(e,["computeControl"],r),e}function FT(t){const e={};if(l(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function $T(t,e){const n={},r=l(t,["systemInstruction"]);e!==void 0&&r!=null&&f(e,["systemInstruction"],nt(r));const s=l(t,["tools"]);if(e!==void 0&&s!=null){let i=s;Array.isArray(i)&&(i=i.map(a=>z0(a))),f(e,["tools"],i)}const o=l(t,["generationConfig"]);return e!==void 0&&o!=null&&f(e,["generationConfig"],RC(o)),n}function GT(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let i=At(s);Array.isArray(i)&&(i=i.map(a=>_a(a))),f(n,["contents"],i)}const o=l(e,["config"]);return o!=null&&FT(o),n}function VT(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let i=At(s);Array.isArray(i)&&(i=i.map(a=>a)),f(n,["contents"],i)}const o=l(e,["config"]);return o!=null&&$T(o,n),n}function BT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);r!=null&&f(e,["totalTokens"],r);const s=l(t,["cachedContentTokenCount"]);return s!=null&&f(e,["cachedContentTokenCount"],s),e}function zT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);return r!=null&&f(e,["totalTokens"],r),e}function qT(t,e){const n={},r=l(e,["model"]);return r!=null&&f(n,["_url","name"],he(t,r)),n}function HT(t,e){const n={},r=l(e,["model"]);return r!=null&&f(n,["_url","name"],he(t,r)),n}function WT(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function JT(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}function KT(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=l(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const i=l(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const u=l(t,["seed"]);e!==void 0&&u!=null&&f(e,["parameters","seed"],u);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&f(e,["parameters","safetySetting"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=l(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const g=l(t,["language"]);e!==void 0&&g!=null&&f(e,["parameters","language"],g);const x=l(t,["outputMimeType"]);e!==void 0&&x!=null&&f(e,["parameters","outputOptions","mimeType"],x);const _=l(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&f(e,["parameters","outputOptions","compressionQuality"],_);const S=l(t,["addWatermark"]);e!==void 0&&S!=null&&f(e,["parameters","addWatermark"],S);const v=l(t,["labels"]);e!==void 0&&v!=null&&f(e,["labels"],v);const y=l(t,["editMode"]);e!==void 0&&y!=null&&f(e,["parameters","editMode"],y);const w=l(t,["baseSteps"]);return e!==void 0&&w!=null&&f(e,["parameters","editConfig","baseSteps"],w),n}function YT(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=l(e,["referenceImages"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>XC(u))),f(n,["instances[0]","referenceImages"],a)}const i=l(e,["config"]);return i!=null&&KT(i,n),n}function QT(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Sa(o))),f(e,["generatedImages"],s)}return e}function XT(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&f(e,["requests[]","taskType"],r);const s=l(t,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&f(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function ZT(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&f(e,["instances[]","task_type"],r);const s=l(t,["title"]);e!==void 0&&s!=null&&f(e,["instances[]","title"],s);const o=l(t,["outputDimensionality"]);e!==void 0&&o!=null&&f(e,["parameters","outputDimensionality"],o);const i=l(t,["mimeType"]);e!==void 0&&i!=null&&f(e,["instances[]","mimeType"],i);const a=l(t,["autoTruncate"]);return e!==void 0&&a!=null&&f(e,["parameters","autoTruncate"],a),n}function eC(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let a=Kc(t,s);Array.isArray(a)&&(a=a.map(u=>u)),f(n,["requests[]","content"],a)}const o=l(e,["config"]);o!=null&&XT(o,n);const i=l(e,["model"]);return i!==void 0&&f(n,["requests[]","model"],he(t,i)),n}function tC(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let i=Kc(t,s);Array.isArray(i)&&(i=i.map(a=>a)),f(n,["instances[]","content"],i)}const o=l(e,["config"]);return o!=null&&ZT(o,n),n}function nC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["embeddings"],o)}const s=l(t,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function rC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>UT(i))),f(e,["embeddings"],o)}const s=l(t,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function sC(t){const e={},n=l(t,["endpoint"]);n!=null&&f(e,["name"],n);const r=l(t,["deployedModelId"]);return r!=null&&f(e,["deployedModelId"],r),e}function oC(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function iC(t){const e={},n=l(t,["id"]);n!=null&&f(e,["id"],n);const r=l(t,["args"]);r!=null&&f(e,["args"],r);const s=l(t,["name"]);if(s!=null&&f(e,["name"],s),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function aC(t){const e={},n=l(t,["allowedFunctionNames"]);n!=null&&f(e,["allowedFunctionNames"],n);const r=l(t,["mode"]);if(r!=null&&f(e,["mode"],r),l(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function lC(t){const e={},n=l(t,["description"]);n!=null&&f(e,["description"],n);const r=l(t,["name"]);r!=null&&f(e,["name"],r);const s=l(t,["parameters"]);s!=null&&f(e,["parameters"],s);const o=l(t,["parametersJsonSchema"]);o!=null&&f(e,["parametersJsonSchema"],o);const i=l(t,["response"]);i!=null&&f(e,["response"],i);const a=l(t,["responseJsonSchema"]);if(a!=null&&f(e,["responseJsonSchema"],a),l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function uC(t,e,n){const r={},s=l(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],_a(nt(s)));const o=l(e,["temperature"]);o!=null&&f(r,["temperature"],o);const i=l(e,["topP"]);i!=null&&f(r,["topP"],i);const a=l(e,["topK"]);a!=null&&f(r,["topK"],a);const u=l(e,["candidateCount"]);u!=null&&f(r,["candidateCount"],u);const d=l(e,["maxOutputTokens"]);d!=null&&f(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=l(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const x=l(e,["frequencyPenalty"]);x!=null&&f(r,["frequencyPenalty"],x);const _=l(e,["seed"]);_!=null&&f(r,["seed"],_);const S=l(e,["responseMimeType"]);S!=null&&f(r,["responseMimeType"],S);const v=l(e,["responseSchema"]);v!=null&&f(r,["responseSchema"],Yc(v));const y=l(e,["responseJsonSchema"]);if(y!=null&&f(r,["responseJsonSchema"],y),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=l(e,["safetySettings"]);if(n!==void 0&&w!=null){let se=w;Array.isArray(se)&&(se=se.map(N=>ZC(N))),f(n,["safetySettings"],se)}const b=l(e,["tools"]);if(n!==void 0&&b!=null){let se=cs(b);Array.isArray(se)&&(se=se.map(N=>i1(us(N)))),f(n,["tools"],se)}const C=l(e,["toolConfig"]);if(n!==void 0&&C!=null&&f(n,["toolConfig"],o1(C)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=l(e,["cachedContent"]);n!==void 0&&k!=null&&f(n,["cachedContent"],yn(t,k));const T=l(e,["responseModalities"]);T!=null&&f(r,["responseModalities"],T);const M=l(e,["mediaResolution"]);M!=null&&f(r,["mediaResolution"],M);const R=l(e,["speechConfig"]);if(R!=null&&f(r,["speechConfig"],Qc(R)),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=l(e,["thinkingConfig"]);U!=null&&f(r,["thinkingConfig"],U);const X=l(e,["imageConfig"]);X!=null&&f(r,["imageConfig"],UC(X));const ye=l(e,["enableEnhancedCivicAnswers"]);return ye!=null&&f(r,["enableEnhancedCivicAnswers"],ye),r}function cC(t,e,n){const r={},s=l(e,["systemInstruction"]);n!==void 0&&s!=null&&f(n,["systemInstruction"],nt(s));const o=l(e,["temperature"]);o!=null&&f(r,["temperature"],o);const i=l(e,["topP"]);i!=null&&f(r,["topP"],i);const a=l(e,["topK"]);a!=null&&f(r,["topK"],a);const u=l(e,["candidateCount"]);u!=null&&f(r,["candidateCount"],u);const d=l(e,["maxOutputTokens"]);d!=null&&f(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&f(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&f(r,["logprobs"],m);const g=l(e,["presencePenalty"]);g!=null&&f(r,["presencePenalty"],g);const x=l(e,["frequencyPenalty"]);x!=null&&f(r,["frequencyPenalty"],x);const _=l(e,["seed"]);_!=null&&f(r,["seed"],_);const S=l(e,["responseMimeType"]);S!=null&&f(r,["responseMimeType"],S);const v=l(e,["responseSchema"]);v!=null&&f(r,["responseSchema"],Yc(v));const y=l(e,["responseJsonSchema"]);y!=null&&f(r,["responseJsonSchema"],y);const w=l(e,["routingConfig"]);w!=null&&f(r,["routingConfig"],w);const b=l(e,["modelSelectionConfig"]);b!=null&&f(r,["modelConfig"],b);const C=l(e,["safetySettings"]);if(n!==void 0&&C!=null){let z=C;Array.isArray(z)&&(z=z.map(Q=>Q)),f(n,["safetySettings"],z)}const k=l(e,["tools"]);if(n!==void 0&&k!=null){let z=cs(k);Array.isArray(z)&&(z=z.map(Q=>z0(us(Q)))),f(n,["tools"],z)}const T=l(e,["toolConfig"]);n!==void 0&&T!=null&&f(n,["toolConfig"],T);const M=l(e,["labels"]);n!==void 0&&M!=null&&f(n,["labels"],M);const R=l(e,["cachedContent"]);n!==void 0&&R!=null&&f(n,["cachedContent"],yn(t,R));const U=l(e,["responseModalities"]);U!=null&&f(r,["responseModalities"],U);const X=l(e,["mediaResolution"]);X!=null&&f(r,["mediaResolution"],X);const ye=l(e,["speechConfig"]);ye!=null&&f(r,["speechConfig"],Qc(ye));const se=l(e,["audioTimestamp"]);se!=null&&f(r,["audioTimestamp"],se);const N=l(e,["thinkingConfig"]);N!=null&&f(r,["thinkingConfig"],N);const V=l(e,["imageConfig"]);if(V!=null&&f(r,["imageConfig"],jC(V)),l(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return r}function ip(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let i=At(s);Array.isArray(i)&&(i=i.map(a=>_a(a))),f(n,["contents"],i)}const o=l(e,["config"]);return o!=null&&f(n,["generationConfig"],uC(t,o,n)),n}function ap(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["contents"]);if(s!=null){let i=At(s);Array.isArray(i)&&(i=i.map(a=>a)),f(n,["contents"],i)}const o=l(e,["config"]);return o!=null&&f(n,["generationConfig"],cC(t,o,n)),n}function lp(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>PT(d))),f(e,["candidates"],u)}const s=l(t,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const o=l(t,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const i=l(t,["responseId"]);i!=null&&f(e,["responseId"],i);const a=l(t,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function up(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>h)),f(e,["candidates"],d)}const s=l(t,["createTime"]);s!=null&&f(e,["createTime"],s);const o=l(t,["modelVersion"]);o!=null&&f(e,["modelVersion"],o);const i=l(t,["promptFeedback"]);i!=null&&f(e,["promptFeedback"],i);const a=l(t,["responseId"]);a!=null&&f(e,["responseId"],a);const u=l(t,["usageMetadata"]);return u!=null&&f(e,["usageMetadata"],u),e}function dC(t,e){const n={};if(l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const o=l(t,["guidanceScale"]);if(e!==void 0&&o!=null&&f(e,["parameters","guidanceScale"],o),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=l(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&f(e,["parameters","safetySetting"],i);const a=l(t,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const u=l(t,["includeSafetyAttributes"]);e!==void 0&&u!=null&&f(e,["parameters","includeSafetyAttributes"],u);const d=l(t,["includeRaiReason"]);e!==void 0&&d!=null&&f(e,["parameters","includeRaiReason"],d);const h=l(t,["language"]);e!==void 0&&h!=null&&f(e,["parameters","language"],h);const p=l(t,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const m=l(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&f(e,["parameters","outputOptions","compressionQuality"],m),l(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=l(t,["imageSize"]);if(e!==void 0&&g!=null&&f(e,["parameters","sampleImageSize"],g),l(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function fC(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=l(t,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&f(e,["parameters","sampleCount"],o);const i=l(t,["aspectRatio"]);e!==void 0&&i!=null&&f(e,["parameters","aspectRatio"],i);const a=l(t,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const u=l(t,["seed"]);e!==void 0&&u!=null&&f(e,["parameters","seed"],u);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&f(e,["parameters","safetySetting"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const m=l(t,["includeRaiReason"]);e!==void 0&&m!=null&&f(e,["parameters","includeRaiReason"],m);const g=l(t,["language"]);e!==void 0&&g!=null&&f(e,["parameters","language"],g);const x=l(t,["outputMimeType"]);e!==void 0&&x!=null&&f(e,["parameters","outputOptions","mimeType"],x);const _=l(t,["outputCompressionQuality"]);e!==void 0&&_!=null&&f(e,["parameters","outputOptions","compressionQuality"],_);const S=l(t,["addWatermark"]);e!==void 0&&S!=null&&f(e,["parameters","addWatermark"],S);const v=l(t,["labels"]);e!==void 0&&v!=null&&f(e,["labels"],v);const y=l(t,["imageSize"]);e!==void 0&&y!=null&&f(e,["parameters","sampleImageSize"],y);const w=l(t,["enhancePrompt"]);return e!==void 0&&w!=null&&f(e,["parameters","enhancePrompt"],w),n}function hC(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=l(e,["config"]);return o!=null&&dC(o,n),n}function pC(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=l(e,["config"]);return o!=null&&fC(o,n),n}function mC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>CC(i))),f(e,["generatedImages"],o)}const s=l(t,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],V0(s)),e}function gC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>Sa(i))),f(e,["generatedImages"],o)}const s=l(t,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],B0(s)),e}function yC(t,e){const n={},r=l(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r),l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=l(t,["durationSeconds"]);if(e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=l(t,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const i=l(t,["resolution"]);e!==void 0&&i!=null&&f(e,["parameters","resolution"],i);const a=l(t,["personGeneration"]);if(e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a),l(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=l(t,["negativePrompt"]);e!==void 0&&u!=null&&f(e,["parameters","negativePrompt"],u);const d=l(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&f(e,["parameters","enhancePrompt"],d),l(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const h=l(t,["lastFrame"]);e!==void 0&&h!=null&&f(e,["instances[0]","lastFrame"],ba(h));const p=l(t,["referenceImages"]);if(e!==void 0&&p!=null){let m=p;Array.isArray(m)&&(m=m.map(g=>x1(g))),f(e,["instances[0]","referenceImages"],m)}if(l(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(l(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function vC(t,e){const n={},r=l(t,["numberOfVideos"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=l(t,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const o=l(t,["fps"]);e!==void 0&&o!=null&&f(e,["parameters","fps"],o);const i=l(t,["durationSeconds"]);e!==void 0&&i!=null&&f(e,["parameters","durationSeconds"],i);const a=l(t,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const u=l(t,["aspectRatio"]);e!==void 0&&u!=null&&f(e,["parameters","aspectRatio"],u);const d=l(t,["resolution"]);e!==void 0&&d!=null&&f(e,["parameters","resolution"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=l(t,["pubsubTopic"]);e!==void 0&&p!=null&&f(e,["parameters","pubsubTopic"],p);const m=l(t,["negativePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","negativePrompt"],m);const g=l(t,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const x=l(t,["generateAudio"]);e!==void 0&&x!=null&&f(e,["parameters","generateAudio"],x);const _=l(t,["lastFrame"]);e!==void 0&&_!=null&&f(e,["instances[0]","lastFrame"],Kt(_));const S=l(t,["referenceImages"]);if(e!==void 0&&S!=null){let w=S;Array.isArray(w)&&(w=w.map(b=>w1(b))),f(e,["instances[0]","referenceImages"],w)}const v=l(t,["mask"]);e!==void 0&&v!=null&&f(e,["instances[0]","mask"],v1(v));const y=l(t,["compressionQuality"]);return e!==void 0&&y!=null&&f(e,["parameters","compressionQuality"],y),n}function xC(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["response","generateVideoResponse"]);return i!=null&&f(e,["response"],bC(i)),e}function wC(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["response"]);return i!=null&&f(e,["response"],kC(i)),e}function _C(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=l(e,["image"]);o!=null&&f(n,["instances[0]","image"],ba(o));const i=l(e,["video"]);i!=null&&f(n,["instances[0]","video"],q0(i));const a=l(e,["source"]);a!=null&&EC(a,n);const u=l(e,["config"]);return u!=null&&yC(u,n),n}function SC(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["prompt"]);s!=null&&f(n,["instances[0]","prompt"],s);const o=l(e,["image"]);o!=null&&f(n,["instances[0]","image"],Kt(o));const i=l(e,["video"]);i!=null&&f(n,["instances[0]","video"],H0(i));const a=l(e,["source"]);a!=null&&TC(a,n);const u=l(e,["config"]);return u!=null&&vC(u,n),n}function bC(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>IC(i))),f(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=l(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function kC(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(i=>AC(i))),f(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&f(e,["raiMediaFilteredCount"],r);const s=l(t,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function EC(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=l(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],ba(s));const o=l(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],q0(o)),n}function TC(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=l(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Kt(s));const o=l(t,["video"]);return e!==void 0&&o!=null&&f(e,["instances[0]","video"],H0(o)),n}function CC(t){const e={},n=l(t,["_self"]);n!=null&&f(e,["image"],OC(n));const r=l(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const s=l(t,["_self"]);return s!=null&&f(e,["safetyAttributes"],V0(s)),e}function Sa(t){const e={},n=l(t,["_self"]);n!=null&&f(e,["image"],G0(n));const r=l(t,["raiFilteredReason"]);r!=null&&f(e,["raiFilteredReason"],r);const s=l(t,["_self"]);s!=null&&f(e,["safetyAttributes"],B0(s));const o=l(t,["prompt"]);return o!=null&&f(e,["enhancedPrompt"],o),e}function NC(t){const e={},n=l(t,["_self"]);n!=null&&f(e,["mask"],G0(n));const r=l(t,["labels"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(e,["labels"],s)}return e}function IC(t){const e={},n=l(t,["video"]);return n!=null&&f(e,["video"],g1(n)),e}function AC(t){const e={},n=l(t,["_self"]);return n!=null&&f(e,["video"],y1(n)),e}function RC(t){const e={},n=l(t,["modelSelectionConfig"]);n!=null&&f(e,["modelConfig"],n);const r=l(t,["responseJsonSchema"]);r!=null&&f(e,["responseJsonSchema"],r);const s=l(t,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const o=l(t,["candidateCount"]);o!=null&&f(e,["candidateCount"],o);const i=l(t,["enableAffectiveDialog"]);i!=null&&f(e,["enableAffectiveDialog"],i);const a=l(t,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const u=l(t,["logprobs"]);u!=null&&f(e,["logprobs"],u);const d=l(t,["maxOutputTokens"]);d!=null&&f(e,["maxOutputTokens"],d);const h=l(t,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=l(t,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const m=l(t,["responseLogprobs"]);m!=null&&f(e,["responseLogprobs"],m);const g=l(t,["responseMimeType"]);g!=null&&f(e,["responseMimeType"],g);const x=l(t,["responseModalities"]);x!=null&&f(e,["responseModalities"],x);const _=l(t,["responseSchema"]);_!=null&&f(e,["responseSchema"],_);const S=l(t,["routingConfig"]);S!=null&&f(e,["routingConfig"],S);const v=l(t,["seed"]);v!=null&&f(e,["seed"],v);const y=l(t,["speechConfig"]);y!=null&&f(e,["speechConfig"],y);const w=l(t,["stopSequences"]);w!=null&&f(e,["stopSequences"],w);const b=l(t,["temperature"]);b!=null&&f(e,["temperature"],b);const C=l(t,["thinkingConfig"]);C!=null&&f(e,["thinkingConfig"],C);const k=l(t,["topK"]);k!=null&&f(e,["topK"],k);const T=l(t,["topP"]);if(T!=null&&f(e,["topP"],T),l(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function PC(t,e){const n={},r=l(e,["model"]);return r!=null&&f(n,["_url","name"],he(t,r)),n}function MC(t,e){const n={},r=l(e,["model"]);return r!=null&&f(n,["_url","name"],he(t,r)),n}function DC(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function LC(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function UC(t){const e={},n=l(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=l(t,["imageSize"]);if(r!=null&&f(e,["imageSize"],r),l(t,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(l(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(l(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function jC(t){const e={},n=l(t,["aspectRatio"]);n!=null&&f(e,["aspectRatio"],n);const r=l(t,["imageSize"]);r!=null&&f(e,["imageSize"],r);const s=l(t,["personGeneration"]);s!=null&&f(e,["personGeneration"],s);const o=l(t,["outputMimeType"]);o!=null&&f(e,["imageOutputOptions","mimeType"],o);const i=l(t,["outputCompressionQuality"]);return i!=null&&f(e,["imageOutputOptions","compressionQuality"],i),e}function OC(t){const e={},n=l(t,["bytesBase64Encoded"]);n!=null&&f(e,["imageBytes"],$n(n));const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function G0(t){const e={},n=l(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&f(e,["imageBytes"],$n(r));const s=l(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function ba(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=l(t,["imageBytes"]);n!=null&&f(e,["bytesBase64Encoded"],$n(n));const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function Kt(t){const e={},n=l(t,["gcsUri"]);n!=null&&f(e,["gcsUri"],n);const r=l(t,["imageBytes"]);r!=null&&f(e,["bytesBase64Encoded"],$n(r));const s=l(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function FC(t,e,n){const r={},s=l(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const i=l(e,["filter"]);n!==void 0&&i!=null&&f(n,["_query","filter"],i);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],D0(t,a)),r}function $C(t,e,n){const r={},s=l(e,["pageSize"]);n!==void 0&&s!=null&&f(n,["_query","pageSize"],s);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&f(n,["_query","pageToken"],o);const i=l(e,["filter"]);n!==void 0&&i!=null&&f(n,["_query","filter"],i);const a=l(e,["queryBase"]);return n!==void 0&&a!=null&&f(n,["_url","models_url"],D0(t,a)),r}function GC(t,e){const n={},r=l(e,["config"]);return r!=null&&FC(t,r,n),n}function VC(t,e){const n={},r=l(e,["config"]);return r!=null&&$C(t,r,n),n}function BC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["_self"]);if(s!=null){let o=L0(s);Array.isArray(o)&&(o=o.map(i=>Cu(i))),f(e,["models"],o)}return e}function zC(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["_self"]);if(s!=null){let o=L0(s);Array.isArray(o)&&(o=o.map(i=>Nu(i))),f(e,["models"],o)}return e}function qC(t){const e={},n=l(t,["maskMode"]);n!=null&&f(e,["maskMode"],n);const r=l(t,["segmentationClasses"]);r!=null&&f(e,["maskClasses"],r);const s=l(t,["maskDilation"]);return s!=null&&f(e,["dilation"],s),e}function Cu(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=l(t,["description"]);s!=null&&f(e,["description"],s);const o=l(t,["version"]);o!=null&&f(e,["version"],o);const i=l(t,["_self"]);i!=null&&f(e,["tunedModelInfo"],a1(i));const a=l(t,["inputTokenLimit"]);a!=null&&f(e,["inputTokenLimit"],a);const u=l(t,["outputTokenLimit"]);u!=null&&f(e,["outputTokenLimit"],u);const d=l(t,["supportedGenerationMethods"]);d!=null&&f(e,["supportedActions"],d);const h=l(t,["temperature"]);h!=null&&f(e,["temperature"],h);const p=l(t,["maxTemperature"]);p!=null&&f(e,["maxTemperature"],p);const m=l(t,["topP"]);m!=null&&f(e,["topP"],m);const g=l(t,["topK"]);g!=null&&f(e,["topK"],g);const x=l(t,["thinking"]);return x!=null&&f(e,["thinking"],x),e}function Nu(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["displayName"]);r!=null&&f(e,["displayName"],r);const s=l(t,["description"]);s!=null&&f(e,["description"],s);const o=l(t,["versionId"]);o!=null&&f(e,["version"],o);const i=l(t,["deployedModels"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>sC(m))),f(e,["endpoints"],p)}const a=l(t,["labels"]);a!=null&&f(e,["labels"],a);const u=l(t,["_self"]);u!=null&&f(e,["tunedModelInfo"],l1(u));const d=l(t,["defaultCheckpointId"]);d!=null&&f(e,["defaultCheckpointId"],d);const h=l(t,["checkpoints"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>m)),f(e,["checkpoints"],p)}return e}function HC(t){const e={},n=l(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=l(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=l(t,["fileData"]);o!=null&&f(e,["fileData"],oC(o));const i=l(t,["functionCall"]);i!=null&&f(e,["functionCall"],iC(i));const a=l(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&f(e,["inlineData"],RT(u));const d=l(t,["text"]);d!=null&&f(e,["text"],d);const h=l(t,["thought"]);h!=null&&f(e,["thought"],h);const p=l(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=l(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function WC(t){const e={},n=l(t,["productImage"]);return n!=null&&f(e,["image"],Kt(n)),e}function JC(t,e){const n={},r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const s=l(t,["baseSteps"]);e!==void 0&&s!=null&&f(e,["parameters","baseSteps"],s);const o=l(t,["outputGcsUri"]);e!==void 0&&o!=null&&f(e,["parameters","storageUri"],o);const i=l(t,["seed"]);e!==void 0&&i!=null&&f(e,["parameters","seed"],i);const a=l(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const u=l(t,["personGeneration"]);e!==void 0&&u!=null&&f(e,["parameters","personGeneration"],u);const d=l(t,["addWatermark"]);e!==void 0&&d!=null&&f(e,["parameters","addWatermark"],d);const h=l(t,["outputMimeType"]);e!==void 0&&h!=null&&f(e,["parameters","outputOptions","mimeType"],h);const p=l(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","compressionQuality"],p);const m=l(t,["enhancePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m);const g=l(t,["labels"]);return e!==void 0&&g!=null&&f(e,["labels"],g),n}function KC(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["source"]);s!=null&&QC(s,n);const o=l(e,["config"]);return o!=null&&JC(o,n),n}function YC(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>Sa(s))),f(e,["generatedImages"],r)}return e}function QC(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=l(t,["personImage"]);e!==void 0&&s!=null&&f(e,["instances[0]","personImage","image"],Kt(s));const o=l(t,["productImages"]);if(e!==void 0&&o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>WC(a))),f(e,["instances[0]","productImages"],i)}return n}function XC(t){const e={},n=l(t,["referenceImage"]);n!=null&&f(e,["referenceImage"],Kt(n));const r=l(t,["referenceId"]);r!=null&&f(e,["referenceId"],r);const s=l(t,["referenceType"]);s!=null&&f(e,["referenceType"],s);const o=l(t,["maskImageConfig"]);o!=null&&f(e,["maskImageConfig"],qC(o));const i=l(t,["controlImageConfig"]);i!=null&&f(e,["controlImageConfig"],OT(i));const a=l(t,["styleImageConfig"]);a!=null&&f(e,["styleImageConfig"],a);const u=l(t,["subjectImageConfig"]);return u!=null&&f(e,["subjectImageConfig"],u),e}function V0(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const s=l(t,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function B0(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&f(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&f(e,["scores"],r);const s=l(t,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function ZC(t){const e={},n=l(t,["category"]);if(n!=null&&f(e,["category"],n),l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=l(t,["threshold"]);return r!=null&&f(e,["threshold"],r),e}function e1(t){const e={},n=l(t,["image"]);return n!=null&&f(e,["image"],Kt(n)),e}function t1(t,e){const n={},r=l(t,["mode"]);e!==void 0&&r!=null&&f(e,["parameters","mode"],r);const s=l(t,["maxPredictions"]);e!==void 0&&s!=null&&f(e,["parameters","maxPredictions"],s);const o=l(t,["confidenceThreshold"]);e!==void 0&&o!=null&&f(e,["parameters","confidenceThreshold"],o);const i=l(t,["maskDilation"]);e!==void 0&&i!=null&&f(e,["parameters","maskDilation"],i);const a=l(t,["binaryColorThreshold"]);e!==void 0&&a!=null&&f(e,["parameters","binaryColorThreshold"],a);const u=l(t,["labels"]);return e!==void 0&&u!=null&&f(e,["labels"],u),n}function n1(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["source"]);s!=null&&s1(s,n);const o=l(e,["config"]);return o!=null&&t1(o,n),n}function r1(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>NC(s))),f(e,["generatedMasks"],r)}return e}function s1(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&f(e,["instances[0]","prompt"],r);const s=l(t,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Kt(s));const o=l(t,["scribbleImage"]);return e!==void 0&&o!=null&&f(e,["instances[0]","scribble"],e1(o)),n}function o1(t){const e={},n=l(t,["retrievalConfig"]);n!=null&&f(e,["retrievalConfig"],n);const r=l(t,["functionCallingConfig"]);return r!=null&&f(e,["functionCallingConfig"],aC(r)),e}function i1(t){const e={};if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=l(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=l(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=l(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=l(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],DC(i));const a=l(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],LC(a));const u=l(t,["googleSearchRetrieval"]);u!=null&&f(e,["googleSearchRetrieval"],u);const d=l(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}function z0(t){const e={},n=l(t,["retrieval"]);n!=null&&f(e,["retrieval"],n);const r=l(t,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),l(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=l(t,["codeExecution"]);s!=null&&f(e,["codeExecution"],s);const o=l(t,["enterpriseWebSearch"]);o!=null&&f(e,["enterpriseWebSearch"],o);const i=l(t,["functionDeclarations"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(m=>lC(m))),f(e,["functionDeclarations"],p)}const a=l(t,["googleMaps"]);a!=null&&f(e,["googleMaps"],a);const u=l(t,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const d=l(t,["googleSearchRetrieval"]);d!=null&&f(e,["googleSearchRetrieval"],d);const h=l(t,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function a1(t){const e={},n=l(t,["baseModel"]);n!=null&&f(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&f(e,["createTime"],r);const s=l(t,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function l1(t){const e={},n=l(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&f(e,["createTime"],r);const s=l(t,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function u1(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=l(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function c1(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const s=l(t,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&f(e,["defaultCheckpointId"],o),n}function d1(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","name"],he(t,r));const s=l(e,["config"]);return s!=null&&u1(s,n),n}function f1(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["config"]);return s!=null&&c1(s,n),n}function h1(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const s=l(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const o=l(t,["personGeneration"]);e!==void 0&&o!=null&&f(e,["parameters","personGeneration"],o);const i=l(t,["includeRaiReason"]);e!==void 0&&i!=null&&f(e,["parameters","includeRaiReason"],i);const a=l(t,["outputMimeType"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","mimeType"],a);const u=l(t,["outputCompressionQuality"]);e!==void 0&&u!=null&&f(e,["parameters","outputOptions","compressionQuality"],u);const d=l(t,["enhanceInputImage"]);e!==void 0&&d!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],d);const h=l(t,["imagePreservationFactor"]);e!==void 0&&h!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const p=l(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=l(t,["numberOfImages"]);e!==void 0&&m!=null&&f(e,["parameters","sampleCount"],m);const g=l(t,["mode"]);return e!==void 0&&g!=null&&f(e,["parameters","mode"],g),n}function p1(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["_url","model"],he(t,r));const s=l(e,["image"]);s!=null&&f(n,["instances[0]","image"],Kt(s));const o=l(e,["upscaleFactor"]);o!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],o);const i=l(e,["config"]);return i!=null&&h1(i,n),n}function m1(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Sa(o))),f(e,["generatedImages"],s)}return e}function g1(t){const e={},n=l(t,["uri"]);n!=null&&f(e,["uri"],n);const r=l(t,["encodedVideo"]);r!=null&&f(e,["videoBytes"],$n(r));const s=l(t,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function y1(t){const e={},n=l(t,["gcsUri"]);n!=null&&f(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&f(e,["videoBytes"],$n(r));const s=l(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function v1(t){const e={},n=l(t,["image"]);n!=null&&f(e,["_self"],Kt(n));const r=l(t,["maskMode"]);return r!=null&&f(e,["maskMode"],r),e}function x1(t){const e={},n=l(t,["image"]);n!=null&&f(e,["image"],ba(n));const r=l(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function w1(t){const e={},n=l(t,["image"]);n!=null&&f(e,["image"],Kt(n));const r=l(t,["referenceType"]);return r!=null&&f(e,["referenceType"],r),e}function q0(t){const e={},n=l(t,["uri"]);n!=null&&f(e,["uri"],n);const r=l(t,["videoBytes"]);r!=null&&f(e,["encodedVideo"],$n(r));const s=l(t,["mimeType"]);return s!=null&&f(e,["encoding"],s),e}function H0(t){const e={},n=l(t,["uri"]);n!=null&&f(e,["gcsUri"],n);const r=l(t,["videoBytes"]);r!=null&&f(e,["bytesBase64Encoded"],$n(r));const s=l(t,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _1(t,e){const n={},r=l(t,["displayName"]);return e!==void 0&&r!=null&&f(e,["displayName"],r),n}function S1(t){const e={},n=l(t,["config"]);return n!=null&&_1(n,e),e}function b1(t,e){const n={},r=l(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function k1(t){const e={},n=l(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=l(t,["config"]);return r!=null&&b1(r,e),e}function E1(t){const e={},n=l(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function T1(t,e){const n={},r=l(t,["customMetadata"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["customMetadata"],o)}const s=l(t,["chunkingConfig"]);return e!==void 0&&s!=null&&f(e,["chunkingConfig"],s),n}function C1(t){const e={},n=l(t,["name"]);n!=null&&f(e,["name"],n);const r=l(t,["metadata"]);r!=null&&f(e,["metadata"],r);const s=l(t,["done"]);s!=null&&f(e,["done"],s);const o=l(t,["error"]);o!=null&&f(e,["error"],o);const i=l(t,["response"]);return i!=null&&f(e,["response"],I1(i)),e}function N1(t){const e={},n=l(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=l(t,["fileName"]);r!=null&&f(e,["fileName"],r);const s=l(t,["config"]);return s!=null&&T1(s,e),e}function I1(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["parent"]);r!=null&&f(e,["parent"],r);const s=l(t,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function A1(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=l(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function R1(t){const e={},n=l(t,["config"]);return n!=null&&A1(n,e),e}function P1(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["fileSearchStores"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["fileSearchStores"],o)}return e}function W0(t,e){const n={},r=l(t,["mimeType"]);e!==void 0&&r!=null&&f(e,["mimeType"],r);const s=l(t,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const o=l(t,["customMetadata"]);if(e!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>u)),f(e,["customMetadata"],a)}const i=l(t,["chunkingConfig"]);return e!==void 0&&i!=null&&f(e,["chunkingConfig"],i),n}function M1(t){const e={},n=l(t,["fileSearchStoreName"]);n!=null&&f(e,["_url","file_search_store_name"],n);const r=l(t,["config"]);return r!=null&&W0(r,e),e}function D1(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&f(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const L1="Content-Type",U1="X-Server-Timeout",j1="User-Agent",Iu="x-goog-api-client",O1="1.35.0",F1=`google-genai-sdk/${O1}`,$1="v1beta1",G1="v1beta";class V1{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:$1,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:G1,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[i,a]of Object.entries(e.queryParams))s.searchParams.append(i,String(a));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(n))typeof o=="object"?r[s]=Object.assign(Object.assign({},r[s]),o):o!==void 0&&(r[s]=o);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r,s){if(n&&n.timeout||s){const o=new AbortController,i=o.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>o.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=i}return n&&n.extraBody!==null&&B1(e,n.extraBody),e.headers=await this.getHeadersInternal(n,r),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await cp(s),new ku(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await cp(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return qt(this,arguments,function*(){var r;const s=(r=e==null?void 0:e.body)===null||r===void 0?void 0:r.getReader(),o=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let i="";const a="data:",u=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:d,value:h}=yield oe(s.read());if(d){if(i.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=o.decode(h,{stream:!0});try{const x=JSON.parse(p);if("error"in x){const _=JSON.parse(JSON.stringify(x.error)),S=_.status,v=_.code,y=`got status: ${S}. ${JSON.stringify(x)}`;if(v>=400&&v<600)throw new wa({message:y,status:v})}}catch(x){if(x.name==="ApiError")throw x}i+=p;let m=-1,g=0;for(;;){m=-1,g=0;for(const S of u){const v=i.indexOf(S);v!==-1&&(m===-1||v<m)&&(m=v,g=S.length)}if(m===-1)break;const x=i.substring(0,m);i=i.substring(m+g);const _=x.trim();if(_.startsWith(a)){const S=_.substring(a.length).trim();try{const v=new Response(S,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield oe(new ku(v))}catch(v){throw new Error(`exception parsing stream chunk ${S}. ${v}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=F1+" "+this.clientOptions.userAgentExtra;return e[j1]=n,e[Iu]=n,e[L1]="application/json",e}async getHeadersInternal(e,n){const r=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))r.append(s,o);e.timeout&&e.timeout>0&&r.append(U1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(e){var n;let r="";return typeof e=="string"&&(r=e.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,i=await o.stat(e);s.sizeBytes=String(i.size);const a=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:i.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=a;const u={file:s},d=this.getFileName(e),h=G("upload/v1beta/files",u._url),p=await this.fetchUploadUrl(h,s.sizeBytes,s.mimeType,d,u,n==null?void 0:n.httpOptions);return o.upload(e,p,this)}async uploadFileToFileSearchStore(e,n,r){var s;const o=this.clientOptions.uploader,i=await o.stat(n),a=String(i.size),u=(s=r==null?void 0:r.mimeType)!==null&&s!==void 0?s:i.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(n),p={};r!=null&&W0(r,p);const m=await this.fetchUploadUrl(d,a,u,h,p,r==null?void 0:r.httpOptions);return o.uploadToFileSearchStore(n,m,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,r,s,o,i){var a;let u={};i?u=i:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},s?{"X-Goog-Upload-File-Name":s}:{})};const d=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:u});if(!d||!(d!=null&&d.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(a=d==null?void 0:d.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function cp(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const s=JSON.stringify(r);throw n>=400&&n<600?new wa({message:s,status:n}):new Error(s)}}function B1(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,i){const a=Object.assign({},o);for(const u in i)if(Object.prototype.hasOwnProperty.call(i,u)){const d=i[u],h=a[u];d&&typeof d=="object"&&!Array.isArray(d)&&h&&typeof h=="object"&&!Array.isArray(h)?a[u]=r(h,d):(h&&d&&typeof h!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof h}, New type: ${typeof d}. Overwriting.`),a[u]=d)}return a}const s=r(n,e);t.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const z1="mcp_used/unknown";let q1=!1;function J0(t){for(const e of t)if(H1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return q1}function K0(t){var e;const n=(e=t[Iu])!==null&&e!==void 0?e:"";t[Iu]=(n+` ${z1}`).trimStart()}function H1(t){return t!==null&&typeof t=="object"&&t instanceof Zc}function W1(t){return qt(this,arguments,function*(n,r=100){let s,o=0;for(;o<r;){const i=yield oe(n.listTools({cursor:s}));for(const a of i.tools)yield yield oe(a),o++;if(!i.nextCursor)break;s=i.nextCursor}})}class Zc{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Zc(e,n)}async initialize(){var e,n,r,s;if(this.mcpTools.length>0)return;const o={},i=[];for(const h of this.mcpClients)try{for(var a=!0,u=(n=void 0,Ht(W1(h))),d;d=await u.next(),e=d.done,!e;a=!0){s=d.value,a=!1;const p=s;i.push(p);const m=p.name;if(o[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);o[m]=h}}catch(p){n={error:p}}finally{try{!a&&!e&&(r=u.return)&&await r.call(u)}finally{if(n)throw n.error}}this.mcpTools=i,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),Ek(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const i=await s.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:i.isError?{error:i}:i}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function J1(t,e,n){const r=new yk;let s;n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),Object.assign(r,s),e(r)}class K1{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),i=X1(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),u=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${a}`;let d=()=>{};const h=new Promise(w=>{d=w}),p=e.callbacks,m=function(){d({})},g=this.apiClient,x={onopen:m,onmessage:w=>{J1(g,p.onmessage,w)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(w){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(w){}},_=this.webSocketFactory.create(u,Q1(i),x);_.connect(),await h;const y={setup:{model:he(this.apiClient,e.model)}};return _.send(JSON.stringify(y)),new Y1(_,this.apiClient)}}class Y1{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=ST(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=_T(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Fr.PLAY)}pause(){this.sendPlaybackControl(Fr.PAUSE)}stop(){this.sendPlaybackControl(Fr.STOP)}resetContext(){this.sendPlaybackControl(Fr.RESET_CONTEXT)}close(){this.conn.close()}}function Q1(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function X1(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Z1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function eN(t,e,n){const r=new gk;let s;n.data instanceof Blob?s=await n.data.text():n.data instanceof ArrayBuffer?s=new TextDecoder().decode(n.data):s=n.data;const o=JSON.parse(s);if(t.isVertexAI()){const i=ET(o);Object.assign(r,i)}else Object.assign(r,o);e(r)}class tN{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new K1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,s,o,i,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&J0(e.config.tools)&&K0(p);const m=oN(p);if(this.apiClient.isVertexAI())h=`${u}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m,h);else{const R=this.apiClient.getApiKey();let U="BidiGenerateContent",X="key";R!=null&&R.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),U="BidiGenerateContentConstrained",X="access_token"),h=`${u}/ws/google.ai.generativelanguage.${d}.GenerativeService.${U}?${X}=${R}`}let g=()=>{};const x=new Promise(R=>{g=R}),_=e.callbacks,S=function(){var R;(R=_==null?void 0:_.onopen)===null||R===void 0||R.call(_),g({})},v=this.apiClient,y={onopen:S,onmessage:R=>{eN(v,_.onmessage,R)},onerror:(n=_==null?void 0:_.onerror)!==null&&n!==void 0?n:function(R){},onclose:(r=_==null?void 0:_.onclose)!==null&&r!==void 0?r:function(R){}},w=this.webSocketFactory.create(h,sN(m),y);w.connect(),await x;let b=he(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&b.startsWith("publishers/")){const R=this.apiClient.getProject(),U=this.apiClient.getLocation();b=`projects/${R}/locations/${U}/`+b}let C={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[zi.AUDIO]}:e.config.responseModalities=[zi.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const k=(a=(i=e.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[],T=[];for(const R of k)if(this.isCallableTool(R)){const U=R;T.push(await U.tool())}else T.push(R);T.length>0&&(e.config.tools=T);const M={model:b,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?C=wT(this.apiClient,M):C=xT(this.apiClient,M),delete C.config,w.send(JSON.stringify(C)),new rN(w,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const nN={turnComplete:!0};class rN{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=At(n.turns),e.isVertexAI()||(r=r.map(s=>_a(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(Z1)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},nN),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:kT(e)}:n={realtimeInput:bT(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function sN(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function oN(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dp=10;function fp(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const i of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Kr(i)){s=!0;break}if(!s)return!0;const o=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Kr(t){return"callTool"in t&&typeof t.callTool=="function"}function iN(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(s=>Kr(s)))!==null&&r!==void 0?r:!1}function hp(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((r,s)=>{if(Kr(r))return;const o=r;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(s)}),n}function pp(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aN extends gn{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,s,o,i,a;const u=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!iN(n)||fp(n.config))return await this.generateContentInternal(u);const d=hp(n);if(d.length>0){const _=d.map(S=>`tools[${S}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${_}.`)}let h,p;const m=At(u.contents),g=(o=(s=(r=u.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:dp;let x=0;for(;x<g&&(h=await this.generateContentInternal(u),!(!h.functionCalls||h.functionCalls.length===0));){const _=h.candidates[0].content,S=[];for(const v of(a=(i=n.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[])if(Kr(v)){const w=await v.callTool(h.functionCalls);S.push(...w)}x++,p={role:"user",parts:S},u.contents=At(u.contents),u.contents.push(_),u.contents.push(p),pp(u.config)&&(m.push(_),m.push(p))}return pp(u.config)&&(h.automaticFunctionCallingHistory=m),h},this.generateContentStream=async n=>{var r,s,o,i,a;if(this.maybeMoveToResponseJsonSchem(n),fp(n.config)){const p=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(p)}const u=hp(n);if(u.length>0){const p=u.map(m=>`tools[${m}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(o=(s=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,h=(a=(i=n==null?void 0:n.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(d&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let o;const i=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((s=u==null?void 0:u.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?o=u==null?void 0:u.safetyAttributes:i.push(u);let a;return o?a={generatedImages:i,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:a={generatedImages:i,sdkHttpResponse:r.sdkHttpResponse},a}),this.list=async n=>{var r;const i={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!i.config.queryBase){if(!((r=i.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");i.config.filter="labels.tune-type:*"}return new hr(hn.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(i),i)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)},this.generateVideos=async n=>{var r,s,o,i,a,u;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((s=n.video)===null||s===void 0)&&s.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((i=(o=n.source)===null||o===void 0?void 0:o.video)===null||i===void 0)&&i.uri&&(!((u=(a=n.source)===null||a===void 0?void 0:a.video)===null||u===void 0)&&u.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,s;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const i=await Promise.all(o.map(async u=>Kr(u)?await u.tool():u)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};if(a.config.tools=i,e.config&&e.config.tools&&J0(e.config.tools)){const u=(s=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&s!==void 0?s:{};let d=Object.assign({},u);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),K0(d),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return a}async initAfcToolsMap(e){var n,r,s;const o=new Map;for(const i of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Kr(i)){const a=i,u=await a.tool();for(const d of(s=u.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(o.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);o.set(d.name,a)}}return o}async processAfcStream(e){var n,r,s;const o=(s=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:dp;let i=!1,a=0;const u=await this.initAfcToolsMap(e);return function(d,h,p){return qt(this,arguments,function*(){for(var m,g,x,_,S,v;a<o;){i&&(a++,i=!1);const C=yield oe(d.processParamsMaybeAddMcpUsage(p)),k=yield oe(d.generateContentStreamInternal(C)),T=[],M=[];try{for(var y=!0,w=(g=void 0,Ht(k)),b;b=yield oe(w.next()),m=b.done,!m;y=!0){_=b.value,y=!1;const R=_;if(yield yield oe(R),R.candidates&&(!((S=R.candidates[0])===null||S===void 0)&&S.content)){M.push(R.candidates[0].content);for(const U of(v=R.candidates[0].content.parts)!==null&&v!==void 0?v:[])if(a<o&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(U.functionCall.name)){const X=yield oe(h.get(U.functionCall.name).callTool([U.functionCall]));T.push(...X)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(R){g={error:R}}finally{try{!y&&!m&&(x=w.return)&&(yield oe(x.call(w)))}finally{if(g)throw g.error}}if(T.length>0){i=!0;const R=new ws;R.candidates=[{content:{role:"user",parts:T}}],yield yield oe(R);const U=[];U.push(...M),U.push({role:"user",parts:T});const X=At(p.contents).concat(U);p.contents=X}else break}})}(this,u,e)}async generateContentInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=ap(this.apiClient,e);return a=G("{model}:generateContent",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=up(h),m=new ws;return Object.assign(m,p),m})}else{const d=ip(this.apiClient,e);return a=G("{model}:generateContent",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=lp(h),m=new ws;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=ap(this.apiClient,e);return a=G("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.requestStream({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),i.then(function(p){return qt(this,arguments,function*(){var m,g,x,_;try{for(var S=!0,v=Ht(p),y;y=yield oe(v.next()),m=y.done,!m;S=!0){_=y.value,S=!1;const w=_,b=up(yield oe(w.json()));b.sdkHttpResponse={headers:w.headers};const C=new ws;Object.assign(C,b),yield yield oe(C)}}catch(w){g={error:w}}finally{try{!S&&!m&&(x=v.return)&&(yield oe(x.call(v)))}finally{if(g)throw g.error}}})})}else{const d=ip(this.apiClient,e);return a=G("{model}:streamGenerateContent?alt=sse",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.requestStream({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),i.then(function(p){return qt(this,arguments,function*(){var m,g,x,_;try{for(var S=!0,v=Ht(p),y;y=yield oe(v.next()),m=y.done,!m;S=!0){_=y.value,S=!1;const w=_,b=lp(yield oe(w.json()));b.sdkHttpResponse={headers:w.headers};const C=new ws;Object.assign(C,b),yield yield oe(C)}}catch(w){g={error:w}}finally{try{!S&&!m&&(x=v.return)&&(yield oe(x.call(v)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=tC(this.apiClient,e);return a=G("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=rC(h),m=new Bh;return Object.assign(m,p),m})}else{const d=eC(this.apiClient,e);return a=G("{model}:batchEmbedContents",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=nC(h),m=new Bh;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=pC(this.apiClient,e);return a=G("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=gC(h),m=new zh;return Object.assign(m,p),m})}else{const d=hC(this.apiClient,e);return a=G("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=mC(h),m=new zh;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=YT(this.apiClient,e);return o=G("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),s.then(u=>{const d=QT(u),h=new ok;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=p1(this.apiClient,e);return o=G("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),s.then(u=>{const d=m1(u),h=new ik;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=KC(this.apiClient,e);return o=G("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>{const d=YC(u),h=new ak;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=n1(this.apiClient,e);return o=G("{model}:predict",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>{const d=r1(u),h=new lk;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=MC(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>Nu(h))}else{const d=PC(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>Cu(h))}}async listInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=VC(this.apiClient,e);return a=G("{models_url}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=zC(h),m=new qh;return Object.assign(m,p),m})}else{const d=GC(this.apiClient,e);return a=G("{models_url}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=BC(h),m=new qh;return Object.assign(m,p),m})}}async update(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=f1(this.apiClient,e);return a=G("{model}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>Nu(h))}else{const d=d1(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>Cu(h))}}async delete(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=HT(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=JT(h),m=new Hh;return Object.assign(m,p),m})}else{const d=qT(this.apiClient,e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=WT(h),m=new Hh;return Object.assign(m,p),m})}}async countTokens(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=VT(this.apiClient,e);return a=G("{model}:countTokens",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=zT(h),m=new Wh;return Object.assign(m,p),m})}else{const d=GT(this.apiClient,e);return a=G("{model}:countTokens",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=BT(h),m=new Wh;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=DT(this.apiClient,e);return o=G("{model}:computeTokens",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),s.then(u=>{const d=LT(u),h=new uk;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=SC(this.apiClient,e);return a=G("{model}:predictLongRunning",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>{const p=wC(h),m=new qi;return Object.assign(m,p),m})}else{const d=_C(this.apiClient,e);return a=G("{model}:predictLongRunning",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const p=xC(h),m=new qi;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lN extends gn{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=Zb(e);return a=G("{operationName}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i}else{const d=Xb(e);return a=G("{operationName}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i}}async fetchPredictVideosOperationInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=qb(e);return o=G("{resourceName}:fetchPredictOperation",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uN(t){const e={},n=l(t,["data"]);if(n!=null&&f(e,["data"],n),l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function cN(t){const e={},n=l(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>xN(o))),f(e,["parts"],s)}const r=l(t,["role"]);return r!=null&&f(e,["role"],r),e}function dN(t,e,n){const r={},s=l(e,["expireTime"]);n!==void 0&&s!=null&&f(n,["expireTime"],s);const o=l(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&f(n,["newSessionExpireTime"],o);const i=l(e,["uses"]);n!==void 0&&i!=null&&f(n,["uses"],i);const a=l(e,["liveConnectConstraints"]);n!==void 0&&a!=null&&f(n,["bidiGenerateContentSetup"],vN(t,a));const u=l(e,["lockAdditionalFields"]);return n!==void 0&&u!=null&&f(n,["fieldMask"],u),r}function fN(t,e){const n={},r=l(e,["config"]);return r!=null&&f(n,["config"],dN(t,r,n)),n}function hN(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&f(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&f(e,["mimeType"],r),e}function pN(t){const e={},n=l(t,["id"]);n!=null&&f(e,["id"],n);const r=l(t,["args"]);r!=null&&f(e,["args"],r);const s=l(t,["name"]);if(s!=null&&f(e,["name"],s),l(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(l(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function mN(t){const e={};if(l(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=l(t,["enableWidget"]);return n!=null&&f(e,["enableWidget"],n),e}function gN(t){const e={};if(l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(l(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=l(t,["timeRangeFilter"]);return n!=null&&f(e,["timeRangeFilter"],n),e}function yN(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig"],r);const s=l(t,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const o=l(t,["temperature"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","temperature"],o);const i=l(t,["topP"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig","topP"],i);const a=l(t,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const u=l(t,["maxOutputTokens"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","maxOutputTokens"],u);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&f(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],Xc(p));const m=l(t,["thinkingConfig"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","thinkingConfig"],m);const g=l(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],g);const x=l(t,["systemInstruction"]);e!==void 0&&x!=null&&f(e,["setup","systemInstruction"],cN(nt(x)));const _=l(t,["tools"]);if(e!==void 0&&_!=null){let k=cs(_);Array.isArray(k)&&(k=k.map(T=>_N(us(T)))),f(e,["setup","tools"],k)}const S=l(t,["sessionResumption"]);e!==void 0&&S!=null&&f(e,["setup","sessionResumption"],wN(S));const v=l(t,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const y=l(t,["outputAudioTranscription"]);e!==void 0&&y!=null&&f(e,["setup","outputAudioTranscription"],y);const w=l(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&f(e,["setup","realtimeInputConfig"],w);const b=l(t,["contextWindowCompression"]);e!==void 0&&b!=null&&f(e,["setup","contextWindowCompression"],b);const C=l(t,["proactivity"]);if(e!==void 0&&C!=null&&f(e,["setup","proactivity"],C),l(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function vN(t,e){const n={},r=l(e,["model"]);r!=null&&f(n,["setup","model"],he(t,r));const s=l(e,["config"]);return s!=null&&f(n,["config"],yN(s,n)),n}function xN(t){const e={},n=l(t,["mediaResolution"]);n!=null&&f(e,["mediaResolution"],n);const r=l(t,["codeExecutionResult"]);r!=null&&f(e,["codeExecutionResult"],r);const s=l(t,["executableCode"]);s!=null&&f(e,["executableCode"],s);const o=l(t,["fileData"]);o!=null&&f(e,["fileData"],hN(o));const i=l(t,["functionCall"]);i!=null&&f(e,["functionCall"],pN(i));const a=l(t,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const u=l(t,["inlineData"]);u!=null&&f(e,["inlineData"],uN(u));const d=l(t,["text"]);d!=null&&f(e,["text"],d);const h=l(t,["thought"]);h!=null&&f(e,["thought"],h);const p=l(t,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const m=l(t,["videoMetadata"]);return m!=null&&f(e,["videoMetadata"],m),e}function wN(t){const e={},n=l(t,["handle"]);if(n!=null&&f(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function _N(t){const e={};if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const n=l(t,["computerUse"]);n!=null&&f(e,["computerUse"],n);const r=l(t,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const s=l(t,["codeExecution"]);if(s!=null&&f(e,["codeExecution"],s),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=l(t,["functionDeclarations"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}const i=l(t,["googleMaps"]);i!=null&&f(e,["googleMaps"],mN(i));const a=l(t,["googleSearch"]);a!=null&&f(e,["googleSearch"],gN(a));const u=l(t,["googleSearchRetrieval"]);u!=null&&f(e,["googleSearchRetrieval"],u);const d=l(t,["urlContext"]);return d!=null&&f(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SN(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const s=Object.keys(r).map(o=>`${n}.${o}`);e.push(...s)}else e.push(n)}return e.join(",")}function bN(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const s=t.fieldMask;if(n){const o=SN(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const i=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];s.length>0&&(a=s.map(d=>i.includes(d)?`generationConfig.${d}`:d));const u=[];o&&u.push(o),a.length>0&&u.push(...a),u.length>0?t.fieldMask=u.join(","):delete t.fieldMask}else delete t.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?t.fieldMask=s.join(","):delete t.fieldMask;return t}class kN extends gn{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=fN(this.apiClient,e);o=G("auth_tokens",a._url),i=a._query,delete a.config,delete a._url,delete a._query;const u=bN(a,e.config);return s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EN(t,e){const n={},r=l(t,["force"]);return e!==void 0&&r!=null&&f(e,["_query","force"],r),n}function TN(t){const e={},n=l(t,["name"]);n!=null&&f(e,["_url","name"],n);const r=l(t,["config"]);return r!=null&&EN(r,e),e}function CN(t){const e={},n=l(t,["name"]);return n!=null&&f(e,["_url","name"],n),e}function NN(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&f(e,["_query","pageSize"],r);const s=l(t,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),n}function IN(t){const e={},n=l(t,["parent"]);n!=null&&f(e,["_url","parent"],n);const r=l(t,["config"]);return r!=null&&NN(r,e),e}function AN(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&f(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&f(e,["nextPageToken"],r);const s=l(t,["documents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),f(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RN extends gn{constructor(e){super(),this.apiClient=e,this.list=async n=>new hr(hn.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=CN(e);return o=G("{name}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>u)}}async delete(e){var n,r;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=TN(e);s=G("{name}",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=IN(e);return o=G("{parent}/documents",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>{const d=AN(u),h=new ck;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PN extends gn{constructor(e,n=new RN(e)){super(),this.apiClient=e,this.documents=n,this.list=async(r={})=>new hr(hn.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(r),r)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=S1(e);return o=G("fileSearchStores",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>u)}}async get(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=E1(e);return o=G("{name}",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>u)}}async delete(e){var n,r;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const i=k1(e);s=G("{name}",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=R1(e);return o=G("fileSearchStores",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>{const d=P1(u),h=new dk;return Object.assign(h,d),h})}}async uploadToFileSearchStoreInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=M1(e);return o=G("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>{const d=D1(u),h=new fk;return Object.assign(h,d),h})}}async importFile(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=N1(e);return o=G("{file_search_store_name}:importFile",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),s.then(u=>{const d=C1(u),h=new Wc;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Y0=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return Y0=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};const MN=()=>Y0();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Au(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Ru=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Dt extends Error{}class at extends Dt{constructor(e,n,r,s){super(`${at.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.error=n}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new ka({message:r,cause:Ru(n)});const o=n;return e===400?new X0(e,o,r,s):e===401?new Z0(e,o,r,s):e===403?new ey(e,o,r,s):e===404?new ty(e,o,r,s):e===409?new ny(e,o,r,s):e===422?new ry(e,o,r,s):e===429?new sy(e,o,r,s):e>=500?new oy(e,o,r,s):new at(e,o,r,s)}}class Pu extends at{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class ka extends at{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Q0 extends ka{constructor({message:e}={}){super({message:e??"Request timed out."})}}class X0 extends at{}class Z0 extends at{}class ey extends at{}class ty extends at{}class ny extends at{}class ry extends at{}class sy extends at{}class oy extends at{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DN=/^[a-z][a-z0-9+.-]*:/i,LN=t=>DN.test(t);let Mu=t=>(Mu=Array.isArray,Mu(t));const UN=Mu;let jN=UN;const mp=jN;function ON(t){if(!t)return!0;for(const e in t)return!1;return!0}function FN(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const $N=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Dt(`${t} must be an integer`);if(e<0)throw new Dt(`${t} must be a positive integer`);return e},GN=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VN=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Er="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BN(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const zN=()=>{var t,e,n,r,s;const o=BN();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Er,"X-Stainless-OS":yp(Deno.build.os),"X-Stainless-Arch":gp(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Er,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Er,"X-Stainless-OS":yp((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":gp((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const i=qN();return i?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Er,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${i.browser}`,"X-Stainless-Runtime-Version":i.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Er,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function qN(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,o=r[2]||0,i=r[3]||0;return{browser:e,version:`${s}.${o}.${i}`}}}return null}const gp=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",yp=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Bo;const HN=()=>Bo??(Bo=zN());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WN(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function iy(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function JN(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return iy({start(){},async pull(n){const{done:r,value:s}=await e.next();r?n.close():n.enqueue(s)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function ay(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function KN(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const r=t.getReader(),s=r.cancel();r.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YN=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ly=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function dl(t,e,n){return ly(),new File(t,e??"unknown_file",n)}function QN(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const XN=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const uy=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",ZN=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&uy(t),eI=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function tI(t,e,n){if(ly(),t=await t,ZN(t))return t instanceof File?t:dl([await t.arrayBuffer()],t.name);if(eI(t)){const s=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),dl(await Du(s),e,n)}const r=await Du(t);if(e||(e=QN(t)),!(n!=null&&n.type)){const s=r.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof s=="string"&&(n=Object.assign(Object.assign({},n),{type:s}))}return dl(r,e,n)}async function Du(t){var e,n,r,s,o;let i=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)i.push(t);else if(uy(t))i.push(t instanceof Blob?t:await t.arrayBuffer());else if(XN(t))try{for(var a=!0,u=Ht(t),d;d=await u.next(),e=d.done,!e;a=!0){s=d.value,a=!1;const h=s;i.push(...await Du(h))}}catch(h){n={error:h}}finally{try{!a&&!e&&(r=u.return)&&await r.call(u)}finally{if(n)throw n.error}}else{const h=(o=t==null?void 0:t.constructor)===null||o===void 0?void 0:o.name;throw new Error(`Unexpected data type: ${typeof t}${h?`; constructor: ${h}`:""}${nI(t)}`)}return i}function nI(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cy{constructor(e){this._client=e}}cy._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dy(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const vp=Object.freeze(Object.create(null)),rI=(t=dy)=>function(n,...r){if(n.length===1)return n[0];let s=!1;const o=[],i=n.reduce((h,p,m)=>{var g,x,_;/[?#]/.test(p)&&(s=!0);const S=r[m];let v=(s?encodeURIComponent:t)(""+S);return m!==r.length&&(S==null||typeof S=="object"&&S.toString===((_=Object.getPrototypeOf((x=Object.getPrototypeOf((g=S.hasOwnProperty)!==null&&g!==void 0?g:vp))!==null&&x!==void 0?x:vp))===null||_===void 0?void 0:_.toString))&&(v=S+"",o.push({start:h.length+p.length,length:v.length,error:`Value of type ${Object.prototype.toString.call(S).slice(8,-1)} is not a valid path parameter`})),h+p+(m===r.length?"":v)},""),a=i.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=u.exec(a))!==null;)o.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(o.sort((h,p)=>h.start-p.start),o.length>0){let h=0;const p=o.reduce((m,g)=>{const x=" ".repeat(g.start-h),_="^".repeat(g.length);return h=g.start+g.length,m+x+_},"");throw new Dt(`Path parameters result in path with invalid segments:
${o.map(m=>m.error).join(`
`)}
${i}
${p}`)}return i},zo=rI(dy);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fy extends cy{create(e,n){var r;const{api_version:s=this._client.apiVersion}=e,o=Wi(e,["api_version"]);if("model"in o&&"agent_config"in o)throw new Dt("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in o&&"generation_config"in o)throw new Dt("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(zo`/${s}/interactions`,Object.assign(Object.assign({body:o},n),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,n={},r){const{api_version:s=this._client.apiVersion}=n??{};return this._client.delete(zo`/${s}/interactions/${e}`,r)}cancel(e,n={},r){const{api_version:s=this._client.apiVersion}=n??{};return this._client.post(zo`/${s}/interactions/${e}/cancel`,r)}get(e,n={},r){var s;const o=n??{},{api_version:i=this._client.apiVersion}=o,a=Wi(o,["api_version"]);return this._client.get(zo`/${i}/interactions/${e}`,Object.assign(Object.assign({query:a},r),{stream:(s=n==null?void 0:n.stream)!==null&&s!==void 0?s:!1}))}}fy._key=Object.freeze(["interactions"]);class hy extends fy{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sI(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}let qo;function ed(t){let e;return(qo??(e=new globalThis.TextEncoder,qo=e.encode.bind(e)))(t)}let Ho;function xp(t){let e;return(Ho??(e=new globalThis.TextDecoder,Ho=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ea{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?ed(e):e;this.buffer=sI([this.buffer,n]);const r=[];let s;for(;(s=oI(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){r.push(xp(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const o=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,i=xp(this.buffer.subarray(0,o));r.push(i),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}Ea.NEWLINE_CHARS=new Set([`
`,"\r"]);Ea.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function oI(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function iI(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ji={off:0,error:200,warn:300,info:400,debug:500},wp=(t,e,n)=>{if(t){if(FN(Ji,t))return t;st(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Ji))}`)}};function Cs(){}function Wo(t,e,n){return!e||Ji[t]>Ji[n]?Cs:e[t].bind(e)}const aI={error:Cs,warn:Cs,info:Cs,debug:Cs};let _p=new WeakMap;function st(t){var e;const n=t.logger,r=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return aI;const s=_p.get(n);if(s&&s[0]===r)return s[1];const o={error:Wo("error",n,r),warn:Wo("warn",n,r),info:Wo("info",n,r),debug:Wo("debug",n,r)};return _p.set(n,[r,o]),o}const Hn=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $r{constructor(e,n,r){this.iterator=e,this.controller=n,this.client=r}static fromSSEResponse(e,n,r){let s=!1;const o=r?st(r):console;function i(){return qt(this,arguments,function*(){var u,d,h,p;if(s)throw new Dt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let m=!1;try{try{for(var g=!0,x=Ht(lI(e,n)),_;_=yield oe(x.next()),u=_.done,!u;g=!0){p=_.value,g=!1;const S=p;if(!m)if(S.data.startsWith("[DONE]")){m=!0;continue}else try{yield yield oe(JSON.parse(S.data))}catch(v){throw o.error("Could not parse message into JSON:",S.data),o.error("From chunk:",S.raw),v}}}catch(S){d={error:S}}finally{try{!g&&!u&&(h=x.return)&&(yield oe(h.call(x)))}finally{if(d)throw d.error}}m=!0}catch(S){if(Au(S))return yield oe(void 0);throw S}finally{m||n.abort()}})}return new $r(i,n,r)}static fromReadableStream(e,n,r){let s=!1;function o(){return qt(this,arguments,function*(){var u,d,h,p;const m=new Ea,g=ay(e);try{for(var x=!0,_=Ht(g),S;S=yield oe(_.next()),u=S.done,!u;x=!0){p=S.value,x=!1;const v=p;for(const y of m.decode(v))yield yield oe(y)}}catch(v){d={error:v}}finally{try{!x&&!u&&(h=_.return)&&(yield oe(h.call(_)))}finally{if(d)throw d.error}}for(const v of m.flush())yield yield oe(v)})}function i(){return qt(this,arguments,function*(){var u,d,h,p;if(s)throw new Dt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let m=!1;try{try{for(var g=!0,x=Ht(o()),_;_=yield oe(x.next()),u=_.done,!u;g=!0){p=_.value,g=!1;const S=p;m||S&&(yield yield oe(JSON.parse(S)))}}catch(S){d={error:S}}finally{try{!g&&!u&&(h=x.return)&&(yield oe(h.call(x)))}finally{if(d)throw d.error}}m=!0}catch(S){if(Au(S))return yield oe(void 0);throw S}finally{m||n.abort()}})}return new $r(i,n,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=o=>({next:()=>{if(o.length===0){const i=r.next();e.push(i),n.push(i)}return o.shift()}});return[new $r(()=>s(e),this.controller,this.client),new $r(()=>s(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return iy({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:s,done:o}=await n.next();if(o)return r.close();const i=ed(JSON.stringify(s)+`
`);r.enqueue(i)}catch(s){r.error(s)}},async cancel(){var r;await((r=n.return)===null||r===void 0?void 0:r.call(n))}})}}function lI(t,e){return qt(this,arguments,function*(){var r,s,o,i;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Dt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Dt("Attempted to iterate over a response with no body");const a=new cI,u=new Ea,d=ay(t.body);try{for(var h=!0,p=Ht(uI(d)),m;m=yield oe(p.next()),r=m.done,!r;h=!0){i=m.value,h=!1;const g=i;for(const x of u.decode(g)){const _=a.decode(x);_&&(yield yield oe(_))}}}catch(g){s={error:g}}finally{try{!h&&!r&&(o=p.return)&&(yield oe(o.call(p)))}finally{if(s)throw s.error}}for(const g of u.flush()){const x=a.decode(g);x&&(yield yield oe(x))}})}function uI(t){return qt(this,arguments,function*(){var n,r,s,o;let i=new Uint8Array;try{for(var a=!0,u=Ht(t),d;d=yield oe(u.next()),n=d.done,!n;a=!0){o=d.value,a=!1;const h=o;if(h==null)continue;const p=h instanceof ArrayBuffer?new Uint8Array(h):typeof h=="string"?ed(h):h;let m=new Uint8Array(i.length+p.length);m.set(i),m.set(p,i.length),i=m;let g;for(;(g=iI(i))!==-1;)yield yield oe(i.slice(0,g)),i=i.slice(g)}}catch(h){r={error:h}}finally{try{!a&&!n&&(s=u.return)&&(yield oe(s.call(u)))}finally{if(r)throw r.error}}i.length>0&&(yield yield oe(i))})}class cI{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=dI(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function dI(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function fI(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:o}=e,i=await(async()=>{var a;if(e.options.stream)return st(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):$r.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const u=n.headers.get("content-type"),d=(a=u==null?void 0:u.split(";")[0])===null||a===void 0?void 0:a.trim();return(d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))?await n.json():await n.text()})();return st(t).debug(`[${r}] response parsed`,Hn({retryOfRequestLogID:s,url:n.url,status:n.status,body:i,durationMs:Date.now()-o})),i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class td extends Promise{constructor(e,n,r=fI){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new td(this.client,this.responsePromise,async(n,r)=>e(await this.parseResponse(n,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const py=Symbol("brand.privateNullableHeaders");function*hI(t){if(!t)return;if(py in t){const{values:r,nulls:s}=t;yield*r.entries();for(const o of s)yield[o,null];return}let e=!1,n;t instanceof Headers?n=t.entries():mp(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const s=r[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const o=mp(r[1])?r[1]:[r[1]];let i=!1;for(const a of o)a!==void 0&&(e&&!i&&(i=!0,yield[s,null]),yield[s,a])}}const _s=t=>{const e=new Headers,n=new Set;for(const r of t){const s=new Set;for(const[o,i]of hI(r)){const a=o.toLowerCase();s.has(a)||(e.delete(o),s.add(a)),i===null?(e.delete(o),n.add(a)):(e.append(o,i),n.delete(a))}}return{[py]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fl=t=>{var e,n,r,s,o,i;if(typeof globalThis.process<"u")return(r=(n=(e=Fb)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(i=(o=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||o===void 0?void 0:o.call(s,t))===null||i===void 0?void 0:i.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var my;class Ta{constructor(e){var n,r,s,o,i,a,u,{baseURL:d=fl("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:h=(n=fl("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:p="v1beta"}=e,m=Wi(e,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:h,apiVersion:p},m),{baseURL:d||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(r=g.timeout)!==null&&r!==void 0?r:Ta.DEFAULT_TIMEOUT,this.logger=(s=g.logger)!==null&&s!==void 0?s:console;const x="warn";this.logLevel=x,this.logLevel=(i=(o=wp(g.logLevel,"ClientOptions.logLevel",this))!==null&&o!==void 0?o:wp(fl("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&i!==void 0?i:x,this.fetchOptions=g.fetchOptions,this.maxRetries=(a=g.maxRetries)!==null&&a!==void 0?a:2,this.fetch=(u=g.fetch)!==null&&u!==void 0?u:WN(),this.encoder=YN,this._options=g,this.apiKey=h,this.apiVersion=p,this.clientAdapter=g.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=_s([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return _s([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return _s([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Dt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Er}`}defaultIdempotencyKey(){return`stainless-node-retry-${MN()}`}makeStatusError(e,n,r,s){return at.generate(e,n,r,s)}buildURL(e,n,r){const s=!this.baseURLOverridden()&&r||this.baseURL,o=LN(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return ON(i)||(n=Object.assign(Object.assign({},i),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(o.search=this.stringifyQuery(n)),o.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(s=>Object.assign({method:e,path:n},s)))}request(e,n=null){return new td(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var s,o,i;const a=await e,u=(s=a.maxRetries)!==null&&s!==void 0?s:this.maxRetries;n==null&&(n=u),await this.prepareOptions(a);const{req:d,url:h,timeout:p}=await this.buildRequest(a,{retryCount:u-n});await this.prepareRequest(d,{url:h,options:a});const m="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=r===void 0?"":`, retryOf: ${r}`,x=Date.now();if(st(this).debug(`[${m}] sending request`,Hn({retryOfRequestLogID:r,method:a.method,url:h,options:a,headers:d.headers})),!((o=a.signal)===null||o===void 0)&&o.aborted)throw new Pu;const _=new AbortController,S=await this.fetchWithTimeout(h,d,p,_).catch(Ru),v=Date.now();if(S instanceof globalThis.Error){const w=`retrying, ${n} attempts remaining`;if(!((i=a.signal)===null||i===void 0)&&i.aborted)throw new Pu;const b=Au(S)||/timed? ?out/i.test(String(S)+("cause"in S?String(S.cause):""));if(n)return st(this).info(`[${m}] connection ${b?"timed out":"failed"} - ${w}`),st(this).debug(`[${m}] connection ${b?"timed out":"failed"} (${w})`,Hn({retryOfRequestLogID:r,url:h,durationMs:v-x,message:S.message})),this.retryRequest(a,n,r??m);throw st(this).info(`[${m}] connection ${b?"timed out":"failed"} - error; no more retries left`),st(this).debug(`[${m}] connection ${b?"timed out":"failed"} (error; no more retries left)`,Hn({retryOfRequestLogID:r,url:h,durationMs:v-x,message:S.message})),b?new Q0:new ka({cause:S})}const y=`[${m}${g}] ${d.method} ${h} ${S.ok?"succeeded":"failed"} with status ${S.status} in ${v-x}ms`;if(!S.ok){const w=await this.shouldRetry(S);if(n&&w){const R=`retrying, ${n} attempts remaining`;return await KN(S.body),st(this).info(`${y} - ${R}`),st(this).debug(`[${m}] response error (${R})`,Hn({retryOfRequestLogID:r,url:S.url,status:S.status,headers:S.headers,durationMs:v-x})),this.retryRequest(a,n,r??m,S.headers)}const b=w?"error; no more retries left":"error; not retryable";st(this).info(`${y} - ${b}`);const C=await S.text().catch(R=>Ru(R).message),k=GN(C),T=k?void 0:C;throw st(this).debug(`[${m}] response error (${b})`,Hn({retryOfRequestLogID:r,url:S.url,status:S.status,headers:S.headers,message:T,durationMs:Date.now()-x})),this.makeStatusError(S.status,k,T,S.headers)}return st(this).info(y),st(this).debug(`[${m}] response start`,Hn({retryOfRequestLogID:r,url:S.url,status:S.status,headers:S.headers,durationMs:v-x})),{response:S,options:a,controller:_,requestLogID:m,retryOfRequestLogID:r,startTime:x}}async fetchWithTimeout(e,n,r,s){const o=n||{},{signal:i,method:a}=o,u=Wi(o,["signal","method"]);i&&i.addEventListener("abort",()=>s.abort());const d=setTimeout(()=>s.abort(),r),h=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,p=Object.assign(Object.assign(Object.assign({signal:s.signal},h?{duplex:"half"}:{}),{method:"GET"}),u);a&&(p.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,p)}finally{clearTimeout(d)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,s){var o;let i;const a=s==null?void 0:s.get("retry-after-ms");if(a){const d=parseFloat(a);Number.isNaN(d)||(i=d)}const u=s==null?void 0:s.get("retry-after");if(u&&!i){const d=parseFloat(u);Number.isNaN(d)?i=Date.parse(u)-Date.now():i=d*1e3}if(!(i&&0<=i&&i<60*1e3)){const d=(o=e.maxRetries)!==null&&o!==void 0?o:this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,d)}return await VN(i),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const o=n-e,i=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return i*a*1e3}async buildRequest(e,{retryCount:n=0}={}){var r,s,o;const i=Object.assign({},e),{method:a,path:u,query:d,defaultBaseURL:h}=i,p=this.buildURL(u,d,h);"timeout"in i&&$N("timeout",i.timeout),i.timeout=(r=i.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:m,body:g}=this.buildBody({options:i}),x=await this.buildHeaders({options:e,method:a,bodyHeaders:m,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:a,headers:x},i.signal&&{signal:i.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(o=i.fetchOptions)!==null&&o!==void 0?o:{}),url:p,timeout:i.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:s}){let o={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const i=await this.authHeaders(e);let a=_s([o,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),HN()),this._options.defaultHeaders,r,e.headers,i]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=_s([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:JN(e)}:this.encoder({body:e,headers:r})}}Ta.DEFAULT_TIMEOUT=6e4;class Be extends Ta{constructor(){super(...arguments),this.interactions=new hy(this)}}my=Be;Be.GeminiNextGenAPIClient=my;Be.GeminiNextGenAPIClientError=Dt;Be.APIError=at;Be.APIConnectionError=ka;Be.APIConnectionTimeoutError=Q0;Be.APIUserAbortError=Pu;Be.NotFoundError=ty;Be.ConflictError=ny;Be.RateLimitError=sy;Be.BadRequestError=X0;Be.AuthenticationError=Z0;Be.InternalServerError=oy;Be.PermissionDeniedError=ey;Be.UnprocessableEntityError=ry;Be.toFile=tI;Be.Interactions=hy;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pI(t,e){const n={},r=l(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function mI(t,e){const n={},r=l(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function gI(t,e){const n={},r=l(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function yI(t,e){const n={},r=l(t,["sdkHttpResponse"]);return r!=null&&f(n,["sdkHttpResponse"],r),n}function vI(t,e,n){const r={};if(l(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=l(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&f(e,["displayName"],s),l(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=l(t,["epochCount"]);e!==void 0&&o!=null&&f(e,["tuningTask","hyperparameters","epochCount"],o);const i=l(t,["learningRateMultiplier"]);if(i!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],i),l(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(l(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=l(t,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const u=l(t,["learningRate"]);if(e!==void 0&&u!=null&&f(e,["tuningTask","hyperparameters","learningRate"],u),l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(l(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function xI(t,e,n){const r={};let s=l(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const g=l(t,["validationDataset"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec"],Sp(g))}else if(s==="PREFERENCE_TUNING"){const g=l(t,["validationDataset"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec"],Sp(g))}const o=l(t,["tunedModelDisplayName"]);e!==void 0&&o!=null&&f(e,["tunedModelDisplayName"],o);const i=l(t,["description"]);e!==void 0&&i!=null&&f(e,["description"],i);let a=l(n,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const g=l(t,["epochCount"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(a==="PREFERENCE_TUNING"){const g=l(t,["epochCount"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let u=l(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=l(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(u==="PREFERENCE_TUNING"){const g=l(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let d=l(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const g=l(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(d==="PREFERENCE_TUNING"){const g=l(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let h=l(n,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const g=l(t,["adapterSize"]);e!==void 0&&g!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(h==="PREFERENCE_TUNING"){const g=l(t,["adapterSize"]);e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(l(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const p=l(t,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const m=l(t,["beta"]);return e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],m),r}function wI(t,e){const n={},r=l(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const s=l(t,["preTunedModel"]);s!=null&&f(n,["preTunedModel"],s);const o=l(t,["trainingDataset"]);o!=null&&RI(o);const i=l(t,["config"]);return i!=null&&vI(i,n),n}function _I(t,e){const n={},r=l(t,["baseModel"]);r!=null&&f(n,["baseModel"],r);const s=l(t,["preTunedModel"]);s!=null&&f(n,["preTunedModel"],s);const o=l(t,["trainingDataset"]);o!=null&&PI(o,n,e);const i=l(t,["config"]);return i!=null&&xI(i,n,e),n}function SI(t,e){const n={},r=l(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function bI(t,e){const n={},r=l(t,["name"]);return r!=null&&f(n,["_url","name"],r),n}function kI(t,e,n){const r={},s=l(t,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const o=l(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const i=l(t,["filter"]);return e!==void 0&&i!=null&&f(e,["_query","filter"],i),r}function EI(t,e,n){const r={},s=l(t,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const o=l(t,["pageToken"]);e!==void 0&&o!=null&&f(e,["_query","pageToken"],o);const i=l(t,["filter"]);return e!==void 0&&i!=null&&f(e,["_query","filter"],i),r}function TI(t,e){const n={},r=l(t,["config"]);return r!=null&&kI(r,n),n}function CI(t,e){const n={},r=l(t,["config"]);return r!=null&&EI(r,n),n}function NI(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=l(t,["nextPageToken"]);s!=null&&f(n,["nextPageToken"],s);const o=l(t,["tunedModels"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>gy(a))),f(n,["tuningJobs"],i)}return n}function II(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=l(t,["nextPageToken"]);s!=null&&f(n,["nextPageToken"],s);const o=l(t,["tuningJobs"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>Lu(a))),f(n,["tuningJobs"],i)}return n}function AI(t,e){const n={},r=l(t,["name"]);r!=null&&f(n,["model"],r);const s=l(t,["name"]);return s!=null&&f(n,["endpoint"],s),n}function RI(t,e){const n={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=l(t,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>o)),f(n,["examples","examples"],s)}return n}function PI(t,e,n){const r={};let s=l(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const i=l(t,["gcsUri"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(s==="PREFERENCE_TUNING"){const i=l(t,["gcsUri"]);e!==void 0&&i!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],i)}let o=l(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const i=l(t,["vertexDatasetResource"]);e!==void 0&&i!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],i)}else if(o==="PREFERENCE_TUNING"){const i=l(t,["vertexDatasetResource"]);e!==void 0&&i!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],i)}if(l(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function gy(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=l(t,["name"]);s!=null&&f(n,["name"],s);const o=l(t,["state"]);o!=null&&f(n,["state"],P0(o));const i=l(t,["createTime"]);i!=null&&f(n,["createTime"],i);const a=l(t,["tuningTask","startTime"]);a!=null&&f(n,["startTime"],a);const u=l(t,["tuningTask","completeTime"]);u!=null&&f(n,["endTime"],u);const d=l(t,["updateTime"]);d!=null&&f(n,["updateTime"],d);const h=l(t,["description"]);h!=null&&f(n,["description"],h);const p=l(t,["baseModel"]);p!=null&&f(n,["baseModel"],p);const m=l(t,["_self"]);return m!=null&&f(n,["tunedModel"],AI(m)),n}function Lu(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=l(t,["name"]);s!=null&&f(n,["name"],s);const o=l(t,["state"]);o!=null&&f(n,["state"],P0(o));const i=l(t,["createTime"]);i!=null&&f(n,["createTime"],i);const a=l(t,["startTime"]);a!=null&&f(n,["startTime"],a);const u=l(t,["endTime"]);u!=null&&f(n,["endTime"],u);const d=l(t,["updateTime"]);d!=null&&f(n,["updateTime"],d);const h=l(t,["error"]);h!=null&&f(n,["error"],h);const p=l(t,["description"]);p!=null&&f(n,["description"],p);const m=l(t,["baseModel"]);m!=null&&f(n,["baseModel"],m);const g=l(t,["tunedModel"]);g!=null&&f(n,["tunedModel"],g);const x=l(t,["preTunedModel"]);x!=null&&f(n,["preTunedModel"],x);const _=l(t,["supervisedTuningSpec"]);_!=null&&f(n,["supervisedTuningSpec"],_);const S=l(t,["preferenceOptimizationSpec"]);S!=null&&f(n,["preferenceOptimizationSpec"],S);const v=l(t,["tuningDataStats"]);v!=null&&f(n,["tuningDataStats"],v);const y=l(t,["encryptionSpec"]);y!=null&&f(n,["encryptionSpec"],y);const w=l(t,["partnerModelTuningSpec"]);w!=null&&f(n,["partnerModelTuningSpec"],w);const b=l(t,["customBaseModel"]);b!=null&&f(n,["customBaseModel"],b);const C=l(t,["experiment"]);C!=null&&f(n,["experiment"],C);const k=l(t,["labels"]);k!=null&&f(n,["labels"],k);const T=l(t,["outputUri"]);T!=null&&f(n,["outputUri"],T);const M=l(t,["pipelineJob"]);M!=null&&f(n,["pipelineJob"],M);const R=l(t,["serviceAccount"]);R!=null&&f(n,["serviceAccount"],R);const U=l(t,["tunedModelDisplayName"]);U!=null&&f(n,["tunedModelDisplayName"],U);const X=l(t,["veoTuningSpec"]);return X!=null&&f(n,["veoTuningSpec"],X),n}function MI(t,e){const n={},r=l(t,["sdkHttpResponse"]);r!=null&&f(n,["sdkHttpResponse"],r);const s=l(t,["name"]);s!=null&&f(n,["name"],s);const o=l(t,["metadata"]);o!=null&&f(n,["metadata"],o);const i=l(t,["done"]);i!=null&&f(n,["done"],i);const a=l(t,["error"]);return a!=null&&f(n,["error"],a),n}function Sp(t,e){const n={},r=l(t,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const s=l(t,["vertexDatasetResource"]);return s!=null&&f(n,["validationDatasetUri"],s),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DI extends gn{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new hr(hn.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const s={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(s.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:s});return o.baseModel=void 0,await this.tuneInternal(o)}else{const s=Object.assign({},n);return await this.tuneInternal(s)}else{const s=Object.assign({},n),o=await this.tuneMldevInternal(s);let i="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?i=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(i=o.name.split("/operations/")[0]),{name:i,state:bu.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=bI(e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>Lu(h))}else{const d=SI(e);return a=G("{name}",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>gy(h))}}async listInternal(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=CI(e);return a=G("tuningJobs",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=II(h),m=new Jh;return Object.assign(m,p),m})}else{const d=TI(e);return a=G("tunedModels",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=NI(h),m=new Jh;return Object.assign(m,p),m})}}async cancel(e){var n,r,s,o;let i,a="",u={};if(this.apiClient.isVertexAI()){const d=mI(e);return a=G("{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=yI(h),m=new Kh;return Object.assign(m,p),m})}else{const d=pI(e);return a=G("{name}:cancel",d._url),u=d._query,delete d._url,delete d._query,i=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),i.then(h=>{const p=gI(h),m=new Kh;return Object.assign(m,p),m})}}async tuneInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI()){const a=_I(e,e);return o=G("tuningJobs",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),s.then(u=>Lu(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=wI(e);return o=G("tunedModels",a._url),i=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:u.headers},h})),s.then(u=>MI(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LI{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const UI=1024*1024*8,jI=3,OI=1e3,FI=2,Ki="x-goog-upload-status";async function $I(t,e,n){var r;const s=await yy(t,e,n),o=await(s==null?void 0:s.json());if(((r=s==null?void 0:s.headers)===null||r===void 0?void 0:r[Ki])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function GI(t,e,n){var r;const s=await yy(t,e,n),o=await(s==null?void 0:s.json());if(((r=s==null?void 0:s.headers)===null||r===void 0?void 0:r[Ki])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const i=T0(o),a=new Jc;return Object.assign(a,i),a}async function yy(t,e,n){var r,s;let o=0,i=0,a=new ku(new Response),u="upload";for(o=t.size;i<o;){const d=Math.min(UI,o-i),h=t.slice(i,i+d);i+d>=o&&(u+=", finalize");let p=0,m=OI;for(;p<jI&&(a=await n.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(i),"Content-Length":String(d)}}}),!(!((r=a==null?void 0:a.headers)===null||r===void 0)&&r[Ki]));)p++,await BI(m),m=m*FI;if(i+=d,((s=a==null?void 0:a.headers)===null||s===void 0?void 0:s[Ki])!=="active")break;if(o<=i)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function VI(t){return{size:t.size,type:t.type}}function BI(t){return new Promise(e=>setTimeout(e,t))}class zI{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await $I(e,n,r)}async uploadToFileSearchStore(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await GI(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await VI(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qI{create(e,n,r){return new HI(e,n,r)}}class HI{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bp="x-goog-api-key";class WI{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(bp)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(bp,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JI="gl-node/";class nd{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new Be({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=Bb(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new WI(this.apiKey);this.apiClient=new V1({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:JI+"web",uploader:new zI,downloader:new LI}),this.models=new aN(this.apiClient),this.live=new tN(this.apiClient,s,new qI),this.batches=new vE(this.apiClient),this.chats=new ZE(this.models,this.apiClient),this.caches=new YE(this.apiClient),this.files=new uT(this.apiClient),this.operations=new lN(this.apiClient),this.authTokens=new kN(this.apiClient),this.tunings=new DI(this.apiClient),this.fileSearchStores=new PN(this.apiClient)}}const KI=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",vy=()=>{const t=KI();return console.log("Gemini Key Detected:","Yes",`(Length: ${t.length})`),new nd({apiKey:t})},xy=`
You are an expert AI nutritionist and mathematical calculator. 

SCENARIO 1: IMAGE/TEXT ESTIMATION
- Analyze food descriptions or images.
- Provide a detailed "receipt" breakdown of every ingredient.
- Estimate weights in grams (g) and calculate nutrition.

SCENARIO 2: STRICT RECALCULATION (User provided weights)
- If a list of ingredients with specific weights (grams) is provided, you MUST act as a precise calculator.
- IGNORE your previous estimations.
- Use the provided weights as the ABSOLUTE GROUND TRUTH.
- Calculate calories and macros strictly based on these weights.
- Return the recalculated totals.
`,wy=t=>{const e=(t==null?void 0:t.message)||String(t)||"",n=e.toLowerCase();return e.includes("429")||n.includes("quota")||n.includes("limit")||n.includes("exhausted")?"AI Limit Reached: You've sent too many requests. Please wait about 60 seconds for the quota to reset.":n.includes("api key")?"Configuration Error: Invalid API key. Please check your settings.":n.includes("network")||n.includes("fetch")?"Connection Error: Please check your internet connection and try again.":e||"An unexpected AI error occurred."};async function rd(t,e=2,n=2e3){try{return await t()}catch(r){const s=(r==null?void 0:r.message)||"";if((s.includes("429")||s.toLowerCase().includes("quota"))&&e>0)return console.warn(`Gemini Quota hit. Retrying in ${n}ms... (${e} retries left)`),await new Promise(i=>setTimeout(i,n)),rd(t,e-1,n*2);throw r}}const YI=async t=>{try{return await rd(async()=>{const n=await vy().models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{mimeType:"image/jpeg",data:t}},{text:"Analyze this image. Breakdown into ingredients, weights in grams, calories, and total nutrition."}]},config:{systemInstruction:xy,responseMimeType:"application/json",responseSchema:{type:ie.OBJECT,properties:{item:{type:ie.STRING},calories:{type:ie.INTEGER},protein:{type:ie.INTEGER},carbs:{type:ie.INTEGER},fat:{type:ie.INTEGER},confidence:{type:ie.NUMBER},ingredients:{type:ie.ARRAY,items:{type:ie.OBJECT,properties:{name:{type:ie.STRING},grams:{type:ie.INTEGER},calories:{type:ie.INTEGER}},required:["name","grams","calories"]}}},required:["item","calories","protein","carbs","fat","confidence","ingredients"]}}});return JSON.parse(n.text||"{}")})}catch(e){throw console.error("Gemini Analysis Error:",e),new Error(wy(e))}},kp=async(t,e)=>{try{return await rd(async()=>{let n="";e&&e.length>0?n=`USER MANUAL WEIGHT CORRECTION:
        The following ingredients have been updated with exact weights. 
        Perform a mathematical calculation for the nutrition of each item based strictly on these grams:
        
        ${e.map(i=>`- ${i.name}: ${i.grams}g`).join(`
`)}
        
        CRITICAL: 
        1. Calculate calories/macros from scratch for each item.
        2. Sum the totals.
        3. Do not adjust the weights provided.
        4. Return the new AnalysisResult.`:n=`Estimate nutrition for: "${t}".`;const s=await vy().models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:n}]}],config:{systemInstruction:xy,responseMimeType:"application/json",responseSchema:{type:ie.OBJECT,properties:{item:{type:ie.STRING},calories:{type:ie.INTEGER},protein:{type:ie.INTEGER},carbs:{type:ie.INTEGER},fat:{type:ie.INTEGER},confidence:{type:ie.NUMBER},ingredients:{type:ie.ARRAY,items:{type:ie.OBJECT,properties:{name:{type:ie.STRING},grams:{type:ie.INTEGER},calories:{type:ie.INTEGER}},required:["name","grams","calories"]}}},required:["item","calories","protein","carbs","fat","confidence","ingredients"]}}});return JSON.parse(s.text||"{}")})}catch(n){throw console.error("Gemini Text Analysis Error:",n),new Error(wy(n))}};let Jo;const QI=new Uint8Array(16);function XI(){if(!Jo&&(Jo=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jo))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jo(QI)}const He=[];for(let t=0;t<256;++t)He.push((t+256).toString(16).slice(1));function ZI(t,e=0){return He[t[e+0]]+He[t[e+1]]+He[t[e+2]]+He[t[e+3]]+"-"+He[t[e+4]]+He[t[e+5]]+"-"+He[t[e+6]]+He[t[e+7]]+"-"+He[t[e+8]]+He[t[e+9]]+"-"+He[t[e+10]]+He[t[e+11]]+He[t[e+12]]+He[t[e+13]]+He[t[e+14]]+He[t[e+15]]}const eA=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ep={randomUUID:eA};function _y(t,e,n){if(Ep.randomUUID&&!t)return Ep.randomUUID();t=t||{};const r=t.random||(t.rng||XI)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,ZI(r)}const Sy=({isActive:t,onComplete:e,message:n="Analyzing Meal..."})=>{const[r,s]=E.useState(0);if(E.useEffect(()=>{t&&s(0)},[t]),E.useEffect(()=>{if(!t)return;const h=setInterval(()=>{s(p=>{if(p>=92)return 92;const m=p<30?2:p<60?1:.5;return Math.min(p+m,92)})},70);return()=>clearInterval(h)},[t]),E.useEffect(()=>{},[t]),!t)return null;const o=60,i=6,a=o-i*2,u=a*2*Math.PI,d=u-r/100*u;return c.jsxs("div",{className:"fixed inset-0 z-[120] flex items-center justify-center pointer-events-none",children:[c.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity"}),c.jsxs("div",{className:"relative bg-[#1a1c26]/95 backdrop-blur-xl p-8 rounded-[40px] border border-white/10 shadow-2xl pointer-events-auto flex flex-col items-center animate-in zoom-in-95 duration-300 min-w-[300px]",children:[c.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-40 h-40 bg-royal-500/20 blur-3xl rounded-full animate-pulse pointer-events-none"}),c.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center mb-6",children:[c.jsx("div",{className:"absolute inset-0 border-4 border-royal-500/10 rounded-full border-t-royal-500/30 animate-[spin_3s_linear_infinite]"}),c.jsxs("svg",{height:o*2,width:o*2,className:"rotate-[-90deg] drop-shadow-[0_0_10px_rgba(124,58,237,0.3)]",children:[c.jsx("circle",{stroke:"rgba(255,255,255,0.1)",strokeWidth:i,fill:"transparent",r:a,cx:o,cy:o}),c.jsx("circle",{stroke:"url(#gradient)",strokeWidth:i,strokeDasharray:u+" "+u,style:{strokeDashoffset:d,transition:"stroke-dashoffset 0.1s linear"},strokeLinecap:"round",fill:"transparent",r:a,cx:o,cy:o}),c.jsx("defs",{children:c.jsxs("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[c.jsx("stop",{offset:"0%",stopColor:"#7c3aed"})," ",c.jsx("stop",{offset:"100%",stopColor:"#a78bfa"})," "]})})]}),c.jsx("div",{className:"absolute flex flex-col items-center justify-center text-white",children:c.jsxs("span",{className:"text-3xl font-black tracking-tighter tabular-nums text-transparent bg-clip-text bg-gradient-to-br from-white to-white/70",children:[Math.round(r),"%"]})})]}),c.jsxs("div",{className:"text-center space-y-2 relative z-10",children:[c.jsxs("h3",{className:"text-lg font-bold text-white tracking-tight flex items-center justify-center gap-2",children:[c.jsx(zt,{size:18,className:"text-yellow-400 animate-pulse"}),n]}),c.jsx("p",{className:"text-xs text-white/50 font-medium",children:"Identifying ingredients..."})]})]})]})},tA=(t,e=600,n=150,r=!1)=>new Promise((s,o)=>{const i=t.size/1048576,a=new FileReader;a.readAsDataURL(t),a.onload=u=>{var h;const d=new Image;d.src=(h=u.target)==null?void 0:h.result,d.onload=()=>{const p=document.createElement("canvas");let m=d.width,g=d.height;m>e&&(g=e/m*g,m=e),p.width=m,p.height=g;const x=p.getContext("2d");x==null||x.drawImage(d,0,0,m,g);let _=.5,S=p.toDataURL("image/jpeg",_);const v=n*1024;if(S.split(",")[1].length*3/4>v&&(_=.35,S=p.toDataURL("image/jpeg",_),S.split(",")[1].length*3/4>v&&(_=.25,S=p.toDataURL("image/jpeg",_))),r){const b=S.split(",")[1].length*3/4/1024,C=(i*1024-b)/(i*1024)*100;console.log(` Image Optimization:
Original: ${i.toFixed(2)} MB(${d.width}${d.height}px)
Optimized: ${b.toFixed(0)} KB(${Math.round(m)}${Math.round(g)}px)
Quality: ${(_*100).toFixed(0)}%
  Saved: ${C.toFixed(0)}% `)}s(S)},d.onerror=p=>o(p)},a.onerror=u=>o(u)}),by=({onClose:t,onSuccess:e,onOpenSharedMeal:n,editEntry:r})=>{const[s,o]=E.useState("scan"),[i,a]=E.useState(r?"details":"upload"),[u,d]=E.useState((r==null?void 0:r.imageUrl)||null),[h,p]=E.useState(!1),[m,g]=E.useState(!1),[x,_]=E.useState(!1),[S,v]=E.useState(null),y=E.useRef(null),[w,b]=E.useState(""),C=new Date,k=`${C.getHours().toString().padStart(2,"0")}:${C.getMinutes().toString().padStart(2,"0")} `,[T,M]=E.useState((r==null?void 0:r.date)||ls()),[R,U]=E.useState((r==null?void 0:r.time)||k),[X,ye]=E.useState((r==null?void 0:r.food_item)||""),[se,N]=E.useState((r==null?void 0:r.calories.toString())||""),[V,z]=E.useState((r==null?void 0:r.protein.toString())||""),[Q,A]=E.useState((r==null?void 0:r.carbs.toString())||""),[O,I]=E.useState((r==null?void 0:r.fat.toString())||""),[F,D]=E.useState((r==null?void 0:r.ingredients)||[]),[K,ee]=E.useState((r==null?void 0:r.confidence)||null),[Z,H]=E.useState((r==null?void 0:r.originalAiResponse)||null),de=async $=>{if($.target.files&&$.target.files[0]){const je=$.target.files[0];try{const Qe=await tA(je,600,150,!0);d(Qe),v(null)}catch{v("Failed to process image.")}}},ze=async()=>{if(u){p(!0),v(null);try{const $=u.split(",")[1],je=await YI($);B(je),H(je),a("details")}catch($){v($.message)}finally{p(!1)}}},P=async()=>{if(w.trim()){p(!0),v(null);try{const $=await kp(w);B($),H($),a("details")}catch($){v($.message)}finally{p(!1)}}},B=$=>{ye($.item),N($.calories.toString()),z($.protein.toString()),A($.carbs.toString()),I($.fat.toString()),D($.ingredients||[]),ee($.confidence)},te=async()=>{g(!0),v(null);try{const $=await kp(X,F);B($)}catch($){v($.message)}finally{g(!1)}},Y=($,je,Qe)=>{const Yt=[...F];if(je==="grams"||je==="calories"){const _o=Qe===""?0:parseInt(Qe);Yt[$]={...Yt[$],[je]:isNaN(_o)?0:_o}}else Yt[$]={...Yt[$],[je]:Qe};D(Yt)},ue=$=>{D(F.filter((je,Qe)=>Qe!==$))},pe=()=>{D([...F,{name:"",grams:100,calories:0}])},me=async()=>{if(!X.trim()||!se){v("Please fill required fields.");return}try{const[$,je,Qe]=T.split("-").map(Number),[Yt,_o]=R.split(":").map(Number),sd=new Date($,je-1,Qe,Yt,_o);if(isNaN(sd.getTime()))throw new Error("Invalid date or time selected.");const Cy=sd.toISOString(),od=Number(se),Ny=Number(V)||0,Iy=Number(Q)||0,Ay=Number(O)||0;if(isNaN(od))throw new Error("Calories must be a valid number.");const Ry={id:(r==null?void 0:r.id)||_y(),timestamp:Cy,date:T,time:R,food_item:X,calories:od,protein:Ny,carbs:Iy,fat:Ay,confidence:K||1,imageUrl:u||void 0,ingredients:F,originalAiResponse:Z};_(!0),v(null),await w0(Ry),e()}catch($){console.error("Save failed:",$),v($.message||"Failed to save record.")}finally{_(!1)}},j=S==null?void 0:S.includes("Limit Reached"),be=S==null?void 0:S.includes("Database Quota"),De=S==null?void 0:S.includes("Browser Storage Full");return c.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:[c.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] w-full max-w-md rounded-[40px] p-6 shadow-2xl border border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300 max-h-[95vh] overflow-y-auto no-scrollbar",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[i==="details"&&!r&&c.jsx("button",{onClick:()=>a("upload"),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-white/10 transition-all active:scale-95",children:c.jsx(ro,{size:24,className:"text-gray-900 dark:text-gray-50"})}),c.jsx("h2",{className:"text-3xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:r?"Edit Record":i==="upload"?"Track Meal":"Meal Receipt"})]}),c.jsx("button",{onClick:t,className:"p-2.5 bg-gray-100 dark:bg-white/10 rounded-full hover:bg-gray-200 dark:hover:bg-white/20 transition-all active:scale-90",children:c.jsx(It,{size:22,className:"text-gray-600 dark:text-gray-400"})})]}),S&&c.jsxs("div",{className:`mb-4 p-4 rounded-3xl flex flex-col gap-3 animate-in shake-1 duration-300 ${j?"bg-amber-50 dark:bg-amber-950/30 border border-amber-100 dark:border-amber-900/30 text-amber-700 dark:text-amber-400":be||De?"bg-orange-50 dark:bg-orange-950/30 border border-orange-100 dark:border-orange-900/30 text-orange-700 dark:text-orange-400":"bg-red-50 dark:bg-red-950/20 border border-red-100 dark:border-red-900/30 text-red-600 dark:text-red-400"} `,children:[c.jsxs("div",{className:"flex items-start gap-3",children:[j?c.jsx(vw,{className:"shrink-0 mt-0.5",size:18}):be||De?c.jsx(zg,{className:"shrink-0 mt-0.5",size:18}):c.jsx(Pc,{className:"shrink-0 mt-0.5",size:18}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:j?"AI limit reached":De?"Phone Storage Full":be?"Cloud Storage Full":"Action Failed"}),c.jsx("p",{className:"text-xs font-semibold leading-relaxed",children:S})]})]}),!De&&(j||!be)&&c.jsxs("button",{onClick:()=>{v(null),i==="upload"?ze():te()},className:"w-full py-2 bg-white/50 dark:bg-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-white/80 dark:hover:bg-white/20 transition-all",children:[c.jsx(Iw,{size:14})," Try Again"]}),De&&c.jsx("div",{className:"pt-2 border-t border-orange-200 dark:border-orange-900/40",children:c.jsx("p",{className:"text-[10px] font-medium text-orange-600/70 dark:text-orange-400/70 italic",children:"Tip: Photos take up the most space. Delete old entries in the History tab to free up browser storage."})})]}),i==="upload"?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex p-1.5 bg-gray-100/80 dark:bg-white/5 rounded-[24px] backdrop-blur-sm border border-black/5 dark:border-white/5",children:[c.jsxs("button",{onClick:()=>o("scan"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="scan"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[c.jsx(nr,{size:18,className:s==="scan"?"animate-pulse":""}),c.jsx("span",{children:"Scan"})]}),c.jsxs("button",{onClick:()=>o("chat"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="chat"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[c.jsx(bw,{size:18}),c.jsx("span",{children:"Chat"})]}),c.jsxs("button",{onClick:()=>o("shared"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="shared"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[c.jsx(uu,{size:18}),c.jsx("span",{children:"Shared"})]}),c.jsxs("button",{onClick:()=>o("recipe"),className:`flex-1 py-3.5 flex items-center justify-center gap-2 rounded-[18px] text-[13px] font-bold transition-all duration-300 ${s==="recipe"?"bg-white dark:bg-royal-600 text-royal-600 dark:text-white shadow-[0_4px_12px_rgba(0,0,0,0.08)]":"text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300"} `,children:[c.jsx(Li,{size:18}),c.jsx("span",{children:"Recipe"})]})]}),s==="scan"&&c.jsxs(c.Fragment,{children:[u?c.jsxs("div",{className:"rounded-[32px] overflow-hidden h-64 relative mb-6 shadow-xl border border-white/10",children:[c.jsx("img",{src:u,className:"w-full h-full object-cover"}),c.jsx("button",{onClick:()=>d(null),className:"absolute top-4 right-4 bg-black/40 text-white p-2 rounded-full backdrop-blur-md",children:c.jsx(It,{size:20})})]}):c.jsxs("div",{onClick:()=>{var $;return($=y.current)==null?void 0:$.click()},className:"border-2 border-dashed border-gray-200 dark:border-white/10 rounded-[32px] h-64 flex flex-col items-center justify-center cursor-pointer hover:border-royal-400 hover:bg-royal-50 dark:hover:bg-white/5 transition-all group",children:[c.jsx(nr,{size:48,className:"text-gray-300 group-hover:text-royal-600 mb-4 transition-colors"}),c.jsx("p",{className:"text-gray-900 dark:text-gray-50 font-bold",children:"Snap or Upload Photo"}),c.jsx("p",{className:"text-gray-400 text-xs mt-1 italic",children:"Let AI do the calorie math"})]}),c.jsx("input",{type:"file",ref:y,accept:"image/*",onChange:de,className:"hidden"}),c.jsx(Me,{className:"w-full py-5 text-lg font-black",disabled:!u||h,isLoading:h,onClick:ze,children:"Analyze Plate"})]}),s==="chat"&&c.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[c.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 p-5 rounded-[32px] border border-royal-100 dark:border-royal-900/30 transition-colors",children:[c.jsxs("p",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-widest mb-3 flex items-center gap-2",children:[c.jsx(zt,{size:14})," Describe your meal"]}),c.jsx("textarea",{value:w,onChange:$=>b($.target.value),placeholder:"e.g. I had two slices of pepperoni pizza and a small Caesar salad with Italian dressing.",rows:4,className:"w-full bg-transparent border-none outline-none text-gray-900 dark:text-white font-medium text-sm resize-none placeholder-gray-400 dark:placeholder-gray-600"})]}),c.jsx(Me,{className:"w-full py-5 text-lg font-black shadow-xl shadow-royal-200",disabled:!w.trim()||h,isLoading:h,onClick:P,children:"Ask AI"})]}),s==="recipe"&&c.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300 text-center py-6",children:[c.jsx(Li,{size:40,className:"mx-auto text-royal-400 mb-2"}),c.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"Recipe Mode Coming Soon"}),c.jsx("p",{className:"text-xs font-medium text-gray-400 px-8",children:"For now, use Chat mode to describe your recipe ingredients for estimation."}),c.jsx(Me,{className:"w-full py-3 mt-4 text-xs font-bold text-gray-400 hover:text-royal-500 bg-gray-50 dark:bg-white/5",onClick:()=>a("details"),children:"Enter Details Manually"})]}),s==="shared"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 p-4 rounded-[24px] mb-6 border border-royal-100 dark:border-royal-900/30 flex gap-3 items-start",children:[c.jsx("div",{className:"p-2 bg-royal-100 dark:bg-royal-900/50 rounded-full shrink-0",children:c.jsx(uu,{size:16,className:"text-royal-600 dark:text-royal-400"})}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-white mb-1",children:"Shared Meal Mode"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed",children:"Upload a photo of the entire table. Connect directly to our multi-dish analysis engine."})]})]}),u?c.jsxs("div",{className:"rounded-[32px] overflow-hidden h-64 relative mb-6 shadow-xl border border-white/10 shadow-royal-200/20",children:[c.jsx("img",{src:u,className:"w-full h-full object-cover",alt:"preview"}),c.jsx("button",{onClick:()=>d(null),className:"absolute top-4 right-4 bg-black/40 text-white p-2 rounded-full backdrop-blur-md hover:bg-black/60 transition-colors",children:c.jsx(It,{size:20})}),c.jsx("div",{className:"absolute bottom-4 left-4 right-4 bg-black/60 backdrop-blur-md p-3 rounded-2xl border border-white/10",children:c.jsxs("p",{className:"text-white text-xs font-semibold text-center flex items-center justify-center gap-2",children:[c.jsx(zt,{size:14,className:"text-yellow-400"}),"Ready to analyze dishes"]})})]}):c.jsxs("div",{onClick:()=>{var $;return($=y.current)==null?void 0:$.click()},className:"border-2 border-dashed border-gray-200 dark:border-white/10 rounded-[32px] h-64 flex flex-col items-center justify-center cursor-pointer hover:border-royal-400 hover:bg-royal-50 dark:hover:bg-white/5 transition-all group",children:[c.jsx(nr,{size:48,className:"text-gray-300 group-hover:text-royal-600 mb-4 transition-colors"}),c.jsx("p",{className:"text-gray-900 dark:text-gray-50 font-bold",children:"Snap or Upload Photo"}),c.jsx("p",{className:"text-gray-400 text-xs mt-1 italic",children:"Capture the whole table"})]}),c.jsx("input",{type:"file",ref:y,accept:"image/*",onChange:de,className:"hidden"}),c.jsx("div",{className:"flex gap-3",children:c.jsx(Me,{className:"w-full py-5 text-lg font-black shadow-xl shadow-royal-200 dark:shadow-none bg-emerald-500 hover:bg-emerald-600 text-white",disabled:!u,onClick:()=>n(u||void 0),children:"Start Shared Meal"})})]}),s!=="recipe"&&s!=="shared"&&c.jsxs("button",{onClick:()=>a("details"),className:"w-full py-4 text-sm font-bold text-gray-400 dark:text-gray-500 hover:text-royal-500 transition-all flex items-center justify-center gap-2 group",children:[c.jsx("span",{children:"Enter Details Manually"}),c.jsx(ro,{size:16,className:"rotate-180 opacity-0 group-hover:opacity-100 transition-all transform -translate-x-1 group-hover:translate-x-0"})]})]}):c.jsxs("div",{className:"space-y-6 animate-in slide-in-from-right duration-300",children:[c.jsxs("div",{className:"bg-royal-600 rounded-[32px] p-6 text-white shadow-xl shadow-royal-200 dark:shadow-none",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-royal-100 text-[10px] font-black uppercase tracking-widest mb-1",children:"Estimated Calories"}),c.jsxs("div",{className:"flex items-baseline gap-1",children:[c.jsx("input",{type:"number",value:se,onChange:$=>N($.target.value),className:"bg-transparent text-4xl font-black w-24 outline-none border-b-2 border-white/20 focus:border-white transition-colors"}),c.jsx("span",{className:"text-xl font-bold opacity-70",children:"kcal"})]})]}),c.jsx("div",{className:"bg-white/20 p-3 rounded-2xl backdrop-blur-md",children:c.jsx(Rc,{size:24})})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("div",{className:"bg-white/10 rounded-xl p-3 flex flex-col items-center",children:[c.jsxs("div",{className:"relative w-full",children:[c.jsx("input",{type:"number",value:V,onChange:$=>z($.target.value),className:"bg-transparent text-xs font-black w-full outline-none border-b border-white/20 focus:border-white transition-colors text-center pb-1"}),c.jsx("span",{className:"absolute -bottom-0 right-0 text-[10px] font-bold opacity-50",children:"g"})]}),c.jsx("span",{className:"text-[8px] uppercase tracking-tighter opacity-70 mt-1",children:"Protein"})]}),c.jsxs("div",{className:"bg-white/10 rounded-xl p-3 flex flex-col items-center",children:[c.jsxs("div",{className:"relative w-full",children:[c.jsx("input",{type:"number",value:Q,onChange:$=>A($.target.value),className:"bg-transparent text-xs font-black w-full outline-none border-b border-white/20 focus:border-white transition-colors text-center pb-1"}),c.jsx("span",{className:"absolute -bottom-0 right-0 text-[10px] font-bold opacity-50",children:"g"})]}),c.jsx("span",{className:"text-[8px] uppercase tracking-tighter opacity-70 mt-1",children:"Carbs"})]}),c.jsxs("div",{className:"bg-white/10 rounded-xl p-3 flex flex-col items-center",children:[c.jsxs("div",{className:"relative w-full",children:[c.jsx("input",{type:"number",value:O,onChange:$=>I($.target.value),className:"bg-transparent text-xs font-black w-full outline-none border-b border-white/20 focus:border-white transition-colors text-center pb-1"}),c.jsx("span",{className:"absolute -bottom-0 right-0 text-[10px] font-bold opacity-50",children:"g"})]}),c.jsx("span",{className:"text-[8px] uppercase tracking-tighter opacity-70 mt-1",children:"Fat"})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-3 flex items-center gap-3 border border-gray-100 dark:border-white/5",children:[c.jsx(ur,{size:18,className:"text-royal-400"}),c.jsx("input",{type:"date",value:T,onChange:$=>M($.target.value),className:"bg-transparent text-sm font-bold w-full outline-none dark:text-white"})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-3 flex items-center gap-3 border border-gray-100 dark:border-white/5",children:[c.jsx(Bg,{size:18,className:"text-royal-400"}),c.jsx("input",{type:"time",value:R,onChange:$=>U($.target.value),className:"bg-transparent text-sm font-bold w-full outline-none dark:text-white"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase ml-1",children:"Meal Title"}),c.jsx("input",{type:"text",value:X,onChange:$=>ye($.target.value),className:"w-full p-4 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-2xl font-bold dark:text-white mt-1"})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-[32px] p-5 border border-gray-100 dark:border-white/5",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("h3",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[c.jsx(zt,{size:14,className:"text-royal-500"})," Ingredient Receipt"]}),c.jsx("button",{onClick:pe,className:"text-royal-500 hover:text-royal-600",children:c.jsx(Nw,{size:18})})]}),c.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto no-scrollbar pr-1",children:F.map(($,je)=>c.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left duration-200",children:[c.jsx("input",{type:"text",value:$.name,onChange:Qe=>Y(je,"name",Qe.target.value),className:"flex-1 bg-white dark:bg-white/10 p-2.5 rounded-xl text-xs font-bold border border-gray-100 dark:border-white/10 outline-none focus:border-royal-300 dark:text-white",placeholder:"Ingredient"}),c.jsxs("div",{className:"relative w-20",children:[c.jsx("input",{type:"number",value:$.grams===0?"":$.grams,onChange:Qe=>Y(je,"grams",Qe.target.value),className:"w-full bg-white dark:bg-white/10 p-2.5 pr-6 rounded-xl text-xs font-bold border border-gray-100 dark:border-white/10 outline-none text-right dark:text-white"}),c.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[8px] font-black text-gray-400",children:"g"})]}),c.jsx("button",{onClick:()=>ue(je),className:"text-red-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:c.jsx(so,{size:16})})]},je))}),c.jsxs(Me,{variant:"ghost",className:"w-full mt-4 py-3 text-[10px] font-black uppercase tracking-widest text-royal-600 bg-royal-100/50 hover:bg-royal-100",onClick:te,isLoading:m,children:[c.jsx(au,{size:14,className:`mr-2 ${m?"animate-spin":""} `}),"Recalculate Totals"]})]}),c.jsx(Me,{className:"w-full py-5 text-lg font-black shadow-xl shadow-royal-200",onClick:me,isLoading:x,disabled:x,children:r?"Update Record":"Save & Track"})]})]}),c.jsx(Sy,{isActive:h,message:s==="chat"?"Analyzing Request...":"Analyzing Meal..."})]})},nA=({currentGoal:t,onClose:e,onSave:n})=>{const[r,s]=E.useState(t.toString()),o=()=>{const i=parseInt(r,10);!isNaN(i)&&i>0&&n(i)};return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white w-full max-w-xs rounded-[32px] p-6 shadow-2xl border border-white/50 animate-in zoom-in-95 duration-200",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h2",{className:"text-lg font-extrabold text-gray-900",children:"Daily Calorie Goal"}),c.jsx("button",{onClick:e,className:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",children:c.jsx(It,{size:18,className:"text-gray-600"})})]}),c.jsxs("div",{className:"mb-8",children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-3 ml-1",children:"Target Calories"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:r,onChange:i=>s(i.target.value),className:"w-full p-5 bg-gray-50 border border-gray-100 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 transition-all font-extrabold text-3xl text-center text-gray-900",autoFocus:!0}),c.jsx("span",{className:"absolute right-6 top-1/2 -translate-y-1/2 text-gray-400 text-sm font-bold",children:"kcal"})]})]}),c.jsx(Me,{className:"w-full py-4 shadow-lg shadow-royal-200",onClick:o,children:"Update Goal"})]})})},Uu=({entry:t,onClose:e,onDelete:n,onEdit:r})=>{const[s,o]=E.useState(!1),[i,a]=E.useState(!1),u=async()=>{confirm("Permanently remove this record?")&&(o(!0),await n(t.id),e())},d=async()=>{if(confirm("Remove the photo to save storage space? Nutritional data will be kept.")){a(!0);try{await Tb(t.id),e(),window.dispatchEvent(new CustomEvent("food-entry-updated"))}catch(h){console.error("Failed to clear image",h),alert("Failed to clear image. Please try again.")}finally{a(!1)}}};return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 dark:bg-black/60 backdrop-blur-md p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl dark:shadow-black border border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300 max-h-[95vh] overflow-y-auto no-scrollbar",children:[c.jsxs("div",{className:"relative h-64 bg-gray-100 dark:bg-white/5",children:[t.imageUrl?c.jsxs(c.Fragment,{children:[c.jsx("img",{src:t.imageUrl,className:"w-full h-full object-cover"}),c.jsxs("button",{onClick:d,disabled:i,className:"absolute bottom-4 right-4 p-2.5 bg-white/20 hover:bg-white/40 text-white rounded-full backdrop-blur-md border border-white/20 transition-all flex items-center gap-2",title:"Remove photo to save space",children:[i?c.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):c.jsx(xw,{size:18}),c.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Clear Image"})]})]}):c.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-300 dark:text-gray-700",children:[c.jsx(Li,{size:48,className:"mb-2 opacity-50"}),c.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest opacity-40",children:"No Photo Attached"})]}),c.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 bg-white/80 dark:bg-black/40 text-gray-900 dark:text-white rounded-full backdrop-blur-md hover:bg-white dark:hover:bg-black/60 shadow-lg transition-colors z-10",children:c.jsx(It,{size:20})}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent pointer-events-none"}),c.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 text-white pointer-events-none",children:[c.jsx("h2",{className:"text-3xl font-black leading-tight tracking-tight",children:t.food_item}),c.jsxs("div",{className:"flex items-center gap-4 text-xs text-white/70 font-bold mt-2",children:[c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx(ur,{size:14})," ",t.date]}),c.jsxs("div",{className:"flex items-center gap-1.5",children:[c.jsx(Bg,{size:14})," ",t.time]})]})]})]}),c.jsxs("div",{className:"p-8 space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[c.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/20 p-3 rounded-2xl flex flex-col items-center border border-royal-100/50",children:[c.jsx("span",{className:"text-lg font-black text-royal-600",children:t.calories}),c.jsx("span",{className:"text-[8px] font-black uppercase text-royal-400",children:"kcal"})]}),c.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-950/20 p-3 rounded-2xl flex flex-col items-center border border-emerald-100/50",children:[c.jsxs("span",{className:"text-lg font-black text-emerald-600",children:[t.protein,"g"]}),c.jsx("span",{className:"text-[8px] font-black uppercase text-emerald-400",children:"Prot"})]}),c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-3 rounded-2xl flex flex-col items-center border border-blue-100/50",children:[c.jsxs("span",{className:"text-lg font-black text-blue-600",children:[t.carbs,"g"]}),c.jsx("span",{className:"text-[8px] font-black uppercase text-blue-400",children:"Carb"})]}),c.jsxs("div",{className:"bg-orange-50 dark:bg-orange-950/20 p-3 rounded-2xl flex flex-col items-center border border-orange-100/50",children:[c.jsxs("span",{className:"text-lg font-black text-orange-600",children:[t.fat,"g"]}),c.jsx("span",{className:"text-[8px] font-black uppercase text-orange-400",children:"Fat"})]})]}),t.ingredients&&t.ingredients.length>0&&c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-3xl p-6 border border-gray-100 dark:border-white/5",children:[c.jsxs("h3",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-4",children:[c.jsx(_w,{size:14})," Ingredient Receipt"]}),c.jsx("div",{className:"space-y-3",children:t.ingredients.map((h,p)=>c.jsxs("div",{className:"flex justify-between items-center text-sm font-bold border-b border-gray-100 dark:border-white/5 pb-2 last:border-0 last:pb-0",children:[c.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:h.name}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("span",{className:"text-gray-400",children:[h.grams,"g"]}),c.jsxs("span",{className:"text-royal-500 text-xs w-12 text-right",children:[h.calories,"cal"]})]})]},p))})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs(Me,{variant:"ghost",className:"flex-1 text-red-500 py-4 font-black",onClick:u,isLoading:s,children:[c.jsx(so,{size:18,className:"mr-2"})," Delete"]}),c.jsxs(Me,{className:"flex-[2] py-4 font-black shadow-lg shadow-royal-200",onClick:()=>r(t),children:[c.jsx(qg,{size:18,className:"mr-2"})," Edit Meal"]})]})]})]})})},rA=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",sA=()=>{const t=rA();return new nd({apiKey:t})},oA=`You are a professional nutritionist and vision AI. Identify all food items in this shared meal image.

For each dish on the table, provide:
1. The dish name (be specific, e.g., "Grilled Chicken Breast" not just "Chicken")
2. A bounding box in [ymin, xmin, ymax, xmax] format with normalized coordinates (0-1000 scale)
3. Total calorie estimate for the ENTIRE portion visible on the table
4. Confidence score (0-1) based on how clearly you can identify the dish

IMPORTANT:
- Detect ALL distinct food items/dishes in the image
- Each dish should have its own bounding box
- Bounding boxes should tightly encompass each dish
- Calorie estimates are for the FULL portion shown, not per serving
- If the image contains no food, return an empty dishes array

Return ONLY a valid JSON object with this exact format:
{
  "dishes": [
    {
      "dish_name": "Dish name here",
      "bounding_box": [ymin, xmin, ymax, xmax],
      "estimated_total_calories": number,
      "confidence_score": 0.95
    }
  ]
}`,iA=t=>{const e=(t==null?void 0:t.message)||String(t)||"",n=e.toLowerCase();return e.includes("429")||n.includes("quota")||n.includes("limit")||n.includes("exhausted")?"AI Limit Reached: You've sent too many requests. Please wait about 60 seconds for the quota to reset.":n.includes("api key")?"Configuration Error: Invalid API key. Please check your settings.":n.includes("network")||n.includes("fetch")?"Connection Error: Please check your internet connection and try again.":e||"An unexpected AI error occurred."};async function ky(t,e=2,n=2e3){try{return await t()}catch(r){const s=(r==null?void 0:r.message)||"";if((s.includes("429")||s.toLowerCase().includes("quota"))&&e>0)return console.warn(`Gemini Quota hit. Retrying in ${n}ms... (${e} retries left)`),await new Promise(i=>setTimeout(i,n)),ky(t,e-1,n*2);throw r}}const Tp=async t=>{try{return await ky(async()=>{const n=await sA().models.generateContent({model:"gemini-2.0-flash-exp",contents:{parts:[{inlineData:{mimeType:"image/jpeg",data:t}},{text:"Analyze this shared meal image and identify all dishes with their locations and calorie estimates."}]},config:{systemInstruction:oA,responseMimeType:"application/json",responseSchema:{type:ie.OBJECT,properties:{dishes:{type:ie.ARRAY,items:{type:ie.OBJECT,properties:{dish_name:{type:ie.STRING},bounding_box:{type:ie.ARRAY,items:{type:ie.INTEGER}},estimated_total_calories:{type:ie.INTEGER},confidence_score:{type:ie.NUMBER}},required:["dish_name","bounding_box","estimated_total_calories","confidence_score"]}}},required:["dishes"]},temperature:.4,topP:.95}}),r=JSON.parse(n.text||"{}");if(!r.dishes||!Array.isArray(r.dishes))throw new Error("Invalid response format from AI");if(r.dishes.forEach((s,o)=>{if(!Array.isArray(s.bounding_box)||s.bounding_box.length!==4)throw new Error(`Invalid bounding box format for dish ${o+1}`);s.bounding_box=s.bounding_box.map(i=>Math.max(0,Math.min(1e3,i)))}),r.dishes.length===0)throw new Error("No dishes detected in this image. Please ensure the photo clearly shows food items on a table.");return r})}catch(e){throw console.error("Gemini Shared Meal Analysis Error:",e),new Error(iA(e))}},aA=(t,e=600,n=150)=>new Promise((r,s)=>{const o=new FileReader;o.readAsDataURL(t),o.onload=i=>{var u;const a=new Image;a.src=(u=i.target)==null?void 0:u.result,a.onload=()=>{const d=document.createElement("canvas");let h=a.width,p=a.height;h>e&&(p=e/h*p,h=e),d.width=h,d.height=p;const m=d.getContext("2d");m==null||m.drawImage(a,0,0,h,p);let g=.5,x=d.toDataURL("image/jpeg",g);const _=n*1024;x.split(",")[1].length*3/4>_&&(g=.35,x=d.toDataURL("image/jpeg",g),x.split(",")[1].length*3/4>_&&(g=.25,x=d.toDataURL("image/jpeg",g))),r(x)},a.onerror=d=>s(d)},o.onerror=i=>s(i)}),lA=({onClose:t,onSuccess:e,initialImage:n})=>{const[r,s]=E.useState(n?"analyzing":"upload"),[o,i]=E.useState(n||null),[a,u]=E.useState([]),[d,h]=E.useState(new Map),[p,m]=E.useState(null),[g,x]=E.useState(50),[_,S]=E.useState(null),[v,y]=E.useState(!1),w=E.useRef(null),b=E.useRef(null),[C,k]=E.useState({width:0,height:0}),T=async N=>{if(N.target.files&&N.target.files[0]){const V=N.target.files[0];try{const z=await aA(V,600,150);i(z),S(null)}catch{S("Failed to process image.")}}};E.useEffect(()=>{n&&r==="analyzing"&&(async()=>{try{const V=n.split(",")[1],z=await Tp(V);u(z.dishes),s("selection")}catch(V){S(V.message),s("upload")}})()},[n]);const M=async()=>{if(o){s("analyzing"),S(null);try{const N=o.split(",")[1],V=await Tp(N);u(V.dishes),s("selection")}catch(N){S(N.message),s("upload")}}};E.useEffect(()=>{if(b.current&&r==="selection"){const N=()=>{b.current&&k({width:b.current.offsetWidth,height:b.current.offsetHeight})};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)}},[r]);const R=N=>{if(!b.current)return{x:0,y:0};const V=b.current,z=V.offsetWidth,Q=V.offsetHeight,A=V.naturalWidth,O=V.naturalHeight,I=(N[1]+N[3])/2,F=(N[0]+N[2])/2,D=I/1e3,K=F/1e3,ee=A/O,Z=z/Q;let H=z,de=Q,ze=0,P=0;return ee>Z?(de=z/ee,P=(Q-de)/2):(H=Q*ee,ze=(z-H)/2),{x:D*H+ze,y:K*de+P}},U=N=>{m(N),x(d.get(N)||50)},X=()=>{if(p!==null){const N=new Map(d);g>0?N.set(p,g):N.delete(p),h(N),m(null)}},ye=()=>{let N=0;return d.forEach((V,z)=>{const Q=a[z];N+=Math.round(Q.estimated_total_calories*V/100)}),N},se=async()=>{if(d.size===0){S("Please select at least one dish portion.");return}y(!0),S(null);try{const N=new Date,V=N.toISOString(),z=ls(),Q=`${N.getHours().toString().padStart(2,"0")}:${N.getMinutes().toString().padStart(2,"0")}`;for(const[A,O]of Array.from(d.entries())){const I=a[A],F=Math.round(I.estimated_total_calories*O/100),D={id:_y(),timestamp:V,date:z,time:Q,food_item:`${I.dish_name} (Shared Meal - ${O}%)`,calories:F,protein:0,carbs:0,fat:0,confidence:I.confidence_score,imageUrl:o||void 0,isManual:!1};await w0(D)}e()}catch(N){console.error("Save failed:",N),S(N.message||"Failed to save entries.")}finally{y(!1)}};return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] w-full max-w-md rounded-[40px] p-6 shadow-2xl border border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300 max-h-[95vh] overflow-y-auto no-scrollbar",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h2",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:r==="upload"?"Shared Meal":r==="analyzing"?"Analyzing...":r==="selection"?"Select Portions":"Confirm"}),c.jsx("button",{onClick:t,className:"p-2 bg-gray-100 dark:bg-white/5 rounded-full hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:c.jsx(It,{size:20,className:"text-gray-600 dark:text-gray-400"})})]}),_&&c.jsxs("div",{className:"mb-4 p-4 rounded-3xl flex items-start gap-3 bg-red-50 dark:bg-red-950/20 border border-red-100 dark:border-red-900/30 text-red-600 dark:text-red-400 animate-in shake-1 duration-300",children:[c.jsx(Pc,{className:"shrink-0 mt-0.5",size:18}),c.jsx("p",{className:"text-xs font-semibold leading-relaxed",children:_})]}),r==="upload"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 p-5 rounded-[32px] border border-royal-100 dark:border-royal-900/30",children:[c.jsx("p",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 mb-2",children:" Shared Meal Mode"}),c.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 leading-relaxed",children:"Take a photo of a table with multiple dishes. The AI will identify each dish and let you specify what percentage you ate."})]}),o?c.jsxs("div",{className:"rounded-[32px] overflow-hidden h-64 relative mb-6 shadow-xl border border-white/10",children:[c.jsx("img",{src:o,className:"w-full h-full object-cover",alt:"preview"}),c.jsx("button",{onClick:()=>i(null),className:"absolute top-4 right-4 bg-black/40 text-white p-2 rounded-full backdrop-blur-md",children:c.jsx(It,{size:20})})]}):c.jsxs("div",{onClick:()=>{var N;return(N=w.current)==null?void 0:N.click()},className:"border-2 border-dashed border-gray-200 dark:border-white/10 rounded-[32px] h-64 flex flex-col items-center justify-center cursor-pointer hover:border-royal-400 hover:bg-royal-50 dark:hover:bg-white/5 transition-all group",children:[c.jsx(nr,{size:48,className:"text-gray-300 group-hover:text-royal-600 mb-4 transition-colors"}),c.jsx("p",{className:"text-gray-900 dark:text-gray-50 font-bold",children:"Snap or Upload Photo"}),c.jsx("p",{className:"text-gray-400 text-xs mt-1 italic",children:"Capture the whole table"})]}),c.jsx("input",{type:"file",ref:w,accept:"image/*",onChange:T,className:"hidden"}),c.jsx(Me,{className:"w-full py-5 text-lg font-black",disabled:!o,onClick:M,children:"Detect Dishes"})]}),r==="analyzing"&&c.jsx(Sy,{isActive:!0,message:"Analyzing Shared Meal..."}),r==="selection"&&o&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"relative rounded-[32px] overflow-hidden border border-white/10 shadow-xl",children:[c.jsx("img",{ref:b,src:o,className:"w-full h-auto object-contain max-h-[400px]",alt:"Shared meal",onLoad:()=>{b.current&&k({width:b.current.offsetWidth,height:b.current.offsetHeight})}}),a.map((N,V)=>{const z=R(N.bounding_box),Q=d.has(V);return c.jsx("button",{onClick:()=>U(V),className:`absolute w-10 h-10 rounded-full flex items-center justify-center transition-all transform -translate-x-1/2 -translate-y-1/2 ${Q?"bg-emerald-500 shadow-lg shadow-emerald-500/50 scale-110":"bg-royal-600 shadow-lg shadow-royal-600/50 hover:scale-110"}`,style:{left:`${z.x}px`,top:`${z.y}px`},children:Q?c.jsx(fw,{size:20,className:"text-white"}):c.jsx("span",{className:"text-white text-xs font-black",children:V+1})},V)})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-[32px] p-5 border border-gray-100 dark:border-white/5",children:[c.jsxs("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-3",children:["Detected Dishes (",a.length,")"]}),c.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto no-scrollbar",children:a.map((N,V)=>c.jsxs("button",{onClick:()=>U(V),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all ${d.has(V)?"bg-emerald-50 dark:bg-emerald-950/30 border border-emerald-200 dark:border-emerald-900/30":"bg-white dark:bg-white/5 border border-gray-100 dark:border-white/10 hover:border-royal-300"}`,children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"w-6 h-6 rounded-full bg-royal-600 text-white text-xs font-black flex items-center justify-center",children:V+1}),c.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 truncate",children:N.dish_name})]}),d.has(V)&&c.jsxs("span",{className:"text-xs font-black text-emerald-600 dark:text-emerald-400",children:[d.get(V),"%"]})]},V))})]}),d.size>0&&c.jsxs(Me,{className:"w-full py-5 text-lg font-black",onClick:()=>s("confirmation"),children:["Review Selection (",d.size," ",d.size===1?"dish":"dishes",")"]})]}),r==="confirmation"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-royal-600 rounded-[32px] p-6 text-white shadow-xl",children:[c.jsx("p",{className:"text-royal-100 text-[10px] font-black uppercase tracking-widest mb-1",children:"Total Calories"}),c.jsxs("div",{className:"flex items-baseline gap-1",children:[c.jsx("span",{className:"text-5xl font-black tracking-tighter",children:ye()}),c.jsx("span",{className:"text-xl font-bold opacity-70",children:"kcal"})]}),c.jsxs("p",{className:"text-xs text-white/70 mt-2",children:["From ",d.size," portion",d.size!==1?"s":""]})]}),c.jsx("div",{className:"space-y-3",children:Array.from(d.entries()).map(([N,V])=>{const z=a[N],Q=Math.round(z.estimated_total_calories*V/100);return c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 text-sm",children:z.dish_name}),c.jsxs("span",{className:"text-xs font-black text-royal-600 dark:text-royal-400",children:[V,"%"]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("span",{className:"text-xs text-gray-400",children:["Portion of ",z.estimated_total_calories," kcal"]}),c.jsxs("span",{className:"font-extrabold text-gray-900 dark:text-gray-50",children:[Q," kcal"]})]})]},N)})}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(Me,{variant:"ghost",className:"flex-1 py-4",onClick:()=>s("selection"),children:"Edit"}),c.jsx(Me,{className:"flex-1 py-4 text-lg font-black",onClick:se,isLoading:v,disabled:v,children:"Save All"})]})]}),p!==null&&r==="selection"&&c.jsx("div",{className:"fixed inset-x-0 bottom-0 z-[110] bg-white dark:bg-[#1a1c26] rounded-t-[40px] p-6 shadow-2xl border-t border-white/50 dark:border-white/5 animate-in slide-in-from-bottom duration-300",children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-black text-gray-900 dark:text-gray-50",children:a[p].dish_name}),c.jsx("button",{onClick:()=>m(null),className:"p-2 bg-gray-100 dark:bg-white/5 rounded-full",children:c.jsx(Vg,{size:20,className:"text-gray-600 dark:text-gray-400"})})]}),c.jsxs("div",{className:"bg-royal-50 dark:bg-royal-950/40 rounded-2xl p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase flex items-center gap-1",children:[c.jsx(Cw,{size:14})," Your Portion"]}),c.jsxs("span",{className:"text-2xl font-black text-royal-600 dark:text-royal-400",children:[g,"%"]})]}),c.jsx("input",{type:"range",min:"0",max:"100",step:"5",value:g,onChange:N=>x(Number(N.target.value)),className:"w-full h-2 bg-royal-200 dark:bg-royal-900/30 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-6 [&::-webkit-slider-thumb]:h-6 [&::-webkit-slider-thumb]:bg-royal-600 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer"})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-4 mb-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-xs text-gray-400",children:"Your Calories"}),c.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[Math.round(a[p].estimated_total_calories*g/100)," kcal"]})]}),c.jsxs("div",{className:"text-[10px] text-gray-400 mt-1",children:["Total dish: ",a[p].estimated_total_calories," kcal"]})]}),c.jsx(Me,{className:"w-full py-4 text-lg font-black",onClick:X,children:"Confirm Selection"})]})})]})})},uA=()=>{const[t,e]=E.useState([]),[n,r]=E.useState(!1),[s,o]=E.useState(!1),[i,a]=E.useState(null),[u,d]=E.useState(null),[h,p]=E.useState(0),[m,g]=E.useState(0),[x,_]=E.useState(0),[S,v]=E.useState(0),[y,w]=E.useState(2e3),[b,C]=E.useState(0),[k,T]=E.useState(!0),[M,R]=E.useState(""),[U,X]=E.useState(!1),[ye,se]=E.useState(null),N=async()=>{try{const I=await _b(),F=ls(),D=I.filter(Z=>Z.date===F);D.sort((Z,H)=>H.timestamp.localeCompare(Z.timestamp)),e(D),p(D.reduce((Z,H)=>Z+H.calories,0)),g(D.reduce((Z,H)=>Z+(H.protein||0),0)),_(D.reduce((Z,H)=>Z+(H.carbs||0),0)),v(D.reduce((Z,H)=>Z+(H.fat||0),0));const K=await Vc();w(K);const ee=await Bc();ee!=null&&ee.name&&R(ee.name)}catch(I){console.error("Failed to load dashboard data",I)}finally{T(!1)}};E.useEffect(()=>{N();const I=()=>N();window.addEventListener("food-entry-updated",I);const F=()=>{console.log(" Dashboard: Midnight detected, reloading data..."),N()};return window.addEventListener("midnight-refresh",F),()=>{window.removeEventListener("food-entry-updated",I),window.removeEventListener("midnight-refresh",F)}},[]),E.useEffect(()=>{if(k)return;const I=Math.min(h/y*100,100),F=setTimeout(()=>{C(I)},100);return()=>clearTimeout(F)},[h,y,k]);const V=async I=>{await _0(I),await N()},z=I=>{a(null),d(I),r(!0)},Q=async I=>{await va(I),w(I),o(!1)},A=()=>{const I=h/y*100;if(I>=100)return{background:"repeating-linear-gradient(45deg, #facc15, #facc15 12px, #171717 12px, #171717 24px)",boxShadow:"0 0 12px rgba(250, 204, 21, 0.4)"};if(I<=60)return{background:"#10b981",boxShadow:"0 0 12px rgba(16, 185, 129, 0.4)"};if(I<=80)return{background:`linear-gradient(90deg, #10b981 0%, #10b981 ${60/I*100}%, #facc15 100%)`,boxShadow:"0 0 12px rgba(250, 204, 21, 0.3)"};const F=60/I*100,D=80/I*100;return{background:`linear-gradient(90deg, #10b981 0%, #10b981 ${F}%, #facc15 ${D}%, #f97316 100%)`,boxShadow:"0 0 12px rgba(249, 115, 22, 0.3)"}},O=I=>{if(I.isManual)return I.imageUrl?c.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-amber-50 dark:bg-amber-950/20 text-amber-600 dark:text-amber-400 text-[10px] font-bold tracking-wide",children:[c.jsx(Ew,{size:10}),"EDITED"]}):c.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 rounded-full bg-gray-100 dark:bg-white/5 text-gray-500 dark:text-gray-400 text-[10px] font-bold tracking-wide",children:[c.jsx(rs,{size:10}),"MANUAL"]});const F=Math.round(I.confidence*100),D=F>80?"bg-emerald-50 dark:bg-emerald-950/20 text-emerald-600 dark:text-emerald-400":F>50?"bg-orange-50 dark:bg-orange-950/20 text-orange-600 dark:text-orange-400":"bg-rose-50 dark:bg-rose-950/20 text-rose-600 dark:text-rose-400";return c.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-[10px] font-bold tracking-wide ${D}`,children:[c.jsx(zt,{size:10}),F,"% AI"]})};return c.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-hidden relative",children:[c.jsxs("div",{className:"flex-shrink-0 px-6 pt-10 space-y-8 pb-4",children:[c.jsxs("header",{className:"flex justify-between items-end",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:new Date().toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),c.jsxs("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight leading-none",children:["Hello ",M||"there",", ",c.jsx("br",{}),"Let's Eat Well."]})]}),c.jsx("div",{className:"w-12 h-12 bg-royal-100 dark:bg-royal-950/30 rounded-full flex items-center justify-center text-royal-600 dark:text-royal-400 shadow-sm border border-white dark:border-white/5",children:c.jsx(xf,{size:20})})]}),c.jsxs("div",{className:`relative rounded-[32px] p-6 text-white overflow-hidden shadow-xl transition-all duration-500 ${h>y?"bg-red-500 shadow-red-200 dark:shadow-red-900/40":"bg-royal-600 shadow-royal-200 dark:shadow-royal-900/40"}`,children:[c.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-black/10 rounded-full blur-3xl"}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-white/70 text-xs font-bold uppercase tracking-widest mb-1",children:"Calories Consumed"}),c.jsxs("div",{className:"flex items-baseline gap-1",children:[c.jsx("span",{className:"text-5xl font-bold tracking-tighter",children:k?"...":h}),c.jsx("span",{className:"text-lg text-white/60 font-medium",children:"kcal"})]})]}),c.jsx("div",{className:"text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2 text-white/80 mb-1",children:[c.jsxs("span",{className:"text-xs font-semibold",children:["Goal: ",y]}),c.jsx("button",{onClick:()=>o(!0),className:"p-1.5 rounded-full bg-white/20 hover:bg-white/30 transition-colors backdrop-blur-sm",children:c.jsx(qg,{size:10})})]})})]}),c.jsx("div",{className:"w-full bg-black/20 rounded-full h-4 mb-3 overflow-hidden backdrop-blur-sm relative",children:c.jsx("div",{className:"h-full rounded-full transition-all duration-1000 ease-out will-change-[width] flex items-center justify-center overflow-hidden",style:{width:`${b}%`,...A()},children:h/y>=1&&c.jsx("span",{className:"text-[10px] font-black tracking-tighter text-white drop-shadow-md animate-pulse",children:"OVER LIMIT"})})}),c.jsx("div",{className:"flex justify-end mb-6",children:h>y?c.jsxs("div",{className:"flex items-center gap-1.5 bg-white/20 backdrop-blur-md px-3 py-1 rounded-full animate-pulse",children:[c.jsx(cw,{size:14,className:"text-white",fill:"white"}),c.jsxs("span",{className:"font-bold text-xs text-white",children:[Math.abs(y-h).toLocaleString()," kcal over limit"]})]}):c.jsxs("p",{className:"text-xs font-medium text-white/80",children:[Math.max(y-h,0).toLocaleString()," kcal remaining"]})}),c.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-5 pt-4 border-t border-white/10",children:[c.jsxs("div",{className:"flex flex-col items-center justify-center p-2 rounded-2xl bg-emerald-500/20 border border-emerald-400/20 shadow-sm relative overflow-hidden group",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-400/10 to-transparent opacity-50"}),c.jsx("p",{className:"text-[9px] uppercase font-bold text-emerald-100 mb-0.5 relative z-10 tracking-wider",children:"Protein"}),c.jsxs("div",{className:"flex items-baseline gap-0.5 relative z-10",children:[c.jsx("span",{className:"text-xl font-black text-emerald-50 shadow-black/10 drop-shadow-sm",children:m}),c.jsx("span",{className:"text-[10px] font-bold text-emerald-200/80",children:"g"})]})]}),c.jsxs("div",{className:"flex flex-col items-center justify-center p-2 rounded-2xl bg-amber-500/20 border border-amber-400/20 shadow-sm relative overflow-hidden group",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-400/10 to-transparent opacity-50"}),c.jsx("p",{className:"text-[9px] uppercase font-bold text-amber-100 mb-0.5 relative z-10 tracking-wider",children:"Carbs"}),c.jsxs("div",{className:"flex items-baseline gap-0.5 relative z-10",children:[c.jsx("span",{className:"text-xl font-black text-amber-50 shadow-black/10 drop-shadow-sm",children:x}),c.jsx("span",{className:"text-[10px] font-bold text-amber-200/80",children:"g"})]})]}),c.jsxs("div",{className:"flex flex-col items-center justify-center p-2 rounded-2xl bg-rose-500/20 border border-rose-400/20 shadow-sm relative overflow-hidden group",children:[c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-rose-400/10 to-transparent opacity-50"}),c.jsx("p",{className:"text-[9px] uppercase font-bold text-rose-100 mb-0.5 relative z-10 tracking-wider",children:"Fat"}),c.jsxs("div",{className:"flex items-baseline gap-0.5 relative z-10",children:[c.jsx("span",{className:"text-xl font-black text-rose-50 shadow-black/10 drop-shadow-sm",children:S}),c.jsx("span",{className:"text-[10px] font-bold text-rose-200/80",children:"g"})]})]})]})]})]})]}),c.jsx("div",{className:"flex-shrink-0 px-6 mb-4",children:c.jsxs("div",{className:"flex items-center justify-between px-1",children:[c.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-gray-50",children:"Recent Meals"}),c.jsxs("span",{className:"text-xs font-medium text-gray-400 dark:text-gray-500 bg-gray-100 dark:bg-white/5 px-2 py-1 rounded-lg",children:[t.length," items"]})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar px-6 pb-32",children:k?c.jsx("div",{className:"space-y-4",children:[1,2].map(I=>c.jsx("div",{className:"h-24 bg-white dark:bg-[#1a1c26] rounded-[32px] animate-pulse shadow-sm border border-white/5 dark:border-white/5"},I))}):t.length===0?c.jsxs("div",{className:"text-center py-16 bg-white dark:bg-[#1a1c26] rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark",children:[c.jsx("div",{className:"w-16 h-16 bg-gray-50 dark:bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300 dark:text-gray-700",children:c.jsx(xf,{size:24})}),c.jsx("p",{className:"text-gray-400 dark:text-gray-500 font-medium mb-1",children:"No meals tracked today."}),c.jsx("p",{className:"text-xs text-gray-300 dark:text-gray-700",children:"Tap the + button to add one."})]}):c.jsx("div",{className:"space-y-4",children:t.map(I=>c.jsxs(tt,{className:"flex gap-4 items-center p-4 group",onClick:()=>a(I),children:[c.jsx("div",{className:"w-16 h-16 bg-gray-50 dark:bg-white/5 rounded-2xl overflow-hidden flex-shrink-0 shadow-inner",children:I.imageUrl?c.jsx("img",{src:I.imageUrl,alt:I.food_item,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 dark:text-gray-700",children:c.jsx(rs,{size:20})})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"flex items-center gap-2 mb-1",children:c.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 truncate text-base",children:I.food_item})}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("p",{className:"text-xs font-semibold text-gray-400 dark:text-gray-500",children:I.time}),O(I)]})]}),c.jsxs("div",{className:"text-right pl-2",children:[c.jsx("span",{className:"block font-extrabold text-gray-900 dark:text-gray-50 text-lg",children:I.calories}),c.jsx("span",{className:"text-[10px] font-bold text-gray-400 dark:text-gray-500 uppercase",children:"kcal"})]})]},I.id))})}),c.jsx("button",{onClick:()=>{d(null),r(!0)},className:"absolute bottom-28 right-6 w-16 h-16 bg-royal-600 text-white rounded-[24px] shadow-[0_12px_24px_-6px_rgba(124,58,237,0.5)] flex items-center justify-center hover:scale-105 hover:bg-royal-700 active:scale-95 transition-all z-[60]",children:c.jsx(ji,{size:32,strokeWidth:2.5})}),n&&c.jsx(by,{editEntry:u,onClose:()=>{r(!1),d(null)},onSuccess:()=>{r(!1),d(null),N()},onOpenSharedMeal:I=>{r(!1),d(null),I&&se(I),setTimeout(()=>X(!0),100)}}),s&&c.jsx(nA,{currentGoal:y,onClose:()=>o(!1),onSave:Q}),i&&c.jsx(Uu,{entry:i,onClose:()=>a(null),onDelete:V,onEdit:z}),U&&c.jsx(lA,{initialImage:ye,onClose:()=>{X(!1),se(null)},onSuccess:()=>{X(!1),se(null),N()}})]})},cA=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",dA=()=>{const t=cA();return new nd({apiKey:t})},fA=`You are **Cal Coach**, an AI fitness and nutrition coach. Your mission is to provide simple, actionable advice to help users reach their goals.

**Core Principles:**
1. **Keep it Simple:** Use short, clear sentences. No jargon or complicated explanations.
2. **Focus on What Matters:** Only highlight the most important insights and actions.
3. **Be Encouraging:** Always stay positive and supportive, even when pointing out areas for improvement.
4. **Card-Friendly Format:** Structure responses to be visually scannable with emojis, bullet points, and short sections.

**Response Guidelines:**

When analyzing nutrition:
- Start with a simple status emoji ( Good /  Needs Work /  Excellent)
- Show only the most critical metrics (Calories, Protein)
- Use 2-3 bullet points max for observation
- Give 2-3 actionable next steps
- Keep total response under 150 words

When providing plans (workout/meal):
- Use simple bullet format, not complex tables
- Show only key exercises or meals (3-5 items max)
- Include specific numbers (reps, grams, servings)
- Add emoji indicators for visual appeal

When answering questions:
- Answer directly in 2-3 sentences
- Add one practical example if needed
- No lengthy explanations

**Formatting Style:**
 **Status**
Brief one-line summary

**Key Points:**
 Point 1 with number
 Point 2 with number
 Point 3 with number

**Action Steps:**
1. Simple action
2. Simple action

**Never:**
- Use complex tables with multiple columns
- Write long paragraphs
- Include technical disclaimers (assume user knows to consult doctors)
- Use phases like "Phase 1", "Phase 2"
- Repeat the user's data back to them

**Context Provided:**
You will receive user profile data and recent food tracking history in each message. Use this to provide personalized analysis and recommendations.`,Ey=async()=>{try{const t={},e=await Bc();e&&(t.userName=e.name,t.height=e.height,t.weight=e.weight,t.age=e.age,t.gender=e.gender,t.activityLevel=e.activityLevel,t.goal=e.goal,t.equipmentAccess=e.equipmentAccess);const n=await Vc();t.dailyGoal=n;const r=await Sb(),s=new Date().toISOString().split("T")[0],o=r.filter(a=>a.date===s);t.todayCalories=o.reduce((a,u)=>a+u.calories,0),t.todayProtein=o.reduce((a,u)=>a+u.protein,0),t.todayCarbs=o.reduce((a,u)=>a+u.carbs,0),t.todayFat=o.reduce((a,u)=>a+u.fat,0);const i=new Map;return r.forEach(a=>{i.has(a.date)||i.set(a.date,[]),i.get(a.date).push(a)}),t.recentEntries=Array.from(i.entries()).slice(0,7).map(([a,u])=>({date:a,totalCalories:u.reduce((d,h)=>d+h.calories,0),totalProtein:u.reduce((d,h)=>d+h.protein,0),totalCarbs:u.reduce((d,h)=>d+h.carbs,0),totalFat:u.reduce((d,h)=>d+h.fat,0),entryCount:u.length})),t}catch(t){return console.error("Failed to build coach context:",t),{}}},hA=t=>{let e=`**User Profile & Current Data:**

`;return t.userName&&(e+=`- Name: ${t.userName}
`),t.height&&(e+=`- Height: ${t.height} cm
`),t.weight&&(e+=`- Weight: ${t.weight} kg
`),t.age&&(e+=`- Age: ${t.age} years
`),t.gender&&(e+=`- Gender: ${t.gender.charAt(0).toUpperCase()+t.gender.slice(1)}
`),t.activityLevel&&(e+=`- Activity Level: ${{sedentary:"Sedentary",light:"Lightly Active",moderate:"Moderately Active",very:"Very Active",extra:"Extra Active"}[t.activityLevel]}
`),t.goal&&(e+=`- Goal: ${{cut:"Cut (Lose Fat)",bulk:"Bulk (Gain Muscle)",maintain:"Maintain"}[t.goal]}
`),t.equipmentAccess&&(e+=`- Equipment: ${{gym:"Gym Access",home:"Home Equipment",bodyweight:"Bodyweight Only"}[t.equipmentAccess]}
`),t.dailyGoal&&(e+=`- Daily Calorie Goal: ${t.dailyGoal} kcal
`),e+=`
**Today's Nutrition (${new Date().toLocaleDateString()}):**
`,e+=`- Calories: ${t.todayCalories||0} kcal
`,e+=`- Protein: ${t.todayProtein||0}g
`,e+=`- Carbs: ${t.todayCarbs||0}g
`,e+=`- Fat: ${t.todayFat||0}g
`,t.recentEntries&&t.recentEntries.length>0&&(e+=`
**Last 7 Days Summary:**
`,t.recentEntries.forEach(n=>{e+=`
${n.date}:
`,e+=`  - ${n.totalCalories} kcal | Protein: ${n.totalProtein}g | Carbs: ${n.totalCarbs}g | Fat: ${n.totalFat}g | Meals: ${n.entryCount}
`})),e+=`
---

`,e},hl=async(t,e)=>{try{const n=dA(),r=await Ey(),s=e.slice(-4).map(a=>`${a.role==="user"?"User":"Coach"}: ${a.content}`).join(`

`),o=`${hA(r)}${s?`**Recent Conversation:**
${s}

`:""}**User's Current Message:**
${t}`;return(await n.models.generateContent({model:"gemini-2.0-flash-exp",contents:[{parts:[{text:o}]}],config:{systemInstruction:fA,temperature:.7,topP:.95}})).text||"I apologize, but I couldn't generate a response. Please try again."}catch(n){console.error("Coach message error:",n);const r=(n==null?void 0:n.message)||String(n);throw r.includes("429")||r.toLowerCase().includes("quota")?new Error("Rate limit reached. Please wait a moment and try again."):r.toLowerCase().includes("api key")?new Error("Configuration error. Please check your API settings."):new Error("Failed to get coach response. Please try again.")}},pA=t=>{t.toLowerCase();const e=/\b(workout|exercise|training|routine|fitness|gym)\b/i.test(t),n=/day\s+\d+:/i.test(t),r=/\d+\s*(sets?|reps?|x)/i.test(t)||/sets?:\s*\d+/i.test(t)||/\d+\s*x\s*\d+/i.test(t),s=/(push-?up|pull-?up|squat|deadlift|bench\s+press|plank|lunge|curl|press|row)/i.test(t);return e&&(r||n||s)},Cp=t=>{const e=[];let n="AI Workout Plan";const r=t.match(/(?:^|\n)(?:##?\s*)?([A-Z][\w\s&]+(?:Day|Workout|Training|Routine))/i);r&&(n=r[1].trim());const s=t.split(`
`).map(o=>o.trim());for(let o=0;o<s.length;o++){const i=s[o];if(!i||i.startsWith("#")||i.startsWith("**Action")||i.startsWith("**Key"))continue;let a="",u=3,d="10",h="60s",p=i.replace(/^[\-\*]\s*/,"").replace(/^\d+\.\s*/,"");const m=p.match(/(\d+)\s*(?:sets?|x)/i)||p.match(/sets?:\s*(\d+)/i);m&&(u=parseInt(m[1]));const g=p.match(/(\d+(?:-\d+)?)\s*reps?/i)||p.match(/reps?:\s*(\d+(?:-\d+)?)/i);if(g)d=g[1];else{const S=p.match(/\dx(\d+(?:-\d+)?)/i);S&&(d=S[1])}const x=p.match(/(\d+(?:s|sec|seconds?|min|minutes?))/i)||p.match(/rest:\s*(\d+(?:s|sec|min)?)/i);x&&(h=x[1].toLowerCase().replace("seconds","s").replace("sec","s").replace("minutes","min").replace("minute","min"));const _=p.match(/^([A-Za-z][\w\s\-'()]+?)(?:\s*[-:|]|\s+\d)/);_?a=_[1].trim():/^[A-Za-z][\w\s\-'()]+$/.test(p)&&p.length<50&&(a=p),a&&!a.match(/^(sets?|reps?|rest|action|next|step)/i)&&e.push({id:`ex-${Date.now()}-${e.length}`,name:a,sets:u,reps:d,rest:h,completed:!1})}return{title:n,exercises:e}},mA=t=>{const e=/Day\s+(\d+):?\s*(.+?)(?=Day\s+\d+:|$)/gis,n=Array.from(t.matchAll(e));if(n.length<2){const{title:s,exercises:o}=Cp(t);return{isMultiDay:!1,days:[{dayNumber:1,title:s,exercises:o,isRestDay:o.length===0}]}}const r=n.map(s=>{const o=parseInt(s[1]),i=s[2].trim(),a=/^(rest|recovery|off)\s*$/i.test(i)||i.toLowerCase().includes("rest day"),u=i.match(/repeat\s+day\s+(\d+)/i);if(a)return{dayNumber:o,title:"Rest Day",exercises:[],isRestDay:!0};if(u)return{dayNumber:o,title:i,exercises:[],isRestDay:!1,repeatsDayNumber:parseInt(u[1])};const{title:d,exercises:h}=Cp(i);return{dayNumber:o,title:d==="AI Workout Plan"?i.split(`
`)[0]:d,exercises:h,isRestDay:h.length===0}});return r.forEach(s=>{if(s.repeatsDayNumber){const o=s.repeatsDayNumber,i=r.find(a=>a.dayNumber===o);i&&(s.title=i.title,s.exercises=i.exercises.map(a=>({...a,id:`ex-${Date.now()}-${Math.random()}`}))),delete s.repeatsDayNumber}}),{isMultiDay:!0,days:r}},gA=({isOpen:t,onClose:e,workoutText:n})=>{const[r,s]=E.useState(new Date().toISOString().split("T")[0]),[o,i]=E.useState(!1),[a,u]=E.useState(null);if(E.useEffect(()=>{if(t&&n){const _=mA(n);u(_)}},[t,n]),!t)return null;const d=async()=>{if(a){i(!0);try{await Db(r,a.days);const _=a.days.length,S=a.isMultiDay?`${_}-day`:"single-day";alert(`${S} workout plan saved successfully! Go check it out in the Workout Plan page.`),e()}catch(_){console.error("Failed to save workout:",_),alert("Failed to save workout plan")}finally{i(!1)}}},h=()=>{if(!a||!a.isMultiDay)return null;const _=new Date(r),S=new Date(_);return S.setDate(S.getDate()+a.days.length-1),S.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),m=h(),g=(a==null?void 0:a.days.length)||0,x=(a==null?void 0:a.isMultiDay)||!1;return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300 px-6",children:c.jsxs(tt,{className:"w-full max-w-md animate-in zoom-in-95 duration-300",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-white/10",children:[c.jsx("h2",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50",children:"Save Workout Plan"}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:c.jsx(It,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),c.jsxs("div",{className:"p-6 space-y-4",children:[x&&c.jsxs("div",{className:"p-4 bg-royal-50 dark:bg-royal-950/20 border-2 border-royal-200 dark:border-royal-800/50 rounded-xl",children:[c.jsxs("p",{className:"text-sm font-bold text-royal-900 dark:text-royal-100 mb-1",children:[" ",g,"-Day Workout Plan"]}),c.jsxs("p",{className:"text-xs text-royal-700 dark:text-royal-300",children:["Will be saved from ",c.jsx("strong",{children:p})," to ",c.jsx("strong",{children:m})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:x?"Choose Start Date":"Choose Date"}),c.jsx("input",{type:"date",value:r,onChange:_=>s(_.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"}),c.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:x?`Select the first day of your ${g}-day plan`:"Select which day you want to use this workout plan"})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-100 dark:border-white/10",children:[c.jsx("button",{onClick:e,disabled:o,className:"px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 rounded-xl font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),c.jsxs("button",{onClick:d,disabled:o,className:"flex items-center gap-2 px-6 py-3 bg-royal-600 hover:bg-royal-700 text-white rounded-xl font-semibold transition-colors disabled:opacity-50 shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:[c.jsx(Mc,{size:18}),c.jsx("span",{children:o?"Saving...":x?`Save ${g}-Day Plan`:"Save Plan"})]})]})]})})},yA=({onNavigate:t})=>{const[e,n]=E.useState([]),[r,s]=E.useState(""),[o,i]=E.useState(!1),[a,u]=E.useState(null),[d,h]=E.useState(!1),[p,m]=E.useState(new Set),[g,x]=E.useState(!1),[_,S]=E.useState(!0),[v,y]=E.useState(!1),[w,b]=E.useState(""),C=E.useRef(null),k=E.useRef(null),T=E.useRef(null),M=N=>!!(N.activityLevel&&N.goal&&N.equipmentAccess);E.useEffect(()=>{(async()=>{const V=await Ey();if(u(V),!M(V)){h(!0);return}await Mb();const z=ls(),Q=await Pb();if(Q.length>0)n(Q),m(new Set([z]));else{const A={id:crypto.randomUUID(),role:"assistant",content:` ** Hi ${V.userName||"there"} !I'm Cal Coach.**

How can I help you today?`,timestamp:Date.now()};n([A])}})()},[]),E.useEffect(()=>{var N;(N=C.current)==null||N.scrollIntoView({behavior:"smooth"})},[e]);const R=async()=>{var V;if(!r.trim()||o)return;const N={id:crypto.randomUUID(),role:"user",content:r,timestamp:Date.now()};n(z=>[...z,N]),s(""),i(!0),_r(N).catch(z=>console.error("Failed to save user message:",z));try{const z=await hl(r,e),Q={id:crypto.randomUUID(),role:"assistant",content:z,timestamp:Date.now()};n(A=>[...A,Q]),_r(Q).catch(A=>console.error("Failed to save assistant message:",A))}catch(z){const Q={id:crypto.randomUUID(),role:"assistant",content:` ${z.message||"Failed to get response. Please try again."}`,timestamp:Date.now()};n(A=>[...A,Q])}finally{i(!1),(V=k.current)==null||V.focus()}},U=N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),R())},X=()=>{t(ge.PROFILE)},ye=async()=>{if(!(g||!_)){x(!0);try{const V=Array.from(p).sort()[0];if(!V){S(!1);return}const z=new Date(V);z.setDate(z.getDate()-1);const Q=z.toISOString().split("T")[0],A=new Date().toISOString().split("T")[0];if(Math.floor((new Date(A).getTime()-new Date(Q).getTime())/(1e3*60*60*24))>=7){S(!1);return}const I=await k0(Q);if(I.length>0){const F=T.current,D=(F==null?void 0:F.scrollHeight)||0;n(K=>[...I,...K]),m(K=>new Set([...K,Q])),setTimeout(()=>{if(F){const K=F.scrollHeight;F.scrollTop=K-D}},0)}else m(F=>new Set([...F,Q]))}catch(N){console.error("Failed to load previous day messages:",N)}finally{x(!1)}}},se=()=>{const N=T.current;if(!N)return;const V=p.size>0;N.scrollTop<100&&!g&&_&&V&&ye()};return d?c.jsx("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:c.jsx("div",{className:"flex-1 flex items-center justify-center px-6",children:c.jsxs(tt,{className:"p-8 max-w-md w-full relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-32 h-32 bg-royal-100 dark:bg-royal-950/20 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-32 h-32 bg-royal-100 dark:bg-royal-950/20 rounded-full blur-3xl"}),c.jsxs("div",{className:"relative z-10",children:[c.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-lg mx-auto mb-6",children:c.jsx(vf,{size:32})}),c.jsx("h2",{className:"text-2xl font-extrabold text-gray-900 dark:text-gray-50 text-center mb-3",children:"Set Your Training Goals"}),c.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6 leading-relaxed",children:["To provide you with personalized AI coaching, please complete your"," ",c.jsx("span",{className:"font-bold text-royal-600 dark:text-royal-400",children:"Training Goal Setting"})," ","in your Profile."]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-4 mb-6",children:[c.jsx("p",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-3",children:"We need to know:"}),c.jsxs("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:""}),c.jsx("span",{children:"Your activity level (sedentary to extra active)"})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:""}),c.jsx("span",{children:"Your fitness goal (cut, bulk, or maintain)"})]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:""}),c.jsx("span",{children:"Your equipment access (gym, home, or bodyweight)"})]})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{onClick:X,className:"w-full flex items-center justify-center gap-2 py-4 bg-royal-600 hover:bg-royal-700 text-white rounded-[20px] font-bold transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[c.jsx(vf,{size:20}),c.jsx("span",{children:"Go to Profile"}),c.jsx(Di,{size:20})]}),c.jsx("button",{onClick:()=>h(!1),className:"w-full py-3 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 rounded-[20px] font-semibold transition-all text-sm",children:"I'll do this later"})]})]})]})})}):c.jsxs("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:[c.jsxs("header",{className:"flex justify-between items-end mb-6 flex-shrink-0",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:"Your Personal Coach"}),c.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight leading-none",children:"Cal Coach"})]}),c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-sm",children:c.jsx(zt,{size:20})})]}),c.jsxs("div",{ref:T,onScroll:se,className:"flex-1 overflow-y-auto space-y-4 mb-4 no-scrollbar",children:[g&&c.jsx("div",{className:"flex justify-center py-3 animate-in fade-in duration-300",children:c.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 text-sm",children:[c.jsx(el,{size:14,className:"animate-spin"}),c.jsx("span",{children:"Loading previous messages..."})]})}),!g&&_&&e.length>1&&c.jsx("div",{className:"flex justify-center py-2",children:c.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:" Scroll up to load older messages"})}),e.map(N=>c.jsx("div",{className:`flex ${N.role==="user"?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-2 duration-300`,children:c.jsx("div",{className:`max-w-[85%] ${N.role==="user"?"bg-royal-600 text-white rounded-[24px] px-5 py-3 shadow-lg":""}`,children:N.role==="assistant"?c.jsxs("div",{children:[c.jsx(tt,{className:"p-5",children:c.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:c.jsx("div",{className:"text-gray-800 dark:text-gray-200 leading-relaxed whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:N.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br/>")}})})}),pA(N.content)&&c.jsxs("button",{onClick:()=>{b(N.content),y(!0)},className:"mt-3 flex items-center gap-2 px-4 py-2 bg-royal-600 hover:bg-royal-700 text-white text-sm font-semibold rounded-xl transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[c.jsx(Mc,{size:16}),c.jsx("span",{children:"Save as Workout Plan"})]})]}):c.jsx("p",{className:"text-sm font-medium leading-relaxed",children:N.content})})},N.id)),e.length===1&&e[0].id==="welcome"&&!o&&c.jsx("div",{className:"grid grid-cols-1 gap-3 mt-4 animate-in fade-in slide-in-from-bottom-4 duration-500 delay-300",children:[{title:"Analyze Nutrition",desc:"Get insights on your recent eating habits",icon:"",text:"Analyze my recent nutrition",color:"from-blue-500/30 to-royal-500/30",baseBg:"bg-blue-50/40 dark:bg-blue-900/10",iconBg:"bg-blue-100 dark:bg-blue-900/40",iconBorder:"border-blue-200 dark:border-blue-700/50"},{title:"Workout Plan",desc:"Create a personalized fitness routine",icon:"",text:"Create a workout plan for me",color:"from-royal-500/30 to-indigo-500/30",baseBg:"bg-royal-50/40 dark:bg-royal-950/20",iconBg:"bg-royal-100 dark:bg-royal-950/40",iconBorder:"border-royal-200 dark:border-royal-700/50"},{title:"Calculate TDEE",desc:"Find out your daily energy expenditure",icon:"",text:"Calculate my TDEE",color:"from-orange-500/30 to-royal-500/30",baseBg:"bg-orange-50/40 dark:bg-orange-900/10",iconBg:"bg-orange-100 dark:bg-orange-900/40",iconBorder:"border-orange-200 dark:border-orange-700/50"},{title:"Macro Targets",desc:"Set optimal protein, carb, and fat goals",icon:"",text:"Help me set macro targets",color:"from-violet-500/30 to-fuchsia-500/30",baseBg:"bg-violet-50/40 dark:bg-violet-900/10",iconBg:"bg-violet-100 dark:bg-violet-900/40",iconBorder:"border-violet-200 dark:border-violet-700/50"}].map((N,V)=>c.jsxs("button",{onClick:()=>{(async Q=>{if(o)return;const A={id:crypto.randomUUID(),role:"user",content:Q,timestamp:Date.now()};n(O=>[...O,A]),i(!0),_r(A).catch(O=>console.error("Failed to save user message:",O));try{const O=await hl(Q,e),I={id:crypto.randomUUID(),role:"assistant",content:O,timestamp:Date.now()};n(F=>[...F,I]),_r(I).catch(F=>console.error("Failed to save assistant message:",F))}catch(O){const I={id:crypto.randomUUID(),role:"assistant",content:` ${O.message||"Failed to get response."}`,timestamp:Date.now()};n(F=>[...F,I])}finally{i(!1)}})(N.text)},className:`flex items-center gap-4 p-4 ${N.baseBg} border-2 border-gray-100 dark:border-white/10 rounded-2xl hover:border-royal-500 dark:hover:border-royal-400 hover:shadow-xl hover:shadow-royal-500/10 transition-all text-left group active:scale-[0.98] relative overflow-hidden`,children:[c.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${N.color} opacity-0 group-hover:opacity-100 transition-opacity`}),c.jsx("div",{className:`relative z-10 w-12 h-12 ${N.iconBg} ${N.iconBorder} border rounded-xl flex items-center justify-center text-2xl group-hover:scale-110 transition-transform shadow-sm group-hover:shadow-md`,children:N.icon}),c.jsxs("div",{className:"relative z-10 flex-1",children:[c.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 text-sm tracking-tight",children:N.title}),c.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-0.5 font-semibold opacity-80",children:N.desc})]}),c.jsx("div",{className:"relative z-10 w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 dark:bg-white/10 group-hover:bg-royal-500 group-hover:text-white transition-all shadow-sm",children:c.jsx(Di,{size:16,className:"text-gray-400 dark:text-gray-500 group-hover:text-white group-hover:translate-x-0.5 transition-all"})})]},V))}),o&&c.jsx("div",{className:"flex justify-start animate-in fade-in duration-300",children:c.jsx(tt,{className:"p-5",children:c.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[c.jsx(el,{size:16,className:"animate-spin"}),c.jsx("span",{className:"text-sm",children:"Coach is thinking..."})]})})}),c.jsx("div",{ref:C})]}),e.length>1&&!o&&c.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 px-1 no-scrollbar animate-in fade-in slide-in-from-bottom-2 duration-500",children:[{title:"Analyze Nutrition",icon:"",text:"Analyze my recent nutrition",color:"from-blue-500/30 to-royal-500/30",baseBg:"bg-blue-50/40 dark:bg-blue-900/10",iconBg:"bg-blue-100 dark:bg-blue-900/40",iconBorder:"border-blue-200 dark:border-blue-700/50"},{title:"Workout Plan",icon:"",text:"Create a workout plan for me",color:"from-royal-500/30 to-indigo-500/30",baseBg:"bg-royal-50/40 dark:bg-royal-950/20",iconBg:"bg-royal-100 dark:bg-royal-950/40",iconBorder:"border-royal-200 dark:border-royal-700/50"},{title:"Calculate TDEE",icon:"",text:"Calculate my TDEE",color:"from-orange-500/30 to-royal-500/30",baseBg:"bg-orange-50/40 dark:bg-orange-900/10",iconBg:"bg-orange-100 dark:bg-orange-900/40",iconBorder:"border-orange-200 dark:border-orange-700/50"},{title:"Macro Targets",icon:"",text:"Help me set macro targets",color:"from-violet-500/30 to-fuchsia-500/30",baseBg:"bg-violet-50/40 dark:bg-violet-900/10",iconBg:"bg-violet-100 dark:bg-violet-900/40",iconBorder:"border-violet-200 dark:border-violet-700/50"}].map((N,V)=>c.jsxs("button",{onClick:()=>{(async Q=>{if(o)return;const A={id:`user-${Date.now()}`,role:"user",content:Q,timestamp:Date.now()};n(O=>[...O,A]),i(!0),_r(A).catch(O=>console.error("Failed to save user message:",O));try{const O=await hl(Q,e),I={id:crypto.randomUUID(),role:"assistant",content:O,timestamp:Date.now()};n(F=>[...F,I]),_r(I).catch(F=>console.error("Failed to save assistant message:",F))}catch(O){const I={id:`error-${Date.now()}`,role:"assistant",content:` ${O.message||"Failed to get response."}`,timestamp:Date.now()};n(F=>[...F,I])}finally{i(!1)}})(N.text)},className:`flex flex-shrink-0 items-center gap-3 p-3 min-w-[180px] ${N.baseBg} border-2 border-gray-100 dark:border-white/10 rounded-2xl hover:border-royal-500 dark:hover:border-royal-400 transition-all text-left group active:scale-[0.98] relative overflow-hidden`,children:[c.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${N.color} opacity-0 group-hover:opacity-100 transition-opacity`}),c.jsx("div",{className:`relative z-10 w-10 h-10 ${N.iconBg} ${N.iconBorder} border rounded-xl flex items-center justify-center text-xl group-hover:scale-110 transition-transform shadow-sm`,children:N.icon}),c.jsx("div",{className:"relative z-10 flex-1",children:c.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 text-xs tracking-tight leading-tight",children:N.title})})]},V))}),c.jsx("div",{className:"flex-shrink-0 bg-white dark:bg-[#1a1c26] rounded-[24px] p-3 shadow-diffused dark:shadow-diffused-dark border border-gray-100 dark:border-white/5",children:c.jsxs("div",{className:"flex gap-2 items-end",children:[c.jsx("textarea",{ref:k,value:r,onChange:N=>s(N.target.value),onKeyDown:U,placeholder:"Ask your coach anything...",className:"flex-1 bg-transparent text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 resize-none outline-none text-sm min-h-[40px] max-h-[120px] py-2 px-3",rows:1,disabled:o}),c.jsx("button",{onClick:R,disabled:!r.trim()||o,className:"flex-shrink-0 w-10 h-10 bg-royal-600 text-white rounded-[16px] flex items-center justify-center hover:bg-royal-700 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:o?c.jsx(el,{size:18,className:"animate-spin"}):c.jsx(Aw,{size:18})})]})}),c.jsx(gA,{isOpen:v,onClose:()=>y(!1),workoutText:w})]})},vA=({isOpen:t,onClose:e,defaultDate:n,onSave:r})=>{const[s,o]=E.useState(""),[i,a]=E.useState(n.toISOString().split("T")[0]),[u,d]=E.useState([{name:"",sets:3,reps:"10",rest:"60s"}]),[h,p]=E.useState(!1);if(!t)return null;const m=()=>{d([...u,{name:"",sets:3,reps:"10",rest:"60s"}])},g=S=>{d(u.filter((v,y)=>y!==S))},x=(S,v,y)=>{const w=[...u];w[S]={...w[S],[v]:y},d(w)},_=async()=>{if(!s.trim()){alert("Please enter a workout title");return}const S=u.filter(v=>v.name.trim());if(S.length===0){alert("Please add at least one exercise");return}p(!0);try{const v=S.map((y,w)=>({...y,id:`ex-${Date.now()}-${w}`,completed:!1}));await Bi(i,s,v),o(""),d([{name:"",sets:3,reps:"10",rest:"60s"}]),a(n.toISOString().split("T")[0]),r==null||r(),e()}catch(v){console.error("Failed to save workout:",v),alert("Failed to save workout plan")}finally{p(!1)}};return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300 px-6",children:c.jsxs(tt,{className:"w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col animate-in zoom-in-95 duration-300",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-white/10",children:[c.jsx("h2",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50",children:"Create Workout Plan"}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:c.jsx(It,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Workout Title"}),c.jsx("input",{type:"text",value:s,onChange:S=>o(S.target.value),placeholder:"e.g., Chest & Triceps, Leg Day",className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),c.jsx("input",{type:"date",value:i,onChange:S=>a(S.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300",children:"Exercises"}),c.jsxs("button",{onClick:m,className:"flex items-center gap-1 px-3 py-1.5 bg-royal-600 hover:bg-royal-700 text-white text-sm font-semibold rounded-lg transition-colors",children:[c.jsx(ji,{size:16}),c.jsx("span",{children:"Add Exercise"})]})]}),c.jsx("div",{className:"space-y-4",children:u.map((S,v)=>c.jsx("div",{className:"p-4 bg-gray-50 dark:bg-white/5 rounded-xl border-2 border-gray-100 dark:border-white/5",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsxs("div",{className:"flex-1 space-y-3",children:[c.jsx("input",{type:"text",value:S.name,onChange:y=>x(v,"name",y.target.value),placeholder:"Exercise name",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"}),c.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1",children:"Sets"}),c.jsx("input",{type:"number",value:S.sets,onChange:y=>x(v,"sets",parseInt(y.target.value)||0),min:"1",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1",children:"Reps"}),c.jsx("input",{type:"text",value:S.reps,onChange:y=>x(v,"reps",y.target.value),placeholder:"8-10",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-semibold text-gray-500 dark:text-gray-400 mb-1",children:"Rest"}),c.jsx("input",{type:"text",value:S.rest,onChange:y=>x(v,"rest",y.target.value),placeholder:"60s",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]})]})]}),u.length>1&&c.jsx("button",{onClick:()=>g(v),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg transition-colors",children:c.jsx(so,{size:18})})]})},v))})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-100 dark:border-white/10",children:[c.jsx("button",{onClick:e,disabled:h,className:"px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 rounded-xl font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),c.jsx("button",{onClick:_,disabled:h,className:"px-6 py-3 bg-royal-600 hover:bg-royal-700 text-white rounded-xl font-semibold transition-colors disabled:opacity-50 shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:h?"Saving...":"Save Workout"})]})]})})},xA=({isOpen:t,onClose:e,exercise:n,onSave:r})=>{const[s,o]=E.useState(""),[i,a]=E.useState(3),[u,d]=E.useState("10"),[h,p]=E.useState("60s"),[m,g]=E.useState(!1);if(E.useEffect(()=>{n&&(o(n.name),a(n.sets),d(n.reps),p(n.rest))},[n]),!t||!n)return null;const x=async()=>{if(!s.trim()){alert("Please enter an exercise name");return}g(!0);const _={...n,name:s.trim(),sets:i,reps:u.trim(),rest:h.trim()};r(_),g(!1)};return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300 px-6",children:c.jsxs(tt,{className:"w-full max-w-md animate-in zoom-in-95 duration-300",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-white/10",children:[c.jsx("h2",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50",children:"Edit Exercise"}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:c.jsx(It,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Exercise Name"}),c.jsx("input",{type:"text",value:s,onChange:_=>o(_.target.value),placeholder:"e.g., Bench Press",className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Sets"}),c.jsx("input",{type:"number",value:i,onChange:_=>a(parseInt(_.target.value)||0),min:"1",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Reps"}),c.jsx("input",{type:"text",value:u,onChange:_=>d(_.target.value),placeholder:"8-10",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Rest"}),c.jsx("input",{type:"text",value:h,onChange:_=>p(_.target.value),placeholder:"60s",className:"w-full px-3 py-2 bg-white dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-lg text-sm text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400"})]})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-100 dark:border-white/10",children:[c.jsx("button",{onClick:e,disabled:m,className:"px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 rounded-xl font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),c.jsxs("button",{onClick:x,disabled:m,className:"flex items-center gap-2 px-6 py-3 bg-royal-600 hover:bg-royal-700 text-white rounded-xl font-semibold transition-colors disabled:opacity-50 shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:[c.jsx(Mc,{size:18}),c.jsx("span",{children:m?"Saving...":"Save Changes"})]})]})]})})},wA=({onNavigate:t})=>{const[e,n]=E.useState(new Date),[r,s]=E.useState(new Date),[o,i]=E.useState([]),[a,u]=E.useState(new Set),[d,h]=E.useState(!1),[p,m]=E.useState(!1),[g,x]=E.useState(null),[_,S]=E.useState(null),[v,y]=E.useState(!1),w=async()=>{const D=e.getFullYear(),K=e.getMonth()+1,ee=await qf(D,K);u(new Set(ee));const Z=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`,H=await zf(Z);i(H)};E.useEffect(()=>{(async()=>{const K=e.getFullYear(),ee=e.getMonth()+1,Z=await qf(K,ee);u(new Set(Z))})()},[e]),E.useEffect(()=>{(async()=>{h(!0);const K=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`,ee=await zf(K);i(ee),h(!1)})()},[r]);const C=(()=>{const D=e.getFullYear(),K=e.getMonth(),ee=new Date(D,K,1),Z=new Date(D,K+1,0),H=ee.getDay(),de=Z.getDate(),ze=[];for(let P=0;P<H;P++)ze.push(null);for(let P=1;P<=de;P++)ze.push(new Date(D,K,P));return ze})(),k=new Date;k.setHours(0,0,0,0);const T=(D,K)=>D.getFullYear()===K.getFullYear()&&D.getMonth()===K.getMonth()&&D.getDate()===K.getDate(),M=()=>{n(new Date(e.getFullYear(),e.getMonth()-1))},R=()=>{n(new Date(e.getFullYear(),e.getMonth()+1))},U=D=>{s(D)},X=(D,K)=>{i(ee=>ee.map(Z=>Z.id===D?{...Z,exercises:Z.exercises.map(H=>H.id===K?{...H,completed:!H.completed}:H)}:Z))},ye=(D,K)=>{S(D),x(K),y(!0)},se=async(D,K)=>{const ee=o.find(Z=>Z.id===D);if(ee&&confirm("Are you sure you want to delete this exercise?")){const Z=ee.exercises.filter(de=>de.id!==K);i(de=>de.map(ze=>ze.id===D?{...ze,exercises:Z}:ze));const H=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;await Bi(H,ee.title,Z,D)}},N=async D=>{confirm("Are you sure you want to delete this entire workout plan?")&&(await Lb(D),await w())},V=async D=>{if(!_)return;const K=o.find(H=>H.id===_);if(!K)return;const ee=K.exercises.map(H=>H.id===D.id?D:H);i(H=>H.map(de=>de.id===_?{...de,exercises:ee}:de));const Z=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;await Bi(Z,K.title,ee,_),y(!1),x(null),S(null)},z=o.flatMap(D=>D.exercises),Q=z.filter(D=>D.completed).length,A=z.length,O=A>0?Q/A*100:0,I=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],F=["January","February","March","April","May","June","July","August","September","October","November","December"];return c.jsxs("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:[c.jsxs("header",{className:"flex justify-between items-end mb-6 flex-shrink-0",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:"Your Training Schedule"}),c.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight leading-none",children:"Workout Plan"})]}),c.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-sm",children:c.jsx(Ui,{size:20})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6 no-scrollbar",children:[c.jsxs(tt,{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ur,{size:16,className:"text-royal-600 dark:text-royal-400"}),c.jsxs("h2",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 uppercase tracking-wide",children:[F[e.getMonth()]," ",e.getFullYear()]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("button",{onClick:M,className:"p-1.5 hover:bg-gray-100 dark:hover:bg-white/5 rounded-lg transition-colors",children:c.jsx(ro,{size:18,className:"text-gray-600 dark:text-gray-400"})}),c.jsx("button",{onClick:R,className:"p-1.5 hover:bg-gray-100 dark:hover:bg-white/5 rounded-lg transition-colors",children:c.jsx(rr,{size:18,className:"text-gray-600 dark:text-gray-400"})})]})]}),c.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:I.map((D,K)=>c.jsx("div",{className:"text-center text-xs font-bold text-gray-400 dark:text-gray-500 py-1",children:D},K))}),c.jsx("div",{className:"grid grid-cols-7 gap-1",children:C.map((D,K)=>{if(!D)return c.jsx("div",{className:"aspect-square"},`empty-${K}`);const ee=T(D,r),Z=T(D,k),H=`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}-${String(D.getDate()).padStart(2,"0")}`,de=a.has(H);return c.jsxs("button",{onClick:()=>U(D),className:`
                                        aspect-square flex flex-col items-center justify-center p-1 rounded-xl transition-all relative text-sm
                                        ${ee?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 scale-105 font-bold":"bg-gray-50 dark:bg-white/5 text-gray-700 dark:text-gray-300 hover:bg-royal-50 dark:hover:bg-royal-900/20 hover:scale-105"}
                                    `,children:[c.jsx("span",{children:D.getDate()}),Z&&!ee&&c.jsx("div",{className:"absolute bottom-1 w-1 h-1 bg-royal-600 dark:bg-royal-400 rounded-full"}),de&&c.jsx("div",{className:`absolute top-1 right-1 w-1.5 h-1.5 rounded-full ${ee?"bg-white":"bg-royal-600 dark:bg-royal-400"}`})]},K)})})]}),d?c.jsx(tt,{className:"p-8",children:c.jsx("div",{className:"flex items-center justify-center",children:c.jsx("div",{className:"w-8 h-8 border-2 border-royal-600 border-t-transparent rounded-full animate-spin"})})}):o.length>0?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-extrabold text-gray-900 dark:text-gray-50",children:T(r,k)?"Today's Workouts":"Workout Plans"}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-semibold mt-0.5",children:[o.length," ",o.length===1?"workout":"workouts"," scheduled"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("p",{className:"text-2xl font-extrabold text-royal-600 dark:text-royal-400",children:[Q,"/",A]}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-semibold",children:"Overall Progress"})]})]}),c.jsx("div",{className:"bg-gray-100 dark:bg-white/5 rounded-full h-2 overflow-hidden",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-royal-500 to-royal-600 transition-all duration-500 ease-out rounded-full",style:{width:`${O}%`}})}),o.map(D=>{const K=D.exercises.filter(H=>H.completed).length,ee=D.exercises.length,Z=ee>0?K/ee*100:0;return c.jsxs(tt,{className:"p-6 border-2 border-gray-200 dark:border-white/10",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-base font-extrabold text-gray-900 dark:text-gray-50 mb-1",children:D.title}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400",children:[K,"/",ee," completed"]}),c.jsx("span",{className:"text-xs text-gray-400",children:""}),c.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Math.round(Z),"%"]})]})]}),c.jsx("button",{onClick:()=>N(D.id),className:"p-2 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete entire workout",children:c.jsx(so,{size:16,className:"text-red-600 dark:text-red-400"})})]}),c.jsx("div",{className:"mb-4 bg-gray-100 dark:bg-white/5 rounded-full h-1.5 overflow-hidden",children:c.jsx("div",{className:"h-full bg-gradient-to-r from-royal-500 to-royal-600 transition-all duration-500 ease-out rounded-full",style:{width:`${Z}%`}})}),c.jsx("div",{className:"space-y-3",children:D.exercises.map(H=>c.jsx("button",{onClick:()=>X(D.id,H.id),className:`
                                                    w-full text-left transition-all active:scale-[0.98]
                                                    ${H.completed?"opacity-60":""}
                                                `,children:c.jsx(tt,{className:`p-4 ${H.completed?"bg-royal-50/50 dark:bg-royal-900/10":""}`,children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"flex-shrink-0 mt-0.5",children:H.completed?c.jsx(ai,{size:20,className:"text-royal-600 dark:text-royal-400",strokeWidth:2.5}):c.jsx(hw,{size:20,className:"text-gray-300 dark:text-gray-600",strokeWidth:2})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h4",{className:`
                                                                font-bold text-sm mb-1.5
                                                                ${H.completed?"text-gray-500 dark:text-gray-400 line-through":"text-gray-900 dark:text-gray-50"}
                                                            `,children:H.name}),c.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Sets:"}),c.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:H.sets})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Reps:"}),c.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:H.reps})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Rest:"}),c.jsx("span",{className:"font-bold text-gray-700 dark:text-gray-300",children:H.rest})]})]})]}),c.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 ml-2",children:[c.jsx("button",{onClick:de=>{de.stopPropagation(),ye(D.id,H)},className:"p-1.5 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Edit exercise",children:c.jsx(Tw,{size:14,className:"text-blue-600 dark:text-blue-400"})}),c.jsx("button",{onClick:de=>{de.stopPropagation(),se(D.id,H.id)},className:"p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete exercise",children:c.jsx(so,{size:14,className:"text-red-600 dark:text-red-400"})})]})]})})},H.id))}),K===ee&&ee>0&&c.jsx("div",{className:"mt-4 p-4 bg-gradient-to-br from-royal-50 to-royal-100 dark:from-royal-950/30 dark:to-royal-900/20 border-2 border-royal-200 dark:border-royal-800/50 rounded-xl",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(ai,{size:20,className:"text-royal-600 dark:text-royal-400",strokeWidth:2.5}),c.jsx("p",{className:"text-sm font-bold text-royal-900 dark:text-royal-100",children:"Workout Complete! "})]})})]},D.id)}),c.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-center gap-2 py-4 bg-white dark:bg-white/5 hover:bg-royal-50 dark:hover:bg-royal-900/20 text-gray-900 dark:text-gray-50 rounded-[20px] font-bold transition-all border-2 border-dashed border-gray-300 dark:border-white/20 hover:border-royal-400 dark:hover:border-royal-600 active:scale-95",children:[c.jsx(ji,{size:20}),c.jsx("span",{children:"Add Another Workout"})]}),Q===A&&A>0&&c.jsx(tt,{className:"p-6 bg-gradient-to-br from-royal-50 to-royal-100 dark:from-royal-950/30 dark:to-royal-900/20 border-2 border-royal-200 dark:border-royal-800/50 animate-in fade-in slide-in-from-bottom-4 duration-500",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-royal-600 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:c.jsx(ai,{size:32,className:"text-white",strokeWidth:2.5})}),c.jsx("h3",{className:"text-xl font-extrabold text-royal-900 dark:text-royal-100 mb-2",children:"All Workouts Complete! "}),c.jsxs("p",{className:"text-sm text-royal-700 dark:text-royal-300 font-semibold",children:["Amazing work! You've completed all exercises for ",T(r,k)?"today":"this day","."]})]})})]}):c.jsx(tt,{className:"p-8",children:c.jsxs("div",{className:"text-center max-w-sm mx-auto",children:[c.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-white/10 dark:to-white/5 rounded-full flex items-center justify-center mx-auto mb-6",children:c.jsx(Ui,{size:32,className:"text-gray-400 dark:text-gray-500"})}),c.jsx("h3",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"No Workout Plan Yet"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6 leading-relaxed",children:T(r,k)?"Ready to crush today's workout? Get a personalized plan from your AI coach or create your own!":"No workout plan for this date. Add one to stay on track!"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{onClick:()=>t==null?void 0:t(ge.CAL_COACH),className:"w-full flex items-center justify-center gap-2 py-4 bg-royal-600 hover:bg-royal-700 text-white rounded-[20px] font-bold transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[c.jsx(zt,{size:20}),c.jsx("span",{children:"Get AI Plan from Coach"})]}),c.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-center gap-2 py-4 bg-white dark:bg-white/5 hover:bg-gray-50 dark:hover:bg-white/10 text-gray-900 dark:text-gray-50 rounded-[20px] font-bold transition-all border-2 border-gray-200 dark:border-white/10 active:scale-95",children:[c.jsx(ji,{size:20}),c.jsx("span",{children:"Create Custom Plan"})]})]})]})})]}),c.jsx(xA,{isOpen:v,onClose:()=>{y(!1),x(null),S(null)},exercise:g,onSave:V}),c.jsx(vA,{isOpen:p,onClose:()=>m(!1),defaultDate:r,onSave:w})]})},_A=({summary:t,onClose:e})=>{const n=new Date(t.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return c.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:c.jsxs("div",{className:"bg-white w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl border border-white/50 animate-in slide-in-from-bottom duration-300",children:[c.jsxs("div",{className:"relative bg-royal-50 p-8 pb-10",children:[c.jsx("div",{className:"absolute top-6 right-6",children:c.jsx("button",{onClick:e,className:"p-2 bg-white text-gray-900 rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:c.jsx(It,{size:20})})}),c.jsxs("div",{className:"flex items-center gap-2 text-royal-600 mb-3",children:[c.jsx(ur,{size:20}),c.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Daily Report"})]}),c.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 leading-tight",children:n})]}),c.jsxs("div",{className:"p-8 -mt-6 bg-white rounded-t-[32px] relative shadow-[-10px_-10px_30px_rgba(0,0,0,0.02)]",children:[c.jsxs("div",{className:"bg-white rounded-[32px] p-6 border border-gray-100 shadow-[0_10px_30px_-10px_rgba(0,0,0,0.05)] mb-8 flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 block",children:"Total Consumed"}),c.jsxs("div",{className:"flex items-baseline gap-1",children:[c.jsx("span",{className:"text-5xl font-extrabold text-gray-900 tracking-tighter",children:t.totalCalories}),c.jsx("span",{className:"text-gray-400 font-bold text-lg",children:"kcal"})]})]}),c.jsx("div",{className:"w-14 h-14 rounded-2xl bg-royal-50 flex items-center justify-center text-royal-600",children:c.jsx(Rc,{size:28})})]}),c.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[c.jsx(Li,{size:16})," Macro Breakdown"]}),c.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[c.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-emerald-50 hover:border-emerald-100 transition-colors",children:c.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[c.jsx("div",{className:"w-1.5 h-10 bg-emerald-400 rounded-full"}),c.jsxs("div",{children:[c.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[t.totalProtein,"g"]}),c.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Protein"})]})]})}),c.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-blue-50 hover:border-blue-100 transition-colors",children:c.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[c.jsx("div",{className:"w-1.5 h-10 bg-blue-400 rounded-full"}),c.jsxs("div",{children:[c.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[t.totalCarbs,"g"]}),c.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Carbs"})]})]})}),c.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-orange-50 hover:border-orange-100 transition-colors",children:c.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[c.jsx("div",{className:"w-1.5 h-10 bg-orange-400 rounded-full"}),c.jsxs("div",{children:[c.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[t.totalFat,"g"]}),c.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Fat"})]})]})})]}),c.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 flex justify-between items-center text-xs font-bold text-gray-400 uppercase tracking-wider",children:[c.jsxs("span",{children:[t.entries.length," meals tracked"]}),c.jsxs("span",{className:"flex items-center gap-1.5 text-royal-600",children:[c.jsx(js,{size:14}),"See History Tab"]})]})]})]})})},SA=()=>{const[t,e]=E.useState([]),[n,r]=E.useState(2e3),[s,o]=E.useState(!0),[i,a]=E.useState("day"),[u,d]=E.useState(null),[h,p]=E.useState(null),[m,g]=E.useState(!1),[x,_]=E.useState(null),[S,v]=E.useState(ls()),[y,w]=E.useState(new Date().toISOString().substring(0,7)),[b,C]=E.useState(()=>{const P=new Date,B=P.getDay(),te=B===0?-6:1-B,Y=new Date(P);Y.setDate(P.getDate()+te);const ue=Y.getFullYear(),pe=String(Y.getMonth()+1).padStart(2,"0"),me=String(Y.getDate()).padStart(2,"0");return`${ue}-${pe}-${me}`}),[k,T]=E.useState(!1),[M,R]=E.useState({}),[U,X]=E.useState({}),[ye,se]=E.useState({}),[N,V]=E.useState({}),z=E.useRef(null);document.documentElement.classList.contains("dark");const Q=E.useCallback(()=>{if(z.current){const P=z.current;P.scrollLeft=P.scrollWidth}},[]);E.useEffect(()=>{const P=setTimeout(Q,100);return()=>clearTimeout(P)},[i,Q]);const A=async()=>{o(!0);try{const[P,B]=await Promise.all([bb(),Vc()]);e(P),r(B),O(S)}catch(P){console.error("Failed to load history data",P)}finally{o(!1)}},O=E.useCallback(async P=>{if(!U[P]){se(B=>({...B,[P]:!0}));try{const B=await kb(P);X(te=>({...te,[P]:B}))}catch(B){console.error(`Failed to load entries for ${P}`,B)}finally{se(B=>({...B,[P]:!1}))}}},[U]),I=E.useCallback(async P=>{if(N[P]===void 0){V(B=>({...B,[P]:null}));try{const B=await Eb(P);V(te=>({...te,[P]:B}))}catch(B){console.error(`Failed to load image for entry ${P}`,B)}}},[N]);E.useEffect(()=>{A();const P=()=>{X({}),V({}),A()};return window.addEventListener("food-entry-updated",P),()=>window.removeEventListener("food-entry-updated",P)},[]),E.useEffect(()=>{S&&i==="week"&&O(S)},[S,O,i]);const F=async P=>{await _0(P),X({}),V({}),await A()},D=P=>{d(null),_(P),g(!0)},K=P=>(N[P.id]===void 0&&I(P.id),{...P,imageUrl:N[P.id]||void 0}),ee=E.useMemo(()=>{if(i==="day"){const P=[],B=new Date,te=new Date(B.getFullYear(),B.getMonth(),1);for(let Y=new Date(te);Y<=B;Y.setDate(Y.getDate()+1)){const ue=Y.getFullYear(),pe=String(Y.getMonth()+1).padStart(2,"0"),me=String(Y.getDate()).padStart(2,"0"),j=`${ue}-${pe}-${me}`;P.push({id:j,name:Y.toLocaleDateString("en-US",{weekday:"short"}),label:Y.getDate().toString(),date:j})}return P}else if(i==="week"){const P=[],B=new Date,te=B.getDay(),Y=te===0?-6:1-te,ue=new Date(B);ue.setDate(B.getDate()+Y);for(let pe=0;pe<8;pe++){const me=new Date(ue);me.setDate(ue.getDate()-pe*7);const j=new Date(me);j.setDate(me.getDate()+6);const be=me.toLocaleDateString("en-US",{month:"short",day:"numeric"}),De=j.toLocaleDateString("en-US",{day:"numeric"}),$=me.getFullYear(),je=String(me.getMonth()+1).padStart(2,"0"),Qe=String(me.getDate()).padStart(2,"0"),Yt=`${$}-${je}-${Qe}`;P.push({id:Yt,name:"Week",label:`${be} - ${De}`,date:Yt})}return P.reverse()}else{const P=new Set;return t.forEach(te=>{const Y=te.date.substring(0,7);P.add(Y)}),Array.from(P).sort().map(te=>{const[Y,ue]=te.split("-"),pe=new Date(parseInt(Y),parseInt(ue)-1,1);return{id:te,name:pe.toLocaleDateString("en-US",{year:"2-digit"}),label:pe.toLocaleDateString("en-US",{month:"short"}),date:te}})}},[i,t]),Z=E.useMemo(()=>{if(i==="day")return t.find(P=>P.date===S)||{date:S,totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};if(i==="week"){if(!b)return{date:"",totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};const P=new Date(b),B=new Date(P);B.setDate(P.getDate()+6);const te=b,Y=B.getFullYear(),ue=String(B.getMonth()+1).padStart(2,"0"),pe=String(B.getDate()).padStart(2,"0"),me=`${Y}-${ue}-${pe}`,be=t.filter(De=>De.date>=te&&De.date<=me).reduce((De,$)=>({totalCalories:De.totalCalories+$.totalCalories,totalProtein:De.totalProtein+$.totalProtein,totalCarbs:De.totalCarbs+$.totalCarbs,totalFat:De.totalFat+$.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:b,...be}}else{const B=t.filter(te=>te.date.startsWith(y)).reduce((te,Y)=>({totalCalories:te.totalCalories+Y.totalCalories,totalProtein:te.totalProtein+Y.totalProtein,totalCarbs:te.totalCarbs+Y.totalCarbs,totalFat:te.totalFat+Y.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:y,...B}}},[t,S,y,b,i]),H=E.useMemo(()=>{if(i==="day")return[];const P=te=>{if(i==="month")return te.startsWith(y);if(i==="week"&&b)try{const[Y,ue,pe]=b.split("-").map(Number),me=new Date(Y,ue-1,pe),j=new Date(me);j.setDate(me.getDate()+6);const be=new Date(te);return be>=me&&be<=j}catch{return!1}return!1};return Object.entries(U).filter(([te])=>P(te)).flatMap(([te,Y])=>Y).sort((te,Y)=>Y.timestamp.localeCompare(te.timestamp))},[U,y,b,i]),de=E.useMemo(()=>{if(i==="day")return{};const P=te=>{if(i==="month")return te.startsWith(y);if(i==="week"&&b)try{const[Y,ue,pe]=b.split("-").map(Number),me=new Date(Y,ue-1,pe),j=new Date(me);j.setDate(me.getDate()+6);const be=new Date(te);return be>=me&&be<=j}catch{return!1}return!1},B={};return Object.entries(U).filter(([te])=>P(te)).forEach(([te,Y])=>{Y.length>0&&(B[te]=Y.sort((ue,pe)=>pe.timestamp.localeCompare(ue.timestamp)))}),B},[U,y,b,i]),ze=P=>{R(B=>({...B,[P]:!B[P]}))};return E.useEffect(()=>{i==="month"&&t.filter(B=>B.date.startsWith(y)).map(B=>B.date).forEach(B=>O(B))},[i,y,t,O]),k?c.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in slide-in-from-right duration-500 bg-[#F8F9FE] dark:bg-[#0F111A]",children:[c.jsxs("div",{className:"px-6 pt-10 pb-32 overflow-y-auto no-scrollbar",children:[c.jsxs("button",{onClick:()=>T(!1),className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 mb-6 hover:text-royal-600 transition-colors",children:[c.jsx(ro,{size:20}),c.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back to Report"})]}),c.jsxs("div",{className:"flex items-center justify-between mb-8",children:[c.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"History Log"}),c.jsx("div",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl border border-royal-100 dark:border-royal-800/50",children:i==="week"?new Date(S).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):new Date(y+"-01").toLocaleDateString(void 0,{month:"long",year:"numeric"})})]}),c.jsx("div",{className:"space-y-4",children:i==="day"?ye[S]?c.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(P=>c.jsx("div",{className:"h-20 bg-white dark:bg-[#1A1C26] rounded-[24px] animate-pulse border border-gray-100 dark:border-white/5"},P))}):(U[S]||[]).length>0?(U[S]||[]).map(P=>{const B=K(P);return c.jsxs("div",{onClick:()=>d(B),className:"bg-white dark:bg-[#1A1C26] p-4 flex justify-between items-center rounded-[24px] shadow-sm border border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer active:scale-[0.98]",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:B.imageUrl?c.jsx("img",{src:B.imageUrl,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:c.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold",children:P.food_item}),c.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:P.time})]})]}),c.jsxs("div",{className:"flex flex-col items-end",children:[c.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:P.calories}),c.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},P.id)}):c.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[c.jsx(ur,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),c.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:"No meals logged for this day."})]}):Object.keys(de).length>0?Object.entries(de).sort(([P],[B])=>B.localeCompare(P)).map(([P,B])=>{const te=M[P],Y=B.reduce((ue,pe)=>ue+pe.calories,0);return c.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] border border-gray-100 dark:border-white/5 overflow-hidden",children:[c.jsxs("button",{onClick:()=>ze(P),className:"w-full p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`transition-transform duration-200 ${te?"rotate-90":""}`,children:c.jsx(rr,{size:16,className:"text-gray-400"})}),c.jsxs("div",{className:"flex flex-col items-start",children:[c.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:new Date(P).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),c.jsxs("span",{className:"text-[9px] font-medium text-gray-400",children:[B.length," meal",B.length!==1?"s":""]})]})]}),c.jsxs("div",{className:"flex flex-col items-end",children:[c.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:Y}),c.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]}),te&&c.jsx("div",{className:"border-t border-gray-100 dark:border-white/5",children:B.map(ue=>{const pe=K(ue);return c.jsxs("div",{onClick:()=>d(pe),className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer border-b border-gray-50 dark:border-white/5 last:border-b-0",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:pe.imageUrl?c.jsx("img",{src:pe.imageUrl,className:"w-full h-full object-cover"}):c.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:c.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold leading-tight",children:ue.food_item}),c.jsx("span",{className:"text-[9px] text-gray-400 dark:text-gray-500",children:ue.time})]})]}),c.jsxs("div",{className:"flex flex-col items-end",children:[c.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:ue.calories}),c.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},ue.id)})})]},P)}):c.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[c.jsx(ur,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),c.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:["No data for this ",i==="month"?"month":"week","."]})]})})]}),u&&c.jsx(Uu,{entry:u,onClose:()=>d(null),onDelete:F,onEdit:D})]}):c.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-y-auto no-scrollbar relative bg-[#F8F9FE] dark:bg-[#0F111A]",children:[c.jsxs("div",{className:"px-6 pt-10 pb-4",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"Report"}),c.jsxs("div",{className:"flex p-1 bg-white dark:bg-[#1A1C26] rounded-xl border border-gray-100 dark:border-white/5 shadow-sm",children:[c.jsx("button",{onClick:()=>a("day"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${i==="day"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Daily"}),c.jsx("button",{onClick:()=>a("week"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${i==="week"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Weekly"}),c.jsx("button",{onClick:()=>a("month"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${i==="month"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Monthly"})]})]}),c.jsxs("div",{className:"relative mb-8",children:[c.jsx("div",{ref:z,className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1 snap-x",style:{WebkitOverflowScrolling:"touch"},children:ee.map(P=>{const B=i==="day"?P.id===S:i==="week"?P.id===b:P.id===y,te=t.some(Y=>{if(i==="day")return Y.date===P.id;if(i==="week"){const[ue,pe,me]=P.id.split("-").map(Number),j=new Date(ue,pe-1,me),be=new Date(j);be.setDate(j.getDate()+6);const De=new Date(Y.date);return De>=j&&De<=be}return Y.date.startsWith(P.id)});return c.jsxs("button",{onClick:()=>{i==="day"?v(P.id):i==="week"?C(P.id):w(P.id)},className:`flex-shrink-0 flex flex-col items-center justify-center ${i==="week"?"w-24":"w-12"} py-3 rounded-2xl transition-all duration-300 snap-center ${B?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 transform scale-110":"bg-white dark:bg-[#1A1C26] text-gray-400 dark:text-gray-500 border border-gray-100 dark:border-white/5"}`,children:[c.jsx("span",{className:`text-[9px] font-bold uppercase mb-1 ${B?"text-white/70":"text-gray-400"}`,children:P.name}),c.jsx("span",{className:"text-sm font-extrabold",children:P.label}),te&&!B&&c.jsx("div",{className:"w-1 h-1 rounded-full bg-royal-400 mt-1"})]},P.id)})}),c.jsx("div",{className:"absolute top-0 left-0 bottom-2 w-8 bg-gradient-to-r from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"}),c.jsx("div",{className:"absolute top-0 right-0 bottom-2 w-8 bg-gradient-to-l from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"})]}),c.jsx("div",{className:"mb-8",children:c.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-6 shadow-sm border border-gray-100 dark:border-white/5 flex flex-col items-center",children:[c.jsx("span",{className:"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-1",children:i==="day"?"Daily Total":i==="week"?"Weekly Total":"Monthly Total"}),c.jsxs("div",{className:"flex flex-col items-center mb-6",children:[c.jsx("span",{className:"text-5xl font-black text-gray-900 dark:text-gray-50 tracking-tighter",children:Math.round(Z.totalCalories)}),c.jsx("span",{className:"text-[10px] font-black text-royal-600 dark:text-royal-400 uppercase tracking-widest mt-0.5",children:"KCAL"})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2.5 w-full",children:[c.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-emerald-50/30 dark:bg-emerald-500/5 rounded-2xl border border-emerald-100/50 dark:border-emerald-500/10 transition-colors",children:[c.jsx("span",{className:"text-[8px] font-bold text-emerald-600/60 dark:text-emerald-400/60 uppercase mb-0.5",children:"Protein"}),c.jsxs("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:[Math.round(Z.totalProtein),"g"]})]}),c.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-amber-50/30 dark:bg-amber-500/5 rounded-2xl border border-amber-100/50 dark:border-amber-500/10 transition-colors",children:[c.jsx("span",{className:"text-[8px] font-bold text-amber-600/60 dark:text-amber-400/60 uppercase mb-0.5",children:"Carbs"}),c.jsxs("span",{className:"text-sm font-black text-amber-600 dark:text-amber-400",children:[Math.round(Z.totalCarbs),"g"]})]}),c.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-rose-50/30 dark:bg-rose-500/5 rounded-2xl border border-rose-100/50 dark:border-rose-500/10 transition-colors",children:[c.jsx("span",{className:"text-[8px] font-bold text-rose-600/60 dark:text-rose-400/60 uppercase mb-0.5",children:"Fat"}),c.jsxs("span",{className:"text-sm font-black text-rose-600 dark:text-rose-400",children:[Math.round(Z.totalFat),"g"]})]})]})]})}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[c.jsxs(tt,{className:"p-5 flex flex-col justify-between h-36 bg-gradient-to-br from-royal-500 to-royal-700 text-white border-none shadow-royal-200/50",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-[10px] font-bold text-white/70 uppercase mb-1",children:i==="day"?"Coach Tips":"Report"}),c.jsx("h3",{className:"text-lg font-black leading-tight",children:i==="day"?"Daily Review":i==="week"?"Weekly Summary":c.jsxs(c.Fragment,{children:["Your Health",c.jsx("br",{}),"Summary"]})})]}),c.jsxs("div",{className:"mt-2 py-2 bg-white/20 rounded-xl text-[10px] font-bold backdrop-blur-sm flex items-center justify-center gap-2",children:[i==="day"?"COMING SOON":"VIEW DETAILS",c.jsx(rr,{size:12})]})]}),c.jsxs("div",{className:"grid grid-rows-2 gap-4 h-36",children:[c.jsxs(tt,{onClick:()=>T(!0),className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5 active:scale-95 transition-transform cursor-pointer",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"History Log"}),c.jsx(rr,{size:10,className:"text-gray-300"})]}),c.jsxs("p",{className:"text-xs font-black text-gray-900 dark:text-gray-50",children:[i==="week"?(U[S]||[]).length:H.length," Meals"]})]}),c.jsxs(tt,{className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5",children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Status"}),c.jsx(ww,{size:10,className:"text-gray-300"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 h-1 bg-gray-100 dark:bg-white/5 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-royal-500 rounded-full",style:{width:`${Math.min(Z.totalCalories/(i==="week"?n:n*30)*100,100)}%`}})}),c.jsxs("span",{className:"text-[10px] font-black text-gray-900 dark:text-gray-50",children:[Math.round(Z.totalCalories/(i==="week"?n:n*30)*100),"%"]})]})]})]})]}),c.jsx("div",{className:"h-24"})]}),u&&c.jsx(Uu,{entry:u,onClose:()=>d(null),onDelete:F,onEdit:D}),h&&c.jsx(_A,{summary:h,onClose:()=>p(null)}),m&&c.jsx(by,{editEntry:x,onClose:()=>{g(!1),_(null)},onSuccess:()=>{g(!1),_(null),X({}),V({}),A()},onOpenSharedMeal:()=>{g(!1)}})]})},bA=()=>{const[t,e]=E.useState(!0),[n,r]=E.useState(""),[s,o]=E.useState(""),[i,a]=E.useState(null),[u,d]=E.useState(!1),[h,p]=E.useState(null),m=async g=>{g.preventDefault(),a(null),p(null),d(!0);try{t?await m0(n,s):(await pb(n,s),t||(p("Account created successfully!"),e(!0)))}catch(x){console.error(x),a(x.message||"Authentication failed")}finally{d(!1)}};return c.jsxs("div",{className:"min-h-screen bg-royal-50 flex flex-col items-center justify-center p-6 relative overflow-hidden",children:[c.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[c.jsx("div",{className:"absolute top-[-20%] right-[-20%] w-[500px] h-[500px] bg-royal-200/40 rounded-full blur-[100px]"}),c.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-80 h-80 bg-pink-200/40 rounded-full blur-[80px]"})]}),c.jsxs("div",{className:"w-full max-w-sm z-10",children:[c.jsxs("div",{className:"text-center mb-10",children:[c.jsx("div",{className:"w-20 h-20 bg-white rounded-[24px] flex items-center justify-center mx-auto mb-6 shadow-xl shadow-royal-200 rotate-3 transition-transform hover:rotate-0 duration-500",children:c.jsx(Jg,{size:36,className:"text-royal-600 fill-royal-600"})}),c.jsx("h1",{className:"text-4xl font-extrabold text-gray-900 tracking-tight mb-2",children:"SnapCal AI"}),c.jsx("p",{className:"text-gray-500 font-medium",children:"Track your vibe, not just calories."})]}),c.jsxs("div",{className:"bg-white/80 backdrop-blur-xl border border-white p-8 rounded-[40px] shadow-[0_20px_40px_-12px_rgba(0,0,0,0.05)]",children:[c.jsxs("div",{className:"flex p-1 bg-gray-100 rounded-[20px] mb-8",children:[c.jsx("button",{onClick:()=>{e(!0),a(null),p(null)},className:`flex-1 py-3 text-sm font-bold rounded-[16px] transition-all duration-300 ${t?"bg-white text-royal-700 shadow-sm":"text-gray-400 hover:text-gray-600"}`,children:"Sign In"}),c.jsx("button",{onClick:()=>{e(!1),a(null),p(null)},className:`flex-1 py-3 text-sm font-bold rounded-[16px] transition-all duration-300 ${t?"text-gray-400 hover:text-gray-600":"bg-white text-royal-700 shadow-sm"}`,children:"Sign Up"})]}),c.jsxs("form",{onSubmit:m,className:"space-y-5",children:[i&&c.jsxs("div",{className:"p-4 bg-red-50 border border-red-100 rounded-2xl flex items-center gap-3 text-red-600 text-sm font-medium animate-in fade-in slide-in-from-top-2",children:[c.jsx(Pc,{size:18}),i]}),h&&c.jsxs("div",{className:"p-4 bg-emerald-50 border border-emerald-100 rounded-2xl flex items-center gap-3 text-emerald-600 text-sm font-medium animate-in fade-in slide-in-from-top-2",children:[c.jsx(ai,{size:18}),h]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 ml-1",children:"Email"}),c.jsx("input",{type:"email",required:!0,value:n,onChange:g=>r(g.target.value),className:"w-full p-4 bg-gray-50 border border-gray-100 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 text-gray-900 transition-all placeholder:text-gray-400 font-medium",placeholder:"hello@snapcal.ai"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 ml-1",children:"Password"}),c.jsx("input",{type:"password",required:!0,value:s,onChange:g=>o(g.target.value),className:"w-full p-4 bg-gray-50 border border-gray-100 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 text-gray-900 transition-all placeholder:text-gray-400 font-medium",placeholder:"",minLength:6})]})]}),c.jsxs(Me,{className:"w-full mt-4 flex justify-between items-center group py-5",isLoading:u,children:[c.jsx("span",{children:t?"Sign In":"Create Account"}),!u&&c.jsx(Di,{size:20,className:"group-hover:translate-x-1 transition-transform"})]})]})]}),c.jsx("p",{className:"text-center text-gray-400 text-xs mt-8 font-medium",children:t?"New here? Create an account above.":"Welcome back. Sign in above."})]})]})},Np=`
-- Run this in your Supabase SQL Editor

-- 1. Create Food Entries Table
create table if not exists food_entries (
  id uuid primary key,
  user_id uuid not null references auth.users(id),
  timestamp text not null,
  date text not null,
  time text not null,
  food_item text not null,
  calories integer not null,
  protein integer default 0,
  carbs integer default 0,
  fat integer default 0,
  confidence float default 1.0,
  is_manual boolean default false,
  image_url text,
  ingredients jsonb default '[]'::jsonb,
  original_ai_response jsonb,
  created_at timestamp with time zone default timezone('utc'::text, now())
);

-- 2. Create User Profiles Table
create table if not exists user_profiles (
  user_id uuid primary key references auth.users(id),
  name text,
  height float,
  weight float,
  age integer,
  gender text check (gender in ('male', 'female')),
  activity_level text check (activity_level in ('sedentary', 'light', 'moderate', 'very', 'extra')),
  goal text check (goal in ('cut', 'bulk', 'maintain')),
  equipment_access text check (equipment_access in ('gym', 'home', 'bodyweight')),
  created_at timestamp with time zone default timezone('utc'::text, now())
);

-- 3. Create Settings Table
create table if not exists user_settings (
  user_id uuid primary key references auth.users(id),
  daily_goal integer default 2000,
  has_completed_onboarding boolean default false
);

-- 4. Create Summaries Table (Optional optimization)
create table if not exists daily_summaries (
  id text primary key, -- Composite key user_id + date usually
  user_id uuid not null references auth.users(id),
  date text not null,
  total_calories integer default 0,
  total_protein integer default 0,
  total_carbs integer default 0,
  total_fat integer default 0
);

-- 5. Enable Row Level Security (RLS)
alter table food_entries enable row level security;
alter table user_profiles enable row level security;
alter table user_settings enable row level security;
alter table daily_summaries enable row level security;

-- 6. Create Policies (Allow users to see/edit ONLY their own data)

-- Food Entries
create policy "Users can all own entries" on food_entries
  for all using (auth.uid() = user_id);

-- Profiles
create policy "Users can all own profile" on user_profiles
  for all using (auth.uid() = user_id);

-- Settings
create policy "Users can all own settings" on user_settings
  for all using (auth.uid() = user_id);

-- Summaries
create policy "Users can all own summaries" on daily_summaries
  for all using (auth.uid() = user_id);
`,kA=()=>{const[t,e]=E.useState(""),[n,r]=E.useState(""),[s,o]=E.useState(""),[i,a]=E.useState(""),[u,d]=E.useState(""),[h,p]=E.useState(""),[m,g]=E.useState(""),[x,_]=E.useState(""),[S,v]=E.useState(!1),[y,w]=E.useState(!1),[b,C]=E.useState(null),[k,T]=E.useState(document.documentElement.classList.contains("dark")),[M,R]=E.useState(!1),[U,X]=E.useState(!1),[ye,se]=E.useState(!1),[N,V]=E.useState("checking"),[z,Q]=E.useState(!1),[A,O]=E.useState(!1);E.useEffect(()=>{K(),ae?(X(Cb()),I()):V("ok")},[]);const I=async()=>{const j=await Ib();j.missingTables?V("missing_tables"):j.ok?V("ok"):V("error")},F=()=>{const j=!k;T(j),j?(document.documentElement.classList.add("dark"),localStorage.setItem("snapcal-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("snapcal-theme","light"))},D=j=>{if(j===_u())return;confirm(j==="local"?"Switching to Local Mode means your data will stay on this device only. You will be logged out of Cloud to create a local profile.":"Switching to Cloud Mode allows you to sync data across devices. You will be redirected to log in or sign up.")&&fb(j)},K=async()=>{const j=await Bc();j&&(e(j.name),r(j.height.toString()),o(j.weight.toString()),j.age&&a(j.age.toString()),j.gender&&d(j.gender),j.activityLevel&&p(j.activityLevel),j.goal&&g(j.goal),j.equipmentAccess&&_(j.equipmentAccess))},ee=()=>{const j=parseFloat(n),be=parseFloat(s);return!j||!be?null:be/(j/100*(j/100))},Z=j=>j<18.5?{label:"Underweight",color:"text-blue-300"}:j<25?{label:"Healthy",color:"text-emerald-300"}:j<30?{label:"Overweight",color:"text-orange-300"}:{label:"Obese",color:"text-red-300"},H=j=>{const $=(10*parseFloat(s)+6.25*parseFloat(n)-5*25+5)*1.2;return j<18.5?Math.round($+400):j>25?Math.round($-400):Math.round($)},de=async()=>{if(!(!t||!n||!s)){v(!0);try{await zc({name:t,height:parseFloat(n),weight:parseFloat(s),age:i?parseInt(i):void 0,gender:u||void 0,activityLevel:h||void 0,goal:m||void 0,equipmentAccess:x||void 0}),w(!0),setTimeout(()=>w(!1),2e3);const j=ee();if(j){const be=H(j);C(be)}}catch(j){console.error(j)}finally{v(!1)}}},ze=async()=>{b&&(await va(b),alert(`Daily goal updated to ${b} kcal!`))},P=async()=>{if(confirm("Are you sure you want to sign out?")){R(!0);try{await mb()}catch(j){console.error(j)}finally{R(!1)}}},B=async()=>{if(confirm("This will upload your local history to your Supabase account and clear local storage. Continue?")){se(!0);try{await Nb(),X(!1),alert("Migration successful! Your local history is now in the cloud.")}catch(j){alert("Sync failed: "+j.message)}finally{se(!1)}}},te=()=>{navigator.clipboard.writeText(Np),alert("SQL Copied to clipboard! Paste it into the Supabase SQL Editor.")},Y=ee(),ue=Y?Z(Y):null,pe=Y?H(Y):null,me=_u();return c.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar pb-32 px-6 pt-10 space-y-8 animate-in fade-in duration-500",children:[c.jsxs("header",{children:[c.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:"My Profile"}),c.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight",children:"Personal Details"})]}),ae&&U&&c.jsx("div",{className:"bg-indigo-50 dark:bg-indigo-950/30 border border-indigo-100 dark:border-indigo-900/40 p-5 rounded-[32px] animate-in slide-in-from-top-4",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/50 rounded-2xl text-indigo-600 dark:text-indigo-400",children:c.jsx(Pw,{size:24})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-sm font-extrabold text-indigo-900 dark:text-indigo-200",children:"Local Data Found"}),c.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-300 mt-1 mb-3 leading-relaxed",children:"We found meal history on this device that isn't in the cloud yet. Sync now to secure your data."}),c.jsx(Me,{onClick:B,isLoading:ye,className:"py-3 px-6 text-xs bg-indigo-600 hover:bg-indigo-700 shadow-lg shadow-indigo-200 dark:shadow-none",children:"Sync to Cloud"})]})]})}),ae&&N==="missing_tables"&&c.jsx("div",{className:"bg-rose-50 dark:bg-rose-950/30 border border-rose-100 dark:border-rose-900/40 p-5 rounded-[32px] animate-in slide-in-from-top-4",children:c.jsxs("div",{className:"flex items-start gap-4",children:[c.jsx("div",{className:"p-3 bg-rose-100 dark:bg-rose-900/50 rounded-2xl text-rose-600 dark:text-rose-400",children:c.jsx(gf,{size:24})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-sm font-extrabold text-rose-900 dark:text-rose-200",children:"Database Setup Required"}),c.jsx("p",{className:"text-xs text-rose-700 dark:text-rose-300 mt-1 mb-3 leading-relaxed",children:"Your Supabase project is connected, but the required tables don't exist yet. Saving will fail until you run the setup script."}),c.jsxs("button",{onClick:()=>Q(!z),className:"flex items-center gap-2 py-2 px-4 rounded-xl text-xs font-bold bg-white dark:bg-white/10 text-rose-600 dark:text-rose-200 shadow-sm",children:[c.jsx(mw,{size:14})," ",z?"Hide SQL":"View SQL Script"]}),z&&c.jsxs("div",{className:"mt-4 animate-in slide-in-from-top-2",children:[c.jsx("div",{className:"bg-gray-900 rounded-xl p-3 mb-2 overflow-x-auto border border-white/10",children:c.jsx("pre",{className:"text-[10px] text-emerald-400 font-mono leading-relaxed",children:Np})}),c.jsxs(Me,{onClick:te,className:"w-full py-3 text-xs bg-rose-600 hover:bg-rose-700 text-white",children:[c.jsx(gw,{size:14,className:"mr-2"})," Copy SQL to Clipboard"]}),c.jsx("p",{className:"text-[10px] text-rose-600/70 dark:text-rose-400/70 mt-2 italic text-center",children:"Paste this into the SQL Editor in your Supabase Dashboard."})]})]})]})}),c.jsx("div",{className:"bg-white dark:bg-[#1a1c26] p-6 rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 bg-royal-50 dark:bg-royal-950/30 rounded-2xl flex items-center justify-center text-royal-600 dark:text-royal-400",children:k?c.jsx(kw,{size:20}):c.jsx(Rw,{size:20})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:"Dark Mode"}),c.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Optimize for low light"})]})]}),c.jsx("button",{onClick:F,className:`w-14 h-8 rounded-full transition-all duration-300 relative ${k?"bg-royal-600":"bg-gray-200 dark:bg-gray-800"}`,children:c.jsx("div",{className:`absolute top-1 left-1 w-6 h-6 bg-white rounded-full shadow-sm transition-transform duration-300 ${k?"translate-x-6":""}`})})]})}),Y&&ue&&pe&&c.jsxs("div",{className:"relative rounded-[32px] p-6 text-white overflow-hidden shadow-xl bg-royal-600 shadow-royal-200 dark:shadow-royal-900/40 animate-in slide-in-from-bottom-4 duration-500",children:[c.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-white/10 rounded-full blur-3xl"}),c.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-40 h-40 bg-black/10 rounded-full blur-3xl"}),c.jsxs("div",{className:"relative z-10",children:[c.jsxs("div",{className:"flex justify-between items-start mb-6",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(Rc,{size:16,className:"text-royal-200"}),c.jsx("span",{className:"text-royal-200 text-xs font-bold uppercase tracking-widest",children:"Body Insight"})]}),c.jsxs("h2",{className:"text-3xl font-extrabold tracking-tight",children:["BMI: ",Y.toFixed(1)]})]}),c.jsx("div",{className:`px-3 py-1 rounded-full bg-white/10 backdrop-blur-md border border-white/10 text-sm font-bold ${ue.color}`,children:ue.label})]}),c.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-[24px] p-5 border border-white/5",children:[c.jsx("p",{className:"text-white/70 text-xs font-medium mb-3",children:"Based on your profile, we recommend a daily calorie limit of:"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-baseline gap-1",children:[c.jsx("span",{className:"text-4xl font-extrabold tracking-tighter",children:pe}),c.jsx("span",{className:"text-lg font-bold text-white/60",children:"kcal"})]}),c.jsx("button",{onClick:ze,className:"w-10 h-10 bg-white text-royal-600 rounded-full flex items-center justify-center hover:scale-110 active:scale-95 transition-all shadow-lg",children:c.jsx(Di,{size:20,strokeWidth:3})})]})]})]})]}),c.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] p-6 rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Display Name"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",value:t,onChange:j=>e(j.target.value),placeholder:"Enter your name",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),c.jsx(rs,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Height (cm)"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:n,onChange:j=>r(j.target.value),placeholder:"175",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),c.jsx(Hg,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Weight (kg)"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:s,onChange:j=>o(j.target.value),placeholder:"70",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),c.jsx(Wg,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Age"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:i,onChange:j=>a(j.target.value),placeholder:"25",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),c.jsx(ur,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Gender"}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{value:u,onChange:j=>d(j.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[c.jsx("option",{value:"",children:"Select"}),c.jsx("option",{value:"male",children:"Male"}),c.jsx("option",{value:"female",children:"Female"})]}),c.jsx(uu,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]})]}),c.jsxs("div",{className:"pt-4 border-t border-gray-100 dark:border-white/5",children:[c.jsxs("button",{type:"button",onClick:()=>O(!A),className:"w-full flex items-center justify-between mb-3 group",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(lu,{size:16,className:"text-royal-600 dark:text-royal-400"}),c.jsx("p",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-wider",children:"Training Goal Setting"})]}),c.jsx(Vg,{size:18,className:`text-royal-600 dark:text-royal-400 transition-transform duration-300 ${A?"rotate-180":""}`})]}),c.jsx("p",{className:"text-[10px] text-gray-400 dark:text-gray-500 mb-3 ml-1",children:"Optional - Fill this for personalized AI Coach recommendations"}),A&&c.jsxs("div",{className:"space-y-5 animate-in slide-in-from-top-2 duration-300",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Activity Level"}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{value:h,onChange:j=>p(j.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[c.jsx("option",{value:"",children:"Select"}),c.jsx("option",{value:"sedentary",children:"Sedentary (Little or no exercise)"}),c.jsx("option",{value:"light",children:"Lightly Active (1-3 days/week)"}),c.jsx("option",{value:"moderate",children:"Moderately Active (3-5 days/week)"}),c.jsx("option",{value:"very",children:"Very Active (6-7 days/week)"}),c.jsx("option",{value:"extra",children:"Extra Active (Intense daily)"})]}),c.jsx(js,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Goal"}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{value:m,onChange:j=>g(j.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[c.jsx("option",{value:"",children:"Select"}),c.jsx("option",{value:"cut",children:"Cut (Lose Fat)"}),c.jsx("option",{value:"bulk",children:"Bulk (Gain Muscle)"}),c.jsx("option",{value:"maintain",children:"Maintain"})]}),c.jsx(lu,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Equipment"}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{value:x,onChange:j=>_(j.target.value),className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all appearance-none cursor-pointer",children:[c.jsx("option",{value:"",children:"Select"}),c.jsx("option",{value:"gym",children:"Gym Access"}),c.jsx("option",{value:"home",children:"Home Equipment"}),c.jsx("option",{value:"bodyweight",children:"Bodyweight Only"})]}),c.jsx(Ui,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 pointer-events-none",size:20})]})]})]})]})]}),c.jsx(Me,{className:"w-full py-5 text-lg shadow-lg shadow-royal-200 dark:shadow-royal-900/40",onClick:de,isLoading:S,children:y?c.jsxs("span",{className:"flex items-center gap-2",children:[c.jsx(Gg,{size:20})," Saved"]}):"Save Profile"})]}),ss&&c.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] p-6 rounded-[32px] border border-gray-100 dark:border-white/5 shadow-diffused dark:shadow-diffused-dark",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:`w-10 h-10 rounded-2xl flex items-center justify-center ${me==="cloud"?"bg-emerald-50 dark:bg-emerald-950/30 text-emerald-600":"bg-gray-100 dark:bg-white/10 text-gray-500"}`,children:me==="cloud"?c.jsx(pw,{size:20}):c.jsx(zg,{size:20})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:"Storage Mode"}),c.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:me==="cloud"?"Connected to Supabase":"Device Storage Only"})]})]}),ae&&c.jsx("button",{onClick:I,className:"p-2 text-gray-400 hover:text-royal-500 transition-colors",title:"Check Connection",children:c.jsx(au,{size:16,className:N==="checking"?"animate-spin":""})})]}),c.jsxs("div",{className:"flex p-1 bg-gray-100 dark:bg-white/5 rounded-2xl",children:[c.jsx("button",{onClick:()=>D("local"),className:`flex-1 py-3 text-xs font-bold rounded-xl transition-all ${me==="local"?"bg-white dark:bg-white/10 text-gray-900 dark:text-white shadow-sm":"text-gray-400 hover:text-gray-600"}`,children:"Device Only"}),c.jsx("button",{onClick:()=>D("cloud"),className:`flex-1 py-3 text-xs font-bold rounded-xl transition-all ${me==="cloud"?"bg-emerald-500 text-white shadow-sm":"text-gray-400 hover:text-gray-600"}`,children:"Cloud Sync"})]})]}),c.jsx("div",{className:"pt-4",children:c.jsx("button",{onClick:P,disabled:M,className:"w-full flex items-center justify-center gap-3 py-5 rounded-[24px] border border-red-200 dark:border-red-900/30 text-red-500 dark:text-red-400 font-bold hover:bg-red-50 dark:hover:bg-red-950/20 active:scale-95 transition-all shadow-sm",children:M?c.jsx(au,{size:20,className:"animate-spin"}):c.jsxs(c.Fragment,{children:[c.jsx(Sw,{size:20}),c.jsx("span",{children:"Sign Out"})]})})}),c.jsx("div",{className:"text-center pt-4 pb-2",children:c.jsxs("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full text-[10px] font-bold border transition-colors ${ae?"bg-emerald-50 dark:bg-emerald-950/20 text-emerald-700 dark:text-emerald-400 border-emerald-100 dark:border-emerald-900/30":"bg-amber-50 dark:bg-amber-950/20 text-amber-700 dark:text-amber-400 border-amber-100 dark:border-amber-900/30"}`,children:[c.jsx(gf,{size:12}),c.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ae?"bg-emerald-500 animate-pulse":"bg-amber-500"}`}),ae?"Syncing to Supabase":"Local Storage Mode"]})})]})},EA=({user:t,onComplete:e})=>{const[n,r]=E.useState(0),[s,o]=E.useState(""),[i,a]=E.useState(""),[u,d]=E.useState(""),[h,p]=E.useState(!1),m=5,g=()=>{const k=parseFloat(i),T=parseFloat(u);return!k||!T?null:T/(k/100*(k/100))},x=k=>{const R=(10*parseFloat(u)+6.25*parseFloat(i)-5*25+5)*1.2;return k<18.5?Math.round(R+400):k>25?Math.round(R-400):Math.round(R)},_=()=>{n<m-1&&r(n+1)},S=()=>{n>0&&r(n-1)},v=async()=>{await Rb(t),e()},y=async()=>{p(!0);try{if(s&&i&&u){await zc({name:s,height:parseFloat(i),weight:parseFloat(u)});const k=g();if(k){const T=x(k);await va(T)}}await S0(t),e()}catch(k){console.error("Failed to save onboarding data:",k),alert("Failed to save your profile. Please try again.")}finally{p(!1)}},w=s&&i&&u,b=g(),C=b?x(b):null;return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-surface via-royal-50/30 to-royal-100/40 dark:from-surface-dark dark:via-royal-950/20 dark:to-black flex items-center justify-center p-4 relative overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-royal-200/20 dark:bg-royal-800/10 rounded-full blur-3xl animate-pulse"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-purple-200/20 dark:bg-purple-900/10 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}}),c.jsxs("button",{onClick:v,className:"absolute top-6 right-6 z-50 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors text-sm font-medium flex items-center gap-1",children:["Skip ",c.jsx(It,{size:16})]}),c.jsxs("div",{className:"relative z-10 w-full max-w-2xl",children:[c.jsx("div",{className:"flex justify-center gap-2 mb-8",children:Array.from({length:m}).map((k,T)=>c.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${T===n?"w-12 bg-royal-600 dark:bg-royal-500":T<n?"w-8 bg-royal-400 dark:bg-royal-600":"w-8 bg-gray-200 dark:bg-gray-700"}`},T))}),c.jsxs("div",{className:"bg-white dark:bg-[#1a1c26] rounded-[40px] shadow-diffused-lg dark:shadow-diffused-dark p-8 md:p-12 min-h-[500px] flex flex-col",children:[n===0&&c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center animate-in fade-in slide-in-from-bottom-4 duration-500",children:[c.jsxs("div",{className:"relative mb-8",children:[c.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-royal-500 to-purple-600 rounded-[32px] flex items-center justify-center shadow-xl shadow-royal-200 dark:shadow-royal-900/40 animate-in zoom-in duration-700",children:c.jsx(zt,{size:48,className:"text-white",strokeWidth:2})}),c.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-yellow-400 rounded-full animate-bounce"})]}),c.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-gray-50 mb-4 tracking-tight",children:"Welcome to SnapCal AI"}),c.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-400 font-medium mb-2",children:"Your AI-Powered Nutrition Companion"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 max-w-md leading-relaxed",children:"Track calories effortlessly with the power of artificial intelligence. Just snap a photo of your meal and let AI do the rest."}),c.jsxs("div",{className:"mt-12 grid grid-cols-3 gap-6 w-full max-w-md",children:[c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("div",{className:"w-14 h-14 bg-royal-50 dark:bg-royal-950/30 rounded-2xl flex items-center justify-center",children:c.jsx(nr,{size:28,className:"text-royal-600 dark:text-royal-400"})}),c.jsx("span",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:"Snap"})]}),c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("div",{className:"w-14 h-14 bg-purple-50 dark:bg-purple-950/30 rounded-2xl flex items-center justify-center",children:c.jsx(Jg,{size:28,className:"text-purple-600 dark:text-purple-400"})}),c.jsx("span",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:"Analyze"})]}),c.jsxs("div",{className:"flex flex-col items-center gap-2",children:[c.jsx("div",{className:"w-14 h-14 bg-emerald-50 dark:bg-emerald-950/30 rounded-2xl flex items-center justify-center",children:c.jsx(js,{size:28,className:"text-emerald-600 dark:text-emerald-400"})}),c.jsx("span",{className:"text-xs font-bold text-gray-700 dark:text-gray-300",children:"Track"})]})]})]}),n===1&&c.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-in fade-in slide-in-from-right-4 duration-500",children:[c.jsxs("div",{className:"mb-8 text-center",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-royal-50 dark:bg-royal-950/30 rounded-full mb-4",children:[c.jsx(nr,{size:16,className:"text-royal-600 dark:text-royal-400"}),c.jsx("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-wider",children:"How It Works"})]}),c.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-gray-50 mb-3",children:"Instant Nutrition Insights"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm max-w-lg mx-auto",children:"Our AI analyzes your food photos to provide accurate calorie counts and nutritional breakdowns in seconds."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-start gap-4 p-5 bg-gray-50 dark:bg-white/5 rounded-[24px] border border-gray-100 dark:border-white/5",children:[c.jsx("div",{className:"w-12 h-12 bg-royal-100 dark:bg-royal-900/30 rounded-2xl flex items-center justify-center flex-shrink-0",children:c.jsx(nr,{size:24,className:"text-royal-600 dark:text-royal-400"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 mb-1",children:"1. Capture Your Meal"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Take a photo of any dish, snack, or beverage"})]})]}),c.jsxs("div",{className:"flex items-start gap-4 p-5 bg-gray-50 dark:bg-white/5 rounded-[24px] border border-gray-100 dark:border-white/5",children:[c.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-2xl flex items-center justify-center flex-shrink-0",children:c.jsx(zt,{size:24,className:"text-purple-600 dark:text-purple-400"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 mb-1",children:"2. AI Recognition"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Advanced AI identifies ingredients and portions instantly"})]})]}),c.jsxs("div",{className:"flex items-start gap-4 p-5 bg-gray-50 dark:bg-white/5 rounded-[24px] border border-gray-100 dark:border-white/5",children:[c.jsx("div",{className:"w-12 h-12 bg-emerald-100 dark:bg-emerald-900/30 rounded-2xl flex items-center justify-center flex-shrink-0",children:c.jsx(js,{size:24,className:"text-emerald-600 dark:text-emerald-400"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-50 mb-1",children:"3. Get Detailed Breakdown"}),c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Calories, protein, carbs, and fatsall automatically calculated"})]})]})]})]}),n===2&&c.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-in fade-in slide-in-from-right-4 duration-500",children:[c.jsxs("div",{className:"mb-8 text-center",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-50 dark:bg-purple-950/30 rounded-full mb-4",children:[c.jsx(yf,{size:16,className:"text-purple-600 dark:text-purple-400"}),c.jsx("span",{className:"text-xs font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider",children:"Personalization"})]}),c.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-gray-50 mb-3",children:"Why Your Profile Matters"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm max-w-lg mx-auto",children:"Share a few details to unlock truly personalized nutrition recommendations tailored just for you."})]}),c.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"p-6 bg-gradient-to-br from-royal-50 to-purple-50 dark:from-royal-950/20 dark:to-purple-950/20 rounded-[28px] border border-royal-100 dark:border-royal-900/30",children:[c.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:c.jsx(lu,{size:24,className:"text-royal-600 dark:text-royal-400"})}),c.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Accurate Goals"}),c.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"Get a science-backed daily calorie target based on your unique body metrics and health objectives."})]}),c.jsxs("div",{className:"p-6 bg-gradient-to-br from-emerald-50 to-teal-50 dark:from-emerald-950/20 dark:to-teal-950/20 rounded-[28px] border border-emerald-100 dark:border-emerald-900/30",children:[c.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:c.jsx(js,{size:24,className:"text-emerald-600 dark:text-emerald-400"})}),c.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Smart Insights"}),c.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"Receive personalized BMI analysis and recommendations to help you reach your ideal weight."})]}),c.jsxs("div",{className:"p-6 bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-950/20 dark:to-amber-950/20 rounded-[28px] border border-orange-100 dark:border-orange-900/30",children:[c.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:c.jsx(zt,{size:24,className:"text-orange-600 dark:text-orange-400"})}),c.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Better Tracking"}),c.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"See how your intake compares to your goals and adjust your habits for optimal results."})]}),c.jsxs("div",{className:"p-6 bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-950/20 dark:to-rose-950/20 rounded-[28px] border border-pink-100 dark:border-pink-900/30",children:[c.jsx("div",{className:"w-12 h-12 bg-white dark:bg-white/10 rounded-2xl flex items-center justify-center mb-4 shadow-sm",children:c.jsx(yf,{size:24,className:"text-pink-600 dark:text-pink-400"})}),c.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 mb-2",children:"Long-term Success"}),c.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:"Build sustainable habits with data-driven feedback tailored to your wellness journey."})]})]})]}),n===3&&c.jsxs("div",{className:"flex-1 flex flex-col justify-center animate-in fade-in slide-in-from-right-4 duration-500",children:[c.jsxs("div",{className:"mb-6 text-center",children:[c.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-royal-50 dark:bg-royal-950/30 rounded-full mb-4",children:[c.jsx(rs,{size:16,className:"text-royal-600 dark:text-royal-400"}),c.jsx("span",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 uppercase tracking-wider",children:"Your Details"})]}),c.jsx("h2",{className:"text-3xl md:text-4xl font-extrabold text-gray-900 dark:text-gray-50 mb-3",children:"Set Up Your Profile"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm max-w-lg mx-auto",children:"Just a few quick details to personalize your experience"})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Display Name"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",value:s,onChange:k=>o(k.target.value),placeholder:"Enter your name",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),c.jsx(rs,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Height (cm)"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:i,onChange:k=>a(k.target.value),placeholder:"175",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),c.jsx(Hg,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-2 ml-1",children:"Weight (kg)"}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"number",value:u,onChange:k=>d(k.target.value),placeholder:"70",className:"w-full p-4 pl-12 bg-gray-50 dark:bg-white/5 border border-gray-100 dark:border-white/5 rounded-[20px] focus:outline-none focus:ring-2 focus:ring-royal-200 focus:border-royal-400 font-bold text-gray-900 dark:text-gray-50 transition-all placeholder:text-gray-300 dark:placeholder:text-gray-600"}),c.jsx(Wg,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",size:20})]})]})]}),b&&c.jsxs("div",{className:"p-5 bg-gradient-to-r from-royal-50 to-purple-50 dark:from-royal-950/20 dark:to-purple-950/20 rounded-[24px] border border-royal-100 dark:border-royal-900/30 animate-in slide-in-from-bottom-2",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-xs font-bold text-royal-700 dark:text-royal-300 uppercase tracking-wider",children:"Your BMI"}),c.jsx("span",{className:"text-2xl font-extrabold text-royal-900 dark:text-royal-100",children:b.toFixed(1)})]}),C&&c.jsxs("p",{className:"text-xs text-royal-600 dark:text-royal-400",children:["Recommended daily goal: ",c.jsxs("span",{className:"font-bold",children:[C," kcal"]})]})]})]})]}),n===4&&c.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center animate-in fade-in zoom-in duration-500",children:[c.jsxs("div",{className:"relative mb-8",children:[c.jsx("div",{className:"w-28 h-28 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center shadow-2xl shadow-emerald-200 dark:shadow-emerald-900/40 animate-in zoom-in duration-700",children:c.jsx(Gg,{size:56,className:"text-white",strokeWidth:3})}),c.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-full animate-ping opacity-20"})]}),c.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-gray-50 mb-4 tracking-tight",children:"You're All Set!"}),c.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 font-medium mb-2",children:"Your personalized nutrition journey begins now"}),s&&C&&c.jsxs("div",{className:"mt-8 p-6 bg-gradient-to-br from-royal-50 to-purple-50 dark:from-royal-950/20 dark:to-purple-950/20 rounded-[28px] border border-royal-100 dark:border-royal-900/30 max-w-md w-full",children:[c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Welcome, ",c.jsx("span",{className:"font-bold text-royal-600 dark:text-royal-400",children:s}),"!"]}),c.jsxs("div",{className:"flex items-baseline gap-2 justify-center",children:[c.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-500 font-medium",children:"Daily Goal:"}),c.jsx("span",{className:"text-3xl font-extrabold text-royal-900 dark:text-royal-100",children:C}),c.jsx("span",{className:"text-sm font-bold text-gray-500 dark:text-gray-500",children:"kcal"})]})]}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-6 max-w-md leading-relaxed",children:"Start snapping photos of your meals to track your nutrition effortlessly. We'll help you stay on track!"})]}),c.jsxs("div",{className:"flex items-center justify-between mt-8 pt-6 border-t border-gray-100 dark:border-white/5",children:[c.jsxs("button",{onClick:S,disabled:n===0,className:`flex items-center gap-2 px-5 py-3 rounded-[16px] font-bold text-sm transition-all ${n===0?"opacity-0 pointer-events-none":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-white/5"}`,children:[c.jsx(ro,{size:20}),"Back"]}),n===m-1?c.jsxs(Me,{onClick:y,isLoading:h,className:"px-8 py-4 text-base shadow-xl shadow-royal-200 dark:shadow-royal-900/40",children:["Start Tracking",c.jsx(rr,{size:20,className:"ml-1"})]}):n===3?c.jsxs(Me,{onClick:_,disabled:!w,className:"px-8 py-4 text-base shadow-xl shadow-royal-200 dark:shadow-royal-900/40",children:["Continue",c.jsx(rr,{size:20,className:"ml-1"})]}):c.jsxs(Me,{onClick:_,className:"px-8 py-4 text-base shadow-xl shadow-royal-200 dark:shadow-royal-900/40",children:["Next",c.jsx(rr,{size:20,className:"ml-1"})]})]})]})]})]})};function TA(){const[t,e]=E.useState(ge.DASHBOARD),[n,r]=E.useState(null),[s,o]=E.useState(!0),[i,a]=E.useState(!1),[u,d]=E.useState(!0);E.useEffect(()=>{Ee().then(m=>{r(m),o(!1),m&&Bf().catch(g=>console.error("Cleanup failed:",g))});const p=gb(m=>{r(m),o(!1),m&&Bf().catch(g=>console.error("Cleanup failed:",g))});return()=>p()},[]),E.useEffect(()=>{Ob()&&(console.log(" New day detected on app load! Clearing stale caches..."),mt.clearDateSensitiveCaches(),window.dispatchEvent(new CustomEvent("midnight-refresh")));const p=jb(()=>{console.log(" Midnight! Clearing caches and broadcasting refresh event..."),mt.clearDateSensitiveCaches(),window.dispatchEvent(new CustomEvent("midnight-refresh"))});return()=>{p()}},[]),E.useEffect(()=>{(async()=>{if(n){d(!0);const m=await Ab(n);a(!m),d(!1)}else a(!1),d(!1)})()},[n]);const h=()=>{a(!1),e(ge.DASHBOARD)};return s||u?c.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:c.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white rounded-full animate-spin"})}):n?i?c.jsx(EA,{user:n,onComplete:h}):c.jsxs(Mw,{currentView:t,onNavigate:e,children:[t===ge.DASHBOARD&&c.jsx(uA,{}),t===ge.CAL_COACH&&c.jsx(yA,{onNavigate:e}),t===ge.WORKOUT_PLAN&&c.jsx(wA,{onNavigate:e}),t===ge.HISTORY&&c.jsx(SA,{}),t===ge.PROFILE&&c.jsx(kA,{})]}):c.jsx(bA,{})}const Ty=document.getElementById("root");if(!Ty)throw new Error("Could not find root element to mount to");const CA=pl.createRoot(Ty);CA.render(c.jsx(Yy.StrictMode,{children:c.jsx(TA,{})}));
