import{c as We,j as e,R as xe,e as he,w as Ue,S as pe,D as Be,x as Q,y as V,z as q,d as ge,E as Ge,g as Oe,F as He,G as Ye,H as qe,h as Je}from"./index-hJxi6Bgy.js";import{r as x}from"./vendor-react-wGySg1uH.js";import{C as le}from"./Card-CbIZjvf3.js";import{C as Ve,U as Ke,c as Xe,d as Qe,M as de,a as Ze}from"./MealDetailModal-D3StZ1go.js";import{X as ue}from"./x-DBX_9i_k.js";import{C as J}from"./calendar-BQIuIOJ3.js";import{A as et}from"./users-CkAI04Vo.js";import{T as be}from"./trending-up-D94QXDTE.js";import{S as tt}from"./scale-B7ceOHo-.js";import{C as at}from"./check-dfzExLi1.js";import{C as fe}from"./chevron-left-DOBD0yYS.js";import{T as rt}from"./target-BXoKeCfi.js";import{T,G as st}from"./index-cQ6qJtkF.js";import{C as X}from"./chevron-right-BrFAlbv7.js";import{L as ot}from"./loader-2-CgaLxbKT.js";import"./vendor-charts-Bdt_fL2G.js";import"./vendor-supabase-DfwcnzK-.js";import"./camera-DvUmU0gI.js";import"./trash-2-BB6Brtb9.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=We("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),it=({summary:a,onClose:i})=>{const l=new Date(a.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl border border-white/50 animate-in slide-in-from-bottom duration-300",children:[e.jsxs("div",{className:"relative bg-primary-50 dark:bg-primary-950/20 p-8 pb-10",children:[e.jsx("div",{className:"absolute top-6 right-6",children:e.jsx("button",{onClick:i,className:"p-2 bg-white text-gray-900 rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:e.jsx(ue,{size:20})})}),e.jsxs("div",{className:"flex items-center gap-2 text-primary-600 mb-3",children:[e.jsx(J,{size:20}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Daily Report"})]}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 leading-tight",children:l})]}),e.jsxs("div",{className:"p-8 -mt-6 bg-white rounded-t-[32px] relative shadow-[-10px_-10px_30px_rgba(0,0,0,0.02)]",children:[e.jsxs("div",{className:"bg-white rounded-[32px] p-6 border border-gray-100 shadow-[0_10px_30px_-10px_rgba(0,0,0,0.05)] mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 block",children:"Total Consumed"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-5xl font-extrabold text-gray-900 tracking-tighter",children:a.totalCalories}),e.jsx("span",{className:"text-gray-400 font-bold text-lg",children:"kcal"})]})]}),e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-primary-50 dark:bg-primary-950/30 flex items-center justify-center text-primary-600",children:e.jsx(et,{size:28})})]}),e.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(Ve,{size:16})," Macro Breakdown"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-emerald-50 hover:border-emerald-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-emerald-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalProtein,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Protein"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-blue-50 hover:border-blue-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-blue-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalCarbs,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Carbs"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-orange-50 hover:border-orange-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-orange-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalFat,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Fat"})]})]})})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 flex justify-between items-center text-xs font-bold text-gray-400 uppercase tracking-wider",children:[e.jsxs("span",{children:[a.entries.length," meals tracked"]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-primary-600",children:[e.jsx(be,{size:14}),"See History Tab"]})]})]})]})})},lt=({onClose:a,onConfirm:i})=>{const[l,u]=x.useState(0),[h,d]=x.useState(""),[r,c]=x.useState(!1),[m,b]=x.useState(!0),[F,_]=x.useState(!1),[I,$]=x.useState(null);x.useEffect(()=>{(async()=>{const E=await he();E&&($(E),u(E.weight),d(E.weight.toString())),b(!1)})()},[]);const z=async()=>{const w=parseFloat(h)||l;if(r&&I&&w!==l){_(!0);try{await Ue({...I,weight:w}),u(w)}catch(E){console.error("Failed to save weight:",E)}_(!1)}i(w)};return m?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-8 w-[90%] max-w-sm shadow-2xl",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-primary-200 dark:border-primary-800 border-t-primary-600 rounded-full animate-spin"})})})}):e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-end sm:items-center justify-center animate-in fade-in duration-300",onClick:a,children:e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-t-[28px] sm:rounded-[28px] p-6 w-full sm:w-[90%] sm:max-w-sm shadow-2xl animate-in slide-in-from-bottom duration-500",onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center",children:e.jsx(tt,{size:20,className:"text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-black text-gray-900 dark:text-gray-50",children:"Weight Check"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-medium",children:"Before viewing your report"})]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-xl bg-gray-100 dark:bg-white/5 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:e.jsx(ue,{size:16,className:"text-gray-400"})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-5 mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4 text-center",children:"Is your current weight still accurate?"}),r?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:h,onChange:w=>d(w.target.value),className:"w-28 text-center text-3xl font-black text-gray-900 dark:text-gray-50 bg-white dark:bg-[#0F111A] border-2 border-primary-200 dark:border-primary-800 rounded-xl py-2 focus:outline-none focus:border-primary-500",step:"0.1",min:"20",max:"300",autoFocus:!0}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm font-bold text-gray-400",children:"kg"})]}),e.jsx("button",{onClick:()=>{c(!1),d(l.toString())},className:"text-xs text-gray-400 font-medium hover:text-gray-600",children:"Cancel"})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-black text-gray-900 dark:text-gray-50 mb-1",children:[l,e.jsx("span",{className:"text-lg font-bold text-gray-400 ml-1",children:"kg"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"text-xs text-primary-600 dark:text-primary-400 font-bold flex items-center gap-1 mx-auto hover:underline",children:[e.jsx(xe,{size:12}),"Update weight"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 py-3.5 rounded-xl bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 font-bold text-sm hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:z,disabled:F,className:"flex-1 py-3.5 rounded-xl bg-primary-600 text-white font-bold text-sm hover:bg-primary-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:F?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(at,{size:16}),"Confirm"]})})]})]})})},dt=({report:a,reportType:i,onClose:l,onRegenerate:u,isRegenerating:h=!1})=>{const d=()=>{const c=new Date(a.periodStart),m=new Date(a.periodEnd);if(i==="daily")return c.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});if(i==="weekly"){const b=c.toLocaleDateString("en-US",{month:"short",day:"numeric"}),F=m.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${b} - ${F}`}return c.toLocaleDateString("en-US",{month:"long",year:"numeric"})},r=()=>{switch(i){case"daily":return"Daily Review";case"weekly":return"Weekly Summary";case"monthly":return"Monthly Report"}};return e.jsx("div",{className:"fixed inset-0 bg-[#F3F0E7] dark:bg-[#0F111A] z-[100] animate-in slide-in-from-right duration-300 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen pb-20",children:[e.jsx("div",{className:"sticky top-0 bg-[#F3F0E7]/80 dark:bg-[#0F111A]/80 backdrop-blur-xl z-10 px-6 pt-10 pb-4 border-b border-gray-100 dark:border-white/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 hover:text-primary-600 transition-colors",children:[e.jsx(fe,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back"})]}),e.jsxs("button",{onClick:u,disabled:h,className:"flex items-center gap-2 text-xs font-bold text-[#3D745B] dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 px-3 py-1.5 rounded-xl hover:bg-primary-100 dark:hover:bg-primary-900/30 transition-colors disabled:opacity-50",children:[e.jsx(xe,{size:12,className:h?"animate-spin":""}),h?"Generating...":"Regenerate"]})]})}),e.jsxs("div",{className:"px-6 pt-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(pe,{size:20,className:"text-primary-600 dark:text-primary-400"}),e.jsx("span",{className:"text-[10px] font-bold text-primary-600 dark:text-primary-400 uppercase tracking-widest",children:"Coach Tips"})]}),e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight mb-1",children:r()}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500",children:[e.jsx(J,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:d()})]})]}),e.jsx("div",{className:"bg-[#3D745B] rounded-4xl p-6 mb-6 shadow-lg shadow-primary-200/30 dark:shadow-primary-900/40",children:e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0",children:e.jsx(be,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white/80 mb-1",children:"Summary"}),e.jsx("p",{className:"text-white text-sm leading-relaxed",children:a.summary})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Period Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-[#FFF4E6] dark:bg-orange-950/20 rounded-2xl p-4 border-2 border-orange-200 dark:border-white/5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-orange-100 dark:bg-orange-500/10 flex items-center justify-center",children:e.jsx(Ke,{size:12,className:"text-orange-600 dark:text-orange-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-orange-800/60 dark:text-gray-400 uppercase",children:"Avg Calories"})]}),e.jsxs("span",{className:"text-xl font-black text-orange-900 dark:text-gray-50",children:[a.metrics.avgCalories,e.jsx("span",{className:"text-xs font-bold text-orange-800/40 ml-1",children:"kcal"})]})]}),e.jsxs("div",{className:"bg-[#F0F7F4] dark:bg-emerald-950/20 rounded-2xl p-4 border-2 border-emerald-200 dark:border-white/5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-emerald-100 dark:bg-emerald-500/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-black text-emerald-600 dark:text-emerald-400",children:"P"})}),e.jsx("span",{className:"text-[9px] font-bold text-emerald-800/60 dark:text-gray-400 uppercase",children:"Avg Protein"})]}),e.jsxs("span",{className:"text-xl font-black text-emerald-900 dark:text-gray-50",children:[a.metrics.avgProtein,e.jsx("span",{className:"text-xs font-bold text-emerald-800/40 ml-1",children:"g"})]})]}),e.jsxs("div",{className:"bg-[#E7ECE9] dark:bg-primary-950/20 rounded-2xl p-4 border-2 border-[#C1D6CB] dark:border-white/5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-primary-100 dark:bg-primary-500/10 flex items-center justify-center",children:e.jsx(Be,{size:12,className:"text-[#3D745B] dark:text-primary-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-[#3D745B]/60 dark:text-gray-400 uppercase",children:"Workouts"})]}),e.jsxs("span",{className:"text-xl font-black text-[#3D745B] dark:text-gray-50",children:[a.metrics.workoutsCompleted,e.jsx("span",{className:"text-xs font-bold text-[#3D745B]/40 ml-1",children:"done"})]})]}),e.jsxs("div",{className:"bg-[#EFF6FF] dark:bg-blue-950/20 rounded-2xl p-4 border-2 border-blue-200 dark:border-white/5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-blue-100 dark:bg-blue-500/10 flex items-center justify-center",children:e.jsx(rt,{size:12,className:"text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-blue-800/60 dark:text-gray-400 uppercase",children:"Goal Rate"})]}),e.jsxs("span",{className:"text-xl font-black text-blue-900 dark:text-gray-50",children:[a.metrics.calorieGoalHitRate,e.jsx("span",{className:"text-xs font-bold text-blue-800/40 ml-1",children:"%"})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Improvement Tips"}),e.jsx("div",{className:"space-y-3",children:a.tips.map((c,m)=>{const b=["bg-[#F0F4F2] border-[#C2D1CC] text-emerald-900","bg-[#F9F4F2] border-[#EAD0C8] text-orange-900","bg-[#F7F6F0] border-[#E8E1BC] text-[#4A483E]","bg-[#F0F4F9] border-[#C8D6E8] text-blue-900"],F=b[m%b.length];return e.jsxs("div",{className:`${F} dark:bg-[#1A1C26] rounded-2xl p-4 border-2 flex items-start gap-3 shadow-sm`,children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/50 backdrop-blur-sm flex items-center justify-center flex-shrink-0 text-xl shadow-sm",children:c.emoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold opacity-90 mb-0.5",children:c.title}),e.jsx("p",{className:"text-xs opacity-70 leading-relaxed font-medium",children:c.description})]})]},m)})})]}),a.weightAtReport&&e.jsxs("div",{className:"text-center text-xs text-gray-400 dark:text-gray-500",children:["Weight at report: ",e.jsxs("span",{className:"font-bold",children:[a.weightAtReport," kg"]})]})]})]})})},ct=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",mt=()=>new st({apiKey:ct()}),ye="snapcal_coach_reports_v1",xt=`You are **Cal Coach**, providing personalized health and fitness reviews.

**Your Role:**
Generate concise, motivating, and actionable reports based on the user's tracking data.

**Report Guidelines:**
1. **Summary**: 2-3 sentences highlighting key achievements and areas for improvement
2. **Tips**: Exactly 3 specific, actionable tips 
3. **Tone**: Encouraging but honest. Celebrate wins, gently address gaps

**Tip Format:**
Each tip should have:
- emoji: A relevant emoji (ðŸ¥—, ðŸ’ª, ðŸŽ¯, âš¡, ðŸ’§, ðŸ”¥, etc.)
- title: Short action phrase (3-5 words)
- description: One sentence explaining the tip

**Never:**
- Be negative or discouraging
- Give generic advice that doesn't relate to the user's data
- Use medical disclaimers or suggest consulting doctors
- Repeat the same tip twice`,ht=async(a,i)=>{if(!Q){const d=localStorage.getItem("snapcal_workouts");return d?JSON.parse(d).filter(c=>c.date>=a&&c.date<=i):[]}const l=await V();if(!l)return[];const{data:u,error:h}=await q.from("workout_plans").select("*").eq("user_id",l.id).gte("date",a).lte("date",i);return h?(console.error("Failed to fetch workout plans:",h),[]):u.map(d=>({id:d.id,date:d.date,title:d.title,exercises:d.exercises||[]}))},pt=async(a,i,l)=>{const[u,h,d,r]=await Promise.all([he(),ge(),Ge(i,l),ht(i,l)]),c=d.length,m=d.reduce((y,k)=>y+(k.totalCalories>0?1:0),0),b=c>0?Math.round(d.reduce((y,k)=>y+k.totalCalories,0)/c):0,F=c>0?Math.round(d.reduce((y,k)=>y+k.totalProtein,0)/c):0,_=c>0?Math.round(d.reduce((y,k)=>y+k.totalCarbs,0)/c):0,I=c>0?Math.round(d.reduce((y,k)=>y+k.totalFat,0)/c):0,$=d.filter(y=>Math.abs(y.totalCalories-h)<=h*.1).length,z=c>0?Math.round($/c*100):0,w=r.filter(y=>y.exercises.some(k=>k.completed)).length,E={avgCalories:b,avgProtein:F,avgCarbs:_,avgFat:I,totalMeals:m,workoutsCompleted:w,daysTracked:c,calorieGoalHitRate:z},L=d.map(y=>({date:y.date,calories:y.totalCalories,protein:y.totalProtein,carbs:y.totalCarbs,fat:y.totalFat,meals:y.totalCalories>0?1:0}));return{profile:u,dailyGoal:h,periodStart:i,periodEnd:l,reportType:a,metrics:E,dailyBreakdown:L,workoutsCompleted:w}},gt=a=>{const{profile:i,dailyGoal:l,periodStart:u,periodEnd:h,reportType:d,metrics:r,dailyBreakdown:c}=a;let m=`**${d.charAt(0).toUpperCase()+d.slice(1)} Health Review**
`;return m+=`Period: ${u} to ${h}

`,i&&(m+=`**User Profile:**
`,i.name&&(m+=`- Name: ${i.name}
`),i.weight&&(m+=`- Weight: ${i.weight} kg
`),i.height&&(m+=`- Height: ${i.height} cm
`),i.goal&&(m+=`- Goal: ${{cut:"Lose weight",bulk:"Build muscle",maintain:"Maintain weight"}[i.goal]}
`),m+=`- Daily Calorie Goal: ${l} kcal

`),m+=`**Period Statistics:**
`,m+=`- Days tracked: ${r.daysTracked}
`,m+=`- Average daily calories: ${r.avgCalories} kcal (Goal: ${l})
`,m+=`- Average protein: ${r.avgProtein}g
`,m+=`- Average carbs: ${r.avgCarbs}g
`,m+=`- Average fat: ${r.avgFat}g
`,m+=`- Calorie goal hit rate: ${r.calorieGoalHitRate}%
`,m+=`- Workouts completed: ${r.workoutsCompleted}

`,c.length>0&&c.length<=7&&(m+=`**Daily Breakdown:**
`,c.forEach(b=>{m+=`- ${b.date}: ${b.calories} kcal, P: ${b.protein}g, C: ${b.carbs}g, F: ${b.fat}g
`})),m+=`
---

Provide a summary and 3 actionable tips based on this data.`,m},ut=async a=>{const i=mt(),l=gt(a),u=await i.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:l}]}],config:{systemInstruction:xt,responseMimeType:"application/json",responseSchema:{type:T.OBJECT,properties:{summary:{type:T.STRING},tips:{type:T.ARRAY,items:{type:T.OBJECT,properties:{emoji:{type:T.STRING},title:{type:T.STRING},description:{type:T.STRING}},required:["emoji","title","description"]}}},required:["summary","tips"]}}});return Xe(Qe,u.text||"{}","Coach Report")},we=()=>{try{const a=localStorage.getItem(ye);return a?JSON.parse(a):[]}catch{return[]}},bt=a=>{localStorage.setItem(ye,JSON.stringify(a))},ke=async(a,i,l)=>{if(!Q)return we().find(c=>c.reportType===a&&c.periodStart===i&&c.periodEnd===l)||null;const u=await V();if(!u)return null;const{data:h,error:d}=await q.from("coach_reports").select("*").eq("user_id",u.id).eq("report_type",a).eq("period_start",i).eq("period_end",l).single();return d||!h?null:{id:h.id,userId:h.user_id,reportType:h.report_type,periodStart:h.period_start,periodEnd:h.period_end,summary:h.summary,tips:h.tips,metrics:h.metrics,weightAtReport:h.weight_at_report,createdAt:h.created_at}},ft=async a=>{if(!Q){const h=we().filter(d=>!(d.reportType===a.reportType&&d.periodStart===a.periodStart&&d.periodEnd===a.periodEnd));h.push(a),bt(h);return}const i=await V();if(!i)throw new Error("User not authenticated");await q.from("coach_reports").delete().eq("user_id",i.id).eq("report_type",a.reportType).eq("period_start",a.periodStart).eq("period_end",a.periodEnd);const{error:l}=await q.from("coach_reports").insert({id:a.id,user_id:i.id,report_type:a.reportType,period_start:a.periodStart,period_end:a.periodEnd,summary:a.summary,tips:a.tips,metrics:a.metrics,weight_at_report:a.weightAtReport});if(l)throw console.error("Failed to save report:",l),new Error("Failed to save report")},yt=async(a,i,l,u)=>{var m;const h=await V();if(!h)throw new Error("User not authenticated");const d=await pt(a,i,l),r=await ut(d),c={id:`${a}_${i}_${Date.now()}`,userId:h.id,reportType:a,periodStart:i,periodEnd:l,summary:r.summary,tips:r.tips.slice(0,3),metrics:d.metrics,weightAtReport:u||((m=d.profile)==null?void 0:m.weight),createdAt:new Date().toISOString()};return await ft(c),c},ce=async(a,i,l,u=!1,h)=>{if(!u){const d=await ke(a,i,l);if(d)return d}return yt(a,i,l,h)},me=(a,i)=>{if(a==="daily")return{start:i,end:i};if(a==="weekly"){const c=new Date(i),m=new Date(c);m.setDate(c.getDate()+6);const b=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")}`;return{start:i,end:b}}const[l,u]=i.split("-").map(Number),h=new Date(l,u,0),d=`${l}-${String(u).padStart(2,"0")}-01`,r=`${l}-${String(u).padStart(2,"0")}-${String(h.getDate()).padStart(2,"0")}`;return{start:d,end:r}},zt=()=>{const[a,i]=x.useState([]),[l,u]=x.useState(2e3),[h,d]=x.useState(!0),[r,c]=x.useState("day"),[m,b]=x.useState(null),[F,_]=x.useState(null),[I,$]=x.useState(!1),[z,w]=x.useState(null),[E,L]=x.useState(!1),[y,k]=x.useState(!1),[M,B]=x.useState(null),[je,G]=x.useState(!1),[Ne,Z]=x.useState(!1),[N,ve]=x.useState(Oe()),[S,Se]=x.useState(new Date().toISOString().substring(0,7)),[v,Ce]=x.useState(()=>{const t=new Date,s=t.getDay(),o=s===0?-6:1-s,n=new Date(t);n.setDate(t.getDate()+o);const p=n.getFullYear(),g=String(n.getMonth()+1).padStart(2,"0"),f=String(n.getDate()).padStart(2,"0");return`${p}-${g}-${f}`}),[De,ee]=x.useState(!1),[Fe,Ee]=x.useState({}),[R,O]=x.useState({}),[Re,te]=x.useState({}),[H,W]=x.useState({}),K=x.useRef(null);document.documentElement.classList.contains("dark");const ae=x.useCallback(()=>{if(K.current){const t=K.current;t.scrollLeft=t.scrollWidth}},[]);x.useEffect(()=>{const t=setTimeout(ae,100);return()=>clearTimeout(t)},[r,ae]);const Y=async()=>{d(!0);try{const[t,s]=await Promise.all([qe(),ge()]);i(t),u(s),U(N)}catch(t){console.error("Failed to load history data",t)}finally{d(!1)}},U=x.useCallback(async t=>{if(!R[t]){te(s=>({...s,[t]:!0}));try{const s=await He(t);O(o=>({...o,[t]:s}))}catch(s){console.error(`Failed to load entries for ${t}`,s)}finally{te(s=>({...s,[t]:!1}))}}},[R]),$e=x.useCallback(async t=>{if(H[t]===void 0){W(s=>({...s,[t]:null}));try{const s=await Ye(t);W(o=>({...o,[t]:s}))}catch(s){console.error(`Failed to load image for entry ${t}`,s)}}},[H]);x.useEffect(()=>{Y();const t=()=>{O({}),W({}),Y()};return window.addEventListener("food-entry-updated",t),()=>window.removeEventListener("food-entry-updated",t)},[]),x.useEffect(()=>{N&&(r==="day"||r==="week")&&U(N)},[N,U,r]);const re=async t=>{await Je(t),O({}),W({}),await Y()},se=t=>{b(null),w(t),$(!0)},Me=async()=>{G(!0);try{const t=r==="day"?"daily":r==="week"?"weekly":"monthly",s=r==="day"?N:r==="week"?v:S,{start:o,end:n}=me(t,s),p=await ke(t,o,n);p?(B(p),k(!0)):L(!0)}catch(t){console.error("Failed to check for report:",t),L(!0)}finally{G(!1)}},Te=async t=>{L(!1),G(!0);try{const s=r==="day"?"daily":r==="week"?"weekly":"monthly",o=r==="day"?N:r==="week"?v:S,{start:n,end:p}=me(s,o),g=await ce(s,n,p,!1,t);B(g),k(!0)}catch(s){console.error("Failed to generate report:",s),alert("Failed to generate AI report. Please try again.")}finally{G(!1)}},_e=async()=>{if(M){Z(!0);try{const t=await ce(M.reportType,M.periodStart,M.periodEnd,!0);B(t)}catch(t){console.error("Failed to regenerate report:",t),alert("Failed to regenerate report. Please try again.")}finally{Z(!1)}}},oe=t=>(H[t.id]===void 0&&$e(t.id),{...t,imageUrl:H[t.id]||void 0}),Ie=x.useMemo(()=>{if(r==="day"){const t=[],s=new Date,o=new Date(s);o.setDate(s.getDate()-30);for(let n=new Date(o);n<=s;n.setDate(n.getDate()+1)){const p=n.getFullYear(),g=String(n.getMonth()+1).padStart(2,"0"),f=String(n.getDate()).padStart(2,"0"),j=`${p}-${g}-${f}`;t.push({id:j,name:n.toLocaleDateString("en-US",{weekday:"short"}),label:n.getDate().toString(),date:j})}return t}else if(r==="week"){const t=[],s=new Date,o=s.getDay(),n=o===0?-6:1-o,p=new Date(s);p.setDate(s.getDate()+n);for(let g=0;g<8;g++){const f=new Date(p);f.setDate(p.getDate()-g*7);const j=new Date(f);j.setDate(f.getDate()+6);const C=f.toLocaleDateString("en-US",{month:"short",day:"numeric"}),D=j.toLocaleDateString("en-US",{day:"numeric"}),A=f.getFullYear(),Ae=String(f.getMonth()+1).padStart(2,"0"),ze=String(f.getDate()).padStart(2,"0"),ie=`${A}-${Ae}-${ze}`;t.push({id:ie,name:"Week",label:`${C} - ${D}`,date:ie})}return t.reverse()}else{const t=new Set;return a.forEach(o=>{const n=o.date.substring(0,7);t.add(n)}),Array.from(t).sort().map(o=>{const[n,p]=o.split("-"),g=new Date(parseInt(n),parseInt(p)-1,1);return{id:o,name:g.toLocaleDateString("en-US",{year:"2-digit"}),label:g.toLocaleDateString("en-US",{month:"short"}),date:o}})}},[r,a]),P=x.useMemo(()=>{if(r==="day")return a.find(t=>t.date===N)||{date:N,totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};if(r==="week"){if(!v)return{date:"",totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};const t=new Date(v),s=new Date(t);s.setDate(t.getDate()+6);const o=v,n=s.getFullYear(),p=String(s.getMonth()+1).padStart(2,"0"),g=String(s.getDate()).padStart(2,"0"),f=`${n}-${p}-${g}`,C=a.filter(D=>D.date>=o&&D.date<=f).reduce((D,A)=>({totalCalories:D.totalCalories+A.totalCalories,totalProtein:D.totalProtein+A.totalProtein,totalCarbs:D.totalCarbs+A.totalCarbs,totalFat:D.totalFat+A.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:v,...C}}else{const s=a.filter(o=>o.date.startsWith(S)).reduce((o,n)=>({totalCalories:o.totalCalories+n.totalCalories,totalProtein:o.totalProtein+n.totalProtein,totalCarbs:o.totalCarbs+n.totalCarbs,totalFat:o.totalFat+n.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:S,...s}}},[a,N,S,v,r]),Le=x.useMemo(()=>{if(r==="day")return[];const t=o=>{if(r==="month")return o.startsWith(S);if(r==="week"&&v)try{const[n,p,g]=v.split("-").map(Number),f=new Date(n,p-1,g),j=new Date(f);j.setDate(f.getDate()+6);const C=new Date(o);return C>=f&&C<=j}catch{return!1}return!1};return Object.entries(R).filter(([o])=>t(o)).flatMap(([o,n])=>n).sort((o,n)=>n.timestamp.localeCompare(o.timestamp))},[R,S,v,r]),ne=x.useMemo(()=>{if(r==="day")return{};const t=o=>{if(r==="month")return o.startsWith(S);if(r==="week"&&v)try{const[n,p,g]=v.split("-").map(Number),f=new Date(n,p-1,g),j=new Date(f);j.setDate(f.getDate()+6);const C=new Date(o);return C>=f&&C<=j}catch{return!1}return!1},s={};return Object.entries(R).filter(([o])=>t(o)).forEach(([o,n])=>{n.length>0&&(s[o]=n.sort((p,g)=>g.timestamp.localeCompare(p.timestamp)))}),s},[R,S,v,r]),Pe=t=>{Ee(s=>({...s,[t]:!s[t]}))};return x.useEffect(()=>{r==="month"&&a.filter(s=>s.date.startsWith(S)).map(s=>s.date).forEach(s=>U(s))},[r,S,a,U]),De?e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in slide-in-from-right duration-500 bg-background dark:bg-surface-dark",children:[e.jsxs("div",{className:"px-6 pt-10 pb-32 overflow-y-auto no-scrollbar",children:[e.jsxs("button",{onClick:()=>ee(!1),className:"flex items-center gap-2 text-secondary-400 dark:text-gray-500 mb-6 hover:text-primary-600 transition-colors",children:[e.jsx(fe,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back to Report"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl font-black text-primary-900 dark:text-primary-50 tracking-tight font-display",children:"History Log"}),e.jsx("div",{className:"text-xs font-bold text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 px-3 py-1.5 rounded-xl border border-primary-100 dark:border-primary-800/50",children:r==="week"?new Date(N).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):new Date(S+"-01").toLocaleDateString(void 0,{month:"long",year:"numeric"})})]}),e.jsx("div",{className:"space-y-4",children:r==="day"?Re[N]?e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(t=>e.jsx("div",{className:"h-20 bg-surface dark:bg-surface-dark rounded-4xl animate-pulse border border-white/40 dark:border-white/5"},t))}):(R[N]||[]).length>0?(R[N]||[]).map(t=>{const s=oe(t);return e.jsxs("div",{onClick:()=>b(s),className:"bg-surface dark:bg-surface-dark p-4 flex justify-between items-center rounded-4xl shadow-soft border border-white/40 dark:border-white/5 hover:bg-white dark:hover:bg-white/5 transition-all cursor-pointer active:scale-[0.98]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-3xl bg-secondary-50 dark:bg-white/5 overflow-hidden shadow-inner border border-white/40 dark:border-white/5",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-secondary-50 dark:bg-white/10 text-secondary-300 dark:text-secondary-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-secondary-300 dark:bg-secondary-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-primary-900 dark:text-primary-50 font-bold",children:t.food_item}),e.jsx("span",{className:"text-[10px] text-secondary-400 dark:text-secondary-500 font-medium",children:t.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-primary-600 dark:text-primary-400 font-black",children:t.calories}),e.jsx("span",{className:"text-[8px] font-bold text-secondary-400 uppercase",children:"kcal"})]})]},t.id)}):e.jsxs("div",{className:"bg-surface dark:bg-surface-dark rounded-4xl p-12 text-center border border-dashed border-secondary-200 dark:border-white/10",children:[e.jsx(J,{size:32,className:"mx-auto text-secondary-200 dark:text-white/5 mb-4"}),e.jsx("p",{className:"text-secondary-400 dark:text-secondary-500 text-sm font-medium",children:"No meals logged for this day."})]}):Object.keys(ne).length>0?Object.entries(ne).sort(([t],[s])=>s.localeCompare(t)).map(([t,s])=>{const o=Fe[t],n=s.reduce((p,g)=>p+g.calories,0);return e.jsxs("div",{className:"bg-surface dark:bg-surface-dark rounded-4xl border border-white/40 dark:border-white/5 overflow-hidden shadow-soft",children:[e.jsxs("button",{onClick:()=>Pe(t),className:"w-full p-4 flex justify-between items-center hover:bg-white dark:hover:bg-white/5 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`transition-transform duration-200 ${o?"rotate-90":""}`,children:e.jsx(X,{size:16,className:"text-secondary-400"})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-sm font-bold text-primary-900 dark:text-primary-50",children:new Date(t).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),e.jsxs("span",{className:"text-[9px] font-medium text-secondary-400",children:[s.length," meal",s.length!==1?"s":""]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-primary-600 dark:text-primary-400 font-black",children:n}),e.jsx("span",{className:"text-[8px] font-bold text-secondary-400 uppercase",children:"kcal"})]})]}),o&&e.jsx("div",{className:"border-t border-secondary-100 dark:border-white/5",children:s.map(p=>{const g=oe(p);return e.jsxs("div",{onClick:()=>b(g),className:"p-4 flex justify-between items-center hover:bg-white dark:hover:bg-white/5 transition-all cursor-pointer border-b border-secondary-50 dark:border-white/5 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-3xl bg-secondary-50 dark:bg-white/5 overflow-hidden shadow-inner border border-white/40 dark:border-white/5",children:g.imageUrl?e.jsx("img",{src:g.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-secondary-50 dark:bg-white/10 text-secondary-300 dark:text-secondary-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-secondary-300 dark:bg-secondary-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-primary-900 dark:text-primary-50 font-bold leading-tight",children:p.food_item}),e.jsx("span",{className:"text-[9px] text-secondary-400 dark:text-secondary-500",children:p.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-primary-600 dark:text-primary-400 font-black",children:p.calories}),e.jsx("span",{className:"text-[8px] font-bold text-secondary-400 uppercase",children:"kcal"})]})]},p.id)})})]},t)}):e.jsxs("div",{className:"bg-surface dark:bg-surface-dark rounded-4xl p-12 text-center border border-dashed border-secondary-200 dark:border-white/10",children:[e.jsx(J,{size:32,className:"mx-auto text-secondary-200 dark:text-white/5 mb-4"}),e.jsxs("p",{className:"text-secondary-400 dark:text-secondary-500 text-sm font-medium",children:["No data for this ",r==="month"?"month":"week","."]})]})})]}),m&&e.jsx(de,{entry:m,onClose:()=>b(null),onDelete:re,onEdit:se})]}):e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-y-auto no-scrollbar relative bg-background dark:bg-surface-dark",children:[e.jsxs("div",{className:"px-6 pt-10 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-black text-primary-900 dark:text-primary-50 tracking-tight font-display",children:"Report"}),e.jsxs("div",{className:"flex p-1 bg-surface dark:bg-surface-dark rounded-xl border border-white/40 dark:border-white/5 shadow-sm",children:[e.jsx("button",{onClick:()=>c("day"),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${r==="day"?"bg-[#3D745B] text-white shadow-soft":"text-secondary-400 dark:text-secondary-500 hover:text-[#3D745B]"}`,children:"Daily"}),e.jsx("button",{onClick:()=>c("week"),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${r==="week"?"bg-[#3D745B] text-white shadow-soft":"text-secondary-400 dark:text-secondary-500 hover:text-[#3D745B]"}`,children:"Weekly"}),e.jsx("button",{onClick:()=>c("month"),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold transition-all ${r==="month"?"bg-[#3D745B] text-white shadow-soft":"text-secondary-400 dark:text-secondary-500 hover:text-[#3D745B]"}`,children:"Monthly"})]})]}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{ref:K,className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1 snap-x",style:{WebkitOverflowScrolling:"touch"},children:Ie.map(t=>{const s=r==="day"?t.id===N:r==="week"?t.id===v:t.id===S,o=a.some(n=>{if(r==="day")return n.date===t.id;if(r==="week"){const[p,g,f]=t.id.split("-").map(Number),j=new Date(p,g-1,f),C=new Date(j);C.setDate(j.getDate()+6);const D=new Date(n.date);return D>=j&&D<=C}return n.date.startsWith(t.id)});return e.jsxs("button",{onClick:()=>{r==="day"?ve(t.id):r==="week"?Ce(t.id):Se(t.id)},className:`flex-shrink-0 flex flex-col items-center justify-center ${r==="week"?"w-24":"w-12"} py-3 rounded-3xl transition-all duration-300 snap-center ${s?"bg-[#3D745B] text-white shadow-lg shadow-primary-200/50 dark:shadow-primary-900/40 transform scale-110":"bg-surface dark:bg-surface-dark text-secondary-400 dark:text-secondary-500 border border-white/40 dark:border-white/5"}`,children:[e.jsx("span",{className:`text-[9px] font-bold uppercase mb-1 ${s?"text-white/70":"text-secondary-400"}`,children:t.name}),e.jsx("span",{className:"text-sm font-extrabold",children:t.label}),o&&!s&&e.jsx("div",{className:"w-1 h-1 rounded-full bg-primary-400 mt-1"})]},t.id)})}),e.jsx("div",{className:"absolute top-0 left-0 bottom-2 w-8 bg-gradient-to-r from-background dark:from-surface-dark to-transparent pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 right-0 bottom-2 w-8 bg-gradient-to-l from-background dark:from-surface-dark to-transparent pointer-events-none z-10"})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-surface dark:bg-surface-dark rounded-4xl p-6 shadow-soft border border-white/40 dark:border-white/5 flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-bold text-secondary-400 dark:text-secondary-500 uppercase tracking-widest mb-1",children:r==="day"?"Daily Total":r==="week"?"Weekly Total":"Monthly Total"}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("span",{className:"text-5xl font-black text-primary-900 dark:text-primary-50 tracking-tighter",children:Math.round(P.totalCalories)}),e.jsx("span",{className:"text-[10px] font-black text-primary-600 dark:text-primary-400 uppercase tracking-widest mt-0.5",children:"KCAL"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2.5 w-full",children:[e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-emerald-50/50 dark:bg-emerald-500/5 rounded-3xl border border-emerald-100/50 dark:border-emerald-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-emerald-600/60 dark:text-emerald-400/60 uppercase mb-0.5",children:"Protein"}),e.jsxs("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:[Math.round(P.totalProtein),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-amber-50/50 dark:bg-amber-500/5 rounded-3xl border border-amber-100/50 dark:border-amber-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-amber-600/60 dark:text-amber-400/60 uppercase mb-0.5",children:"Carbs"}),e.jsxs("span",{className:"text-sm font-black text-amber-600 dark:text-amber-400",children:[Math.round(P.totalCarbs),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-rose-50/50 dark:bg-rose-500/5 rounded-3xl border border-rose-100/50 dark:border-rose-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-rose-600/60 dark:text-rose-400/60 uppercase mb-0.5",children:"Fat"}),e.jsxs("span",{className:"text-sm font-black text-rose-600 dark:text-rose-400",children:[Math.round(P.totalFat),"g"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{onClick:Me,className:"p-5 flex flex-col justify-between h-36 bg-[#3D745B] text-white shadow-soft-lg cursor-pointer active:scale-[0.98] transition-transform rounded-4xl",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(pe,{size:12,className:"text-white/70"}),e.jsx("p",{className:"text-[10px] font-bold text-white/70 uppercase",children:r==="day"?"Coach Tips":"Report"})]}),e.jsx("h3",{className:"text-lg font-black leading-tight",children:r==="day"?"Daily Review":r==="week"?"Weekly Summary":e.jsxs(e.Fragment,{children:["Your Health",e.jsx("br",{}),"Summary"]})})]}),e.jsx("div",{className:"mt-2 py-2 bg-white/20 rounded-full text-[10px] font-bold backdrop-blur-sm flex items-center justify-center gap-2",children:je?e.jsx(ot,{size:12,className:"animate-spin"}):e.jsxs(e.Fragment,{children:["VIEW INSIGHTS",e.jsx(X,{size:12})]})})]}),e.jsxs("div",{className:"grid grid-rows-2 gap-4 h-36",children:[e.jsxs(le,{onClick:()=>ee(!0),className:"p-4 flex flex-col justify-center bg-surface dark:bg-surface-dark border-white/40 dark:border-white/5 active:scale-95 transition-transform cursor-pointer rounded-4xl shadow-soft",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-secondary-400 uppercase",children:"History Log"}),e.jsx(X,{size:10,className:"text-secondary-300"})]}),e.jsxs("p",{className:"text-xs font-black text-primary-900 dark:text-primary-50",children:[r==="day"?(R[N]||[]).length:Le.length," Meals"]})]}),e.jsxs(le,{className:"p-4 flex flex-col justify-center bg-surface dark:bg-surface-dark border-white/40 dark:border-white/5 rounded-4xl shadow-soft",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-secondary-400 uppercase",children:"Goal Status"}),e.jsx(nt,{size:10,className:"text-secondary-300"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1 bg-secondary-100 dark:bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[#3D745B] rounded-full",style:{width:`${Math.min(P.totalCalories/(r==="day"?l:r==="week"?l*7:l*30)*100,100)}%`}})}),e.jsxs("span",{className:"text-[10px] font-black text-primary-900 dark:text-primary-50",children:[Math.round(P.totalCalories/(r==="day"?l:r==="week"?l*7:l*30)*100),"%"]})]})]})]})]}),e.jsx("div",{className:"h-24"})]}),m&&e.jsx(de,{entry:m,onClose:()=>b(null),onDelete:re,onEdit:se}),F&&e.jsx(it,{summary:F,onClose:()=>_(null)}),I&&e.jsx(Ze,{editEntry:z,onClose:()=>{$(!1),w(null)},onSuccess:()=>{$(!1),w(null),O({}),W({}),Y()},onOpenSharedMeal:()=>{$(!1)}}),E&&e.jsx(lt,{onClose:()=>L(!1),onConfirm:Te}),y&&M&&e.jsx(dt,{report:M,reportType:M.reportType,onClose:()=>{k(!1),B(null)},onRegenerate:_e,isRegenerating:Ne})]})};export{zt as History};
