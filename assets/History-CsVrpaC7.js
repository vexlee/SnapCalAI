import{c as We,j as e,R as me,e as ge,w as Ue,S as he,D as Ge,x as Z,y as V,z as q,d as pe,E as Oe,g as He,F as Ye,G as Be,H as qe,h as Je}from"./index-BOkvYJIO.js";import{r as m}from"./vendor-react-wGySg1uH.js";import{C as X}from"./Card-OoPnMbgp.js";import{C as Ve,U as Ke,c as Xe,d as Qe,M as de,a as Ze}from"./MealDetailModal-CH6yJAq5.js";import{X as ue}from"./x-UqcKxpOp.js";import{C as J}from"./calendar-D7qyTET5.js";import{A as et}from"./users-CDr-sS8V.js";import{T as be}from"./trending-up-Fk3pr1EM.js";import{S as tt}from"./scale-G1BI-Oup.js";import{C as at}from"./check-DKU_3Zbm.js";import{C as ye}from"./chevron-left-CvgWPEtr.js";import{T as rt}from"./target-B4Ccz6di.js";import{T as $,G as st}from"./index-cQ6qJtkF.js";import{C as Q}from"./chevron-right-j72FCP8v.js";import{L as ot}from"./loader-2-2SpGU7ED.js";import"./vendor-charts-Bdt_fL2G.js";import"./vendor-supabase-DfwcnzK-.js";import"./camera-BtjSmijZ.js";import"./trash-2-CHZSAWCB.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=We("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),lt=({summary:a,onClose:l})=>{const i=new Date(a.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl border border-white/50 animate-in slide-in-from-bottom duration-300",children:[e.jsxs("div",{className:"relative bg-royal-50 p-8 pb-10",children:[e.jsx("div",{className:"absolute top-6 right-6",children:e.jsx("button",{onClick:l,className:"p-2 bg-white text-gray-900 rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:e.jsx(ue,{size:20})})}),e.jsxs("div",{className:"flex items-center gap-2 text-royal-600 mb-3",children:[e.jsx(J,{size:20}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Daily Report"})]}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 leading-tight",children:i})]}),e.jsxs("div",{className:"p-8 -mt-6 bg-white rounded-t-[32px] relative shadow-[-10px_-10px_30px_rgba(0,0,0,0.02)]",children:[e.jsxs("div",{className:"bg-white rounded-[32px] p-6 border border-gray-100 shadow-[0_10px_30px_-10px_rgba(0,0,0,0.05)] mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 block",children:"Total Consumed"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-5xl font-extrabold text-gray-900 tracking-tighter",children:a.totalCalories}),e.jsx("span",{className:"text-gray-400 font-bold text-lg",children:"kcal"})]})]}),e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-royal-50 flex items-center justify-center text-royal-600",children:e.jsx(et,{size:28})})]}),e.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(Ve,{size:16})," Macro Breakdown"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-emerald-50 hover:border-emerald-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-emerald-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalProtein,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Protein"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-blue-50 hover:border-blue-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-blue-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalCarbs,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Carbs"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-orange-50 hover:border-orange-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-orange-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalFat,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Fat"})]})]})})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 flex justify-between items-center text-xs font-bold text-gray-400 uppercase tracking-wider",children:[e.jsxs("span",{children:[a.entries.length," meals tracked"]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-royal-600",children:[e.jsx(be,{size:14}),"See History Tab"]})]})]})]})})},it=({onClose:a,onConfirm:l})=>{const[i,u]=m.useState(0),[g,d]=m.useState(""),[r,c]=m.useState(!1),[x,f]=m.useState(!0),[R,T]=m.useState(!1),[_,A]=m.useState(null);m.useEffect(()=>{(async()=>{const F=await ge();F&&(A(F),u(F.weight),d(F.weight.toString())),f(!1)})()},[]);const z=async()=>{const w=parseFloat(g)||i;if(r&&_&&w!==i){T(!0);try{await Ue({..._,weight:w}),u(w)}catch(F){console.error("Failed to save weight:",F)}T(!1)}l(w)};return x?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-8 w-[90%] max-w-sm shadow-2xl",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-royal-200 dark:border-royal-800 border-t-royal-600 rounded-full animate-spin"})})})}):e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-end sm:items-center justify-center animate-in fade-in duration-300",onClick:a,children:e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-t-[28px] sm:rounded-[28px] p-6 w-full sm:w-[90%] sm:max-w-sm shadow-2xl animate-in slide-in-from-bottom duration-500",onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-royal-100 dark:bg-royal-900/30 flex items-center justify-center",children:e.jsx(tt,{size:20,className:"text-royal-600 dark:text-royal-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-black text-gray-900 dark:text-gray-50",children:"Weight Check"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-medium",children:"Before viewing your report"})]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-xl bg-gray-100 dark:bg-white/5 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:e.jsx(ue,{size:16,className:"text-gray-400"})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-5 mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4 text-center",children:"Is your current weight still accurate?"}),r?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:g,onChange:w=>d(w.target.value),className:"w-28 text-center text-3xl font-black text-gray-900 dark:text-gray-50 bg-white dark:bg-[#0F111A] border-2 border-royal-200 dark:border-royal-800 rounded-xl py-2 focus:outline-none focus:border-royal-500",step:"0.1",min:"20",max:"300",autoFocus:!0}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm font-bold text-gray-400",children:"kg"})]}),e.jsx("button",{onClick:()=>{c(!1),d(i.toString())},className:"text-xs text-gray-400 font-medium hover:text-gray-600",children:"Cancel"})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-black text-gray-900 dark:text-gray-50 mb-1",children:[i,e.jsx("span",{className:"text-lg font-bold text-gray-400 ml-1",children:"kg"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"text-xs text-royal-600 dark:text-royal-400 font-bold flex items-center gap-1 mx-auto hover:underline",children:[e.jsx(me,{size:12}),"Update weight"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 py-3.5 rounded-xl bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 font-bold text-sm hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:z,disabled:R,className:"flex-1 py-3.5 rounded-xl bg-royal-600 text-white font-bold text-sm hover:bg-royal-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:R?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(at,{size:16}),"Confirm"]})})]})]})})},dt=({report:a,reportType:l,onClose:i,onRegenerate:u,isRegenerating:g=!1})=>{const d=()=>{const c=new Date(a.periodStart),x=new Date(a.periodEnd);if(l==="daily")return c.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});if(l==="weekly"){const f=c.toLocaleDateString("en-US",{month:"short",day:"numeric"}),R=x.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${f} - ${R}`}return c.toLocaleDateString("en-US",{month:"long",year:"numeric"})},r=()=>{switch(l){case"daily":return"Daily Review";case"weekly":return"Weekly Summary";case"monthly":return"Monthly Report"}};return e.jsx("div",{className:"fixed inset-0 bg-[#F8F9FE] dark:bg-[#0F111A] z-[100] animate-in slide-in-from-right duration-300 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen pb-20",children:[e.jsx("div",{className:"sticky top-0 bg-[#F8F9FE]/80 dark:bg-[#0F111A]/80 backdrop-blur-xl z-10 px-6 pt-10 pb-4 border-b border-gray-100 dark:border-white/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 hover:text-royal-600 transition-colors",children:[e.jsx(ye,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back"})]}),e.jsxs("button",{onClick:u,disabled:g,className:"flex items-center gap-2 text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl hover:bg-royal-100 dark:hover:bg-royal-900/30 transition-colors disabled:opacity-50",children:[e.jsx(me,{size:12,className:g?"animate-spin":""}),g?"Generating...":"Regenerate"]})]})}),e.jsxs("div",{className:"px-6 pt-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(he,{size:20,className:"text-royal-600 dark:text-royal-400"}),e.jsx("span",{className:"text-[10px] font-bold text-royal-600 dark:text-royal-400 uppercase tracking-widest",children:"Coach Tips"})]}),e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight mb-1",children:r()}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500",children:[e.jsx(J,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:d()})]})]}),e.jsx("div",{className:"bg-gradient-to-br from-royal-500 to-royal-700 rounded-[24px] p-6 mb-6 shadow-lg shadow-royal-200/30 dark:shadow-royal-900/40",children:e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0",children:e.jsx(be,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white/80 mb-1",children:"Summary"}),e.jsx("p",{className:"text-white text-sm leading-relaxed",children:a.summary})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Period Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-orange-100 dark:bg-orange-500/10 flex items-center justify-center",children:e.jsx(Ke,{size:12,className:"text-orange-600 dark:text-orange-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Calories"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.avgCalories,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"kcal"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-emerald-100 dark:bg-emerald-500/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-black text-emerald-600 dark:text-emerald-400",children:"P"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Protein"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.avgProtein,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"g"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-purple-100 dark:bg-purple-500/10 flex items-center justify-center",children:e.jsx(Ge,{size:12,className:"text-purple-600 dark:text-purple-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Workouts"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.workoutsCompleted,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"done"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-blue-100 dark:bg-blue-500/10 flex items-center justify-center",children:e.jsx(rt,{size:12,className:"text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Rate"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.calorieGoalHitRate,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"%"})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Improvement Tips"}),e.jsx("div",{className:"space-y-3",children:a.tips.map((c,x)=>e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5 flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-50 dark:bg-white/5 flex items-center justify-center flex-shrink-0 text-xl",children:c.emoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 mb-0.5",children:c.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed",children:c.description})]})]},x))})]}),a.weightAtReport&&e.jsxs("div",{className:"text-center text-xs text-gray-400 dark:text-gray-500",children:["Weight at report: ",e.jsxs("span",{className:"font-bold",children:[a.weightAtReport," kg"]})]})]})]})})},ct=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",xt=()=>new st({apiKey:ct()}),fe="snapcal_coach_reports_v1",mt=`You are **Cal Coach**, providing personalized health and fitness reviews.

**Your Role:**
Generate concise, motivating, and actionable reports based on the user's tracking data.

**Report Guidelines:**
1. **Summary**: 2-3 sentences highlighting key achievements and areas for improvement
2. **Tips**: Exactly 3 specific, actionable tips 
3. **Tone**: Encouraging but honest. Celebrate wins, gently address gaps

**Tip Format:**
Each tip should have:
- emoji: A relevant emoji (ðŸ¥—, ðŸ’ª, ðŸŽ¯, âš¡, ðŸ’§, ðŸ”¥, etc.)
- title: Short action phrase (3-5 words)
- description: One sentence explaining the tip

**Never:**
- Be negative or discouraging
- Give generic advice that doesn't relate to the user's data
- Use medical disclaimers or suggest consulting doctors
- Repeat the same tip twice`,gt=async(a,l)=>{if(!Z){const d=localStorage.getItem("snapcal_workouts");return d?JSON.parse(d).filter(c=>c.date>=a&&c.date<=l):[]}const i=await V();if(!i)return[];const{data:u,error:g}=await q.from("workout_plans").select("*").eq("user_id",i.id).gte("date",a).lte("date",l);return g?(console.error("Failed to fetch workout plans:",g),[]):u.map(d=>({id:d.id,date:d.date,title:d.title,exercises:d.exercises||[]}))},ht=async(a,l,i)=>{const[u,g,d,r]=await Promise.all([ge(),pe(),Oe(l,i),gt(l,i)]),c=d.length,x=d.reduce((y,k)=>y+(k.totalCalories>0?1:0),0),f=c>0?Math.round(d.reduce((y,k)=>y+k.totalCalories,0)/c):0,R=c>0?Math.round(d.reduce((y,k)=>y+k.totalProtein,0)/c):0,T=c>0?Math.round(d.reduce((y,k)=>y+k.totalCarbs,0)/c):0,_=c>0?Math.round(d.reduce((y,k)=>y+k.totalFat,0)/c):0,A=d.filter(y=>Math.abs(y.totalCalories-g)<=g*.1).length,z=c>0?Math.round(A/c*100):0,w=r.filter(y=>y.exercises.some(k=>k.completed)).length,F={avgCalories:f,avgProtein:R,avgCarbs:T,avgFat:_,totalMeals:x,workoutsCompleted:w,daysTracked:c,calorieGoalHitRate:z},I=d.map(y=>({date:y.date,calories:y.totalCalories,protein:y.totalProtein,carbs:y.totalCarbs,fat:y.totalFat,meals:y.totalCalories>0?1:0}));return{profile:u,dailyGoal:g,periodStart:l,periodEnd:i,reportType:a,metrics:F,dailyBreakdown:I,workoutsCompleted:w}},pt=a=>{const{profile:l,dailyGoal:i,periodStart:u,periodEnd:g,reportType:d,metrics:r,dailyBreakdown:c}=a;let x=`**${d.charAt(0).toUpperCase()+d.slice(1)} Health Review**
`;return x+=`Period: ${u} to ${g}

`,l&&(x+=`**User Profile:**
`,l.name&&(x+=`- Name: ${l.name}
`),l.weight&&(x+=`- Weight: ${l.weight} kg
`),l.height&&(x+=`- Height: ${l.height} cm
`),l.goal&&(x+=`- Goal: ${{cut:"Lose weight",bulk:"Build muscle",maintain:"Maintain weight"}[l.goal]}
`),x+=`- Daily Calorie Goal: ${i} kcal

`),x+=`**Period Statistics:**
`,x+=`- Days tracked: ${r.daysTracked}
`,x+=`- Average daily calories: ${r.avgCalories} kcal (Goal: ${i})
`,x+=`- Average protein: ${r.avgProtein}g
`,x+=`- Average carbs: ${r.avgCarbs}g
`,x+=`- Average fat: ${r.avgFat}g
`,x+=`- Calorie goal hit rate: ${r.calorieGoalHitRate}%
`,x+=`- Workouts completed: ${r.workoutsCompleted}

`,c.length>0&&c.length<=7&&(x+=`**Daily Breakdown:**
`,c.forEach(f=>{x+=`- ${f.date}: ${f.calories} kcal, P: ${f.protein}g, C: ${f.carbs}g, F: ${f.fat}g
`})),x+=`
---

Provide a summary and 3 actionable tips based on this data.`,x},ut=async a=>{const l=xt(),i=pt(a),u=await l.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:i}]}],config:{systemInstruction:mt,responseMimeType:"application/json",responseSchema:{type:$.OBJECT,properties:{summary:{type:$.STRING},tips:{type:$.ARRAY,items:{type:$.OBJECT,properties:{emoji:{type:$.STRING},title:{type:$.STRING},description:{type:$.STRING}},required:["emoji","title","description"]}}},required:["summary","tips"]}}});return Xe(Qe,u.text||"{}","Coach Report")},we=()=>{try{const a=localStorage.getItem(fe);return a?JSON.parse(a):[]}catch{return[]}},bt=a=>{localStorage.setItem(fe,JSON.stringify(a))},ke=async(a,l,i)=>{if(!Z)return we().find(c=>c.reportType===a&&c.periodStart===l&&c.periodEnd===i)||null;const u=await V();if(!u)return null;const{data:g,error:d}=await q.from("coach_reports").select("*").eq("user_id",u.id).eq("report_type",a).eq("period_start",l).eq("period_end",i).single();return d||!g?null:{id:g.id,userId:g.user_id,reportType:g.report_type,periodStart:g.period_start,periodEnd:g.period_end,summary:g.summary,tips:g.tips,metrics:g.metrics,weightAtReport:g.weight_at_report,createdAt:g.created_at}},yt=async a=>{if(!Z){const g=we().filter(d=>!(d.reportType===a.reportType&&d.periodStart===a.periodStart&&d.periodEnd===a.periodEnd));g.push(a),bt(g);return}const l=await V();if(!l)throw new Error("User not authenticated");await q.from("coach_reports").delete().eq("user_id",l.id).eq("report_type",a.reportType).eq("period_start",a.periodStart).eq("period_end",a.periodEnd);const{error:i}=await q.from("coach_reports").insert({id:a.id,user_id:l.id,report_type:a.reportType,period_start:a.periodStart,period_end:a.periodEnd,summary:a.summary,tips:a.tips,metrics:a.metrics,weight_at_report:a.weightAtReport});if(i)throw console.error("Failed to save report:",i),new Error("Failed to save report")},ft=async(a,l,i,u)=>{var x;const g=await V();if(!g)throw new Error("User not authenticated");const d=await ht(a,l,i),r=await ut(d),c={id:`${a}_${l}_${Date.now()}`,userId:g.id,reportType:a,periodStart:l,periodEnd:i,summary:r.summary,tips:r.tips.slice(0,3),metrics:d.metrics,weightAtReport:u||((x=d.profile)==null?void 0:x.weight),createdAt:new Date().toISOString()};return await yt(c),c},ce=async(a,l,i,u=!1,g)=>{if(!u){const d=await ke(a,l,i);if(d)return d}return ft(a,l,i,g)},xe=(a,l)=>{if(a==="daily")return{start:l,end:l};if(a==="weekly"){const c=new Date(l),x=new Date(c);x.setDate(c.getDate()+6);const f=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}`;return{start:l,end:f}}const[i,u]=l.split("-").map(Number),g=new Date(i,u,0),d=`${i}-${String(u).padStart(2,"0")}-01`,r=`${i}-${String(u).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}`;return{start:d,end:r}},zt=()=>{const[a,l]=m.useState([]),[i,u]=m.useState(2e3),[g,d]=m.useState(!0),[r,c]=m.useState("day"),[x,f]=m.useState(null),[R,T]=m.useState(null),[_,A]=m.useState(!1),[z,w]=m.useState(null),[F,I]=m.useState(!1),[y,k]=m.useState(!1),[M,G]=m.useState(null),[je,O]=m.useState(!1),[Ne,ee]=m.useState(!1),[N,ve]=m.useState(He()),[S,Se]=m.useState(new Date().toISOString().substring(0,7)),[v,Ce]=m.useState(()=>{const t=new Date,s=t.getDay(),o=s===0?-6:1-s,n=new Date(t);n.setDate(t.getDate()+o);const h=n.getFullYear(),p=String(n.getMonth()+1).padStart(2,"0"),b=String(n.getDate()).padStart(2,"0");return`${h}-${p}-${b}`}),[De,te]=m.useState(!1),[Fe,Re]=m.useState({}),[E,H]=m.useState({}),[Ee,ae]=m.useState({}),[Y,W]=m.useState({}),K=m.useRef(null);document.documentElement.classList.contains("dark");const re=m.useCallback(()=>{if(K.current){const t=K.current;t.scrollLeft=t.scrollWidth}},[]);m.useEffect(()=>{const t=setTimeout(re,100);return()=>clearTimeout(t)},[r,re]);const B=async()=>{d(!0);try{const[t,s]=await Promise.all([qe(),pe()]);l(t),u(s),U(N)}catch(t){console.error("Failed to load history data",t)}finally{d(!1)}},U=m.useCallback(async t=>{if(!E[t]){ae(s=>({...s,[t]:!0}));try{const s=await Ye(t);H(o=>({...o,[t]:s}))}catch(s){console.error(`Failed to load entries for ${t}`,s)}finally{ae(s=>({...s,[t]:!1}))}}},[E]),Ae=m.useCallback(async t=>{if(Y[t]===void 0){W(s=>({...s,[t]:null}));try{const s=await Be(t);W(o=>({...o,[t]:s}))}catch(s){console.error(`Failed to load image for entry ${t}`,s)}}},[Y]);m.useEffect(()=>{B();const t=()=>{H({}),W({}),B()};return window.addEventListener("food-entry-updated",t),()=>window.removeEventListener("food-entry-updated",t)},[]),m.useEffect(()=>{N&&(r==="day"||r==="week")&&U(N)},[N,U,r]);const se=async t=>{await Je(t),H({}),W({}),await B()},oe=t=>{f(null),w(t),A(!0)},Me=async()=>{O(!0);try{const t=r==="day"?"daily":r==="week"?"weekly":"monthly",s=r==="day"?N:r==="week"?v:S,{start:o,end:n}=xe(t,s),h=await ke(t,o,n);h?(G(h),k(!0)):I(!0)}catch(t){console.error("Failed to check for report:",t),I(!0)}finally{O(!1)}},$e=async t=>{I(!1),O(!0);try{const s=r==="day"?"daily":r==="week"?"weekly":"monthly",o=r==="day"?N:r==="week"?v:S,{start:n,end:h}=xe(s,o),p=await ce(s,n,h,!1,t);G(p),k(!0)}catch(s){console.error("Failed to generate report:",s),alert("Failed to generate AI report. Please try again.")}finally{O(!1)}},Te=async()=>{if(M){ee(!0);try{const t=await ce(M.reportType,M.periodStart,M.periodEnd,!0);G(t)}catch(t){console.error("Failed to regenerate report:",t),alert("Failed to regenerate report. Please try again.")}finally{ee(!1)}}},ne=t=>(Y[t.id]===void 0&&Ae(t.id),{...t,imageUrl:Y[t.id]||void 0}),_e=m.useMemo(()=>{if(r==="day"){const t=[],s=new Date,o=new Date(s);o.setDate(s.getDate()-30);for(let n=new Date(o);n<=s;n.setDate(n.getDate()+1)){const h=n.getFullYear(),p=String(n.getMonth()+1).padStart(2,"0"),b=String(n.getDate()).padStart(2,"0"),j=`${h}-${p}-${b}`;t.push({id:j,name:n.toLocaleDateString("en-US",{weekday:"short"}),label:n.getDate().toString(),date:j})}return t}else if(r==="week"){const t=[],s=new Date,o=s.getDay(),n=o===0?-6:1-o,h=new Date(s);h.setDate(s.getDate()+n);for(let p=0;p<8;p++){const b=new Date(h);b.setDate(h.getDate()-p*7);const j=new Date(b);j.setDate(b.getDate()+6);const C=b.toLocaleDateString("en-US",{month:"short",day:"numeric"}),D=j.toLocaleDateString("en-US",{day:"numeric"}),P=b.getFullYear(),Pe=String(b.getMonth()+1).padStart(2,"0"),ze=String(b.getDate()).padStart(2,"0"),ie=`${P}-${Pe}-${ze}`;t.push({id:ie,name:"Week",label:`${C} - ${D}`,date:ie})}return t.reverse()}else{const t=new Set;return a.forEach(o=>{const n=o.date.substring(0,7);t.add(n)}),Array.from(t).sort().map(o=>{const[n,h]=o.split("-"),p=new Date(parseInt(n),parseInt(h)-1,1);return{id:o,name:p.toLocaleDateString("en-US",{year:"2-digit"}),label:p.toLocaleDateString("en-US",{month:"short"}),date:o}})}},[r,a]),L=m.useMemo(()=>{if(r==="day")return a.find(t=>t.date===N)||{date:N,totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};if(r==="week"){if(!v)return{date:"",totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};const t=new Date(v),s=new Date(t);s.setDate(t.getDate()+6);const o=v,n=s.getFullYear(),h=String(s.getMonth()+1).padStart(2,"0"),p=String(s.getDate()).padStart(2,"0"),b=`${n}-${h}-${p}`,C=a.filter(D=>D.date>=o&&D.date<=b).reduce((D,P)=>({totalCalories:D.totalCalories+P.totalCalories,totalProtein:D.totalProtein+P.totalProtein,totalCarbs:D.totalCarbs+P.totalCarbs,totalFat:D.totalFat+P.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:v,...C}}else{const s=a.filter(o=>o.date.startsWith(S)).reduce((o,n)=>({totalCalories:o.totalCalories+n.totalCalories,totalProtein:o.totalProtein+n.totalProtein,totalCarbs:o.totalCarbs+n.totalCarbs,totalFat:o.totalFat+n.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:S,...s}}},[a,N,S,v,r]),Ie=m.useMemo(()=>{if(r==="day")return[];const t=o=>{if(r==="month")return o.startsWith(S);if(r==="week"&&v)try{const[n,h,p]=v.split("-").map(Number),b=new Date(n,h-1,p),j=new Date(b);j.setDate(b.getDate()+6);const C=new Date(o);return C>=b&&C<=j}catch{return!1}return!1};return Object.entries(E).filter(([o])=>t(o)).flatMap(([o,n])=>n).sort((o,n)=>n.timestamp.localeCompare(o.timestamp))},[E,S,v,r]),le=m.useMemo(()=>{if(r==="day")return{};const t=o=>{if(r==="month")return o.startsWith(S);if(r==="week"&&v)try{const[n,h,p]=v.split("-").map(Number),b=new Date(n,h-1,p),j=new Date(b);j.setDate(b.getDate()+6);const C=new Date(o);return C>=b&&C<=j}catch{return!1}return!1},s={};return Object.entries(E).filter(([o])=>t(o)).forEach(([o,n])=>{n.length>0&&(s[o]=n.sort((h,p)=>p.timestamp.localeCompare(h.timestamp)))}),s},[E,S,v,r]),Le=t=>{Re(s=>({...s,[t]:!s[t]}))};return m.useEffect(()=>{r==="month"&&a.filter(s=>s.date.startsWith(S)).map(s=>s.date).forEach(s=>U(s))},[r,S,a,U]),De?e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in slide-in-from-right duration-500 bg-[#F8F9FE] dark:bg-[#0F111A]",children:[e.jsxs("div",{className:"px-6 pt-10 pb-32 overflow-y-auto no-scrollbar",children:[e.jsxs("button",{onClick:()=>te(!1),className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 mb-6 hover:text-royal-600 transition-colors",children:[e.jsx(ye,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back to Report"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"History Log"}),e.jsx("div",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl border border-royal-100 dark:border-royal-800/50",children:r==="week"?new Date(N).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):new Date(S+"-01").toLocaleDateString(void 0,{month:"long",year:"numeric"})})]}),e.jsx("div",{className:"space-y-4",children:r==="day"?Ee[N]?e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(t=>e.jsx("div",{className:"h-20 bg-white dark:bg-[#1A1C26] rounded-[24px] animate-pulse border border-gray-100 dark:border-white/5"},t))}):(E[N]||[]).length>0?(E[N]||[]).map(t=>{const s=ne(t);return e.jsxs("div",{onClick:()=>f(s),className:"bg-white dark:bg-[#1A1C26] p-4 flex justify-between items-center rounded-[24px] shadow-sm border border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer active:scale-[0.98]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold",children:t.food_item}),e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:t.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:t.calories}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},t.id)}):e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[e.jsx(J,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:"No meals logged for this day."})]}):Object.keys(le).length>0?Object.entries(le).sort(([t],[s])=>s.localeCompare(t)).map(([t,s])=>{const o=Fe[t],n=s.reduce((h,p)=>h+p.calories,0);return e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] border border-gray-100 dark:border-white/5 overflow-hidden",children:[e.jsxs("button",{onClick:()=>Le(t),className:"w-full p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`transition-transform duration-200 ${o?"rotate-90":""}`,children:e.jsx(Q,{size:16,className:"text-gray-400"})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:new Date(t).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),e.jsxs("span",{className:"text-[9px] font-medium text-gray-400",children:[s.length," meal",s.length!==1?"s":""]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:n}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]}),o&&e.jsx("div",{className:"border-t border-gray-100 dark:border-white/5",children:s.map(h=>{const p=ne(h);return e.jsxs("div",{onClick:()=>f(p),className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer border-b border-gray-50 dark:border-white/5 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:p.imageUrl?e.jsx("img",{src:p.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold leading-tight",children:h.food_item}),e.jsx("span",{className:"text-[9px] text-gray-400 dark:text-gray-500",children:h.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:h.calories}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},h.id)})})]},t)}):e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[e.jsx(J,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),e.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:["No data for this ",r==="month"?"month":"week","."]})]})})]}),x&&e.jsx(de,{entry:x,onClose:()=>f(null),onDelete:se,onEdit:oe})]}):e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-y-auto no-scrollbar relative bg-[#F8F9FE] dark:bg-[#0F111A]",children:[e.jsxs("div",{className:"px-6 pt-10 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"Report"}),e.jsxs("div",{className:"flex p-1 bg-white dark:bg-[#1A1C26] rounded-xl border border-gray-100 dark:border-white/5 shadow-sm",children:[e.jsx("button",{onClick:()=>c("day"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="day"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Daily"}),e.jsx("button",{onClick:()=>c("week"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="week"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Weekly"}),e.jsx("button",{onClick:()=>c("month"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="month"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Monthly"})]})]}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{ref:K,className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1 snap-x",style:{WebkitOverflowScrolling:"touch"},children:_e.map(t=>{const s=r==="day"?t.id===N:r==="week"?t.id===v:t.id===S,o=a.some(n=>{if(r==="day")return n.date===t.id;if(r==="week"){const[h,p,b]=t.id.split("-").map(Number),j=new Date(h,p-1,b),C=new Date(j);C.setDate(j.getDate()+6);const D=new Date(n.date);return D>=j&&D<=C}return n.date.startsWith(t.id)});return e.jsxs("button",{onClick:()=>{r==="day"?ve(t.id):r==="week"?Ce(t.id):Se(t.id)},className:`flex-shrink-0 flex flex-col items-center justify-center ${r==="week"?"w-24":"w-12"} py-3 rounded-2xl transition-all duration-300 snap-center ${s?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 transform scale-110":"bg-white dark:bg-[#1A1C26] text-gray-400 dark:text-gray-500 border border-gray-100 dark:border-white/5"}`,children:[e.jsx("span",{className:`text-[9px] font-bold uppercase mb-1 ${s?"text-white/70":"text-gray-400"}`,children:t.name}),e.jsx("span",{className:"text-sm font-extrabold",children:t.label}),o&&!s&&e.jsx("div",{className:"w-1 h-1 rounded-full bg-royal-400 mt-1"})]},t.id)})}),e.jsx("div",{className:"absolute top-0 left-0 bottom-2 w-8 bg-gradient-to-r from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 right-0 bottom-2 w-8 bg-gradient-to-l from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-6 shadow-sm border border-gray-100 dark:border-white/5 flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-1",children:r==="day"?"Daily Total":r==="week"?"Weekly Total":"Monthly Total"}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("span",{className:"text-5xl font-black text-gray-900 dark:text-gray-50 tracking-tighter",children:Math.round(L.totalCalories)}),e.jsx("span",{className:"text-[10px] font-black text-royal-600 dark:text-royal-400 uppercase tracking-widest mt-0.5",children:"KCAL"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2.5 w-full",children:[e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-emerald-50/30 dark:bg-emerald-500/5 rounded-2xl border border-emerald-100/50 dark:border-emerald-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-emerald-600/60 dark:text-emerald-400/60 uppercase mb-0.5",children:"Protein"}),e.jsxs("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:[Math.round(L.totalProtein),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-amber-50/30 dark:bg-amber-500/5 rounded-2xl border border-amber-100/50 dark:border-amber-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-amber-600/60 dark:text-amber-400/60 uppercase mb-0.5",children:"Carbs"}),e.jsxs("span",{className:"text-sm font-black text-amber-600 dark:text-amber-400",children:[Math.round(L.totalCarbs),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-rose-50/30 dark:bg-rose-500/5 rounded-2xl border border-rose-100/50 dark:border-rose-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-rose-600/60 dark:text-rose-400/60 uppercase mb-0.5",children:"Fat"}),e.jsxs("span",{className:"text-sm font-black text-rose-600 dark:text-rose-400",children:[Math.round(L.totalFat),"g"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs(X,{onClick:Me,className:"p-5 flex flex-col justify-between h-36 bg-gradient-to-br from-royal-500 to-royal-700 text-white border-none shadow-royal-200/50 cursor-pointer active:scale-[0.98] transition-transform",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(he,{size:12,className:"text-white/70"}),e.jsx("p",{className:"text-[10px] font-bold text-white/70 uppercase",children:r==="day"?"Coach Tips":"Report"})]}),e.jsx("h3",{className:"text-lg font-black leading-tight",children:r==="day"?"Daily Review":r==="week"?"Weekly Summary":e.jsxs(e.Fragment,{children:["Your Health",e.jsx("br",{}),"Summary"]})})]}),e.jsx("div",{className:"mt-2 py-2 bg-white/20 rounded-xl text-[10px] font-bold backdrop-blur-sm flex items-center justify-center gap-2",children:je?e.jsx(ot,{size:12,className:"animate-spin"}):e.jsxs(e.Fragment,{children:["VIEW INSIGHTS",e.jsx(Q,{size:12})]})})]}),e.jsxs("div",{className:"grid grid-rows-2 gap-4 h-36",children:[e.jsxs(X,{onClick:()=>te(!0),className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5 active:scale-95 transition-transform cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"History Log"}),e.jsx(Q,{size:10,className:"text-gray-300"})]}),e.jsxs("p",{className:"text-xs font-black text-gray-900 dark:text-gray-50",children:[r==="day"?(E[N]||[]).length:Ie.length," Meals"]})]}),e.jsxs(X,{className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Status"}),e.jsx(nt,{size:10,className:"text-gray-300"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1 bg-gray-100 dark:bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-royal-500 rounded-full",style:{width:`${Math.min(L.totalCalories/(r==="day"?i:r==="week"?i*7:i*30)*100,100)}%`}})}),e.jsxs("span",{className:"text-[10px] font-black text-gray-900 dark:text-gray-50",children:[Math.round(L.totalCalories/(r==="day"?i:r==="week"?i*7:i*30)*100),"%"]})]})]})]})]}),e.jsx("div",{className:"h-24"})]}),x&&e.jsx(de,{entry:x,onClose:()=>f(null),onDelete:se,onEdit:oe}),R&&e.jsx(lt,{summary:R,onClose:()=>T(null)}),_&&e.jsx(Ze,{editEntry:z,onClose:()=>{A(!1),w(null)},onSuccess:()=>{A(!1),w(null),H({}),W({}),B()},onOpenSharedMeal:()=>{A(!1)}}),F&&e.jsx(it,{onClose:()=>I(!1),onConfirm:$e}),y&&M&&e.jsx(dt,{report:M,reportType:M.reportType,onClose:()=>{k(!1),G(null)},onRegenerate:Te,isRegenerating:Ne})]})};export{zt as History};
