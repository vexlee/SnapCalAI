import{c as W,d as X,b as Q,h as ee,j as e,i as te,k as T,S as ae,l as se,g as re,m as oe,n as ne,o as S,p as ie}from"./index-C-GE5puo.js";import{r as u}from"./vendor-react-wGySg1uH.js";import{C as $}from"./Card-CeIScbxl.js";import{G as le}from"./index-cQ6qJtkF.js";import{X as ce}from"./x-BzuwmaGU.js";import{S as G}from"./save-DiB98Neu.js";import{L as A}from"./loader-2-CyjC-jWP.js";import"./vendor-charts-Bdt_fL2G.js";import"./vendor-supabase-DfwcnzK-.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=W("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=W("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ge=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",ue=()=>{const t=ge();return new le({apiKey:t})},me=`You are **Cal Coach**, an AI fitness and nutrition coach. Your mission is to provide simple, actionable advice to help users reach their goals.

**Core Principles:**
1. **Keep it Simple:** Use short, clear sentences. No jargon or complicated explanations.
2. **Focus on What Matters:** Only highlight the most important insights and actions.
3. **Be Encouraging:** Always stay positive and supportive, even when pointing out areas for improvement.
4. **Card-Friendly Format:** Structure responses to be visually scannable with emojis, bullet points, and short sections.

**Response Guidelines:**

When analyzing nutrition:
- Start with a simple status emoji (âœ… Good / âš ï¸ Needs Work / ðŸ”¥ Excellent)
- Show only the most critical metrics (Calories, Protein)
- Use 2-3 bullet points max for observation
- Give 2-3 actionable next steps
- Keep total response under 150 words

When providing plans (workout/meal):
- Use simple bullet format, not complex tables
- Show only key exercises or meals (3-5 items max)
- Include specific numbers (reps, grams, servings)
- Add emoji indicators for visual appeal

When answering questions:
- Answer directly in 2-3 sentences
- Add one practical example if needed
- No lengthy explanations

**Formatting Style:**
âœ… **Status**
Brief one-line summary

**Key Points:**
â€¢ Point 1 with number
â€¢ Point 2 with number
â€¢ Point 3 with number

**Action Steps:**
1. Simple action
2. Simple action

**Never:**
- Use complex tables with multiple columns
- Write long paragraphs
- Include technical disclaimers (assume user knows to consult doctors)
- Use phases like "Phase 1", "Phase 2"
- Repeat the user's data back to them

**Context Provided:**
You will receive user profile data and recent food tracking history in each message. Use this to provide personalized analysis and recommendations.`,R=async()=>{try{const t={},a=await X();a&&(t.userName=a.name,t.height=a.height,t.weight=a.weight,t.age=a.age,t.gender=a.gender,t.activityLevel=a.activityLevel,t.goal=a.goal,t.equipmentAccess=a.equipmentAccess);const o=await Q();t.dailyGoal=o;const l=await ee(),c=new Date().toISOString().split("T")[0],n=l.filter(r=>r.date===c);t.todayCalories=n.reduce((r,d)=>r+d.calories,0),t.todayProtein=n.reduce((r,d)=>r+d.protein,0),t.todayCarbs=n.reduce((r,d)=>r+d.carbs,0),t.todayFat=n.reduce((r,d)=>r+d.fat,0);const i=new Map;return l.forEach(r=>{i.has(r.date)||i.set(r.date,[]),i.get(r.date).push(r)}),t.recentEntries=Array.from(i.entries()).slice(0,30).map(([r,d])=>({date:r,totalCalories:d.reduce((m,h)=>m+h.calories,0),totalProtein:d.reduce((m,h)=>m+h.protein,0),totalCarbs:d.reduce((m,h)=>m+h.carbs,0),totalFat:d.reduce((m,h)=>m+h.fat,0),entryCount:d.length})),t}catch(t){return console.error("Failed to build coach context:",t),{}}},he=t=>{let a=`**User Profile & Current Data:**

`;return t.userName&&(a+=`- Name: ${t.userName}
`),t.height&&(a+=`- Height: ${t.height} cm
`),t.weight&&(a+=`- Weight: ${t.weight} kg
`),t.age&&(a+=`- Age: ${t.age} years
`),t.gender&&(a+=`- Gender: ${t.gender.charAt(0).toUpperCase()+t.gender.slice(1)}
`),t.activityLevel&&(a+=`- Activity Level: ${{sedentary:"Sedentary",light:"Lightly Active",moderate:"Moderately Active",very:"Very Active",extra:"Extra Active"}[t.activityLevel]}
`),t.goal&&(a+=`- Goal: ${{cut:"Cut (Lose Fat)",bulk:"Bulk (Gain Muscle)",maintain:"Maintain"}[t.goal]}
`),t.equipmentAccess&&(a+=`- Equipment: ${{gym:"Gym Access",home:"Home Equipment",bodyweight:"Bodyweight Only"}[t.equipmentAccess]}
`),t.dailyGoal&&(a+=`- Daily Calorie Goal: ${t.dailyGoal} kcal
`),a+=`
**Today's Nutrition (${new Date().toLocaleDateString()}):**
`,a+=`- Calories: ${t.todayCalories||0} kcal
`,a+=`- Protein: ${t.todayProtein||0}g
`,a+=`- Carbs: ${t.todayCarbs||0}g
`,a+=`- Fat: ${t.todayFat||0}g
`,t.recentEntries&&t.recentEntries.length>0&&(a+=`
**Last 30 Days Summary:**
`,t.recentEntries.forEach(o=>{a+=`
${o.date}:
`,a+=`  - ${o.totalCalories} kcal | Protein: ${o.totalProtein}g | Carbs: ${o.totalCarbs}g | Fat: ${o.totalFat}g | Meals: ${o.entryCount}
`})),a+=`
---

`,a},I=async(t,a)=>{try{const o=ue(),l=await R(),c=a.slice(-4).map(r=>`${r.role==="user"?"User":"Coach"}: ${r.content}`).join(`

`),n=`${he(l)}${c?`**Recent Conversation:**
${c}

`:""}**User's Current Message:**
${t}`;return(await o.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:n}]}],config:{systemInstruction:me,temperature:.7,topP:.95}})).text||"I apologize, but I couldn't generate a response. Please try again."}catch(o){console.error("Coach message error:",o);const l=(o==null?void 0:o.message)||String(o);throw l.includes("429")||l.toLowerCase().includes("quota")?new Error("Rate limit reached. Please wait a moment and try again."):l.toLowerCase().includes("api key")?new Error("Configuration error. Please check your API settings."):new Error("Failed to get coach response. Please try again.")}},ye=t=>{t.toLowerCase();const a=/\b(workout|exercise|training|routine|fitness|gym)\b/i.test(t),o=/day\s+\d+:/i.test(t),l=/\d+\s*(sets?|reps?|x)/i.test(t)||/sets?:\s*\d+/i.test(t)||/\d+\s*x\s*\d+/i.test(t),c=/(push-?up|pull-?up|squat|deadlift|bench\s+press|plank|lunge|curl|press|row)/i.test(t);return a&&(l||o||c)},U=t=>{const a=[];let o="AI Workout Plan";const l=t.match(/(?:^|\n)(?:##?\s*)?([A-Z][\w\s&]+(?:Day|Workout|Training|Routine))/i);l&&(o=l[1].trim());const c=t.split(`
`).map(n=>n.trim());for(let n=0;n<c.length;n++){const i=c[n];if(!i||i.startsWith("#")||i.startsWith("**Action")||i.startsWith("**Key"))continue;let r="",d=3,m="10",h="60s",p=i.replace(/^[â€¢\-\*]\s*/,"").replace(/^\d+\.\s*/,"");const C=p.match(/(\d+)\s*(?:sets?|x)/i)||p.match(/sets?:\s*(\d+)/i);C&&(d=parseInt(C[1]));const j=p.match(/(\d+(?:-\d+)?)\s*reps?/i)||p.match(/reps?:\s*(\d+(?:-\d+)?)/i);if(j)m=j[1];else{const N=p.match(/\dx(\d+(?:-\d+)?)/i);N&&(m=N[1])}const D=p.match(/(\d+(?:s|sec|seconds?|min|minutes?))/i)||p.match(/rest:\s*(\d+(?:s|sec|min)?)/i);D&&(h=D[1].toLowerCase().replace("seconds","s").replace("sec","s").replace("minutes","min").replace("minute","min"));const x=p.match(/^([A-Za-z][\w\s\-'()]+?)(?:\s*[-:|]|\s+\d)/);x?r=x[1].trim():/^[A-Za-z][\w\s\-'()]+$/.test(p)&&p.length<50&&(r=p),r&&!r.match(/^(sets?|reps?|rest|action|next|step)/i)&&a.push({id:`ex-${Date.now()}-${a.length}`,name:r,sets:d,reps:m,rest:h,completed:!1})}return{title:o,exercises:a}},pe=t=>{const a=/Day\s+(\d+):?\s*(.+?)(?=Day\s+\d+:|$)/gis,o=Array.from(t.matchAll(a));if(o.length<2){const{title:c,exercises:n}=U(t);return{isMultiDay:!1,days:[{dayNumber:1,title:c,exercises:n,isRestDay:n.length===0}]}}const l=o.map(c=>{const n=parseInt(c[1]),i=c[2].trim(),r=/^(rest|recovery|off)\s*$/i.test(i)||i.toLowerCase().includes("rest day"),d=i.match(/repeat\s+day\s+(\d+)/i);if(r)return{dayNumber:n,title:"Rest Day",exercises:[],isRestDay:!0};if(d)return{dayNumber:n,title:i,exercises:[],isRestDay:!1,repeatsDayNumber:parseInt(d[1])};const{title:m,exercises:h}=U(i);return{dayNumber:n,title:m==="AI Workout Plan"?i.split(`
`)[0]:m,exercises:h,isRestDay:h.length===0}});return l.forEach(c=>{if(c.repeatsDayNumber){const n=c.repeatsDayNumber,i=l.find(r=>r.dayNumber===n);i&&(c.title=i.title,c.exercises=i.exercises.map(r=>({...r,id:`ex-${Date.now()}-${Math.random()}`}))),delete c.repeatsDayNumber}}),{isMultiDay:!0,days:l}},xe=({isOpen:t,onClose:a,workoutText:o})=>{const[l,c]=u.useState(new Date().toISOString().split("T")[0]),[n,i]=u.useState(!1),[r,d]=u.useState(null);if(u.useEffect(()=>{if(t&&o){const x=pe(o);d(x)}},[t,o]),!t)return null;const m=async()=>{if(r){i(!0);try{await te(l,r.days);const x=r.days.length,N=r.isMultiDay?`${x}-day`:"single-day";alert(`${N} workout plan saved successfully! Go check it out in the Workout Plan page.`),a()}catch(x){console.error("Failed to save workout:",x),alert("Failed to save workout plan")}finally{i(!1)}}},h=()=>{if(!r||!r.isMultiDay)return null;const x=new Date(l),N=new Date(x);return N.setDate(N.getDate()+r.days.length-1),N.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},p=new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),C=h(),j=(r==null?void 0:r.days.length)||0,D=(r==null?void 0:r.isMultiDay)||!1;return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-300 px-6",children:e.jsxs($,{className:"w-full max-w-md animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-white/10",children:[e.jsx("h2",{className:"text-xl font-extrabold text-gray-900 dark:text-gray-50",children:"Save Workout Plan"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 dark:hover:bg-white/5 rounded-full transition-colors",children:e.jsx(ce,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[D&&e.jsxs("div",{className:"p-4 bg-royal-50 dark:bg-royal-950/20 border-2 border-royal-200 dark:border-royal-800/50 rounded-xl",children:[e.jsxs("p",{className:"text-sm font-bold text-royal-900 dark:text-royal-100 mb-1",children:["ðŸ“… ",j,"-Day Workout Plan"]}),e.jsxs("p",{className:"text-xs text-royal-700 dark:text-royal-300",children:["Will be saved from ",e.jsx("strong",{children:p})," to ",e.jsx("strong",{children:C})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:D?"Choose Start Date":"Choose Date"}),e.jsx("input",{type:"date",value:l,onChange:x=>c(x.target.value),className:"w-full px-4 py-3 bg-gray-50 dark:bg-white/5 border-2 border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-gray-50 focus:outline-none focus:border-royal-500 dark:focus:border-royal-400 transition-colors"}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:D?`Select the first day of your ${j}-day plan`:"Select which day you want to use this workout plan"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-100 dark:border-white/10",children:[e.jsx("button",{onClick:a,disabled:n,className:"px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 rounded-xl font-semibold transition-colors disabled:opacity-50",children:"Cancel"}),e.jsxs("button",{onClick:m,disabled:n,className:"flex items-center gap-2 px-6 py-3 bg-royal-600 hover:bg-royal-700 text-white rounded-xl font-semibold transition-colors disabled:opacity-50 shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:[e.jsx(G,{size:18}),e.jsx("span",{children:n?"Saving...":D?`Save ${j}-Day Plan`:"Save Plan"})]})]})]})})},Se=({onNavigate:t})=>{const[a,o]=u.useState([]),[l,c]=u.useState(""),[n,i]=u.useState(!1),[r,d]=u.useState(null),[m,h]=u.useState(!1),[p,C]=u.useState(new Set),[j,D]=u.useState(!1),[x,N]=u.useState(!0),[q,L]=u.useState(!1),[H,K]=u.useState(""),z=u.useRef(null),B=u.useRef(null),P=u.useRef(null),O=s=>!!(s.activityLevel&&s.goal&&s.equipmentAccess);u.useEffect(()=>{(async()=>{const b=await R();if(d(b),!O(b)){h(!0);return}await se();const v=re(),y=await oe();if(y.length>0)o(y),C(new Set([v]));else{const w={id:crypto.randomUUID(),role:"assistant",content:`ðŸ‘‹ ** Hi ${b.userName||"there"} !I'm Cal Coach.**

How can I help you today?`,timestamp:Date.now()};o([w])}})()},[]),u.useEffect(()=>{var s;(s=z.current)==null||s.scrollIntoView({behavior:"smooth"})},[a]);const E=async()=>{var b;if(!l.trim()||n)return;const s={id:crypto.randomUUID(),role:"user",content:l,timestamp:Date.now()};o(v=>[...v,s]),c(""),i(!0),S(s).catch(v=>console.error("Failed to save user message:",v));try{const v=await I(l,a),y={id:crypto.randomUUID(),role:"assistant",content:v,timestamp:Date.now()};o(w=>[...w,y]),S(y).catch(w=>console.error("Failed to save assistant message:",w))}catch(v){const y={id:crypto.randomUUID(),role:"assistant",content:`âš ï¸ ${v.message||"Failed to get response. Please try again."}`,timestamp:Date.now()};o(w=>[...w,y])}finally{i(!1),(b=B.current)==null||b.focus()}},Y=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),E())},V=()=>{t(ne.PROFILE)},Z=async()=>{if(!(j||!x)){D(!0);try{const b=Array.from(p).sort()[0];if(!b){N(!1);return}const v=new Date(b);v.setDate(v.getDate()-1);const y=v.toISOString().split("T")[0],w=new Date().toISOString().split("T")[0];if(Math.floor((new Date(w).getTime()-new Date(y).getTime())/(1e3*60*60*24))>=30){N(!1);return}const k=await ie(y);if(k.length>0){const g=P.current,J=(g==null?void 0:g.scrollHeight)||0;o(M=>[...k,...M]),C(M=>new Set([...M,y])),setTimeout(()=>{if(g){const M=g.scrollHeight;g.scrollTop=M-J}},0)}else C(g=>new Set([...g,y]))}catch(s){console.error("Failed to load previous day messages:",s)}finally{D(!1)}}},_=()=>{const s=P.current;if(!s)return;const b=p.size>0;s.scrollTop<100&&!j&&x&&b&&Z()};return m?e.jsx("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:e.jsx("div",{className:"flex-1 flex items-center justify-center px-6",children:e.jsxs($,{className:"p-8 max-w-md w-full relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 -mt-10 -mr-10 w-32 h-32 bg-royal-100 dark:bg-royal-950/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 -mb-10 -ml-10 w-32 h-32 bg-royal-100 dark:bg-royal-950/20 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-lg mx-auto mb-6",children:e.jsx(F,{size:32})}),e.jsx("h2",{className:"text-2xl font-extrabold text-gray-900 dark:text-gray-50 text-center mb-3",children:"Set Your Training Goals"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-center mb-6 leading-relaxed",children:["To provide you with personalized AI coaching, please complete your"," ",e.jsx("span",{className:"font-bold text-royal-600 dark:text-royal-400",children:"Training Goal Setting"})," ","in your Profile."]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-4 mb-6",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-wider mb-3",children:"We need to know:"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:"â€¢"}),e.jsx("span",{children:"Your activity level (sedentary to extra active)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:"â€¢"}),e.jsx("span",{children:"Your fitness goal (cut, bulk, or maintain)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-royal-600 dark:text-royal-400 mt-0.5",children:"â€¢"}),e.jsx("span",{children:"Your equipment access (gym, home, or bodyweight)"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:V,className:"w-full flex items-center justify-center gap-2 py-4 bg-royal-600 hover:bg-royal-700 text-white rounded-[20px] font-bold transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[e.jsx(F,{size:20}),e.jsx("span",{children:"Go to Profile"}),e.jsx(T,{size:20})]}),e.jsx("button",{onClick:()=>h(!1),className:"w-full py-3 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 rounded-[20px] font-semibold transition-all text-sm",children:"I'll do this later"})]})]})]})})}):e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 px-6 pt-10 pb-32 animate-in fade-in duration-500",children:[e.jsxs("header",{className:"flex justify-between items-end mb-6 flex-shrink-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs font-semibold uppercase tracking-widest mb-2",children:"Your Personal Coach"}),e.jsx("h1",{className:"text-3xl font-extrabold text-gray-900 dark:text-gray-50 tracking-tight leading-none",children:"Cal Coach"})]}),e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-royal-500 to-royal-700 rounded-full flex items-center justify-center text-white shadow-sm",children:e.jsx(ae,{size:20})})]}),e.jsxs("div",{ref:P,onScroll:_,className:"flex-1 overflow-y-auto space-y-4 mb-4 no-scrollbar",children:[j&&e.jsx("div",{className:"flex justify-center py-3 animate-in fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 text-sm",children:[e.jsx(A,{size:14,className:"animate-spin"}),e.jsx("span",{children:"Loading previous messages..."})]})}),!j&&x&&a.length>1&&e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-500",children:"â†‘ Scroll up to load older messages"})}),a.map(s=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-2 duration-300`,children:e.jsx("div",{className:`max-w-[85%] ${s.role==="user"?"bg-royal-600 text-white rounded-[24px] px-5 py-3 shadow-lg":""}`,children:s.role==="assistant"?e.jsxs("div",{children:[e.jsx($,{className:"p-5",children:e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:e.jsx("div",{className:"text-gray-800 dark:text-gray-200 leading-relaxed whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:s.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br/>")}})})}),ye(s.content)&&e.jsxs("button",{onClick:()=>{K(s.content),L(!0)},className:"mt-3 flex items-center gap-2 px-4 py-2 bg-royal-600 hover:bg-royal-700 text-white text-sm font-semibold rounded-xl transition-all shadow-lg shadow-royal-200 dark:shadow-royal-900/40 active:scale-95",children:[e.jsx(G,{size:16}),e.jsx("span",{children:"Save as Workout Plan"})]})]}):e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:s.content})})},s.id)),a.length===1&&a[0].role==="assistant"&&!n&&e.jsx("div",{className:"grid grid-cols-1 gap-3 mt-4 animate-in fade-in slide-in-from-bottom-4 duration-500 delay-300",children:[{title:"Analyze Nutrition",desc:"Get insights on your recent eating habits",icon:"ðŸ“Š",text:"Analyze my recent nutrition",color:"from-blue-500/30 to-royal-500/30",baseBg:"bg-blue-50/40 dark:bg-blue-900/10",iconBg:"bg-blue-100 dark:bg-blue-900/40",iconBorder:"border-blue-200 dark:border-blue-700/50"},{title:"Workout Plan",desc:"Create a personalized fitness routine",icon:"ðŸ’ª",text:"Create a workout plan for me",color:"from-royal-500/30 to-indigo-500/30",baseBg:"bg-royal-50/40 dark:bg-royal-950/20",iconBg:"bg-royal-100 dark:bg-royal-950/40",iconBorder:"border-royal-200 dark:border-royal-700/50"},{title:"Calculate TDEE",desc:"Find out your daily energy expenditure",icon:"ðŸ”¥",text:"Calculate my TDEE",color:"from-orange-500/30 to-royal-500/30",baseBg:"bg-orange-50/40 dark:bg-orange-900/10",iconBg:"bg-orange-100 dark:bg-orange-900/40",iconBorder:"border-orange-200 dark:border-orange-700/50"},{title:"Macro Targets",desc:"Set optimal protein, carb, and fat goals",icon:"ðŸŽ¯",text:"Help me set macro targets",color:"from-violet-500/30 to-fuchsia-500/30",baseBg:"bg-violet-50/40 dark:bg-violet-900/10",iconBg:"bg-violet-100 dark:bg-violet-900/40",iconBorder:"border-violet-200 dark:border-violet-700/50"}].map((s,b)=>e.jsxs("button",{onClick:()=>{(async y=>{if(n)return;const w={id:crypto.randomUUID(),role:"user",content:y,timestamp:Date.now()};o(f=>[...f,w]),i(!0),S(w).catch(f=>console.error("Failed to save user message:",f));try{const f=await I(y,a),k={id:crypto.randomUUID(),role:"assistant",content:f,timestamp:Date.now()};o(g=>[...g,k]),S(k).catch(g=>console.error("Failed to save assistant message:",g))}catch(f){const k={id:crypto.randomUUID(),role:"assistant",content:`âš ï¸ ${f.message||"Failed to get response."}`,timestamp:Date.now()};o(g=>[...g,k])}finally{i(!1)}})(s.text)},className:`flex items-center gap-4 p-4 ${s.baseBg} border-2 border-gray-100 dark:border-white/10 rounded-2xl hover:border-royal-500 dark:hover:border-royal-400 hover:shadow-xl hover:shadow-royal-500/10 transition-all text-left group active:scale-[0.98] relative overflow-hidden`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.color} opacity-0 group-hover:opacity-100 transition-opacity`}),e.jsx("div",{className:`relative z-10 w-12 h-12 ${s.iconBg} ${s.iconBorder} border rounded-xl flex items-center justify-center text-2xl group-hover:scale-110 transition-transform shadow-sm group-hover:shadow-md`,children:s.icon}),e.jsxs("div",{className:"relative z-10 flex-1",children:[e.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 text-sm tracking-tight",children:s.title}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mt-0.5 font-semibold opacity-80",children:s.desc})]}),e.jsx("div",{className:"relative z-10 w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 dark:bg-white/10 group-hover:bg-royal-500 group-hover:text-white transition-all shadow-sm",children:e.jsx(T,{size:16,className:"text-gray-400 dark:text-gray-500 group-hover:text-white group-hover:translate-x-0.5 transition-all"})})]},b))}),n&&e.jsx("div",{className:"flex justify-start animate-in fade-in duration-300",children:e.jsx($,{className:"p-5",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400",children:[e.jsx(A,{size:16,className:"animate-spin"}),e.jsx("span",{className:"text-sm",children:"Coach is thinking..."})]})})}),e.jsx("div",{ref:z})]}),a.length>1&&!n&&e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 px-1 no-scrollbar animate-in fade-in slide-in-from-bottom-2 duration-500",children:[{title:"Analyze Nutrition",icon:"ðŸ“Š",text:"Analyze my recent nutrition",color:"from-blue-500/30 to-royal-500/30",baseBg:"bg-blue-50/40 dark:bg-blue-900/10",iconBg:"bg-blue-100 dark:bg-blue-900/40",iconBorder:"border-blue-200 dark:border-blue-700/50"},{title:"Workout Plan",icon:"ðŸ’ª",text:"Create a workout plan for me",color:"from-royal-500/30 to-indigo-500/30",baseBg:"bg-royal-50/40 dark:bg-royal-950/20",iconBg:"bg-royal-100 dark:bg-royal-950/40",iconBorder:"border-royal-200 dark:border-royal-700/50"},{title:"Calculate TDEE",icon:"ðŸ”¥",text:"Calculate my TDEE",color:"from-orange-500/30 to-royal-500/30",baseBg:"bg-orange-50/40 dark:bg-orange-900/10",iconBg:"bg-orange-100 dark:bg-orange-900/40",iconBorder:"border-orange-200 dark:border-orange-700/50"},{title:"Macro Targets",icon:"ðŸŽ¯",text:"Help me set macro targets",color:"from-violet-500/30 to-fuchsia-500/30",baseBg:"bg-violet-50/40 dark:bg-violet-900/10",iconBg:"bg-violet-100 dark:bg-violet-900/40",iconBorder:"border-violet-200 dark:border-violet-700/50"}].map((s,b)=>e.jsxs("button",{onClick:()=>{(async y=>{if(n)return;const w={id:`user-${Date.now()}`,role:"user",content:y,timestamp:Date.now()};o(f=>[...f,w]),i(!0),S(w).catch(f=>console.error("Failed to save user message:",f));try{const f=await I(y,a),k={id:crypto.randomUUID(),role:"assistant",content:f,timestamp:Date.now()};o(g=>[...g,k]),S(k).catch(g=>console.error("Failed to save assistant message:",g))}catch(f){const k={id:`error-${Date.now()}`,role:"assistant",content:`âš ï¸ ${f.message||"Failed to get response."}`,timestamp:Date.now()};o(g=>[...g,k])}finally{i(!1)}})(s.text)},className:`flex flex-shrink-0 items-center gap-3 p-3 min-w-[180px] ${s.baseBg} border-2 border-gray-100 dark:border-white/10 rounded-2xl hover:border-royal-500 dark:hover:border-royal-400 transition-all text-left group active:scale-[0.98] relative overflow-hidden`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${s.color} opacity-0 group-hover:opacity-100 transition-opacity`}),e.jsx("div",{className:`relative z-10 w-10 h-10 ${s.iconBg} ${s.iconBorder} border rounded-xl flex items-center justify-center text-xl group-hover:scale-110 transition-transform shadow-sm`,children:s.icon}),e.jsx("div",{className:"relative z-10 flex-1",children:e.jsx("h3",{className:"font-extrabold text-gray-900 dark:text-gray-50 text-xs tracking-tight leading-tight",children:s.title})})]},b))}),e.jsx("div",{className:"flex-shrink-0 bg-white dark:bg-[#1a1c26] rounded-[24px] p-3 shadow-diffused dark:shadow-diffused-dark border border-gray-100 dark:border-white/5",children:e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsx("textarea",{ref:B,value:l,onChange:s=>c(s.target.value),onKeyDown:Y,placeholder:"Ask your coach anything...",className:"flex-1 bg-transparent text-gray-900 dark:text-gray-50 placeholder-gray-400 dark:placeholder-gray-500 resize-none outline-none text-sm min-h-[40px] max-h-[120px] py-2 px-3",rows:1,disabled:n}),e.jsx("button",{onClick:E,disabled:!l.trim()||n,className:"flex-shrink-0 w-10 h-10 bg-royal-600 text-white rounded-[16px] flex items-center justify-center hover:bg-royal-700 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-royal-200 dark:shadow-royal-900/40",children:n?e.jsx(A,{size:18,className:"animate-spin"}):e.jsx(de,{size:18})})]})}),e.jsx(xe,{isOpen:q,onClose:()=>L(!1),workoutText:H})]})};export{Se as CalCoach};
