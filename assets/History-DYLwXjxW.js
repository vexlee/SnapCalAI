import{c as Ue,j as e,d as me,v as Ge,S as ge,D as Oe,w as Z,x as J,y as B,b as he,z as pe,g as Ye,E as He,F as Be,f as qe}from"./index-DC3id3Mb.js";import{r as x}from"./vendor-react-wGySg1uH.js";import{C as X}from"./Card-BWzeMHvH.js";import{C as Je,U as Ve,M as de,a as Ke}from"./MealDetailModal-BsQK25xA.js";import{X as ue}from"./x-C_Ytw0rY.js";import{C as q}from"./calendar-Bo1Lwrvo.js";import{A as Xe,R as be}from"./users-4_U-RpyW.js";import{T as ye,C as Qe}from"./trending-up-D0C4-wXC.js";import{S as Ze}from"./scale-BJ-ZQiE6.js";import{C as fe}from"./chevron-left-B8KuD6i8.js";import{T as et}from"./target-C15aZRWT.js";import{T as $,G as tt}from"./index-cQ6qJtkF.js";import{C as Q}from"./chevron-right-CazGvmaI.js";import{L as at}from"./loader-2-CS7Iyy8I.js";import"./vendor-charts-Bdt_fL2G.js";import"./vendor-supabase-DfwcnzK-.js";import"./camera-CyyPOWEX.js";import"./trash-2-cUg5ghus.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=Ue("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),st=({summary:a,onClose:i})=>{const d=new Date(a.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/40 backdrop-blur-md p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[40px] overflow-hidden shadow-2xl border border-white/50 animate-in slide-in-from-bottom duration-300",children:[e.jsxs("div",{className:"relative bg-royal-50 p-8 pb-10",children:[e.jsx("div",{className:"absolute top-6 right-6",children:e.jsx("button",{onClick:i,className:"p-2 bg-white text-gray-900 rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:e.jsx(ue,{size:20})})}),e.jsxs("div",{className:"flex items-center gap-2 text-royal-600 mb-3",children:[e.jsx(q,{size:20}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:"Daily Report"})]}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 leading-tight",children:d})]}),e.jsxs("div",{className:"p-8 -mt-6 bg-white rounded-t-[32px] relative shadow-[-10px_-10px_30px_rgba(0,0,0,0.02)]",children:[e.jsxs("div",{className:"bg-white rounded-[32px] p-6 border border-gray-100 shadow-[0_10px_30px_-10px_rgba(0,0,0,0.05)] mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1 block",children:"Total Consumed"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-5xl font-extrabold text-gray-900 tracking-tighter",children:a.totalCalories}),e.jsx("span",{className:"text-gray-400 font-bold text-lg",children:"kcal"})]})]}),e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-royal-50 flex items-center justify-center text-royal-600",children:e.jsx(Xe,{size:28})})]}),e.jsxs("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(Je,{size:16})," Macro Breakdown"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-emerald-50 hover:border-emerald-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-emerald-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalProtein,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Protein"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-blue-50 hover:border-blue-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-blue-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalCarbs,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Carbs"})]})]})}),e.jsx("div",{className:"bg-gray-50 p-5 rounded-[24px] border border-gray-100 flex items-center justify-between relative overflow-hidden group hover:bg-orange-50 hover:border-orange-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[e.jsx("div",{className:"w-1.5 h-10 bg-orange-400 rounded-full"}),e.jsxs("div",{children:[e.jsxs("span",{className:"block text-2xl font-bold text-gray-900",children:[a.totalFat,"g"]}),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold tracking-widest",children:"Fat"})]})]})})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 flex justify-between items-center text-xs font-bold text-gray-400 uppercase tracking-wider",children:[e.jsxs("span",{children:[a.entries.length," meals tracked"]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-royal-600",children:[e.jsx(ye,{size:14}),"See History Tab"]})]})]})]})})},ot=({onClose:a,onConfirm:i})=>{const[d,b]=x.useState(0),[m,g]=x.useState(""),[r,c]=x.useState(!1),[o,f]=x.useState(!0),[E,A]=x.useState(!1),[T,M]=x.useState(null);x.useEffect(()=>{(async()=>{const F=await me();F&&(M(F),b(F.weight),g(F.weight.toString())),f(!1)})()},[]);const P=async()=>{const j=parseFloat(m)||d;if(r&&T&&j!==d){A(!0);try{await Ge({...T,weight:j}),b(j)}catch(F){console.error("Failed to save weight:",F)}A(!1)}i(j)};return o?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center animate-in fade-in duration-300",children:e.jsx("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-8 w-[90%] max-w-sm shadow-2xl",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-royal-200 dark:border-royal-800 border-t-royal-600 rounded-full animate-spin"})})})}):e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-end sm:items-center justify-center animate-in fade-in duration-300",onClick:a,children:e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-t-[28px] sm:rounded-[28px] p-6 w-full sm:w-[90%] sm:max-w-sm shadow-2xl animate-in slide-in-from-bottom duration-500",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-royal-100 dark:bg-royal-900/30 flex items-center justify-center",children:e.jsx(Ze,{size:20,className:"text-royal-600 dark:text-royal-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-black text-gray-900 dark:text-gray-50",children:"Weight Check"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-medium",children:"Before viewing your report"})]})]}),e.jsx("button",{onClick:a,className:"w-8 h-8 rounded-xl bg-gray-100 dark:bg-white/5 flex items-center justify-center hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:e.jsx(ue,{size:16,className:"text-gray-400"})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-white/5 rounded-2xl p-5 mb-6",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4 text-center",children:"Is your current weight still accurate?"}),r?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:m,onChange:j=>g(j.target.value),className:"w-28 text-center text-3xl font-black text-gray-900 dark:text-gray-50 bg-white dark:bg-[#0F111A] border-2 border-royal-200 dark:border-royal-800 rounded-xl py-2 focus:outline-none focus:border-royal-500",step:"0.1",min:"20",max:"300",autoFocus:!0}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm font-bold text-gray-400",children:"kg"})]}),e.jsx("button",{onClick:()=>{c(!1),g(d.toString())},className:"text-xs text-gray-400 font-medium hover:text-gray-600",children:"Cancel"})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-black text-gray-900 dark:text-gray-50 mb-1",children:[d,e.jsx("span",{className:"text-lg font-bold text-gray-400 ml-1",children:"kg"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"text-xs text-royal-600 dark:text-royal-400 font-bold flex items-center gap-1 mx-auto hover:underline",children:[e.jsx(be,{size:12}),"Update weight"]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,className:"flex-1 py-3.5 rounded-xl bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 font-bold text-sm hover:bg-gray-200 dark:hover:bg-white/10 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:P,disabled:E,className:"flex-1 py-3.5 rounded-xl bg-royal-600 text-white font-bold text-sm hover:bg-royal-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:E?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:16}),"Confirm"]})})]})]})})},lt=({report:a,reportType:i,onClose:d,onRegenerate:b,isRegenerating:m=!1})=>{const g=()=>{const c=new Date(a.periodStart),o=new Date(a.periodEnd);if(i==="daily")return c.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});if(i==="weekly"){const f=c.toLocaleDateString("en-US",{month:"short",day:"numeric"}),E=o.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${f} - ${E}`}return c.toLocaleDateString("en-US",{month:"long",year:"numeric"})},r=()=>{switch(i){case"daily":return"Daily Review";case"weekly":return"Weekly Summary";case"monthly":return"Monthly Report"}};return e.jsx("div",{className:"fixed inset-0 bg-[#F8F9FE] dark:bg-[#0F111A] z-[100] animate-in slide-in-from-right duration-300 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen pb-20",children:[e.jsx("div",{className:"sticky top-0 bg-[#F8F9FE]/80 dark:bg-[#0F111A]/80 backdrop-blur-xl z-10 px-6 pt-10 pb-4 border-b border-gray-100 dark:border-white/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:d,className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 hover:text-royal-600 transition-colors",children:[e.jsx(fe,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back"})]}),e.jsxs("button",{onClick:b,disabled:m,className:"flex items-center gap-2 text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl hover:bg-royal-100 dark:hover:bg-royal-900/30 transition-colors disabled:opacity-50",children:[e.jsx(be,{size:12,className:m?"animate-spin":""}),m?"Generating...":"Regenerate"]})]})}),e.jsxs("div",{className:"px-6 pt-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{size:20,className:"text-royal-600 dark:text-royal-400"}),e.jsx("span",{className:"text-[10px] font-bold text-royal-600 dark:text-royal-400 uppercase tracking-widest",children:"Coach Tips"})]}),e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight mb-1",children:r()}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500",children:[e.jsx(q,{size:14}),e.jsx("span",{className:"text-sm font-medium",children:g()})]})]}),e.jsx("div",{className:"bg-gradient-to-br from-royal-500 to-royal-700 rounded-[24px] p-6 mb-6 shadow-lg shadow-royal-200/30 dark:shadow-royal-900/40",children:e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center flex-shrink-0",children:e.jsx(ye,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white/80 mb-1",children:"Summary"}),e.jsx("p",{className:"text-white text-sm leading-relaxed",children:a.summary})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Period Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-orange-100 dark:bg-orange-500/10 flex items-center justify-center",children:e.jsx(Ve,{size:12,className:"text-orange-600 dark:text-orange-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Calories"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.avgCalories,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"kcal"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-emerald-100 dark:bg-emerald-500/10 flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-black text-emerald-600 dark:text-emerald-400",children:"P"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Avg Protein"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.avgProtein,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"g"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-purple-100 dark:bg-purple-500/10 flex items-center justify-center",children:e.jsx(Oe,{size:12,className:"text-purple-600 dark:text-purple-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Workouts"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.workoutsCompleted,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"done"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-lg bg-blue-100 dark:bg-blue-500/10 flex items-center justify-center",children:e.jsx(et,{size:12,className:"text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Rate"})]}),e.jsxs("span",{className:"text-xl font-black text-gray-900 dark:text-gray-50",children:[a.metrics.calorieGoalHitRate,e.jsx("span",{className:"text-xs font-bold text-gray-400 ml-1",children:"%"})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xs font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-3",children:"Improvement Tips"}),e.jsx("div",{className:"space-y-3",children:a.tips.map((c,o)=>e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-2xl p-4 border border-gray-100 dark:border-white/5 flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-50 dark:bg-white/5 flex items-center justify-center flex-shrink-0 text-xl",children:c.emoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-gray-50 mb-0.5",children:c.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed",children:c.description})]})]},o))})]}),a.weightAtReport&&e.jsxs("div",{className:"text-center text-xs text-gray-400 dark:text-gray-500",children:["Weight at report: ",e.jsxs("span",{className:"font-bold",children:[a.weightAtReport," kg"]})]})]})]})})},nt=()=>"AIzaSyBe0v3rn4bATheRJCE77AmY58Op-tiJJVU",it=()=>new tt({apiKey:nt()}),we="snapcal_coach_reports_v1",dt=`You are **Cal Coach**, providing personalized health and fitness reviews.

**Your Role:**
Generate concise, motivating, and actionable reports based on the user's tracking data.

**Report Guidelines:**
1. **Summary**: 2-3 sentences highlighting key achievements and areas for improvement
2. **Tips**: Exactly 3 specific, actionable tips 
3. **Tone**: Encouraging but honest. Celebrate wins, gently address gaps

**Tip Format:**
Each tip should have:
- emoji: A relevant emoji (ðŸ¥—, ðŸ’ª, ðŸŽ¯, âš¡, ðŸ’§, ðŸ”¥, etc.)
- title: Short action phrase (3-5 words)
- description: One sentence explaining the tip

**Never:**
- Be negative or discouraging
- Give generic advice that doesn't relate to the user's data
- Use medical disclaimers or suggest consulting doctors
- Repeat the same tip twice`,ct=async(a,i)=>{if(!Z){const g=localStorage.getItem("snapcal_workouts");return g?JSON.parse(g).filter(c=>c.date>=a&&c.date<=i):[]}const d=await J();if(!d)return[];const{data:b,error:m}=await B.from("workout_plans").select("*").eq("user_id",d.id).gte("date",a).lte("date",i);return m?(console.error("Failed to fetch workout plans:",m),[]):b.map(g=>({id:g.id,date:g.date,title:g.title,exercises:g.exercises||[]}))},xt=async(a,i,d)=>{const[b,m,g,r]=await Promise.all([me(),he(),pe(),ct(i,d)]),c=g.filter(u=>u.date>=i&&u.date<=d),o=c.length,f=c.reduce((u,w)=>u+(w.totalCalories>0?1:0),0),E=o>0?Math.round(c.reduce((u,w)=>u+w.totalCalories,0)/o):0,A=o>0?Math.round(c.reduce((u,w)=>u+w.totalProtein,0)/o):0,T=o>0?Math.round(c.reduce((u,w)=>u+w.totalCarbs,0)/o):0,M=o>0?Math.round(c.reduce((u,w)=>u+w.totalFat,0)/o):0,P=c.filter(u=>Math.abs(u.totalCalories-m)<=m*.1).length,j=o>0?Math.round(P/o*100):0,F=r.filter(u=>u.exercises.some(w=>w.completed)).length,_={avgCalories:E,avgProtein:A,avgCarbs:T,avgFat:M,totalMeals:f,workoutsCompleted:F,daysTracked:o,calorieGoalHitRate:j},V=c.map(u=>({date:u.date,calories:u.totalCalories,protein:u.totalProtein,carbs:u.totalCarbs,fat:u.totalFat,meals:u.totalCalories>0?1:0}));return{profile:b,dailyGoal:m,periodStart:i,periodEnd:d,reportType:a,metrics:_,dailyBreakdown:V,workoutsCompleted:F}},mt=a=>{const{profile:i,dailyGoal:d,periodStart:b,periodEnd:m,reportType:g,metrics:r,dailyBreakdown:c}=a;let o=`**${g.charAt(0).toUpperCase()+g.slice(1)} Health Review**
`;return o+=`Period: ${b} to ${m}

`,i&&(o+=`**User Profile:**
`,i.name&&(o+=`- Name: ${i.name}
`),i.weight&&(o+=`- Weight: ${i.weight} kg
`),i.height&&(o+=`- Height: ${i.height} cm
`),i.goal&&(o+=`- Goal: ${{cut:"Lose weight",bulk:"Build muscle",maintain:"Maintain weight"}[i.goal]}
`),o+=`- Daily Calorie Goal: ${d} kcal

`),o+=`**Period Statistics:**
`,o+=`- Days tracked: ${r.daysTracked}
`,o+=`- Average daily calories: ${r.avgCalories} kcal (Goal: ${d})
`,o+=`- Average protein: ${r.avgProtein}g
`,o+=`- Average carbs: ${r.avgCarbs}g
`,o+=`- Average fat: ${r.avgFat}g
`,o+=`- Calorie goal hit rate: ${r.calorieGoalHitRate}%
`,o+=`- Workouts completed: ${r.workoutsCompleted}

`,c.length>0&&c.length<=7&&(o+=`**Daily Breakdown:**
`,c.forEach(f=>{o+=`- ${f.date}: ${f.calories} kcal, P: ${f.protein}g, C: ${f.carbs}g, F: ${f.fat}g
`})),o+=`
---

Provide a summary and 3 actionable tips based on this data.`,o},gt=async a=>{const i=it(),d=mt(a),b=await i.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:d}]}],config:{systemInstruction:dt,responseMimeType:"application/json",responseSchema:{type:$.OBJECT,properties:{summary:{type:$.STRING},tips:{type:$.ARRAY,items:{type:$.OBJECT,properties:{emoji:{type:$.STRING},title:{type:$.STRING},description:{type:$.STRING}},required:["emoji","title","description"]}}},required:["summary","tips"]}}});return JSON.parse(b.text||'{"summary": "", "tips": []}')},ke=()=>{try{const a=localStorage.getItem(we);return a?JSON.parse(a):[]}catch{return[]}},ht=a=>{localStorage.setItem(we,JSON.stringify(a))},je=async(a,i,d)=>{if(!Z)return ke().find(c=>c.reportType===a&&c.periodStart===i&&c.periodEnd===d)||null;const b=await J();if(!b)return null;const{data:m,error:g}=await B.from("coach_reports").select("*").eq("user_id",b.id).eq("report_type",a).eq("period_start",i).eq("period_end",d).single();return g||!m?null:{id:m.id,userId:m.user_id,reportType:m.report_type,periodStart:m.period_start,periodEnd:m.period_end,summary:m.summary,tips:m.tips,metrics:m.metrics,weightAtReport:m.weight_at_report,createdAt:m.created_at}},pt=async a=>{if(!Z){const m=ke().filter(g=>!(g.reportType===a.reportType&&g.periodStart===a.periodStart&&g.periodEnd===a.periodEnd));m.push(a),ht(m);return}const i=await J();if(!i)throw new Error("User not authenticated");await B.from("coach_reports").delete().eq("user_id",i.id).eq("report_type",a.reportType).eq("period_start",a.periodStart).eq("period_end",a.periodEnd);const{error:d}=await B.from("coach_reports").insert({id:a.id,user_id:i.id,report_type:a.reportType,period_start:a.periodStart,period_end:a.periodEnd,summary:a.summary,tips:a.tips,metrics:a.metrics,weight_at_report:a.weightAtReport});if(d)throw console.error("Failed to save report:",d),new Error("Failed to save report")},ut=async(a,i,d,b)=>{var o;const m=await J();if(!m)throw new Error("User not authenticated");const g=await xt(a,i,d),r=await gt(g),c={id:`${a}_${i}_${Date.now()}`,userId:m.id,reportType:a,periodStart:i,periodEnd:d,summary:r.summary,tips:r.tips.slice(0,3),metrics:g.metrics,weightAtReport:b||((o=g.profile)==null?void 0:o.weight),createdAt:new Date().toISOString()};return await pt(c),c},ce=async(a,i,d,b=!1,m)=>{if(!b){const g=await je(a,i,d);if(g)return g}return ut(a,i,d,m)},xe=(a,i)=>{if(a==="daily")return{start:i,end:i};if(a==="weekly"){const c=new Date(i),o=new Date(c);o.setDate(c.getDate()+6);const f=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`;return{start:i,end:f}}const[d,b]=i.split("-").map(Number),m=new Date(d,b,0),g=`${d}-${String(b).padStart(2,"0")}-01`,r=`${d}-${String(b).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")}`;return{start:g,end:r}},_t=()=>{const[a,i]=x.useState([]),[d,b]=x.useState(2e3),[m,g]=x.useState(!0),[r,c]=x.useState("day"),[o,f]=x.useState(null),[E,A]=x.useState(null),[T,M]=x.useState(!1),[P,j]=x.useState(null),[F,_]=x.useState(!1),[V,u]=x.useState(!1),[w,U]=x.useState(null),[Ne,G]=x.useState(!1),[ve,ee]=x.useState(!1),[N,Se]=x.useState(Ye()),[S,Ce]=x.useState(new Date().toISOString().substring(0,7)),[v,De]=x.useState(()=>{const t=new Date,s=t.getDay(),l=s===0?-6:1-s,n=new Date(t);n.setDate(t.getDate()+l);const h=n.getFullYear(),p=String(n.getMonth()+1).padStart(2,"0"),y=String(n.getDate()).padStart(2,"0");return`${h}-${p}-${y}`}),[Fe,te]=x.useState(!1),[Ee,Re]=x.useState({}),[R,O]=x.useState({}),[Me,ae]=x.useState({}),[Y,z]=x.useState({}),K=x.useRef(null);document.documentElement.classList.contains("dark");const re=x.useCallback(()=>{if(K.current){const t=K.current;t.scrollLeft=t.scrollWidth}},[]);x.useEffect(()=>{const t=setTimeout(re,100);return()=>clearTimeout(t)},[r,re]);const H=async()=>{g(!0);try{const[t,s]=await Promise.all([pe(),he()]);i(t),b(s),W(N)}catch(t){console.error("Failed to load history data",t)}finally{g(!1)}},W=x.useCallback(async t=>{if(!R[t]){ae(s=>({...s,[t]:!0}));try{const s=await He(t);O(l=>({...l,[t]:s}))}catch(s){console.error(`Failed to load entries for ${t}`,s)}finally{ae(s=>({...s,[t]:!1}))}}},[R]),$e=x.useCallback(async t=>{if(Y[t]===void 0){z(s=>({...s,[t]:null}));try{const s=await Be(t);z(l=>({...l,[t]:s}))}catch(s){console.error(`Failed to load image for entry ${t}`,s)}}},[Y]);x.useEffect(()=>{H();const t=()=>{O({}),z({}),H()};return window.addEventListener("food-entry-updated",t),()=>window.removeEventListener("food-entry-updated",t)},[]),x.useEffect(()=>{N&&(r==="day"||r==="week")&&W(N)},[N,W,r]);const se=async t=>{await qe(t),O({}),z({}),await H()},oe=t=>{f(null),j(t),M(!0)},Ae=async()=>{G(!0);try{const t=r==="day"?"daily":r==="week"?"weekly":"monthly",s=r==="day"?N:r==="week"?v:S,{start:l,end:n}=xe(t,s),h=await je(t,l,n);h?(U(h),u(!0)):_(!0)}catch(t){console.error("Failed to check for report:",t),_(!0)}finally{G(!1)}},Te=async t=>{_(!1),G(!0);try{const s=r==="day"?"daily":r==="week"?"weekly":"monthly",l=r==="day"?N:r==="week"?v:S,{start:n,end:h}=xe(s,l),p=await ce(s,n,h,!1,t);U(p),u(!0)}catch(s){console.error("Failed to generate report:",s),alert("Failed to generate AI report. Please try again.")}finally{G(!1)}},_e=async()=>{if(w){ee(!0);try{const t=await ce(w.reportType,w.periodStart,w.periodEnd,!0);U(t)}catch(t){console.error("Failed to regenerate report:",t),alert("Failed to regenerate report. Please try again.")}finally{ee(!1)}}},le=t=>(Y[t.id]===void 0&&$e(t.id),{...t,imageUrl:Y[t.id]||void 0}),Le=x.useMemo(()=>{if(r==="day"){const t=[],s=new Date,l=new Date(s.getFullYear(),s.getMonth(),1);for(let n=new Date(l);n<=s;n.setDate(n.getDate()+1)){const h=n.getFullYear(),p=String(n.getMonth()+1).padStart(2,"0"),y=String(n.getDate()).padStart(2,"0"),k=`${h}-${p}-${y}`;t.push({id:k,name:n.toLocaleDateString("en-US",{weekday:"short"}),label:n.getDate().toString(),date:k})}return t}else if(r==="week"){const t=[],s=new Date,l=s.getDay(),n=l===0?-6:1-l,h=new Date(s);h.setDate(s.getDate()+n);for(let p=0;p<8;p++){const y=new Date(h);y.setDate(h.getDate()-p*7);const k=new Date(y);k.setDate(y.getDate()+6);const C=y.toLocaleDateString("en-US",{month:"short",day:"numeric"}),D=k.toLocaleDateString("en-US",{day:"numeric"}),I=y.getFullYear(),ze=String(y.getMonth()+1).padStart(2,"0"),We=String(y.getDate()).padStart(2,"0"),ie=`${I}-${ze}-${We}`;t.push({id:ie,name:"Week",label:`${C} - ${D}`,date:ie})}return t.reverse()}else{const t=new Set;return a.forEach(l=>{const n=l.date.substring(0,7);t.add(n)}),Array.from(t).sort().map(l=>{const[n,h]=l.split("-"),p=new Date(parseInt(n),parseInt(h)-1,1);return{id:l,name:p.toLocaleDateString("en-US",{year:"2-digit"}),label:p.toLocaleDateString("en-US",{month:"short"}),date:l}})}},[r,a]),L=x.useMemo(()=>{if(r==="day")return a.find(t=>t.date===N)||{date:N,totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};if(r==="week"){if(!v)return{date:"",totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0};const t=new Date(v),s=new Date(t);s.setDate(t.getDate()+6);const l=v,n=s.getFullYear(),h=String(s.getMonth()+1).padStart(2,"0"),p=String(s.getDate()).padStart(2,"0"),y=`${n}-${h}-${p}`,C=a.filter(D=>D.date>=l&&D.date<=y).reduce((D,I)=>({totalCalories:D.totalCalories+I.totalCalories,totalProtein:D.totalProtein+I.totalProtein,totalCarbs:D.totalCarbs+I.totalCarbs,totalFat:D.totalFat+I.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:v,...C}}else{const s=a.filter(l=>l.date.startsWith(S)).reduce((l,n)=>({totalCalories:l.totalCalories+n.totalCalories,totalProtein:l.totalProtein+n.totalProtein,totalCarbs:l.totalCarbs+n.totalCarbs,totalFat:l.totalFat+n.totalFat}),{totalCalories:0,totalProtein:0,totalCarbs:0,totalFat:0});return{date:S,...s}}},[a,N,S,v,r]),Ie=x.useMemo(()=>{if(r==="day")return[];const t=l=>{if(r==="month")return l.startsWith(S);if(r==="week"&&v)try{const[n,h,p]=v.split("-").map(Number),y=new Date(n,h-1,p),k=new Date(y);k.setDate(y.getDate()+6);const C=new Date(l);return C>=y&&C<=k}catch{return!1}return!1};return Object.entries(R).filter(([l])=>t(l)).flatMap(([l,n])=>n).sort((l,n)=>n.timestamp.localeCompare(l.timestamp))},[R,S,v,r]),ne=x.useMemo(()=>{if(r==="day")return{};const t=l=>{if(r==="month")return l.startsWith(S);if(r==="week"&&v)try{const[n,h,p]=v.split("-").map(Number),y=new Date(n,h-1,p),k=new Date(y);k.setDate(y.getDate()+6);const C=new Date(l);return C>=y&&C<=k}catch{return!1}return!1},s={};return Object.entries(R).filter(([l])=>t(l)).forEach(([l,n])=>{n.length>0&&(s[l]=n.sort((h,p)=>p.timestamp.localeCompare(h.timestamp)))}),s},[R,S,v,r]),Pe=t=>{Re(s=>({...s,[t]:!s[t]}))};return x.useEffect(()=>{r==="month"&&a.filter(s=>s.date.startsWith(S)).map(s=>s.date).forEach(s=>W(s))},[r,S,a,W]),Fe?e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in slide-in-from-right duration-500 bg-[#F8F9FE] dark:bg-[#0F111A]",children:[e.jsxs("div",{className:"px-6 pt-10 pb-32 overflow-y-auto no-scrollbar",children:[e.jsxs("button",{onClick:()=>te(!1),className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 mb-6 hover:text-royal-600 transition-colors",children:[e.jsx(fe,{size:20}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest",children:"Back to Report"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"History Log"}),e.jsx("div",{className:"text-xs font-bold text-royal-600 dark:text-royal-400 bg-royal-50 dark:bg-royal-900/20 px-3 py-1.5 rounded-xl border border-royal-100 dark:border-royal-800/50",children:r==="week"?new Date(N).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):new Date(S+"-01").toLocaleDateString(void 0,{month:"long",year:"numeric"})})]}),e.jsx("div",{className:"space-y-4",children:r==="day"?Me[N]?e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(t=>e.jsx("div",{className:"h-20 bg-white dark:bg-[#1A1C26] rounded-[24px] animate-pulse border border-gray-100 dark:border-white/5"},t))}):(R[N]||[]).length>0?(R[N]||[]).map(t=>{const s=le(t);return e.jsxs("div",{onClick:()=>f(s),className:"bg-white dark:bg-[#1A1C26] p-4 flex justify-between items-center rounded-[24px] shadow-sm border border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer active:scale-[0.98]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold",children:t.food_item}),e.jsx("span",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:t.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:t.calories}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},t.id)}):e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[e.jsx(q,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:"No meals logged for this day."})]}):Object.keys(ne).length>0?Object.entries(ne).sort(([t],[s])=>s.localeCompare(t)).map(([t,s])=>{const l=Ee[t],n=s.reduce((h,p)=>h+p.calories,0);return e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] border border-gray-100 dark:border-white/5 overflow-hidden",children:[e.jsxs("button",{onClick:()=>Pe(t),className:"w-full p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`transition-transform duration-200 ${l?"rotate-90":""}`,children:e.jsx(Q,{size:16,className:"text-gray-400"})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-gray-50",children:new Date(t).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}),e.jsxs("span",{className:"text-[9px] font-medium text-gray-400",children:[s.length," meal",s.length!==1?"s":""]})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:n}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]}),l&&e.jsx("div",{className:"border-t border-gray-100 dark:border-white/5",children:s.map(h=>{const p=le(h);return e.jsxs("div",{onClick:()=>f(p),className:"p-4 flex justify-between items-center hover:bg-gray-50 dark:hover:bg-white/5 transition-all cursor-pointer border-b border-gray-50 dark:border-white/5 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-50 dark:bg-white/5 overflow-hidden shadow-inner border border-gray-100 dark:border-white/5",children:p.imageUrl?e.jsx("img",{src:p.imageUrl,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-100 dark:bg-white/10 text-gray-300 dark:text-gray-700",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-700"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-gray-50 font-bold leading-tight",children:h.food_item}),e.jsx("span",{className:"text-[9px] text-gray-400 dark:text-gray-500",children:h.time})]})]}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx("span",{className:"text-sm text-royal-600 dark:text-royal-400 font-black",children:h.calories}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"kcal"})]})]},h.id)})})]},t)}):e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[24px] p-12 text-center border border-dashed border-gray-200 dark:border-white/10",children:[e.jsx(q,{size:32,className:"mx-auto text-gray-200 dark:text-white/5 mb-4"}),e.jsxs("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:["No data for this ",r==="month"?"month":"week","."]})]})})]}),o&&e.jsx(de,{entry:o,onClose:()=>f(null),onDelete:se,onEdit:oe})]}):e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 animate-in fade-in duration-500 overflow-y-auto no-scrollbar relative bg-[#F8F9FE] dark:bg-[#0F111A]",children:[e.jsxs("div",{className:"px-6 pt-10 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-gray-50 tracking-tight",children:"Report"}),e.jsxs("div",{className:"flex p-1 bg-white dark:bg-[#1A1C26] rounded-xl border border-gray-100 dark:border-white/5 shadow-sm",children:[e.jsx("button",{onClick:()=>c("day"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="day"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Daily"}),e.jsx("button",{onClick:()=>c("week"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="week"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Weekly"}),e.jsx("button",{onClick:()=>c("month"),className:`px-3 py-1 rounded-lg text-[10px] font-bold transition-all ${r==="month"?"bg-royal-600 text-white shadow-sm":"text-gray-400 dark:text-gray-500 hover:text-royal-500"}`,children:"Monthly"})]})]}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{ref:K,className:"flex gap-3 overflow-x-auto no-scrollbar pb-2 px-1 snap-x",style:{WebkitOverflowScrolling:"touch"},children:Le.map(t=>{const s=r==="day"?t.id===N:r==="week"?t.id===v:t.id===S,l=a.some(n=>{if(r==="day")return n.date===t.id;if(r==="week"){const[h,p,y]=t.id.split("-").map(Number),k=new Date(h,p-1,y),C=new Date(k);C.setDate(k.getDate()+6);const D=new Date(n.date);return D>=k&&D<=C}return n.date.startsWith(t.id)});return e.jsxs("button",{onClick:()=>{r==="day"?Se(t.id):r==="week"?De(t.id):Ce(t.id)},className:`flex-shrink-0 flex flex-col items-center justify-center ${r==="week"?"w-24":"w-12"} py-3 rounded-2xl transition-all duration-300 snap-center ${s?"bg-royal-600 text-white shadow-lg shadow-royal-200 dark:shadow-royal-900/40 transform scale-110":"bg-white dark:bg-[#1A1C26] text-gray-400 dark:text-gray-500 border border-gray-100 dark:border-white/5"}`,children:[e.jsx("span",{className:`text-[9px] font-bold uppercase mb-1 ${s?"text-white/70":"text-gray-400"}`,children:t.name}),e.jsx("span",{className:"text-sm font-extrabold",children:t.label}),l&&!s&&e.jsx("div",{className:"w-1 h-1 rounded-full bg-royal-400 mt-1"})]},t.id)})}),e.jsx("div",{className:"absolute top-0 left-0 bottom-2 w-8 bg-gradient-to-r from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"}),e.jsx("div",{className:"absolute top-0 right-0 bottom-2 w-8 bg-gradient-to-l from-[#F8F9FE] dark:from-[#0F111A] to-transparent pointer-events-none z-10"})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-white dark:bg-[#1A1C26] rounded-[28px] p-6 shadow-sm border border-gray-100 dark:border-white/5 flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-bold text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-1",children:r==="day"?"Daily Total":r==="week"?"Weekly Total":"Monthly Total"}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("span",{className:"text-5xl font-black text-gray-900 dark:text-gray-50 tracking-tighter",children:Math.round(L.totalCalories)}),e.jsx("span",{className:"text-[10px] font-black text-royal-600 dark:text-royal-400 uppercase tracking-widest mt-0.5",children:"KCAL"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2.5 w-full",children:[e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-emerald-50/30 dark:bg-emerald-500/5 rounded-2xl border border-emerald-100/50 dark:border-emerald-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-emerald-600/60 dark:text-emerald-400/60 uppercase mb-0.5",children:"Protein"}),e.jsxs("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:[Math.round(L.totalProtein),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-amber-50/30 dark:bg-amber-500/5 rounded-2xl border border-amber-100/50 dark:border-amber-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-amber-600/60 dark:text-amber-400/60 uppercase mb-0.5",children:"Carbs"}),e.jsxs("span",{className:"text-sm font-black text-amber-600 dark:text-amber-400",children:[Math.round(L.totalCarbs),"g"]})]}),e.jsxs("div",{className:"flex flex-col items-center py-2.5 bg-rose-50/30 dark:bg-rose-500/5 rounded-2xl border border-rose-100/50 dark:border-rose-500/10 transition-colors",children:[e.jsx("span",{className:"text-[8px] font-bold text-rose-600/60 dark:text-rose-400/60 uppercase mb-0.5",children:"Fat"}),e.jsxs("span",{className:"text-sm font-black text-rose-600 dark:text-rose-400",children:[Math.round(L.totalFat),"g"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs(X,{onClick:Ae,className:"p-5 flex flex-col justify-between h-36 bg-gradient-to-br from-royal-500 to-royal-700 text-white border-none shadow-royal-200/50 cursor-pointer active:scale-[0.98] transition-transform",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(ge,{size:12,className:"text-white/70"}),e.jsx("p",{className:"text-[10px] font-bold text-white/70 uppercase",children:r==="day"?"Coach Tips":"Report"})]}),e.jsx("h3",{className:"text-lg font-black leading-tight",children:r==="day"?"Daily Review":r==="week"?"Weekly Summary":e.jsxs(e.Fragment,{children:["Your Health",e.jsx("br",{}),"Summary"]})})]}),e.jsx("div",{className:"mt-2 py-2 bg-white/20 rounded-xl text-[10px] font-bold backdrop-blur-sm flex items-center justify-center gap-2",children:Ne?e.jsx(at,{size:12,className:"animate-spin"}):e.jsxs(e.Fragment,{children:["VIEW INSIGHTS",e.jsx(Q,{size:12})]})})]}),e.jsxs("div",{className:"grid grid-rows-2 gap-4 h-36",children:[e.jsxs(X,{onClick:()=>te(!0),className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5 active:scale-95 transition-transform cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"History Log"}),e.jsx(Q,{size:10,className:"text-gray-300"})]}),e.jsxs("p",{className:"text-xs font-black text-gray-900 dark:text-gray-50",children:[r==="day"?(R[N]||[]).length:Ie.length," Meals"]})]}),e.jsxs(X,{className:"p-4 flex flex-col justify-center bg-white dark:bg-[#1A1C26] border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase",children:"Goal Status"}),e.jsx(rt,{size:10,className:"text-gray-300"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1 bg-gray-100 dark:bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-royal-500 rounded-full",style:{width:`${Math.min(L.totalCalories/(r==="day"?d:r==="week"?d*7:d*30)*100,100)}%`}})}),e.jsxs("span",{className:"text-[10px] font-black text-gray-900 dark:text-gray-50",children:[Math.round(L.totalCalories/(r==="day"?d:r==="week"?d*7:d*30)*100),"%"]})]})]})]})]}),e.jsx("div",{className:"h-24"})]}),o&&e.jsx(de,{entry:o,onClose:()=>f(null),onDelete:se,onEdit:oe}),E&&e.jsx(st,{summary:E,onClose:()=>A(null)}),T&&e.jsx(Ke,{editEntry:P,onClose:()=>{M(!1),j(null)},onSuccess:()=>{M(!1),j(null),O({}),z({}),H()},onOpenSharedMeal:()=>{M(!1)}}),F&&e.jsx(ot,{onClose:()=>_(!1),onConfirm:Te}),V&&w&&e.jsx(lt,{report:w,reportType:w.reportType,onClose:()=>{u(!1),U(null)},onRegenerate:_e,isRegenerating:ve})]})};export{_t as History};
